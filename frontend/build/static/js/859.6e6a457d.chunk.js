"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[859],{859:function(t,n,e){e.r(n),e.d(n,{default:function(){return S}});var r=e(4165),o=e(3433),s=e(5861),i=e(9439),a=e(2791),c=e(3239),u=e(2763),f=e(9877),l=e(2419),p=e(1243),d=e(7888),h=e(1087),x=e(184),Z=function(t){return t.posts.map((function(t){return(0,x.jsx)(d.Z,{component:h.rU,to:t.id,children:(0,x.jsx)("img",{src:t[0],alt:"test",loading:"lazy"})},t.id)}))},g=(0,a.memo)(Z),m=e(8447),v=e(4554),w=e(4518),j=e(7984),b=function(t){var n=t.openModal,e=t.setOpenModal,o=(0,a.useState)([]),c=(0,i.Z)(o,2),u=c[0],f=c[1],l=(0,a.useState)([]),d=(0,i.Z)(l,2),h=d[0],Z=d[1];function g(){return(g=(0,s.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){for(var n=[],e=function(e){y(u[e],(function(r,o){n.push(o),e===u.length-1&&t(n)}))},r=0;r<u.length;r++)e(r)})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}(0,a.useEffect)((function(){Array.from(u).forEach((function(t){Z((function(n){return[n.push,URL.createObjectURL(t)]}))}))}),[u]);function b(){return(b=(0,s.Z)((0,r.Z)().mark((function t(n){var e,o;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e={},o=0;o<n.length;o++)e[o]=n.shift();return t.next=4,p.Z.post("/api/meditationON/uploadPost",{images:e});case 4:t.sent;case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var y=function(){var t=(0,s.Z)((0,r.Z)().mark((function t(n,e){var o,s;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,j.Z)(n,{maxSizeMB:.1});case 2:o=t.sent,(s=new FileReader).readAsDataURL(o),s.onload=function(){e(null,s.result)},s.onerror=function(t){e(t,null)};case 7:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}();return(0,x.jsx)(m.Z,{open:n,onClose:function(){f([]),Z([]),e(!1)},children:(0,x.jsxs)(v.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"800px",height:"800px",bgcolor:"#ffffff",border:"0.1px solid #f57c00",boxShadow:24,p:2},bgcolor:"white",children:[(0,x.jsx)("div",{style:{display:"flex"},children:h.map((function(t){return(0,x.jsx)("img",{src:t})}))}),(0,x.jsxs)(w.Z,{variant:"contained",component:"label",children:["Upload",(0,x.jsx)("input",{hidden:!0,accept:"image/*",multiple:!0,type:"file",onChange:function(t){return function(t){f(t.target.files)}(t)}})]}),(0,x.jsx)(w.Z,{onClick:function(){(function(){return g.apply(this,arguments)})().then((function(t){!function(t){b.apply(this,arguments)}(t)}))},variant:"contained",component:"label",children:"Submit"})]})})},y=e(4771),S=function(){var t=(0,a.useState)([]),n=(0,i.Z)(t,2),e=n[0],d=n[1],h=(0,a.useState)(!1),Z=(0,i.Z)(h,2),m=Z[0],v=Z[1],w=(0,a.useState)(!0),j=(0,i.Z)(w,2),S=j[0],k=j[1],O=function(){var t=(0,s.Z)((0,r.Z)().mark((function t(){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("test getPosts"),t.next=3,p.Z.get("/api/MeditationON/getPosts".concat(0===e.length?"":"?lastVisible=".concat(e.at(-1).id)));case 3:n=t.sent,d((function(t){return[].concat((0,o.Z)(t),(0,o.Z)(n.data))}));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,a.useEffect)((function(){e.length%12!==0&&v(!0)}),[e]);(0,a.useEffect)((function(){return window.onpopstate=function(){k(!0),console.log("test restore"),d(JSON.parse(sessionStorage.getItem("posts")))},k(!1),function(){window.onpopstate=function(){}}}),[]),(0,a.useEffect)((function(){S||O()}),[S]),(0,a.useEffect)((function(){return function(){sessionStorage.setItem("posts",JSON.stringify(e))}}));var M=(0,a.useState)(!1),C=(0,i.Z)(M,2),E=C[0],N=C[1];return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h1",{children:"\ubb35\uc0c1 ON"}),(0,x.jsx)("div",{style:{position:"absolute",width:"100%",maxWidth:"1500px",left:"50%",transform:"translateX(-50%)"},children:0!==e.length?(0,x.jsx)(y.Z,{dataLength:e.length,next:O,hasMore:!m,loader:(0,x.jsx)(c.Z,{}),scrollThreshold:.75,style:{overflowY:"hidden"},children:(0,x.jsx)(u.Z,{sx:{mx:"0.5rem"},cols:3,gap:2.5,children:(0,x.jsx)(g,{posts:e})})}):(0,x.jsx)(c.Z,{})}),(0,x.jsx)(f.Z,{variant:"primary",style:{position:"fixed",right:"2vw",bottom:"3vh"},onClick:function(){N(!0)},children:(0,x.jsx)(l.Z,{})}),(0,x.jsx)(b,{openModal:E,setOpenModal:N})]})}}}]);
//# sourceMappingURL=859.6e6a457d.chunk.js.map