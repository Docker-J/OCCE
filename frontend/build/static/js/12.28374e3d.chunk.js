"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[12],{7788:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(4420);const s=e=>(0,n.v9)((e=>e.authToken.admin))&&e.children},8012:(e,t,i)=>{i.r(t),i.d(t,{default:()=>z});var n=i(2791),s=i(5193),o=i(890),r=i(6314),a=i(3239),l=i(2763),c=i(9877),d=i(2419),h=i(5294),g=i(7888),p=i(1087),u=i(184);const m=e=>{let{posts:t}=e;return t.map((e=>(0,u.jsx)(g.Z,{component:p.rU,to:e.ID,children:(0,u.jsx)("img",{src:"https://imagedelivery.net/ICo2WI8PXO_BVRlWfwzOww/".concat(e.Cover,"/thumbnail"),alt:"thumbnail",loading:"lazy"})},e.ID)))},x=(0,n.memo)(m);var f=i(8447),v=i(697),j=i(4518),b=i(7831),w=i(1172),y=i.n(w),Z=i(8141),C=i(5394),k=i(6401),I=i(3400),S=i(5130),R=i(1067),O=i(8422);const D=e=>{let{id:t,image:i,index:s,movePhoto:o,removeImage:r}=e;const a=(0,n.useRef)(null),[{isDragging:l},c]=(0,R.c)({type:"previewcard",item:()=>({id:t,index:s}),collect:e=>({isDragging:e.isDragging()})}),d=l?.7:1,[{handlerId:h},g]=(0,O.L)({accept:"previewcard",collect:e=>({handlerId:e.getHandlerId()}),hover(e,t){var i;if(!a.current)return;const n=e.index,r=s;if(n===r)return;const l=null===(i=a.current)||void 0===i?void 0:i.getBoundingClientRect(),c=(l.left-l.right)/2,d=t.getClientOffset().x-l.left;n<r&&d<c||n>r&&d<c||(o(n,r),e.index=r)}});return c(g(a)),(0,u.jsxs)("div",{ref:a,style:{position:"relative",display:"inline-flex",borderRadius:2,border:"1px solid #eaeaea",marginBottom:8,marginRight:8,width:"calc(90%/3)",aspectRatio:"1/1",boxSizing:"border-box",cursor:"move",opacity:d,overflow:"hidden"},children:[(0,u.jsx)("img",{src:i,alt:"preview",style:{display:"block",width:"auto",height:"100%"}}),(0,u.jsx)(I.Z,{sx:{position:"absolute",display:"block",zIndex:99,top:0,right:0,backgroundColor:"orange"},onClick:()=>r(s),children:(0,u.jsx)(S.Z,{sx:{color:"black"}})})]})};var E=i(7427);const N={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",height:"80vh",maxWidth:"1300px",bgcolor:"#ffffff",boxShadow:24,borderRadius:"0.5em",p:1,py:5,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},P=e=>{let{isOpen:t,onClose:i}=e;const{openSnackbar:s}=(0,E.Z)(),r=()=>{m(),i()},[l,c]=(0,n.useState)([]),[d,g]=(0,n.useState)([]),p=e=>{URL.revokeObjectURL(d[e]),c((t=>y()(t,{$splice:[[e,1]]}))),g((t=>y()(t,{$splice:[[e,1]]})))},m=()=>{d.forEach((e=>URL.revokeObjectURL(e))),c([]),g([])},x=(0,n.useCallback)(((e,t)=>{c((i=>y()(i,{$splice:[[e,1],[t,0,i[e]]]}))),g((i=>y()(i,{$splice:[[e,1],[t,0,i[e]]]})))}),[]),{getRootProps:w,getInputProps:I}=(0,b.uI)({accept:{"image/*":[]},onDrop:e=>{var t;t=e,c((e=>[...e,...t])),t.forEach((e=>{g((t=>y()(t,{$push:[URL.createObjectURL(e)]})))}))},noDragEventsBubbling:!0}),S=(0,n.useCallback)(((e,t)=>(0,u.jsx)(D,{index:t,image:e,movePhoto:x,removeImage:p},t)),[]),[R,O]=(0,n.useState)(!1);return(0,u.jsx)(f.Z,{open:t,onClose:r,children:(0,u.jsx)(v.Z,{sx:N,bgcolor:"white",children:R?(0,u.jsx)(a.Z,{}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(C.W,{backend:k.PD,children:(0,u.jsx)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",justifyContent:"space-between",margin:"10pt",width:"95%",height:"75%",overflowX:"auto"},children:d.map(((e,t)=>S(e,t)))})}),(0,u.jsxs)("div",{style:{width:"95%",height:"20%",border:"1pt dotted #f57c00",borderRadius:"1em",overflowY:"auto"},...w(),children:[(0,u.jsx)("input",{...I()}),(0,u.jsx)(v.Z,{sx:{position:"relative",height:"100%",widht:"100%"},children:(0,u.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[(0,u.jsx)(Z.Z,{fontSize:"large",color:"primary"}),(0,u.jsx)(o.Z,{children:"Click or Drag Files to here"})]})})]}),(0,u.jsxs)("div",{style:{display:"flex",marginTop:"2em"},children:[(0,u.jsx)(j.Z,{variant:"outlined",disabled:l.length<=0,onClick:async()=>{const e=new FormData;l.forEach((t=>{e.append("images",t)}));try{O(!0);await h.Z.post("/api/meditationON/uploadImage",e,{headers:{"Content-Type":"multipart/form-data"}});s("success","Uploaded Succesfully!"),r()}catch(t){console.log(t),s("error","Error Occured. Please contact to the administrator.")}finally{O(!1)}},children:"Submit"}),(0,u.jsx)(j.Z,{variant:"outlined",onClick:m,disabled:l.length<=0,children:"Clear All"}),(0,u.jsx)(j.Z,{variant:"outlined",onClick:r,children:"Close"})]})]})})})};var L=i(4771),U=(i(6527),i(7788)),T=(i(5057),i(5977));const W={backgroundImage:'linear-gradient(rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.45)), url("/img/Online/MeditationON.webp")'},z=()=>{const e=(0,s.Z)("(min-width:1200px)"),{openModal:t}=(0,T.Z)(),[i,g]=(0,n.useState)([]),[p,m]=(0,n.useState)(!1),[f,v]=(0,n.useState)(null),j=async()=>{console.log("test getPosts");const e=await h.Z.get("/api/MeditationON/getPosts".concat(0===i.length?"":"?lastVisible=".concat(i.at(-1).ID,"&timeStamp=").concat(i.at(-1).Timestamp)));e.data.length>0?g((t=>[...t,...e.data])):m(!0)};(0,n.useEffect)((()=>{i.length%12!==0&&m(!0)}),[i]),(0,n.useEffect)((()=>(window.onpopstate=()=>{v(!0),console.log("test restore"),g(JSON.parse(sessionStorage.getItem("posts")))},v(!1),()=>{window.onpopstate=()=>{}})),[]),(0,n.useEffect)((()=>{null===f||f||j()}),[f]),(0,n.useEffect)((()=>()=>{sessionStorage.setItem("posts",JSON.stringify(i))}));const b=(0,n.useRef)();return(0,n.useEffect)((()=>{b.current&&!p&&i.length>=12&&setTimeout((()=>{try{const e=b.current.clientHeight,t=window.innerHeight-500;console.log("test content",e),console.log("test screen",t),e>100&&e<t&&j()}catch(e){}}),500)}),[i]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"title-wrapper",style:W,children:(0,u.jsx)("div",{className:"title",children:(0,u.jsx)(o.Z,{variant:"h4",fontWeight:830,sx:{letterSpacing:"0.4em",pl:"0.4em",color:"white"},children:"\ubb35\uc0c1 ON"})})}),(0,u.jsx)("div",{className:"container-wrapper",children:(0,u.jsx)("div",{className:"container",style:{padding:"0em 0.2em"},children:i.length<=0?(0,u.jsx)(r.Z,{alignItems:"center",children:(0,u.jsx)(a.Z,{})}):(0,u.jsx)(L.Z,{dataLength:i.length,next:j,hasMore:!p,loader:(0,u.jsx)(r.Z,{alignItems:"center",children:(0,u.jsx)(a.Z,{})}),scrollThreshold:1,style:{overflowY:"hidden"},children:(0,u.jsx)(l.Z,{ref:b,cols:e?4:3,gap:2.5,children:(0,u.jsx)(x,{posts:i})})})})}),(0,u.jsx)(U.Z,{children:(0,u.jsx)(c.Z,{variant:"primary",style:{position:"fixed",right:"2vw",bottom:"3vh"},onClick:()=>t(P,{}),children:(0,u.jsx)(d.Z,{})})})]})}},6527:()=>{}}]);
//# sourceMappingURL=12.28374e3d.chunk.js.map