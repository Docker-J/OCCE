{"version":3,"file":"static/js/580.5806b598.chunk.js","mappings":"+RAqMA,UAzKqB,WACnB,IAAAA,GAAkCC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAA1CI,EAASF,EAAA,GAAEG,EAAYH,EAAA,GAyB9BI,GAA0CL,EAAAA,EAAAA,UAAS,IAAGM,GAAAJ,EAAAA,EAAAA,GAAAG,EAAA,GAA/CE,EAAaD,EAAA,GAAEE,EAAgBF,EAAA,GACtCG,GAA0CT,EAAAA,EAAAA,UAAS,IAAGU,GAAAR,EAAAA,EAAAA,GAAAO,EAAA,GAA/CE,EAAaD,EAAA,GAAEE,EAAgBF,EAAA,GAYZ,SAAAG,IAYzB,OAZyBA,GAAAC,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAA1B,SAAAC,IAAA,OAAAF,EAAAA,EAAAA,KAAAG,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAG,OAAA,SACS,IAAIC,SAAQ,SAACC,GAElB,IADA,IAAIC,EAAS,GAAGC,EAAA,SAAAC,GAEdC,EAAarB,EAAcoB,IAAI,SAACE,EAAKC,GACnCL,EAAOM,KAAKD,GACRH,IAAMpB,EAAcyB,OAAS,GAC/BR,EAAQC,EAEZ,GACF,EAPSE,EAAI,EAAGA,EAAIpB,EAAcyB,OAAQL,IAAGD,EAAAC,EAQ/C,KAAE,wBAAAR,EAAAc,OAAA,GAAAhB,EAAA,KACHJ,EAAAqB,MAAA,KAAAC,UAAA,EAlBDC,EAAAA,EAAAA,YAAU,WACRC,MAAMC,KAAK/B,GAAegC,SAAQ,SAACC,GACjC5B,EAAiB,GAAD6B,QAAAC,EAAAA,EAAAA,GAAK/B,GAAa,CAAEgC,IAAIC,gBAAgBJ,KAC1D,GACF,GAAG,CAACjC,IAsBe,SAAAsC,IAIlB,OAJkBA,GAAA/B,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAnB,SAAA8B,EAAoBrB,GAAM,OAAAV,EAAAA,EAAAA,KAAAG,MAAA,SAAA6B,GAAA,cAAAA,EAAA3B,KAAA2B,EAAA1B,MAAA,cAAA0B,EAAA1B,KAAA,GAClB2B,EAAAA,EAAAA,KAAOC,EAAAA,EAAAA,IAAWC,EAAAA,GAAI,gBAAiB,CAC3CzB,OAAQA,IACP,KAAD,mBAAAsB,EAAAd,OAAA,GAAAa,EAAA,KACHD,EAAAX,MAAA,KAAAC,UAAA,CAED,IAAAgB,GAA4BnD,EAAAA,EAAAA,UAAS,MAAKoD,GAAAlD,EAAAA,EAAAA,GAAAiD,EAAA,GAAnC1B,EAAM2B,EAAA,GAAEC,EAASD,EAAA,GAEA,SAAAE,IAIvB,OAJuBA,GAAAxC,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAxB,SAAAuC,IAAA,IAAAC,EAAA,OAAAzC,EAAAA,EAAAA,KAAAG,MAAA,SAAAuC,GAAA,cAAAA,EAAArC,KAAAqC,EAAApC,MAAA,cAAAoC,EAAApC,KAAA,GAC0BqC,EAAAA,EAAAA,KAAQT,EAAAA,EAAAA,IAAWC,EAAAA,GAAI,iBAAiB,KAAD,EAAzDM,EAASC,EAAAE,KACfN,EAAUG,GACVI,QAAQC,IAAIL,EAAUM,KAAK,GAAGC,QAAQ,wBAAAN,EAAAxB,OAAA,GAAAsB,EAAA,MACvCrB,MAAA,KAAAC,UAAA,EAEDC,EAAAA,EAAAA,YAAU,YARiC,WAEnBkB,EAAApB,MAAC,KAADC,UAAA,CAOtB6B,EACF,GAAG,IAEH,IAAMpC,EAAY,eAAAqC,GAAAnD,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAG,SAAAkD,EAAOC,EAAMC,GAAE,IAAAC,EAAAC,EAAA,OAAAvD,EAAAA,EAAAA,KAAAG,MAAA,SAAAqD,GAAA,cAAAA,EAAAnD,KAAAmD,EAAAlD,MAAA,cAAAkD,EAAAlD,KAAA,GACJmD,EAAAA,EAAAA,GAAiBL,EAAM,CAAEM,UAAW,KAAO,KAAD,EAAlEJ,EAAeE,EAAAZ,MACfW,EAAS,IAAII,YACZC,cAAcN,GACrBC,EAAOM,OAAS,WACdR,EAAG,KAAME,EAAOxC,OAClB,EACAwC,EAAOO,QAAU,SAAUC,GACzBV,EAAGU,EAAO,KACZ,EAAE,wBAAAP,EAAAtC,OAAA,GAAAiC,EAAA,KACH,gBAViBa,EAAAC,GAAA,OAAAf,EAAA/B,MAAA,KAAAC,UAAA,KAYlB,OACE8C,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAC,SAAA,EACEF,EAAAA,EAAAA,MAAA,OACEG,MAAO,CACLC,SAAU,WAGVC,KAAM,MACNC,UAAW,oBACXJ,SAAA,EAEFK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,oBACH1D,GACC+D,EAAAA,EAAAA,KAACC,EAAAA,EAAS,CAACC,GAAI,CAAEC,MAAO,QAAUC,KAAM,EAAET,SACvC1D,EAAOqC,KAAK+B,KAAI,SAACC,GAAI,OACpBN,EAAAA,EAAAA,KAACO,EAAAA,EAAa,CACZC,UAAWC,EAAAA,GACXC,GAAI,4BAA8BJ,EAAKK,GAAGhB,UAE1CK,EAAAA,EAAAA,KAAA,OAIEY,IAAG,GAAA3D,OACDqD,EAAK/B,OAAOtC,OAAO,GAAE,qCAEvB4E,OAAQP,EAAK/B,OAAOtC,OAAO,GAM3B6E,QAAQ,UAEI,OAIpBd,EAAAA,EAAAA,KAACe,EAAAA,EAAgB,QAIrBf,EAAAA,EAAAA,KAACgB,EAAAA,EAAG,CACFC,QAAQ,UACRrB,MAAO,CAAEC,SAAU,QAASqB,MAAO,MAAOC,OAAQ,OAClDC,QAnIa,WACjBxG,GAAa,EACf,EAiI0B+E,UAEpBK,EAAAA,EAAAA,KAACqB,EAAAA,EAAO,OAEVrB,EAAAA,EAAAA,KAACsB,EAAAA,EAAK,CACJC,KAAM5G,EACN6G,QArIc,WAClBxG,EAAiB,IACjBI,EAAiB,IACjBR,GAAa,EACf,EAmIM+E,UAEAF,EAAAA,EAAAA,MAACgC,EAAAA,EAAG,CAACvB,GAnIG,CACZL,SAAU,WACV6B,IAAK,MACL5B,KAAM,MACNC,UAAW,wBACXI,MAAO,QACPwB,OAAQ,QACRC,QAAS,UACTC,OAAQ,sBACRC,UAAW,GACXC,EAAG,GAyHiBH,QAAQ,QAAOjC,SAAA,EAC7BF,EAAAA,EAAAA,MAACuC,EAAAA,EAAM,CAACf,QAAQ,YAAYT,UAAU,QAAOb,SAAA,CAAC,UAE5CK,EAAAA,EAAAA,KAAA,SACEiC,QAAM,EACNC,OAAO,UACPC,UAAQ,EACRC,KAAK,OACLC,SAAU,SAACC,GAAC,OA3HC,SAACA,GACxBtH,EAAiBsH,EAAEC,OAAOC,MAC5B,CAyH6BC,CAAiBH,EAAE,QAIxCtC,EAAAA,EAAAA,KAACgC,EAAAA,EAAM,CAACZ,QAvGI,YAhBA,WAEM,OAAA/F,EAAAqB,MAAC,KAADC,UAAA,EAexB+F,GAAcC,MAAK,SAACrG,IAGpB,SAEiBsG,GAAAvF,EAAAX,MAAC,KAADC,UAAA,CAJfkG,CAAKvG,EACP,GACF,EAmGsC2E,QAAQ,YAAYT,UAAU,QAAOb,SAAC,WAInExE,EAAckF,KAAI,SAACrD,GAAK,OACvBgD,EAAAA,EAAAA,KAAA,OAAKY,IAAK5D,GAAS,WAM/B,C","sources":["pages/Online/MeditationON.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\n\r\nimport {\r\n  Box,\r\n  Button,\r\n  CircularProgress,\r\n  Fab,\r\n  ImageList,\r\n  ImageListItem,\r\n  Modal,\r\n  Typography,\r\n} from \"@mui/material\";\r\n\r\nimport AddIcon from \"@mui/icons-material/Add\";\r\n\r\nimport {\r\n  collection,\r\n  getDocs,\r\n  addDoc,\r\n  doc,\r\n  getDoc,\r\n  query,\r\n} from \"firebase/firestore\";\r\nimport { db } from \"../../api/firebase\";\r\n\r\nimport imageCompression from \"browser-image-compression\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst MeditationON = () => {\r\n  const [openModal, setOpenModal] = useState(false);\r\n\r\n  const handleOpen = () => {\r\n    setOpenModal(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setFilesToUpload([]);\r\n    setImagesPreview([]);\r\n    setOpenModal(false);\r\n  };\r\n\r\n  const style = {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -50%)\",\r\n    width: \"800px\",\r\n    height: \"800px\",\r\n    bgcolor: \"#ffffff\",\r\n    border: \"0.1px solid #f57c00\",\r\n    boxShadow: 24,\r\n    p: 2,\r\n  };\r\n\r\n  const [filesToUpload, setFilesToUpload] = useState([]);\r\n  const [imagesPreview, setImagesPreview] = useState([]);\r\n\r\n  const handleChangeFile = (e) => {\r\n    setFilesToUpload(e.target.files);\r\n  };\r\n\r\n  useEffect(() => {\r\n    Array.from(filesToUpload).forEach((image) => {\r\n      setImagesPreview([...imagesPreview, URL.createObjectURL(image)]);\r\n    });\r\n  }, [filesToUpload]);\r\n\r\n  async function imgToBase64() {\r\n    return new Promise((resolve) => {\r\n      let images = [];\r\n      for (let i = 0; i < filesToUpload.length; i++) {\r\n        fileToBase64(filesToUpload[i], (err, result) => {\r\n          images.push(result);\r\n          if (i === filesToUpload.length - 1) {\r\n            resolve(images);\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  const uploadFiles = () => {\r\n    imgToBase64().then((result) => {\r\n      post(result);\r\n    });\r\n  };\r\n\r\n  async function post(images) {\r\n    await addDoc(collection(db, \"MeditationON\"), {\r\n      images: images,\r\n    });\r\n  }\r\n\r\n  const [images, setImages] = useState(null);\r\n\r\n  async function getImages() {\r\n    const querySnap = await getDocs(collection(db, \"MeditationON\"));\r\n    setImages(querySnap);\r\n    console.log(querySnap.docs[0].data());\r\n  }\r\n\r\n  useEffect(() => {\r\n    getImages();\r\n  }, []);\r\n\r\n  const fileToBase64 = async (file, cb) => {\r\n    const compressedImage = await imageCompression(file, { maxSizeMB: 0.1 });\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(compressedImage);\r\n    reader.onload = function () {\r\n      cb(null, reader.result);\r\n    };\r\n    reader.onerror = function (error) {\r\n      cb(error, null);\r\n    };\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        style={{\r\n          position: \"absolute\",\r\n          // width: \"100%\",\r\n          // maxWidth: \"1500px\",\r\n          left: \"50%\",\r\n          transform: \"translateX(-50%)\",\r\n        }}\r\n      >\r\n        <h1>묵상 ON</h1>\r\n        {images ? (\r\n          <ImageList sx={{ width: \"100%\" }} cols={3}>\r\n            {images.docs.map((item) => (\r\n              <ImageListItem\r\n                component={Link}\r\n                to={\"/meditationON/post?docID=\" + item.id}\r\n              >\r\n                <img\r\n                  // src={`${\r\n                  //   item.data().images[0]\r\n                  // }?w=164&h=164&fit=crop&auto=format`}\r\n                  src={`${\r\n                    item.data().images[0]\r\n                  }?w=300&h=300&fit=crop&auto=format`}\r\n                  srcSet={item.data().images[0]}\r\n                  // onClick={}\r\n                  // srcSet={`${\r\n                  //   item.data().images[0]\r\n                  // }?w=164&h=164&fit=crop&auto=format&dpr=2 2x`}\r\n                  // alt={item.title}\r\n                  loading=\"lazy\"\r\n                />\r\n              </ImageListItem>\r\n            ))}\r\n          </ImageList>\r\n        ) : (\r\n          <CircularProgress />\r\n        )}\r\n      </div>\r\n\r\n      <Fab\r\n        variant=\"primary\"\r\n        style={{ position: \"fixed\", right: \"2vw\", bottom: \"3vh\" }}\r\n        onClick={handleOpen}\r\n      >\r\n        <AddIcon />\r\n      </Fab>\r\n      <Modal\r\n        open={openModal}\r\n        onClose={handleClose}\r\n        // aria-labelledby=\"modal-modal-title\"\r\n        // aria-describedby=\"modal-modal-description\"\r\n      >\r\n        <Box sx={style} bgcolor=\"white\">\r\n          <Button variant=\"contained\" component=\"label\">\r\n            Upload\r\n            <input\r\n              hidden\r\n              accept=\"image/*\"\r\n              multiple\r\n              type=\"file\"\r\n              onChange={(e) => handleChangeFile(e)}\r\n            />\r\n          </Button>\r\n\r\n          <Button onClick={uploadFiles} variant=\"contained\" component=\"label\">\r\n            Submit\r\n          </Button>\r\n\r\n          {imagesPreview.map((image) => (\r\n            <img src={image} />\r\n          ))}\r\n        </Box>\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MeditationON;\r\n"],"names":["_useState","useState","_useState2","_slicedToArray","openModal","setOpenModal","_useState3","_useState4","filesToUpload","setFilesToUpload","_useState5","_useState6","imagesPreview","setImagesPreview","_imgToBase","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","wrap","_context2","prev","next","abrupt","Promise","resolve","images","_loop","i","fileToBase64","err","result","push","length","stop","apply","arguments","useEffect","Array","from","forEach","image","concat","_toConsumableArray","URL","createObjectURL","_post","_callee3","_context3","addDoc","collection","db","_useState7","_useState8","setImages","_getImages","_callee4","querySnap","_context4","getDocs","sent","console","log","docs","data","getImages","_ref","_callee","file","cb","compressedImage","reader","_context","imageCompression","maxSizeMB","FileReader","readAsDataURL","onload","onerror","error","_x2","_x3","_jsxs","_Fragment","children","style","position","left","transform","_jsx","ImageList","sx","width","cols","map","item","ImageListItem","component","Link","to","id","src","srcSet","loading","CircularProgress","Fab","variant","right","bottom","onClick","AddIcon","Modal","open","onClose","Box","top","height","bgcolor","border","boxShadow","p","Button","hidden","accept","multiple","type","onChange","e","target","files","handleChangeFile","imgToBase64","then","_x","post"],"sourceRoot":""}