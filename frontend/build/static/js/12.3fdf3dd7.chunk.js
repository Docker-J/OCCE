"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[12],{7788:(e,t,s)=>{s.d(t,{Z:()=>o});var i=s(4420);const o=e=>(0,i.v9)((e=>e.authToken.admin))&&e.children},8012:(e,t,s)=>{s.r(t),s.d(t,{default:()=>T});var i=s(2791),o=s(5193),n=s(890),a=s(3239),l=s(2763),r=s(9877),c=s(2419),d=s(5294),h=s(7888),g=s(1087),p=s(184);const u=e=>{let{posts:t}=e;return t.map((e=>(0,p.jsx)(h.Z,{component:g.rU,to:e.ID,children:(0,p.jsx)("img",{src:"https://imagedelivery.net/ICo2WI8PXO_BVRlWfwzOww/".concat(e.Cover,"/thumbnail"),alt:"thumbnail",loading:"lazy"})},e.ID)))},x=(0,i.memo)(u);var m=s(8447),f=s(697),v=s(4518),j=s(3543),b=s(9658),w=s(7831),y=s(1172),Z=s.n(y),C=s(8141),k=s(5394),S=s(6401),I=s(3400),R=s(5130),O=s(1067),D=s(8422);const N=e=>{let{id:t,image:s,index:o,movePhoto:n,removeImage:a}=e;const l=(0,i.useRef)(null),[{isDragging:r},c]=(0,O.c)({type:"previewcard",item:()=>({id:t,index:o}),collect:e=>({isDragging:e.isDragging()})}),d=r?.7:1,[{handlerId:h},g]=(0,D.L)({accept:"previewcard",collect:e=>({handlerId:e.getHandlerId()}),hover(e,t){var s;if(!l.current)return;const i=e.index,a=o;if(i===a)return;const r=null===(s=l.current)||void 0===s?void 0:s.getBoundingClientRect(),c=(r.left-r.right)/2,d=t.getClientOffset().x-r.left;i<a&&d<c||i>a&&d<c||(n(i,a),e.index=a)}});return c(g(l)),(0,p.jsxs)("div",{ref:l,style:{position:"relative",display:"inline-flex",borderRadius:2,border:"1px solid #eaeaea",marginBottom:8,marginRight:8,width:"calc(90%/3)",aspectRatio:"1/1",boxSizing:"border-box",cursor:"move",opacity:d,overflow:"hidden"},children:[(0,p.jsx)("img",{src:s,alt:"preview",style:{display:"block",width:"auto",height:"100%"}}),(0,p.jsx)(I.Z,{sx:{position:"absolute",display:"block",zIndex:99,top:0,right:0,backgroundColor:"orange"},onClick:()=>a(o),children:(0,p.jsx)(R.Z,{sx:{color:"black"}})})]})},E={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80vw",height:"80vh",maxWidth:"1300px",bgcolor:"#ffffff",boxShadow:24,borderRadius:"0.5em",p:1,py:5,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},L=e=>{let{openModal:t,setOpenModal:s}=e;const o=()=>{u(),s(!1)},[l,r]=(0,i.useState)([]),[c,h]=(0,i.useState)([]),g=e=>{URL.revokeObjectURL(c[e]),r((t=>Z()(t,{$splice:[[e,1]]}))),h((t=>Z()(t,{$splice:[[e,1]]})))},u=()=>{c.forEach((e=>URL.revokeObjectURL(e))),r([]),h([])},x=(0,i.useCallback)(((e,t)=>{r((s=>Z()(s,{$splice:[[e,1],[t,0,s[e]]]}))),h((s=>Z()(s,{$splice:[[e,1],[t,0,s[e]]]})))}),[]),{getRootProps:y,getInputProps:I}=(0,w.uI)({accept:{"image/*":[]},onDrop:e=>{var t;t=e,r((e=>[...e,...t])),t.forEach((e=>{h((t=>Z()(t,{$push:[URL.createObjectURL(e)]})))}))},noDragEventsBubbling:!0}),R=(0,i.useCallback)(((e,t)=>(0,p.jsx)(N,{index:t,image:e,movePhoto:x,removeImage:g},t)),[]),[O,D]=(0,i.useState)(!1),[L,P]=(0,i.useState)(!1),U=(e,t)=>{"clickaway"!==t&&P(!1)};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(m.Z,{open:t,onClose:o,children:(0,p.jsx)(f.Z,{sx:E,bgcolor:"white",children:O?(0,p.jsx)(a.Z,{}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(k.W,{backend:S.PD,children:(0,p.jsx)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",justifyContent:"space-between",margin:"10pt",width:"95%",height:"75%",overflowX:"auto"},children:c.map(((e,t)=>R(e,t)))})}),(0,p.jsxs)("div",{style:{width:"95%",height:"20%",border:"1pt dotted #f57c00",borderRadius:"1em",overflowY:"auto"},...y(),children:[(0,p.jsx)("input",{...I()}),(0,p.jsx)(f.Z,{sx:{position:"relative",height:"100%",widht:"100%"},children:(0,p.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[(0,p.jsx)(C.Z,{fontSize:"large",color:"primary"}),(0,p.jsx)(n.Z,{children:"Click or Drag Files to here"})]})})]}),(0,p.jsxs)("div",{style:{display:"flex",marginTop:"2em"},children:[(0,p.jsx)(v.Z,{variant:"outlined",disabled:l.length<=0,onClick:async()=>{const e=new FormData;l.forEach((t=>{e.append("images",t)}));try{D(!0);await d.Z.post("/api/meditationON/uploadImage",e,{headers:{"Content-Type":"multipart/form-data"}});P(!0),D(!1),o()}catch(t){D(!1),console.log(t)}},children:"Submit"}),(0,p.jsx)(v.Z,{variant:"outlined",onClick:u,disabled:l.length<=0,children:"Clear All"}),(0,p.jsx)(v.Z,{variant:"outlined",onClick:o,children:"Close"})]})]})})}),(0,p.jsx)(j.Z,{open:L,autoHideDuration:8e3,onClose:U,children:(0,p.jsx)(b.Z,{severity:"success",onClose:U,children:"Uploaded Succesfully!"})})]})};var P=s(4771),U=(s(6527),s(7788));s(1152);const M={backgroundImage:'linear-gradient(rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.45)), url("/img/Online/MeditationON.webp")'},T=()=>{const e=(0,o.Z)("(min-width:1200px)"),[t,s]=(0,i.useState)([]),[h,g]=(0,i.useState)(!1),[u,m]=(0,i.useState)(null),f=async()=>{console.log("test getPosts");const e=await d.Z.get("/api/MeditationON/getPosts".concat(0===t.length?"":"?lastVisible=".concat(t.at(-1).ID,"&timeStamp=").concat(t.at(-1).Timestamp)));e.data.length>0?s((t=>[...t,...e.data])):g(!0)};(0,i.useEffect)((()=>{t.length%12!==0&&g(!0)}),[t]),(0,i.useEffect)((()=>(window.onpopstate=()=>{m(!0),console.log("test restore"),s(JSON.parse(sessionStorage.getItem("posts")))},m(!1),()=>{window.onpopstate=()=>{}})),[]),(0,i.useEffect)((()=>{null===u||u||f()}),[u]),(0,i.useEffect)((()=>()=>{sessionStorage.setItem("posts",JSON.stringify(t))}));const[v,j]=(0,i.useState)(!1),b=(0,i.useRef)();return(0,i.useEffect)((()=>{b.current&&!h&&t.length>=12&&setTimeout((()=>{try{const e=b.current.clientHeight,t=window.innerHeight-500;console.log("test content",e),console.log("test screen",t),e>100&&e<t&&f()}catch(e){}}),500)}),[t]),console.log(h),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"title-wrapper",style:M,children:(0,p.jsx)("div",{className:"title",children:(0,p.jsx)(n.Z,{variant:"h4",fontWeight:830,sx:{letterSpacing:"0.4em",pl:"0.4em",color:"white"},children:"\ubb35\uc0c1 ON"})})}),(0,p.jsx)("div",{className:"container-wrapper",children:(0,p.jsx)("div",{className:"container",style:{paddingLeft:"0.2em",paddingRight:"0.2em",marginTop:"0.2em"},children:t.length>0?(0,p.jsx)(P.Z,{dataLength:t.length,next:f,hasMore:!h,loader:(0,p.jsx)(a.Z,{}),scrollThreshold:1,style:{overflowY:"hidden"},children:(0,p.jsx)(l.Z,{ref:b,sx:{mx:"0.5rem"},cols:e?4:3,gap:2.5,children:(0,p.jsx)(x,{posts:t})})}):(0,p.jsx)(a.Z,{})})}),(0,p.jsxs)(U.Z,{children:[(0,p.jsx)(r.Z,{variant:"primary",style:{position:"fixed",right:"2vw",bottom:"3vh"},onClick:()=>{j(!0)},children:(0,p.jsx)(c.Z,{})}),(0,p.jsx)(L,{openModal:v,setOpenModal:j})]})]})}},6527:()=>{}}]);
//# sourceMappingURL=12.3fdf3dd7.chunk.js.map