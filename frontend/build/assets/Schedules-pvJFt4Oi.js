import{h as M,j as a,F as D,T as m,a0 as F,a1 as Y,l as $,k as R,r as W,A as O,C as A}from"./index-Dpe0VgRM.js";import{n as E,d as B,c as H,t as w,m as b,a as I,f as u}from"./format-C9vNfFN1.js";import{S as T}from"./Stack-BKp2NgzL.js";import{i as L,g as C}from"./getDate-DAKJtapI.js";import{a as k}from"./addDays-_A4UCdTH.js";import{i as Z}from"./isSunday-Clxqs9nd.js";import{A as v,F as P}from"./AdminComponent-CAM95sfi.js";function U(t,e,n){const[r,s]=E(n==null?void 0:n.in,t,e),i=S(r,s),c=Math.abs(B(r,s));r.setDate(r.getDate()-i*c);const o=+(S(r,s)===-i),l=i*(c-o);return l===0?0:l}function S(t,e){const n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function p(t,e){const n=()=>H(e==null?void 0:e.in,NaN),s=J(t);let i;if(s.date){const d=V(s.date,2);i=X(d.restDateString,d.year)}if(!i||isNaN(+i))return n();const c=+i;let o=0,l;if(s.time&&(o=G(s.time),isNaN(o)))return n();if(s.timezone){if(l=Q(s.timezone),isNaN(l))return n()}else{const d=new Date(c+o),f=w(0,e==null?void 0:e.in);return f.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),f.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),f}return w(c+o+l,e==null?void 0:e.in)}const x={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},_=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,K=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,q=/^([+-])(\d{2})(?::?(\d{2}))?$/;function J(t){const e={},n=t.split(x.dateTimeDelimiter);let r;if(n.length>2)return e;if(/:/.test(n[0])?r=n[0]:(e.date=n[0],r=n[1],x.timeZoneDelimiter.test(e.date)&&(e.date=t.split(x.timeZoneDelimiter)[0],r=t.substr(e.date.length,t.length))),r){const s=x.timezone.exec(r);s?(e.time=r.replace(s[1],""),e.timezone=s[1]):e.time=r}return e}function V(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=t.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function X(t,e){if(e===null)return new Date(NaN);const n=t.match(_);if(!n)return new Date(NaN);const r=!!n[4],s=g(n[1]),i=g(n[2])-1,c=g(n[3]),o=g(n[4]),l=g(n[5])-1;if(r)return re(e,o,l)?ee(e,o,l):new Date(NaN);{const d=new Date(0);return!ne(e,i,c)||!se(e,s)?new Date(NaN):(d.setUTCFullYear(e,i,Math.max(s,c)),d)}}function g(t){return t?parseInt(t):1}function G(t){const e=t.match(K);if(!e)return NaN;const n=j(e[1]),r=j(e[2]),s=j(e[3]);return ae(n,r,s)?n*b+r*I+s*1e3:NaN}function j(t){return t&&parseFloat(t.replace(",","."))||0}function Q(t){if(t==="Z")return 0;const e=t.match(q);if(!e)return 0;const n=e[1]==="+"?-1:1,r=parseInt(e[2]),s=e[3]&&parseInt(e[3])||0;return ie(r,s)?n*(r*b+s*I):NaN}function ee(t,e,n){const r=new Date(0);r.setUTCFullYear(t,0,4);const s=r.getUTCDay()||7,i=(e-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const te=[31,null,31,30,31,30,31,31,30,31,30,31];function z(t){return t%400===0||t%4===0&&t%100!==0}function ne(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(te[e]||(z(t)?29:28))}function se(t,e){return e>=1&&e<=(z(t)?366:365)}function re(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function ae(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function ie(t,e){return e>=0&&e<=59}const oe=M([a.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),a.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")]),ce=M(a.jsx("path",{d:"M12 12c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m6-1.8C18 6.57 15.35 4 12 4s-6 2.57-6 6.2c0 2.34 1.95 5.44 6 9.14 4.05-3.7 6-6.8 6-9.14M12 2c4.2 0 8 3.22 8 8.2 0 3.32-2.67 7.25-8 11.8-5.33-4.55-8-8.48-8-11.8C4 5.22 7.8 2 12 2"}));function le(t,e,n){return L(t,e)||C(k(t,1))===C(e)&&n==="00:00 AM"}const de=({date:t,event:e,sx:n})=>{const r=e.allday,s=p(r?e.start.date:e.start.dateTime),i=p(r?e.end.date:e.end.dateTime);u(s,"dd");const c=u(s,"hh:mm a");u(i,"dd");const o=u(i,"hh:mm a"),l=le(s,i,o);return a.jsxs(D,{sx:{backgroundColor:r?"#f57c00":"#e8eaed",borderColor:r?"#f57c00":"#afafaf",p:1.5,borderRadius:1,...n},children:[r?a.jsxs(m,{fontWeight:700,color:"primary",children:[e.summary,!l&&` (Day ${U(t,s)+1}/${e.alldaylength})`]}):a.jsx(m,{fontSize:"1.1em",fontWeight:700,children:e.summary}),a.jsx(m,{sx:{mb:"0.2em"},children:e.description}),!r&&a.jsxs(T,{direction:"row",spacing:.5,alignItems:"flex-start",children:[a.jsx(oe,{fontSize:"small"}),a.jsxs(m,{variant:"body2",children:[c,!r&&(l?` - ${o}`:` - ${u(i,"MM/dd hh:mm a")} `)]})]}),(e==null?void 0:e.location)&&a.jsxs(T,{direction:"row",spacing:.5,alignItems:"flex-start",marginTop:"0.1em",children:[a.jsx(ce,{color:"orange",fontSize:"small"}),a.jsx(m,{component:"a",target:"_blank",href:`https://www.google.com/maps/search/?api=1&query=${e.location}`,variant:"body2",color:"black",sx:{textDecoration:"none"},children:e.location.split(",")[0]})]})]})},ue=({events:t})=>{function e(n){return n.reduce((s,i)=>{const c=p(i.start.dateTime||i.start.date),o=u(c,"MMMM yyyy"),l=u(c,"d");if(s[o]=s[o]||{},s[o][l]=s[o][l]||[],i.start.date){i.allday=!!i.start.date,console.log(i),s[o][l].unshift(i);const d=p(i.end.date);i.alldaylength=U(d,c);for(let f=1;f<i.alldaylength;f++){const N=k(c,f),h=u(N,"MMMM yyyy"),y=u(N,"dd");s[h]=s[h]||{},s[h][y]=s[h][y]||[],s[h][y].unshift(i)}}else s[o][l].push(i);return s},{})}return Object.entries(e(t)).map(([n,r])=>a.jsxs("div",{children:[a.jsx(m,{variant:"h5",fontWeight:500,sx:{mb:"12px"},children:n}),Object.entries(r).map(([s,i])=>{const c=new Date(`${n} ${s}`),o=Z(c);return a.jsxs(F,{elevation:3,sx:{p:1.5,mb:2,display:"flex",justifyContent:"center",borderRadius:2.5},children:[a.jsx("div",{style:{borderLeft:o?"3px solid red":"3px solid #f57c00",height:"32px",marginTop:"0.5em",marginRight:"6px"}}),a.jsxs(D,{sx:{mr:"16px"},style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"0.5em",minWidth:"32px"},children:[a.jsx(m,{variant:"h5",color:o?"red":"primary",children:s.toString().padStart(2,"0")}),a.jsx(m,{variant:"caption",color:o?"red":"primary",children:u(c,"eee")})]}),a.jsx(D,{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",children:i.map((l,d)=>a.jsx(de,{date:c,event:l,sx:{marginBottom:d!==i.length-1&&"12px"}},d))})]},s)}),a.jsx("br",{})]},n))},me=M(a.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),fe=async()=>{try{await Y.get("/api/schedules/refresh")}catch{throw new Error}},he={backgroundImage:'url("/img/News/Schedules/Schedules.webp")',backgroundPositionX:"0%",backgroundPositionY:"60%"},Ne=()=>{const t=$(),e=R();return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"title-wrapper",style:he,children:a.jsx("div",{className:"title",children:a.jsx(m,{variant:"h4",fontWeight:830,textAlign:"center",sx:{letterSpacing:"0.4em",pl:"0.4em",color:"white"},children:"교회일정"})})}),a.jsx("div",{className:"container-wrapper",children:a.jsx("div",{className:"container",style:{display:"flex",justifyContent:"center"},children:a.jsx(W.Suspense,{fallback:a.jsx(A,{}),children:a.jsx(O,{resolve:t.schedules,errorElement:a.jsx("p",{children:"Error loading!"}),children:({data:n})=>a.jsx("div",{style:{width:"100%",maxWidth:"800px",display:"flex",flexDirection:"column",justifyContent:"center"},children:n.length===0?"등록된 일정이 없습니다.":a.jsx(ue,{events:n})})})})})}),a.jsx(v,{children:a.jsx(P,{style:{position:"fixed",right:"2vw",bottom:"3vh"},onClick:async()=>{await fe(),e.revalidate()},children:a.jsx(me,{})})})]})};export{Ne as default};
