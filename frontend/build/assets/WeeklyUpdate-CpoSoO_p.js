var qm=Object.defineProperty;var Uu=h=>{throw TypeError(h)};var Xm=(h,t,e)=>t in h?qm(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var Z=(h,t,e)=>Xm(h,typeof t!="symbol"?t+"":t,e),cc=(h,t,e)=>t.has(h)||Uu("Cannot "+e);var r=(h,t,e)=>(cc(h,t,"read from private field"),e?e.call(h):t.get(h)),y=(h,t,e)=>t.has(h)?Uu("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(h):t.set(h,e),m=(h,t,e,i)=>(cc(h,t,"write to private field"),i?i.call(h,e):t.set(h,e),e),v=(h,t,e)=>(cc(h,t,"access private method"),e);var Me=(h,t,e,i)=>({set _(s){m(h,t,s,e)},get _(){return r(h,t,i)}});import{r as O,o as Ym,p as Km,s as Qm,q as Jm,t as Vu,v as Zm,w as tb,g as Mt,x as Bl,y as eb,z as ib,D as ni,E as sb,G as Pf,H as jd,I as nb,f as zd,J as rb,_ as Gl,K as ab,j as $e,e as tt,B as to,i as ob,F as vc,C as lb,L as hb,k as yc,d as cb,h as db,M as ub,a as fb,N as pb,T as gb,O as ju,P as mb,Q as bb,R as vb}from"./index-C7O2x3CB.js";import{D as yb}from"./Delete-oBVr0A8D.js";import{a as wb,e as Rf,B as kf,i as zu,b as Ab,c as _b}from"./ButtonDatePicker-CFqKCEIY.js";import{C as kh}from"./CircularProgress-BYsvZrSQ.js";import{A as Eb,F as $u}from"./AdminComponent-Kuz2ZndF.js";import{F as Gu}from"./FileUploadComponent-DunPz_EL.js";import{C as Sb}from"./CustomConfirmDialog-1QmMiBDN.js";import"./index-BOqikxBJ.js";import"./useThemeProps-BZ7RXcL6.js";import"./Popper-ChBmnHWW.js";import"./ListItem-B1EAgiaM.js";function xb(h){return O.Children.toArray(h).filter(t=>O.isValidElement(t))}function Tb(h){return Km("MuiButtonGroup",h)}const rt=Ym("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),Cb=(h,t)=>{const{ownerState:e}=h;return[{[`& .${rt.grouped}`]:t.grouped},{[`& .${rt.grouped}`]:t[`grouped${ni(e.orientation)}`]},{[`& .${rt.grouped}`]:t[`grouped${ni(e.variant)}`]},{[`& .${rt.grouped}`]:t[`grouped${ni(e.variant)}${ni(e.orientation)}`]},{[`& .${rt.grouped}`]:t[`grouped${ni(e.variant)}${ni(e.color)}`]},{[`& .${rt.firstButton}`]:t.firstButton},{[`& .${rt.lastButton}`]:t.lastButton},{[`& .${rt.middleButton}`]:t.middleButton},t.root,t[e.variant],e.disableElevation===!0&&t.disableElevation,e.fullWidth&&t.fullWidth,e.orientation==="vertical"&&t.vertical]},Pb=h=>{const{classes:t,color:e,disabled:i,disableElevation:s,fullWidth:n,orientation:a,variant:o}=h,l={root:["root",o,a,n&&"fullWidth",s&&"disableElevation",`color${ni(e)}`],grouped:["grouped",`grouped${ni(a)}`,`grouped${ni(o)}`,`grouped${ni(o)}${ni(a)}`,`grouped${ni(o)}${ni(e)}`,i&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return sb(l,Tb,t)},Rb=Qm("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:Cb})(Jm(({theme:h})=>({display:"inline-flex",borderRadius:(h.vars||h).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(h.vars||h).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${rt.lastButton},& .${rt.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${rt.lastButton},& .${rt.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderRight:h.vars?`1px solid rgba(${h.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${h.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${rt.disabled}`]:{borderRight:`1px solid ${(h.vars||h).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderBottom:h.vars?`1px solid rgba(${h.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${h.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${rt.disabled}`]:{borderBottom:`1px solid ${(h.vars||h).palette.action.disabled}`}}}},...Object.entries(h.palette).filter(Vu()).flatMap(([t])=>[{props:{variant:"text",color:t},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderColor:h.vars?`rgba(${h.vars.palette[t].mainChannel} / 0.5)`:Zm(h.palette[t].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${rt.lastButton},& .${rt.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${rt.lastButton},& .${rt.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderRight:`1px solid ${(h.vars||h).palette.grey[400]}`,[`&.${rt.disabled}`]:{borderRight:`1px solid ${(h.vars||h).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderBottom:`1px solid ${(h.vars||h).palette.grey[400]}`,[`&.${rt.disabled}`]:{borderBottom:`1px solid ${(h.vars||h).palette.action.disabled}`}}}},...Object.entries(h.palette).filter(Vu(["dark"])).map(([t])=>({props:{variant:"contained",color:t},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderColor:(h.vars||h).palette[t].dark}}}))],[`& .${rt.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),qu=O.forwardRef(function(t,e){const i=tb({props:t,name:"MuiButtonGroup"}),{children:s,className:n,color:a="primary",component:o="div",disabled:l=!1,disableElevation:c=!1,disableFocusRipple:d=!1,disableRipple:f=!1,fullWidth:u=!1,orientation:p="horizontal",size:g="medium",variant:b="outlined",...w}=i,A={...i,color:a,component:o,disabled:l,disableElevation:c,disableFocusRipple:d,disableRipple:f,fullWidth:u,orientation:p,size:g,variant:b},T=Pb(A),S=O.useMemo(()=>({className:T.grouped,color:a,disabled:l,disableElevation:c,disableFocusRipple:d,disableRipple:f,fullWidth:u,size:g,variant:b}),[a,l,c,d,f,u,g,b,T.grouped]),x=xb(s),P=x.length,R=M=>{const L=M===0,F=M===P-1;return L&&F?"":L?T.firstButton:F?T.lastButton:T.middleButton};return Mt.jsx(Rb,{as:o,role:"group",className:Bl(T.root,n),ref:e,ownerState:A,...w,children:Mt.jsx(eb.Provider,{value:S,children:x.map((M,L)=>Mt.jsx(ib.Provider,{value:R(L),children:M},L))})})});function kb(h,t,e){const{years:i=0,months:s=0,weeks:n=0,days:a=0,hours:o=0,minutes:l=0,seconds:c=0}=t,d=Pf(h,e==null?void 0:e.in),f=s||i?wb(d,s+i*12):d,u=a||n?jd(f,a+n*7):f,p=l+o*60,b=(c+p*60)*1e3;return nb(h,+u+b)}function Jl(h,t){return Pf(h,t==null?void 0:t.in).getDay()===0}function Mb(h,t,e){return jd(h,-t,e)}const Lb=zd(Mt.jsx("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos"),Ib=zd(Mt.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos"),Fb=zd(Mt.jsx("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"}),"Upload");var V={},eo={exports:{}},Db=eo.exports,Xu;function Ob(){return Xu||(Xu=1,function(h,t){(function(e,i){var s="1.0.35",n="",a="?",o="function",l="undefined",c="object",d="string",f="major",u="model",p="name",g="type",b="vendor",w="version",A="architecture",T="console",S="mobile",x="tablet",P="smarttv",R="wearable",M="embedded",L=350,F="Amazon",D="Apple",H="ASUS",st="BlackBerry",q="Browser",$="Chrome",J="Edge",K="Firefox",W="Google",G="Huawei",ut="LG",mt="Microsoft",Dt="Motorola",St="Opera",wt="Samsung",Zt="Sharp",j="Sony",xt="Xiaomi",ct="Zebra",Re="Facebook",ue="Chromium OS",Tt="Mac OS",ss=function(ot,bt){var Y={};for(var vt in ot)bt[vt]&&bt[vt].length%2===0?Y[vt]=bt[vt].concat(ot[vt]):Y[vt]=ot[vt];return Y},oi=function(ot){for(var bt={},Y=0;Y<ot.length;Y++)bt[ot[Y].toUpperCase()]=ot[Y];return bt},At=function(ot,bt){return typeof ot===d?kt(bt).indexOf(kt(ot))!==-1:!1},kt=function(ot){return ot.toLowerCase()},Gt=function(ot){return typeof ot===d?ot.replace(/[^\d\.]/g,n).split(".")[0]:i},Nt=function(ot,bt){if(typeof ot===d)return ot=ot.replace(/^\s\s*/,n),typeof bt===l?ot:ot.substring(0,L)},ke=function(ot,bt){for(var Y=0,vt,we,fe,yt,Q,qe;Y<bt.length&&!Q;){var Or=bt[Y],Ka=bt[Y+1];for(vt=we=0;vt<Or.length&&!Q&&Or[vt];)if(Q=Or[vt++].exec(ot),Q)for(fe=0;fe<Ka.length;fe++)qe=Q[++we],yt=Ka[fe],typeof yt===c&&yt.length>0?yt.length===2?typeof yt[1]==o?this[yt[0]]=yt[1].call(this,qe):this[yt[0]]=yt[1]:yt.length===3?typeof yt[1]===o&&!(yt[1].exec&&yt[1].test)?this[yt[0]]=qe?yt[1].call(this,qe,yt[2]):i:this[yt[0]]=qe?qe.replace(yt[1],yt[2]):i:yt.length===4&&(this[yt[0]]=qe?yt[3].call(this,qe.replace(yt[1],yt[2])):i):this[yt]=qe||i;Y+=2}},li=function(ot,bt){for(var Y in bt)if(typeof bt[Y]===c&&bt[Y].length>0){for(var vt=0;vt<bt[Y].length;vt++)if(At(bt[Y][vt],ot))return Y===a?i:Y}else if(At(bt[Y],ot))return Y===a?i:Y;return ot},Ws={"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},En={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Oi={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[w,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[w,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,w],[/opios[\/ ]+([\w\.]+)/i],[w,[p,St+" Mini"]],[/\bopr\/([\w\.]+)/i],[w,[p,St]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,w],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[w,[p,"UC"+q]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[w,[p,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[w,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[w,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[w,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[w,[p,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+q],w],[/\bfocus\/([\w\.]+)/i],[w,[p,K+" Focus"]],[/\bopt\/([\w\.]+)/i],[w,[p,St+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[w,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[w,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[w,[p,St+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[w,[p,"MIUI "+q]],[/fxios\/([-\w\.]+)/i],[w,[p,K]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+q]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+q],w],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],w],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[p,w],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,Re],w],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[p,w],[/\bgsa\/([\w\.]+) .*safari\//i],[w,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[w,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[w,[p,$+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,$+" WebView"],w],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[w,[p,"Android "+q]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,w],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[w,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[w,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[w,li,Ws]],[/(webkit|khtml)\/([\w\.]+)/i],[p,w],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],w],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[w,[p,K+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,w],[/(cobalt)\/([\w\.]+)/i],[p,[w,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[A,"amd64"]],[/(ia32(?=;))/i],[[A,kt]],[/((?:i[346]|x)86)[;\)]/i],[[A,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[A,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[A,"armhf"]],[/windows (ce|mobile); ppc;/i],[[A,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[A,/ower/,n,kt]],[/(sun4\w)[;\)]/i],[[A,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[A,kt]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[b,wt],[g,x]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[b,wt],[g,S]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[b,D],[g,S]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[b,D],[g,x]],[/(macintosh);/i],[u,[b,D]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[b,Zt],[g,S]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[b,G],[g,x]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[b,G],[g,S]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[b,xt],[g,S]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[b,xt],[g,x]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[b,"OPPO"],[g,S]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[b,"Vivo"],[g,S]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[u,[b,"Realme"],[g,S]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[b,Dt],[g,S]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[b,Dt],[g,x]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[b,ut],[g,x]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[b,ut],[g,S]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[b,"Lenovo"],[g,x]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[b,"Nokia"],[g,S]],[/(pixel c)\b/i],[u,[b,W],[g,x]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[b,W],[g,S]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[b,j],[g,S]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[b,j],[g,x]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[b,"OnePlus"],[g,S]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[b,F],[g,x]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[b,F],[g,S]],[/(playbook);[-\w\),; ]+(rim)/i],[u,b,[g,x]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[b,st],[g,S]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[b,H],[g,x]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[b,H],[g,S]],[/(nexus 9)/i],[u,[b,"HTC"],[g,x]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[b,[u,/_/g," "],[g,S]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[b,"Acer"],[g,x]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[b,"Meizu"],[g,S]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[b,u,[g,S]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[b,u,[g,x]],[/(surface duo)/i],[u,[b,mt],[g,x]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[b,"Fairphone"],[g,S]],[/(u304aa)/i],[u,[b,"AT&T"],[g,S]],[/\bsie-(\w*)/i],[u,[b,"Siemens"],[g,S]],[/\b(rct\w+) b/i],[u,[b,"RCA"],[g,x]],[/\b(venue[\d ]{2,7}) b/i],[u,[b,"Dell"],[g,x]],[/\b(q(?:mv|ta)\w+) b/i],[u,[b,"Verizon"],[g,x]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[b,"Barnes & Noble"],[g,x]],[/\b(tm\d{3}\w+) b/i],[u,[b,"NuVision"],[g,x]],[/\b(k88) b/i],[u,[b,"ZTE"],[g,x]],[/\b(nx\d{3}j) b/i],[u,[b,"ZTE"],[g,S]],[/\b(gen\d{3}) b.+49h/i],[u,[b,"Swiss"],[g,S]],[/\b(zur\d{3}) b/i],[u,[b,"Swiss"],[g,x]],[/\b((zeki)?tb.*\b) b/i],[u,[b,"Zeki"],[g,x]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[b,"Dragon Touch"],u,[g,x]],[/\b(ns-?\w{0,9}) b/i],[u,[b,"Insignia"],[g,x]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[b,"NextBook"],[g,x]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[b,"Voice"],u,[g,S]],[/\b(lvtel\-)?(v1[12]) b/i],[[b,"LvTel"],u,[g,S]],[/\b(ph-1) /i],[u,[b,"Essential"],[g,S]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[b,"Envizen"],[g,x]],[/\b(trio[-\w\. ]+) b/i],[u,[b,"MachSpeed"],[g,x]],[/\btu_(1491) b/i],[u,[b,"Rotor"],[g,x]],[/(shield[\w ]+) b/i],[u,[b,"Nvidia"],[g,x]],[/(sprint) (\w+)/i],[b,u,[g,S]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[b,mt],[g,S]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[b,ct],[g,x]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[b,ct],[g,S]],[/smart-tv.+(samsung)/i],[b,[g,P]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[b,wt],[g,P]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[b,ut],[g,P]],[/(apple) ?tv/i],[b,[u,D+" TV"],[g,P]],[/crkey/i],[[u,$+"cast"],[b,W],[g,P]],[/droid.+aft(\w)( bui|\))/i],[u,[b,F],[g,P]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[b,Zt],[g,P]],[/(bravia[\w ]+)( bui|\))/i],[u,[b,j],[g,P]],[/(mitv-\w{5}) bui/i],[u,[b,xt],[g,P]],[/Hbbtv.*(technisat) (.*);/i],[b,u,[g,P]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[b,Nt],[u,Nt],[g,P]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[g,P]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[b,u,[g,T]],[/droid.+; (shield) bui/i],[u,[b,"Nvidia"],[g,T]],[/(playstation [345portablevi]+)/i],[u,[b,j],[g,T]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[b,mt],[g,T]],[/((pebble))app/i],[b,u,[g,R]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[b,D],[g,R]],[/droid.+; (glass) \d/i],[u,[b,W],[g,R]],[/droid.+; (wt63?0{2,3})\)/i],[u,[b,ct],[g,R]],[/(quest( 2| pro)?)/i],[u,[b,Re],[g,R]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[b,[g,M]],[/(aeobc)\b/i],[u,[b,F],[g,M]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[u,[g,S]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[g,x]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[g,x]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[g,S]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[b,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[w,[p,J+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[w,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,w],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[w,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,w],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[p,[w,li,En]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,"Windows"],[w,li,En]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[w,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,Tt],[w,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[w,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,w],[/\(bb(10);/i],[w,[p,st]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[w,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[w,[p,K+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[w,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[w,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[w,[p,$+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,ue],w],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,w],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],w],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,w]]},ye=function(ot,bt){if(typeof ot===c&&(bt=ot,ot=i),!(this instanceof ye))return new ye(ot,bt).getResult();var Y=typeof e!==l&&e.navigator?e.navigator:i,vt=ot||(Y&&Y.userAgent?Y.userAgent:n),we=Y&&Y.userAgentData?Y.userAgentData:i,fe=bt?ss(Oi,bt):Oi,yt=Y&&Y.userAgent==vt;return this.getBrowser=function(){var Q={};return Q[p]=i,Q[w]=i,ke.call(Q,vt,fe.browser),Q[f]=Gt(Q[w]),yt&&Y&&Y.brave&&typeof Y.brave.isBrave==o&&(Q[p]="Brave"),Q},this.getCPU=function(){var Q={};return Q[A]=i,ke.call(Q,vt,fe.cpu),Q},this.getDevice=function(){var Q={};return Q[b]=i,Q[u]=i,Q[g]=i,ke.call(Q,vt,fe.device),yt&&!Q[g]&&we&&we.mobile&&(Q[g]=S),yt&&Q[u]=="Macintosh"&&Y&&typeof Y.standalone!==l&&Y.maxTouchPoints&&Y.maxTouchPoints>2&&(Q[u]="iPad",Q[g]=x),Q},this.getEngine=function(){var Q={};return Q[p]=i,Q[w]=i,ke.call(Q,vt,fe.engine),Q},this.getOS=function(){var Q={};return Q[p]=i,Q[w]=i,ke.call(Q,vt,fe.os),yt&&!Q[p]&&we&&we.platform!="Unknown"&&(Q[p]=we.platform.replace(/chrome os/i,ue).replace(/macos/i,Tt)),Q},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return vt},this.setUA=function(Q){return vt=typeof Q===d&&Q.length>L?Nt(Q,L):Q,this},this.setUA(vt),this};ye.VERSION=s,ye.BROWSER=oi([p,w,f]),ye.CPU=oi([A]),ye.DEVICE=oi([u,b,g,T,S,P,x,R,M]),ye.ENGINE=ye.OS=oi([p,w]),h.exports&&(t=h.exports=ye),t.UAParser=ye;var yi=typeof e!==l&&(e.jQuery||e.Zepto);if(yi&&!yi.ua){var ns=new ye;yi.ua=ns.getResult(),yi.ua.get=function(){return ns.getUA()},yi.ua.set=function(ot){ns.setUA(ot);var bt=ns.getResult();for(var Y in bt)yi.ua[Y]=bt[Y]}}})(typeof window=="object"?window:Db)}(eo,eo.exports)),eo.exports}var Yu;function Nb(){if(Yu)return V;Yu=1,Object.defineProperty(V,"__esModule",{value:!0});function h(C){return C&&typeof C=="object"&&"default"in C?C.default:C}var t=rb(),e=h(t),i=Ob(),s=new i,n=s.getBrowser(),a=s.getCPU(),o=s.getDevice(),l=s.getEngine(),c=s.getOS(),d=s.getUA(),f=function(_){return s.setUA(_)},u=function(_){if(!_){console.error("No userAgent string was provided");return}var E=new i(_);return{UA:E,browser:E.getBrowser(),cpu:E.getCPU(),device:E.getDevice(),engine:E.getEngine(),os:E.getOS(),ua:E.getUA(),setUserAgent:function(I){return E.setUA(I)}}},p=Object.freeze({ClientUAInstance:s,browser:n,cpu:a,device:o,engine:l,os:c,ua:d,setUa:f,parseUserAgent:u});function g(C,_){var E=Object.keys(C);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(C);_&&(k=k.filter(function(I){return Object.getOwnPropertyDescriptor(C,I).enumerable})),E.push.apply(E,k)}return E}function b(C){for(var _=1;_<arguments.length;_++){var E=arguments[_]!=null?arguments[_]:{};_%2?g(Object(E),!0).forEach(function(k){x(C,k,E[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(E)):g(Object(E)).forEach(function(k){Object.defineProperty(C,k,Object.getOwnPropertyDescriptor(E,k))})}return C}function w(C){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?w=function(_){return typeof _}:w=function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},w(C)}function A(C,_){if(!(C instanceof _))throw new TypeError("Cannot call a class as a function")}function T(C,_){for(var E=0;E<_.length;E++){var k=_[E];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(C,k.key,k)}}function S(C,_,E){return T(C.prototype,_),C}function x(C,_,E){return _ in C?Object.defineProperty(C,_,{value:E,enumerable:!0,configurable:!0,writable:!0}):C[_]=E,C}function P(){return P=Object.assign||function(C){for(var _=1;_<arguments.length;_++){var E=arguments[_];for(var k in E)Object.prototype.hasOwnProperty.call(E,k)&&(C[k]=E[k])}return C},P.apply(this,arguments)}function R(C,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(_&&_.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),_&&L(C,_)}function M(C){return M=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)},M(C)}function L(C,_){return L=Object.setPrototypeOf||function(k,I){return k.__proto__=I,k},L(C,_)}function F(C,_){if(C==null)return{};var E={},k=Object.keys(C),I,ft;for(ft=0;ft<k.length;ft++)I=k[ft],!(_.indexOf(I)>=0)&&(E[I]=C[I]);return E}function D(C,_){if(C==null)return{};var E=F(C,_),k,I;if(Object.getOwnPropertySymbols){var ft=Object.getOwnPropertySymbols(C);for(I=0;I<ft.length;I++)k=ft[I],!(_.indexOf(k)>=0)&&Object.prototype.propertyIsEnumerable.call(C,k)&&(E[k]=C[k])}return E}function H(C){if(C===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C}function st(C,_){if(_&&(typeof _=="object"||typeof _=="function"))return _;if(_!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H(C)}function q(C,_){return $(C)||J(C,_)||K(C,_)||G()}function $(C){if(Array.isArray(C))return C}function J(C,_){var E=C==null?null:typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(E!=null){var k=[],I=!0,ft=!1,Yt,Be;try{for(E=E.call(C);!(I=(Yt=E.next()).done)&&(k.push(Yt.value),!(_&&k.length===_));I=!0);}catch($l){ft=!0,Be=$l}finally{try{!I&&E.return!=null&&E.return()}finally{if(ft)throw Be}}return k}}function K(C,_){if(C){if(typeof C=="string")return W(C,_);var E=Object.prototype.toString.call(C).slice(8,-1);if(E==="Object"&&C.constructor&&(E=C.constructor.name),E==="Map"||E==="Set")return Array.from(C);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return W(C,_)}}function W(C,_){(_==null||_>C.length)&&(_=C.length);for(var E=0,k=new Array(_);E<_;E++)k[E]=C[E];return k}function G(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ut={Mobile:"mobile",Tablet:"tablet",SmartTv:"smarttv",Console:"console",Wearable:"wearable",Embedded:"embedded",Browser:void 0},mt={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",EdgeChromium:"Edge Chromium",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},Dt={IOS:"iOS",Android:"Android",WindowsPhone:"Windows Phone",Windows:"Windows",MAC_OS:"Mac OS"},St={isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1},wt=function(_){switch(_){case ut.Mobile:return{isMobile:!0};case ut.Tablet:return{isTablet:!0};case ut.SmartTv:return{isSmartTV:!0};case ut.Console:return{isConsole:!0};case ut.Wearable:return{isWearable:!0};case ut.Browser:return{isBrowser:!0};case ut.Embedded:return{isEmbedded:!0};default:return St}},Zt=function(_){return f(_)},j=function(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none";return _||E},xt=function(){return typeof window<"u"&&(window.navigator||navigator)?window.navigator||navigator:!1},ct=function(_){var E=xt();return E&&E.platform&&(E.platform.indexOf(_)!==-1||E.platform==="MacIntel"&&E.maxTouchPoints>1&&!window.MSStream)},Re=function(_,E,k,I,ft){return{isBrowser:_,browserMajorVersion:j(E.major),browserFullVersion:j(E.version),browserName:j(E.name),engineName:j(k.name),engineVersion:j(k.version),osName:j(I.name),osVersion:j(I.version),userAgent:j(ft)}},ue=function(_,E,k,I){return b({},_,{vendor:j(E.vendor),model:j(E.model),os:j(k.name),osVersion:j(k.version),ua:j(I)})},Tt=function(_,E,k,I){return{isSmartTV:_,engineName:j(E.name),engineVersion:j(E.version),osName:j(k.name),osVersion:j(k.version),userAgent:j(I)}},ss=function(_,E,k,I){return{isConsole:_,engineName:j(E.name),engineVersion:j(E.version),osName:j(k.name),osVersion:j(k.version),userAgent:j(I)}},oi=function(_,E,k,I){return{isWearable:_,engineName:j(E.name),engineVersion:j(E.version),osName:j(k.name),osVersion:j(k.version),userAgent:j(I)}},At=function(_,E,k,I,ft){return{isEmbedded:_,vendor:j(E.vendor),model:j(E.model),engineName:j(k.name),engineVersion:j(k.version),osName:j(I.name),osVersion:j(I.version),userAgent:j(ft)}};function kt(C){var _=C?u(C):p,E=_.device,k=_.browser,I=_.engine,ft=_.os,Yt=_.ua,Be=wt(E.type),$l=Be.isBrowser,$m=Be.isMobile,Gm=Be.isTablet,Nu=Be.isSmartTV,Bu=Be.isConsole,Hu=Be.isWearable,Wu=Be.isEmbedded;if($l)return Re($l,k,I,ft,Yt);if(Nu)return Tt(Nu,I,ft,Yt);if(Bu)return ss(Bu,I,ft,Yt);if($m||Gm)return ue(Be,E,ft,Yt);if(Hu)return oi(Hu,I,ft,Yt);if(Wu)return At(Wu,E,I,ft,Yt)}var Gt=function(_){var E=_.type;return E===ut.Mobile},Nt=function(_){var E=_.type;return E===ut.Tablet},ke=function(_){var E=_.type;return E===ut.Mobile||E===ut.Tablet},li=function(_){var E=_.type;return E===ut.SmartTv},Ws=function(_){var E=_.type;return E===ut.Browser},En=function(_){var E=_.type;return E===ut.Wearable},Oi=function(_){var E=_.type;return E===ut.Console},ye=function(_){var E=_.type;return E===ut.Embedded},yi=function(_){var E=_.vendor;return j(E)},ns=function(_){var E=_.model;return j(E)},ot=function(_){var E=_.type;return j(E,"browser")},bt=function(_){var E=_.name;return E===Dt.Android},Y=function(_){var E=_.name;return E===Dt.Windows},vt=function(_){var E=_.name;return E===Dt.MAC_OS},we=function(_){var E=_.name;return E===Dt.WindowsPhone},fe=function(_){var E=_.name;return E===Dt.IOS},yt=function(_){var E=_.version;return j(E)},Q=function(_){var E=_.name;return j(E)},qe=function(_){var E=_.name;return E===mt.Chrome},Or=function(_){var E=_.name;return E===mt.Firefox},Ka=function(_){var E=_.name;return E===mt.Chromium},jl=function(_){var E=_.name;return E===mt.Edge},lu=function(_){var E=_.name;return E===mt.Yandex},hu=function(_){var E=_.name;return E===mt.Safari||E===mt.MobileSafari},cu=function(_){var E=_.name;return E===mt.MobileSafari},du=function(_){var E=_.name;return E===mt.Opera},uu=function(_){var E=_.name;return E===mt.InternetExplorer||E===mt.Ie},fu=function(_){var E=_.name;return E===mt.MIUI},pu=function(_){var E=_.name;return E===mt.SamsungBrowser},gu=function(_){var E=_.version;return j(E)},mu=function(_){var E=_.major;return j(E)},bu=function(_){var E=_.name;return j(E)},vu=function(_){var E=_.name;return j(E)},yu=function(_){var E=_.version;return j(E)},wu=function(){var _=xt(),E=_&&_.userAgent&&_.userAgent.toLowerCase();return typeof E=="string"?/electron/.test(E):!1},Nr=function(_){return typeof _=="string"&&_.indexOf("Edg/")!==-1},Au=function(){var _=xt();return _&&(/iPad|iPhone|iPod/.test(_.platform)||_.platform==="MacIntel"&&_.maxTouchPoints>1)&&!window.MSStream},Ni=function(){return ct("iPad")},_u=function(){return ct("iPhone")},Eu=function(){return ct("iPod")},Su=function(_){return j(_)};function xu(C){var _=C||p,E=_.device,k=_.browser,I=_.os,ft=_.engine,Yt=_.ua;return{isSmartTV:li(E),isConsole:Oi(E),isWearable:En(E),isEmbedded:ye(E),isMobileSafari:cu(k)||Ni(),isChromium:Ka(k),isMobile:ke(E)||Ni(),isMobileOnly:Gt(E),isTablet:Nt(E)||Ni(),isBrowser:Ws(E),isDesktop:Ws(E),isAndroid:bt(I),isWinPhone:we(I),isIOS:fe(I)||Ni(),isChrome:qe(k),isFirefox:Or(k),isSafari:hu(k),isOpera:du(k),isIE:uu(k),osVersion:yt(I),osName:Q(I),fullBrowserVersion:gu(k),browserVersion:mu(k),browserName:bu(k),mobileVendor:yi(E),mobileModel:ns(E),engineName:vu(ft),engineVersion:yu(ft),getUA:Su(Yt),isEdge:jl(k)||Nr(Yt),isYandex:lu(k),deviceType:ot(E),isIOS13:Au(),isIPad13:Ni(),isIPhone13:_u(),isIPod13:Eu(),isElectron:wu(),isEdgeChromium:Nr(Yt),isLegacyEdge:jl(k)&&!Nr(Yt),isWindows:Y(I),isMacOs:vt(I),isMIUI:fu(k),isSamsungBrowser:pu(k)}}var Tu=li(o),Cu=Oi(o),Pu=En(o),Qg=ye(o),Jg=cu(n)||Ni(),Zg=Ka(n),zl=ke(o)||Ni(),Ru=Gt(o),ku=Nt(o)||Ni(),Mu=Ws(o),tm=Ws(o),Lu=bt(c),Iu=we(c),Fu=fe(c)||Ni(),em=qe(n),im=Or(n),sm=hu(n),nm=du(n),Du=uu(n),rm=yt(c),am=Q(c),om=gu(n),lm=mu(n),hm=bu(n),cm=yi(o),dm=ns(o),um=vu(l),fm=yu(l),pm=Su(d),gm=jl(n)||Nr(d),mm=lu(n),bm=ot(o),vm=Au(),ym=Ni(),wm=_u(),Am=Eu(),_m=wu(),Em=Nr(d),Sm=jl(n)&&!Nr(d),xm=Y(c),Tm=vt(c),Cm=fu(n),Pm=pu(n),Rm=function(_){if(!_||typeof _!="string"){console.error("No valid user agent string was provided");return}var E=u(_),k=E.device,I=E.browser,ft=E.os,Yt=E.engine,Be=E.ua;return xu({device:k,browser:I,os:ft,engine:Yt,ua:Be})},km=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return Lu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Mm=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return Mu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Lm=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return Du?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Im=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return Fu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Fm=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return zl?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Dm=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return ku?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Om=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return Iu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Nm=function(_){var E=_.renderWithFragment,k=_.children;_.viewClassName,_.style;var I=D(_,["renderWithFragment","children","viewClassName","style"]);return Ru?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Bm=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return Tu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Hm=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return Cu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Wm=function(_){var E=_.renderWithFragment,k=_.children,I=D(_,["renderWithFragment","children"]);return Pu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Um=function(_){var E=_.renderWithFragment,k=_.children;_.viewClassName,_.style;var I=_.condition,ft=D(_,["renderWithFragment","children","viewClassName","style","condition"]);return I?E?e.createElement(t.Fragment,null,k):e.createElement("div",ft,k):null};function Vm(C){return function(_){R(E,_);function E(k){var I;return A(this,E),I=st(this,M(E).call(this,k)),I.isEventListenerAdded=!1,I.handleOrientationChange=I.handleOrientationChange.bind(H(I)),I.onOrientationChange=I.onOrientationChange.bind(H(I)),I.onPageLoad=I.onPageLoad.bind(H(I)),I.state={isLandscape:!1,isPortrait:!1},I}return S(E,[{key:"handleOrientationChange",value:function(){this.isEventListenerAdded||(this.isEventListenerAdded=!0);var I=window.innerWidth>window.innerHeight?90:0;this.setState({isPortrait:I===0,isLandscape:I===90})}},{key:"onOrientationChange",value:function(){this.handleOrientationChange()}},{key:"onPageLoad",value:function(){this.handleOrientationChange()}},{key:"componentDidMount",value:function(){(typeof window>"u"?"undefined":w(window))!==void 0&&zl&&(this.isEventListenerAdded?window.removeEventListener("load",this.onPageLoad,!1):(this.handleOrientationChange(),window.addEventListener("load",this.onPageLoad,!1)),window.addEventListener("resize",this.onOrientationChange,!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onOrientationChange,!1)}},{key:"render",value:function(){return e.createElement(C,P({},this.props,{isLandscape:this.state.isLandscape,isPortrait:this.state.isPortrait}))}}]),E}(e.Component)}function jm(){var C=t.useState(function(){var ft=window.innerWidth>window.innerHeight?90:0;return{isPortrait:ft===0,isLandscape:ft===90,orientation:ft===0?"portrait":"landscape"}}),_=q(C,2),E=_[0],k=_[1],I=t.useCallback(function(){var ft=window.innerWidth>window.innerHeight?90:0,Yt={isPortrait:ft===0,isLandscape:ft===90,orientation:ft===0?"portrait":"landscape"};E.orientation!==Yt.orientation&&k(Yt)},[E.orientation]);return t.useEffect(function(){return(typeof window>"u"?"undefined":w(window))!==void 0&&zl&&(I(),window.addEventListener("load",I,!1),window.addEventListener("resize",I,!1)),function(){window.removeEventListener("resize",I,!1),window.removeEventListener("load",I,!1)}},[I]),E}function Ou(C){var _=C||window.navigator.userAgent;return u(_)}function zm(C){var _=C||window.navigator.userAgent,E=Ou(_),k=xu(E);return[k,E]}return V.AndroidView=km,V.BrowserTypes=mt,V.BrowserView=Mm,V.ConsoleView=Hm,V.CustomView=Um,V.IEView=Lm,V.IOSView=Im,V.MobileOnlyView=Nm,V.MobileView=Fm,V.OsTypes=Dt,V.SmartTVView=Bm,V.TabletView=Dm,V.WearableView=Wm,V.WinPhoneView=Om,V.browserName=hm,V.browserVersion=lm,V.deviceDetect=kt,V.deviceType=bm,V.engineName=um,V.engineVersion=fm,V.fullBrowserVersion=om,V.getSelectorsByUserAgent=Rm,V.getUA=pm,V.isAndroid=Lu,V.isBrowser=Mu,V.isChrome=em,V.isChromium=Zg,V.isConsole=Cu,V.isDesktop=tm,V.isEdge=gm,V.isEdgeChromium=Em,V.isElectron=_m,V.isEmbedded=Qg,V.isFirefox=im,V.isIE=Du,V.isIOS=Fu,V.isIOS13=vm,V.isIPad13=ym,V.isIPhone13=wm,V.isIPod13=Am,V.isLegacyEdge=Sm,V.isMIUI=Cm,V.isMacOs=Tm,V.isMobile=zl,V.isMobileOnly=Ru,V.isMobileSafari=Jg,V.isOpera=nm,V.isSafari=sm,V.isSamsungBrowser=Pm,V.isSmartTV=Tu,V.isTablet=ku,V.isWearable=Pu,V.isWinPhone=Iu,V.isWindows=xm,V.isYandex=mm,V.mobileModel=dm,V.mobileVendor=cm,V.osName=am,V.osVersion=rm,V.parseUserAgent=u,V.setUserAgent=Zt,V.useDeviceData=Ou,V.useDeviceSelectors=zm,V.useMobileOrientation=jm,V.withOrientationChange=Vm,V}var wc=Nb(),yo={};yo.d=(h,t)=>{for(var e in t)yo.o(t,e)&&!yo.o(h,e)&&Object.defineProperty(h,e,{enumerable:!0,get:t[e]})};yo.o=(h,t)=>Object.prototype.hasOwnProperty.call(h,t);var it=globalThis.pdfjsLib={};yo.d(it,{AbortException:()=>Fr,AnnotationEditorLayer:()=>Ld,AnnotationEditorParamsType:()=>et,AnnotationEditorType:()=>at,AnnotationEditorUIManager:()=>Pr,AnnotationLayer:()=>Dy,AnnotationMode:()=>js,ColorPicker:()=>Fh,DOMSVGFactory:()=>iu,DrawLayer:()=>Od,FeatureTest:()=>De,GlobalWorkerOptions:()=>Fs,ImageKind:()=>Zl,InvalidPDFException:()=>Lf,MissingPDFException:()=>Ir,OPS:()=>Ai,OutputScale:()=>xc,PDFDataRangeTransport:()=>Pp,PDFDateString:()=>Yd,PDFWorker:()=>Xr,PasswordResponses:()=>Ub,PermissionFlag:()=>Wb,PixelsPerInch:()=>vn,RenderingCancelledException:()=>qd,TextLayer:()=>Zc,UnexpectedResponseException:()=>ic,Util:()=>z,VerbosityLevel:()=>Zh,XfaLayer:()=>kp,build:()=>gy,createValidAbsoluteUrl:()=>$b,fetchData:()=>nc,getDocument:()=>ay,getFilenameFromUrl:()=>tv,getPdfFilenameFromUrl:()=>ev,getXfaPageViewport:()=>iv,isDataScheme:()=>rc,isPdfFile:()=>Xd,noContextMenu:()=>vi,normalizeUnicode:()=>Qb,setLayerDimensions:()=>Cr,shadow:()=>gt,version:()=>py});const Pe=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Mf=[1,0,0,1,0,0],Ac=[.001,0,0,.001,0,0],Bb=1e7,dc=1.35,si={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},js={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Hb="pdfjs_internal_editor_",at={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},et={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},Wb={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ae={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Zl={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},te={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Qa={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Zh={ERRORS:0,WARNINGS:1,INFOS:5},Ai={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Ub={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let tc=Zh.WARNINGS;function Vb(h){Number.isInteger(h)&&(tc=h)}function jb(){return tc}function ec(h){tc>=Zh.INFOS&&console.log(`Info: ${h}`)}function ht(h){tc>=Zh.WARNINGS&&console.log(`Warning: ${h}`)}function Bt(h){throw new Error(h)}function ne(h,t){h||Bt(t)}function zb(h){switch(h==null?void 0:h.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function $b(h,t=null,e=null){if(!h)return null;try{if(e&&typeof h=="string"){if(e.addDefaultProtocol&&h.startsWith("www.")){const s=h.match(/\./g);(s==null?void 0:s.length)>=2&&(h=`http://${h}`)}if(e.tryConvertEncoding)try{h=Kb(h)}catch{}}const i=t?new URL(h,t):new URL(h);if(zb(i))return i}catch{}return null}function gt(h,t,e,i=!1){return Object.defineProperty(h,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const _n=function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t}();class _c extends _n{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Ec extends _n{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Lf extends _n{constructor(t){super(t,"InvalidPDFException")}}class Ir extends _n{constructor(t){super(t,"MissingPDFException")}}class ic extends _n{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class Gb extends _n{constructor(t){super(t,"FormatError")}}class Fr extends _n{constructor(t){super(t,"AbortException")}}function If(h){(typeof h!="object"||(h==null?void 0:h.length)===void 0)&&Bt("Invalid argument for bytesToString");const t=h.length,e=8192;if(t<e)return String.fromCharCode.apply(null,h);const i=[];for(let s=0;s<t;s+=e){const n=Math.min(s+e,t),a=h.subarray(s,n);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function sc(h){typeof h!="string"&&Bt("Invalid argument for stringToBytes");const t=h.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=h.charCodeAt(i)&255;return e}function qb(h){return String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,h&255)}function $d(h){const t=Object.create(null);for(const[e,i]of h)t[e]=i;return t}function Xb(){const h=new Uint8Array(4);return h[0]=1,new Uint32Array(h.buffer,0,1)[0]===1}function Yb(){try{return new Function(""),!0}catch{return!1}}class De{static get isLittleEndian(){return gt(this,"isLittleEndian",Xb())}static get isEvalSupported(){return gt(this,"isEvalSupported",Yb())}static get isOffscreenCanvasSupported(){return gt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?gt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):gt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return gt(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const uc=Array.from(Array(256).keys(),h=>h.toString(16).padStart(2,"0"));var Os,th,Sc;class z{static makeHexColor(t,e,i){return`#${uc[t]}${uc[e]}${uc[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const i=t[0]*e[0]+t[1]*e[2]+e[4],s=t[0]*e[1]+t[1]*e[3]+e[5];return[i,s]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2],s=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,n=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i;return[s,n]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),s=this.applyTransform(t.slice(2,4),e),n=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],s[0],n[0],a[0]),Math.min(i[1],s[1],n[1],a[1]),Math.max(i[0],s[0],n[0],a[0]),Math.max(i[1],s[1],n[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],s=t[0]*e[1]+t[1]*e[3],n=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],o=(i+a)/2,l=Math.sqrt((i+a)**2-4*(i*a-n*s))/2,c=o+l||1,d=o-l||1;return[Math.sqrt(c),Math.sqrt(d)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const n=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return n>a?null:[i,n,s,a]}static bezierBoundingBox(t,e,i,s,n,a,o,l,c){return c?(c[0]=Math.min(c[0],t,o),c[1]=Math.min(c[1],e,l),c[2]=Math.max(c[2],t,o),c[3]=Math.max(c[3],e,l)):c=[Math.min(t,o),Math.min(e,l),Math.max(t,o),Math.max(e,l)],v(this,Os,Sc).call(this,t,i,n,o,e,s,a,l,3*(-t+3*(i-n)+o),6*(t-2*i+n),3*(i-t),c),v(this,Os,Sc).call(this,t,i,n,o,e,s,a,l,3*(-e+3*(s-a)+l),6*(e-2*s+a),3*(s-e),c),c}}Os=new WeakSet,th=function(t,e,i,s,n,a,o,l,c,d){if(c<=0||c>=1)return;const f=1-c,u=c*c,p=u*c,g=f*(f*(f*t+3*c*e)+3*u*i)+p*s,b=f*(f*(f*n+3*c*a)+3*u*o)+p*l;d[0]=Math.min(d[0],g),d[1]=Math.min(d[1],b),d[2]=Math.max(d[2],g),d[3]=Math.max(d[3],b)},Sc=function(t,e,i,s,n,a,o,l,c,d,f,u){if(Math.abs(c)<1e-12){Math.abs(d)>=1e-12&&v(this,Os,th).call(this,t,e,i,s,n,a,o,l,-f/d,u);return}const p=d**2-4*f*c;if(p<0)return;const g=Math.sqrt(p),b=2*c;v(this,Os,th).call(this,t,e,i,s,n,a,o,l,(-d+g)/b,u),v(this,Os,th).call(this,t,e,i,s,n,a,o,l,(-d-g)/b,u)},y(z,Os);function Kb(h){return decodeURIComponent(escape(h))}let fc=null,Ku=null;function Qb(h){return fc||(fc=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ku=new Map([["ﬅ","ſt"]])),h.replaceAll(fc,(t,e,i)=>e?e.normalize("NFKC"):Ku.get(i))}function Jb(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const h=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(h);else for(let t=0;t<32;t++)h[t]=Math.floor(Math.random()*255);return If(h)}const Gd="pdfjs_internal_id_",rs={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function Zb(h){return Uint8Array.prototype.toBase64?h.toBase64():btoa(If(h))}const os="http://www.w3.org/2000/svg",Rn=class Rn{};Z(Rn,"CSS",96),Z(Rn,"PDF",72),Z(Rn,"PDF_TO_CSS_UNITS",Rn.CSS/Rn.PDF);let vn=Rn;async function nc(h,t="text"){if(io(h,document.baseURI)){const e=await fetch(h);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",h,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class Hl{constructor({viewBox:t,scale:e,rotation:i,offsetX:s=0,offsetY:n=0,dontFlip:a=!1}){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=s,this.offsetY=n;const o=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let c,d,f,u;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,d=0,f=0,u=1;break;case 90:c=0,d=1,f=1,u=0;break;case 270:c=0,d=-1,f=-1,u=0;break;case 0:c=1,d=0,f=0,u=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(f=-f,u=-u);let p,g,b,w;c===0?(p=Math.abs(l-t[1])*e+s,g=Math.abs(o-t[0])*e+n,b=(t[3]-t[1])*e,w=(t[2]-t[0])*e):(p=Math.abs(o-t[0])*e+s,g=Math.abs(l-t[1])*e+n,b=(t[2]-t[0])*e,w=(t[3]-t[1])*e),this.transform=[c*e,d*e,f*e,u*e,p-c*e*o-f*e*l,g-d*e*o-u*e*l],this.width=b,this.height=w}get rawDims(){const{viewBox:t}=this;return gt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:n=!1}={}){return new Hl({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:n})}convertToViewportPoint(t,e){return z.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=z.applyTransform([t[0],t[1]],this.transform),i=z.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return z.applyInverseTransform([t,e],this.transform)}}class qd extends _n{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function rc(h){const t=h.length;let e=0;for(;e<t&&h[e].trim()==="";)e++;return h.substring(e,e+5).toLowerCase()==="data:"}function Xd(h){return typeof h=="string"&&/\.pdf$/i.test(h)}function tv(h){return[h]=h.split(/[#?]/,1),h.substring(h.lastIndexOf("/")+1)}function ev(h,t="document.pdf"){if(typeof h!="string")return t;if(rc(h))return ht('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=e.exec(h);let n=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(n&&(n=n[0],n.includes("%")))try{n=i.exec(decodeURIComponent(n))[0]}catch{}return n||t}class Qu{constructor(){Z(this,"started",Object.create(null));Z(this,"times",[])}time(t){t in this.started&&ht(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ht(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:n}of this.times)t.push(`${i.padEnd(e)} ${n-s}ms
`);return t.join("")}}function io(h,t){try{const{protocol:e}=t?new URL(h,t):new URL(h);return e==="http:"||e==="https:"}catch{return!1}}function vi(h){h.preventDefault()}function Ju(h){console.log("Deprecated API usage: "+h)}var Eo;class Yd{static toDateObject(t){if(!t||typeof t!="string")return null;r(this,Eo)||m(this,Eo,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=r(this,Eo).exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let n=parseInt(e[3],10);n=n>=1&&n<=31?n:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const c=e[7]||"Z";let d=parseInt(e[8],10);d=d>=0&&d<=23?d:0;let f=parseInt(e[9],10)||0;return f=f>=0&&f<=59?f:0,c==="-"?(a+=d,o+=f):c==="+"&&(a-=d,o-=f),new Date(Date.UTC(i,s,n,a,o,l))}}Eo=new WeakMap,y(Yd,Eo);function iv(h,{scale:t=1,rotation:e=0}){const{width:i,height:s}=h.attributes.style,n=[0,0,parseInt(i),parseInt(s)];return new Hl({viewBox:n,scale:t,rotation:e})}function Kd(h){if(h.startsWith("#")){const t=parseInt(h.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return h.startsWith("rgb(")?h.slice(4,-1).split(",").map(t=>parseInt(t)):h.startsWith("rgba(")?h.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ht(`Not a valid color format: "${h}"`),[0,0,0])}function sv(h){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of h.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;h.set(e,Kd(i))}t.remove()}function jt(h){const{a:t,b:e,c:i,d:s,e:n,f:a}=h.getTransform();return[t,e,i,s,n,a]}function as(h){const{a:t,b:e,c:i,d:s,e:n,f:a}=h.getTransform().invertSelf();return[t,e,i,s,n,a]}function Cr(h,t,e=!1,i=!0){if(t instanceof Hl){const{pageWidth:s,pageHeight:n}=t.rawDims,{style:a}=h,o=De.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,c=`var(--scale-factor) * ${n}px`,d=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,f=o?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!e||t.rotation%180===0?(a.width=d,a.height=f):(a.width=f,a.height=d)}i&&h.setAttribute("data-main-rotation",t.rotation)}class xc{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var zs,Mn,_i,Ln,So,xo,Oh,Ff,Oe,Df,Of,eh,Nf,Cc;const ls=class ls{constructor(t){y(this,Oe);y(this,zs,null);y(this,Mn,null);y(this,_i);y(this,Ln,null);y(this,So,null);m(this,_i,t),r(ls,xo)||m(ls,xo,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=m(this,zs,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=r(this,_i)._uiManager._signal;t.addEventListener("contextmenu",vi,{signal:e}),t.addEventListener("pointerdown",v(ls,Oh,Ff),{signal:e});const i=m(this,Ln,document.createElement("div"));i.className="buttons",t.append(i);const s=r(this,_i).toolbarPosition;if(s){const{style:n}=t,a=r(this,_i)._uiManager.direction==="ltr"?1-s[0]:s[0];n.insetInlineEnd=`${100*a}%`,n.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return v(this,Oe,Nf).call(this),t}get div(){return r(this,zs)}hide(){var t;r(this,zs).classList.add("hidden"),(t=r(this,Mn))==null||t.hideDropdown()}show(){var t;r(this,zs).classList.remove("hidden"),(t=r(this,So))==null||t.shown()}async addAltText(t){const e=await t.render();v(this,Oe,eh).call(this,e),r(this,Ln).prepend(e,r(this,Oe,Cc)),m(this,So,t)}addColorPicker(t){m(this,Mn,t);const e=t.renderButton();v(this,Oe,eh).call(this,e),r(this,Ln).prepend(e,r(this,Oe,Cc))}remove(){var t;r(this,zs).remove(),(t=r(this,Mn))==null||t.destroy(),m(this,Mn,null)}};zs=new WeakMap,Mn=new WeakMap,_i=new WeakMap,Ln=new WeakMap,So=new WeakMap,xo=new WeakMap,Oh=new WeakSet,Ff=function(t){t.stopPropagation()},Oe=new WeakSet,Df=function(t){r(this,_i)._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()},Of=function(t){r(this,_i)._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()},eh=function(t){const e=r(this,_i)._uiManager._signal;t.addEventListener("focusin",v(this,Oe,Df).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",v(this,Oe,Of).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",vi,{signal:e})},Nf=function(){const{editorType:t,_uiManager:e}=r(this,_i),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",r(ls,xo)[t]),v(this,Oe,eh).call(this,i),i.addEventListener("click",s=>{e.delete()},{signal:e._signal}),r(this,Ln).append(i)},Cc=function(){const t=document.createElement("div");return t.className="divider",t},y(ls,Oh),y(ls,xo,null);let Tc=ls;var To,In,Fn,wn,Bf,Hf,Wf;class nv{constructor(t){y(this,wn);y(this,To,null);y(this,In,null);y(this,Fn);m(this,Fn,t)}show(t,e,i){const[s,n]=v(this,wn,Hf).call(this,e,i),{style:a}=r(this,In)||m(this,In,v(this,wn,Bf).call(this));t.append(r(this,In)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*n}% + var(--editor-toolbar-vert-offset))`}hide(){r(this,In).remove()}}To=new WeakMap,In=new WeakMap,Fn=new WeakMap,wn=new WeakSet,Bf=function(){const t=m(this,In,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",vi,{signal:r(this,Fn)._signal});const e=m(this,To,document.createElement("div"));return e.className="buttons",t.append(e),v(this,wn,Wf).call(this),t},Hf=function(t,e){let i=0,s=0;for(const n of t){const a=n.y+n.height;if(a<i)continue;const o=n.x+(e?n.width:0);if(a>i){s=o,i=a;continue}e?o>s&&(s=o):o<s&&(s=o)}return[e?1-s:s,i]},Wf=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=r(this,Fn)._signal;t.addEventListener("contextmenu",vi,{signal:i}),t.addEventListener("click",()=>{r(this,Fn).highlightSelection("floating_button")},{signal:i}),r(this,To).append(t)};function Mh(h,t,e){for(const i of e)t.addEventListener(i,h[i].bind(h))}function rv(h){return Math.round(Math.min(255,Math.max(1,255*h))).toString(16).padStart(2,"0")}var Nh;class av{constructor(){y(this,Nh,0)}get id(){return`${Hb}${Me(this,Nh)._++}`}}Nh=new WeakMap;var Qr,Co,Ee,Jr,ih;const ru=class ru{constructor(){y(this,Jr);y(this,Qr,Jb());y(this,Co,0);y(this,Ee,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const n=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return gt(this,"_isSVGFittingCanvas",n)}async getFromFile(t){const{lastModified:e,name:i,size:s,type:n}=t;return v(this,Jr,ih).call(this,`${e}_${i}_${s}_${n}`,t)}async getFromUrl(t){return v(this,Jr,ih).call(this,t,t)}async getFromBlob(t,e){const i=await e;return v(this,Jr,ih).call(this,t,i)}async getFromId(t){r(this,Ee)||m(this,Ee,new Map);const e=r(this,Ee).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){r(this,Ee)||m(this,Ee,new Map);let i=r(this,Ee).get(t);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${r(this,Qr)}_${Me(this,Co)._++}`,refCounter:1,isSvg:!1},r(this,Ee).set(t,i),r(this,Ee).set(i.id,i),i}getSvgUrl(t){const e=r(this,Ee).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var s;r(this,Ee)||m(this,Ee,new Map);const e=r(this,Ee).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const n=new OffscreenCanvas(i.width,i.height);n.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=n.convertToBlob()}(s=i.close)==null||s.call(i),e.bitmap=null}isValidId(t){return t.startsWith(`image_${r(this,Qr)}_`)}};Qr=new WeakMap,Co=new WeakMap,Ee=new WeakMap,Jr=new WeakSet,ih=async function(t,e){r(this,Ee)||m(this,Ee,new Map);let i=r(this,Ee).get(t);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${r(this,Qr)}_${Me(this,Co)._++}`,refCounter:0,isSvg:!1});let s;if(typeof e=="string"?(i.url=e,s=await nc(e,"blob")):e instanceof File?s=i.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const n=ru._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,d)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const f=i.svgUrl=a.result;o.src=await n?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=d});a.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){console.error(s),i=null}return r(this,Ee).set(t,i),i&&r(this,Ee).set(i.id,i),i};let Pc=ru;var oe,$s,Po,le;class ov{constructor(t=128){y(this,oe,[]);y(this,$s,!1);y(this,Po);y(this,le,-1);m(this,Po,t)}add({cmd:t,undo:e,post:i,mustExec:s,type:n=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&t(),r(this,$s))return;const l={cmd:t,undo:e,post:i,type:n};if(r(this,le)===-1){r(this,oe).length>0&&(r(this,oe).length=0),m(this,le,0),r(this,oe).push(l);return}if(a&&r(this,oe)[r(this,le)].type===n){o&&(l.undo=r(this,oe)[r(this,le)].undo),r(this,oe)[r(this,le)]=l;return}const c=r(this,le)+1;c===r(this,Po)?r(this,oe).splice(0,1):(m(this,le,c),c<r(this,oe).length&&r(this,oe).splice(c)),r(this,oe).push(l)}undo(){if(r(this,le)===-1)return;m(this,$s,!0);const{undo:t,post:e}=r(this,oe)[r(this,le)];t(),e==null||e(),m(this,$s,!1),m(this,le,r(this,le)-1)}redo(){if(r(this,le)<r(this,oe).length-1){m(this,le,r(this,le)+1),m(this,$s,!0);const{cmd:t,post:e}=r(this,oe)[r(this,le)];t(),e==null||e(),m(this,$s,!1)}}hasSomethingToUndo(){return r(this,le)!==-1}hasSomethingToRedo(){return r(this,le)<r(this,oe).length-1}destroy(){m(this,oe,null)}}oe=new WeakMap,$s=new WeakMap,Po=new WeakMap,le=new WeakMap;var Bh,Uf;class Wl{constructor(t){y(this,Bh);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=De.platform;for(const[i,s,n={}]of t)for(const a of i){const o=a.startsWith("mac+");e&&o?(this.callbacks.set(a.slice(4),{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1))):!e&&!o&&(this.callbacks.set(a,{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(v(this,Bh,Uf).call(this,e));if(!i)return;const{callback:s,options:{bubbles:n=!1,args:a=[],checker:o=null}}=i;o&&!o(t,e)||(s.bind(t,...a,e)(),n||(e.stopPropagation(),e.preventDefault()))}}Bh=new WeakSet,Uf=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const Hh=class Hh{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return sv(t),gt(this,"_colors",t)}convert(t){const e=Kd(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((n,a)=>n===e[a]))return Hh._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?z.makeHexColor(...e):t}};Z(Hh,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Rc=Hh;var Zr,Ye,ee,ge,ta,cs,ea,Ei,Gs,ia,Dn,Hi,Si,On,Ro,ko,sa,Mo,Wi,qs,na,Xs,Ui,Wh,Ys,Lo,Ks,Nn,Io,Fo,he,Ct,ds,Bn,Do,Oo,Qs,Vi,us,No,ci,B,sh,kc,Vf,jf,nh,zf,$f,Gf,Mc,qf,Lc,Ic,Xf,Le,Us,Yf,Kf,Fc,Qf,so,Dc;const Gr=class Gr{constructor(t,e,i,s,n,a,o,l,c,d,f){y(this,B);y(this,Zr,new AbortController);y(this,Ye,null);y(this,ee,new Map);y(this,ge,new Map);y(this,ta,null);y(this,cs,null);y(this,ea,null);y(this,Ei,new ov);y(this,Gs,null);y(this,ia,0);y(this,Dn,new Set);y(this,Hi,null);y(this,Si,null);y(this,On,new Set);y(this,Ro,!1);y(this,ko,!1);y(this,sa,!1);y(this,Mo,null);y(this,Wi,null);y(this,qs,null);y(this,na,null);y(this,Xs,!1);y(this,Ui,null);y(this,Wh,new av);y(this,Ys,!1);y(this,Lo,!1);y(this,Ks,null);y(this,Nn,null);y(this,Io,null);y(this,Fo,null);y(this,he,at.NONE);y(this,Ct,new Set);y(this,ds,null);y(this,Bn,null);y(this,Do,null);y(this,Oo,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});y(this,Qs,[0,0]);y(this,Vi,null);y(this,us,null);y(this,No,null);y(this,ci,null);const u=this._signal=r(this,Zr).signal;m(this,us,t),m(this,No,e),m(this,ta,i),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:u}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:u}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:u}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:u}),s._on("setpreference",this.onSetPreference.bind(this),{signal:u}),s._on("switchannotationeditorparams",p=>this.updateParams(p.type,p.value),{signal:u}),v(this,B,zf).call(this),v(this,B,Xf).call(this),v(this,B,Mc).call(this),m(this,cs,n.annotationStorage),m(this,Mo,n.filterFactory),m(this,Bn,a),m(this,na,o||null),m(this,Ro,l),m(this,ko,c),m(this,sa,d),m(this,Fo,f||null),this.viewParameters={realScale:vn.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const t=Gr.prototype,e=a=>r(a,us).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,n=this.TRANSLATE_BIG;return gt(this,"_keyboardManager",new Wl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&r(a,us).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&r(a,us).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}]]))}destroy(){var t,e,i,s;(t=r(this,ci))==null||t.resolve(),m(this,ci,null),(e=r(this,Zr))==null||e.abort(),m(this,Zr,null),this._signal=null;for(const n of r(this,ge).values())n.destroy();r(this,ge).clear(),r(this,ee).clear(),r(this,On).clear(),m(this,Ye,null),r(this,Ct).clear(),r(this,Ei).destroy(),(i=r(this,ta))==null||i.destroy(),(s=r(this,Ui))==null||s.hide(),m(this,Ui,null),r(this,Wi)&&(clearTimeout(r(this,Wi)),m(this,Wi,null)),r(this,Vi)&&(clearTimeout(r(this,Vi)),m(this,Vi,null))}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return r(this,Fo)}get useNewAltTextFlow(){return r(this,ko)}get useNewAltTextWhenAddingImage(){return r(this,sa)}get hcmFilter(){return gt(this,"hcmFilter",r(this,Bn)?r(this,Mo).addHCMFilter(r(this,Bn).foreground,r(this,Bn).background):"none")}get direction(){return gt(this,"direction",getComputedStyle(r(this,us)).direction)}get highlightColors(){return gt(this,"highlightColors",r(this,na)?new Map(r(this,na).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return gt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){m(this,Io,t)}editAltText(t,e=!1){var i;(i=r(this,ta))==null||i.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":m(this,sa,e);break}}onPageChanging({pageNumber:t}){m(this,ia,t-1)}focusMainContainer(){r(this,us).focus()}findParent(t,e){for(const i of r(this,ge).values()){const{x:s,y:n,width:a,height:o}=i.div.getBoundingClientRect();if(t>=s&&t<=s+a&&e>=n&&e<=n+o)return i}return null}disableUserSelect(t=!1){r(this,No).classList.toggle("noUserSelect",t)}addShouldRescale(t){r(this,On).add(t)}removeShouldRescale(t){r(this,On).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*vn.PDF_TO_CSS_UNITS;for(const e of r(this,On))e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:n,focusOffset:a}=e,o=e.toString(),c=v(this,B,sh).call(this,e).closest(".textLayer"),d=this.getSelectionBoxes(c);if(!d)return;e.empty();const f=v(this,B,kc).call(this,c),u=r(this,he)===at.NONE,p=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:i,anchorOffset:s,focusNode:n,focusOffset:a,text:o}),u&&this.showAllEditors("highlight",!0,!0)};if(u){this.switchToMode(at.HIGHLIGHT,p);return}p()}addToAnnotationStorage(t){!t.isEmpty()&&r(this,cs)&&!r(this,cs).has(t.id)&&r(this,cs).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,r(this,Xs)&&(m(this,Xs,!1),v(this,B,nh).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of r(this,Ct))if(e.div.contains(t)){m(this,Nn,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!r(this,Nn))return;const[t,e]=r(this,Nn);m(this,Nn,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){v(this,B,Mc).call(this),v(this,B,Lc).call(this)}removeEditListeners(){v(this,B,qf).call(this),v(this,B,Ic).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of r(this,Si))if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of r(this,Si))if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var i;if(t.preventDefault(),(i=r(this,Ye))==null||i.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of r(this,Ct)){const n=s.serialize(!0);n&&e.push(n)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const n of e.items)for(const a of r(this,Si))if(a.isHandlingMimeForPasting(n.type)){a.paste(n,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(n){ht(`paste: "${n.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const n=[];for(const l of i){const c=await s.deserialize(l);if(!c)return;n.push(c)}const a=()=>{for(const l of n)v(this,B,Fc).call(this,l);v(this,B,Dc).call(this,n)},o=()=>{for(const l of n)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(n){ht(`paste: "${n.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),r(this,he)!==at.NONE&&!this.isEditorHandlingKeyboard&&Gr._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,r(this,Xs)&&(m(this,Xs,!1),v(this,B,nh).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(v(this,B,$f).call(this),v(this,B,Lc).call(this),v(this,B,Le).call(this,{isEditing:r(this,he)!==at.NONE,isEmpty:v(this,B,so).call(this),hasSomethingToUndo:r(this,Ei).hasSomethingToUndo(),hasSomethingToRedo:r(this,Ei).hasSomethingToRedo(),hasSelectedEditor:!1})):(v(this,B,Gf).call(this),v(this,B,Ic).call(this),v(this,B,Le).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!r(this,Si)){m(this,Si,t);for(const e of r(this,Si))v(this,B,Us).call(this,e.defaultPropertiesToUpdate)}}getId(){return r(this,Wh).id}get currentLayer(){return r(this,ge).get(r(this,ia))}getLayer(t){return r(this,ge).get(t)}get currentPageIndex(){return r(this,ia)}addLayer(t){r(this,ge).set(t.pageIndex,t),r(this,Ys)?t.enable():t.disable()}removeLayer(t){r(this,ge).delete(t.pageIndex)}async updateMode(t,e=null,i=!1){if(r(this,he)!==t&&!(r(this,ci)&&(await r(this,ci).promise,!r(this,ci)))){if(m(this,ci,Promise.withResolvers()),m(this,he,t),t===at.NONE){this.setEditingState(!1),v(this,B,Kf).call(this),r(this,ci).resolve();return}this.setEditingState(!0),await v(this,B,Yf).call(this),this.unselectAll();for(const s of r(this,ge).values())s.updateMode(t);if(!e){i&&this.addNewEditorFromKeyboard(),r(this,ci).resolve();return}for(const s of r(this,ee).values())s.annotationElementId===e?(this.setSelected(s),s.enterInEditMode()):s.unselect();r(this,ci).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==r(this,he)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var i;if(r(this,Si)){switch(t){case et.CREATE:this.currentLayer.addNewEditor();return;case et.HIGHLIGHT_DEFAULT_COLOR:(i=r(this,Io))==null||i.updateColor(e);break;case et.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(r(this,Do)||m(this,Do,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const s of r(this,Ct))s.updateParams(t,e);for(const s of r(this,Si))s.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){var n;for(const a of r(this,ee).values())a.editorType===t&&a.show(e);(((n=r(this,Do))==null?void 0:n.get(et.HIGHLIGHT_SHOW_ALL))??!0)!==e&&v(this,B,Us).call(this,[[et.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(r(this,Lo)!==t){m(this,Lo,t);for(const e of r(this,ge).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const i of r(this,ee).values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return r(this,ee).get(t)}addEditor(t){r(this,ee).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(r(this,Wi)&&clearTimeout(r(this,Wi)),m(this,Wi,setTimeout(()=>{this.focusMainContainer(),m(this,Wi,null)},0))),r(this,ee).delete(t.id),this.unselect(t),(!t.annotationElementId||!r(this,Dn).has(t.annotationElementId))&&((e=r(this,cs))==null||e.remove(t.id))}addDeletedAnnotationElement(t){r(this,Dn).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return r(this,Dn).has(t)}removeDeletedAnnotationElement(t){r(this,Dn).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){r(this,Ye)!==t&&(m(this,Ye,t),t&&v(this,B,Us).call(this,t.propertiesToUpdate))}updateUI(t){r(this,B,Qf)===t&&v(this,B,Us).call(this,t.propertiesToUpdate)}toggleSelected(t){if(r(this,Ct).has(t)){r(this,Ct).delete(t),t.unselect(),v(this,B,Le).call(this,{hasSelectedEditor:this.hasSelection});return}r(this,Ct).add(t),t.select(),v(this,B,Us).call(this,t.propertiesToUpdate),v(this,B,Le).call(this,{hasSelectedEditor:!0})}setSelected(t){for(const e of r(this,Ct))e!==t&&e.unselect();r(this,Ct).clear(),r(this,Ct).add(t),t.select(),v(this,B,Us).call(this,t.propertiesToUpdate),v(this,B,Le).call(this,{hasSelectedEditor:!0})}isSelected(t){return r(this,Ct).has(t)}get firstSelectedEditor(){return r(this,Ct).values().next().value}unselect(t){t.unselect(),r(this,Ct).delete(t),v(this,B,Le).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return r(this,Ct).size!==0}get isEnterHandled(){return r(this,Ct).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){r(this,Ei).undo(),v(this,B,Le).call(this,{hasSomethingToUndo:r(this,Ei).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:v(this,B,so).call(this)})}redo(){r(this,Ei).redo(),v(this,B,Le).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:r(this,Ei).hasSomethingToRedo(),isEmpty:v(this,B,so).call(this)})}addCommands(t){r(this,Ei).add(t),v(this,B,Le).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:v(this,B,so).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...r(this,Ct)],e=()=>{for(const s of t)s.remove()},i=()=>{for(const s of t)v(this,B,Fc).call(this,s)};this.addCommands({cmd:e,undo:i,mustExec:!0})}commitOrRemove(){var t;(t=r(this,Ye))==null||t.commitOrRemove()}hasSomethingToControl(){return r(this,Ye)||this.hasSelection}selectAll(){for(const t of r(this,Ct))t.commit();v(this,B,Dc).call(this,r(this,ee).values())}unselectAll(){if(!(r(this,Ye)&&(r(this,Ye).commitOrRemove(),r(this,he)!==at.NONE))&&this.hasSelection){for(const t of r(this,Ct))t.unselect();r(this,Ct).clear(),v(this,B,Le).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;r(this,Qs)[0]+=t,r(this,Qs)[1]+=e;const[s,n]=r(this,Qs),a=[...r(this,Ct)],o=1e3;r(this,Vi)&&clearTimeout(r(this,Vi)),m(this,Vi,setTimeout(()=>{m(this,Vi,null),r(this,Qs)[0]=r(this,Qs)[1]=0,this.addCommands({cmd:()=>{for(const l of a)r(this,ee).has(l.id)&&l.translateInPage(s,n)},undo:()=>{for(const l of a)r(this,ee).has(l.id)&&l.translateInPage(-s,-n)},mustExec:!1})},o));for(const l of a)l.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,Hi,new Map);for(const t of r(this,Ct))r(this,Hi).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!r(this,Hi))return!1;this.disableUserSelect(!1);const t=r(this,Hi);m(this,Hi,null);let e=!1;for(const[{x:s,y:n,pageIndex:a},o]of t)o.newX=s,o.newY=n,o.newPageIndex=a,e||(e=s!==o.savedX||n!==o.savedY||a!==o.savedPageIndex);if(!e)return!1;const i=(s,n,a,o)=>{if(r(this,ee).has(s.id)){const l=r(this,ge).get(o);l?s._setParentAndPosition(l,n,a):(s.pageIndex=o,s.x=n,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:n,newY:a,newPageIndex:o}]of t)i(s,n,a,o)},undo:()=>{for(const[s,{savedX:n,savedY:a,savedPageIndex:o}]of t)i(s,n,a,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(r(this,Hi))for(const i of r(this,Hi).keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||r(this,Ct).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return r(this,Ye)===t}getActive(){return r(this,Ye)}getMode(){return r(this,he)}get imageManager(){return gt(this,"imageManager",new Pc)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let c=0,d=e.rangeCount;c<d;c++)if(!t.contains(e.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:n,height:a}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(c,d,f,u)=>({x:(d-s)/a,y:1-(c+f-i)/n,width:u/a,height:f/n});break;case"180":o=(c,d,f,u)=>({x:1-(c+f-i)/n,y:1-(d+u-s)/a,width:f/n,height:u/a});break;case"270":o=(c,d,f,u)=>({x:1-(d+u-s)/a,y:(c-i)/n,width:u/a,height:f/n});break;default:o=(c,d,f,u)=>({x:(c-i)/n,y:(d-s)/a,width:f/n,height:u/a});break}const l=[];for(let c=0,d=e.rangeCount;c<d;c++){const f=e.getRangeAt(c);if(!f.collapsed)for(const{x:u,y:p,width:g,height:b}of f.getClientRects())g===0||b===0||l.push(o(u,p,g,b))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:e}){(r(this,ea)||m(this,ea,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=r(this,ea))==null||e.delete(t)}renderAnnotationElement(t){var s;const e=(s=r(this,ea))==null?void 0:s.get(t.data.id);if(!e)return;const i=r(this,cs).getRawValue(e);i&&(r(this,he)===at.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}};Zr=new WeakMap,Ye=new WeakMap,ee=new WeakMap,ge=new WeakMap,ta=new WeakMap,cs=new WeakMap,ea=new WeakMap,Ei=new WeakMap,Gs=new WeakMap,ia=new WeakMap,Dn=new WeakMap,Hi=new WeakMap,Si=new WeakMap,On=new WeakMap,Ro=new WeakMap,ko=new WeakMap,sa=new WeakMap,Mo=new WeakMap,Wi=new WeakMap,qs=new WeakMap,na=new WeakMap,Xs=new WeakMap,Ui=new WeakMap,Wh=new WeakMap,Ys=new WeakMap,Lo=new WeakMap,Ks=new WeakMap,Nn=new WeakMap,Io=new WeakMap,Fo=new WeakMap,he=new WeakMap,Ct=new WeakMap,ds=new WeakMap,Bn=new WeakMap,Do=new WeakMap,Oo=new WeakMap,Qs=new WeakMap,Vi=new WeakMap,us=new WeakMap,No=new WeakMap,ci=new WeakMap,B=new WeakSet,sh=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},kc=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of r(this,ge).values())if(i.hasTextLayer(t))return i;return null},Vf=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=v(this,B,sh).call(this,t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(r(this,Ui)||m(this,Ui,new nv(this)),r(this,Ui).show(i,s,this.direction==="ltr"))},jf=function(){var n,a,o;const t=document.getSelection();if(!t||t.isCollapsed){r(this,ds)&&((n=r(this,Ui))==null||n.hide(),m(this,ds,null),v(this,B,Le).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===r(this,ds))return;const s=v(this,B,sh).call(this,t).closest(".textLayer");if(!s){r(this,ds)&&((a=r(this,Ui))==null||a.hide(),m(this,ds,null),v(this,B,Le).call(this,{hasSelectedText:!1}));return}if((o=r(this,Ui))==null||o.hide(),m(this,ds,e),v(this,B,Le).call(this,{hasSelectedText:!0}),!(r(this,he)!==at.HIGHLIGHT&&r(this,he)!==at.NONE)&&(r(this,he)===at.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,Xs,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=r(this,he)===at.HIGHLIGHT?v(this,B,kc).call(this,s):null;l==null||l.toggleDrawing();const c=new AbortController,d=this.combinedSignal(c),f=u=>{u.type==="pointerup"&&u.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),u.type==="pointerup"&&v(this,B,nh).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}},nh=function(t=""){r(this,he)===at.HIGHLIGHT?this.highlightSelection(t):r(this,Ro)&&v(this,B,Vf).call(this)},zf=function(){document.addEventListener("selectionchange",v(this,B,jf).bind(this),{signal:this._signal})},$f=function(){if(r(this,qs))return;m(this,qs,new AbortController);const t=this.combinedSignal(r(this,qs));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},Gf=function(){var t;(t=r(this,qs))==null||t.abort(),m(this,qs,null)},Mc=function(){if(r(this,Ks))return;m(this,Ks,new AbortController);const t=this.combinedSignal(r(this,Ks));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},qf=function(){var t;(t=r(this,Ks))==null||t.abort(),m(this,Ks,null)},Lc=function(){if(r(this,Gs))return;m(this,Gs,new AbortController);const t=this.combinedSignal(r(this,Gs));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},Ic=function(){var t;(t=r(this,Gs))==null||t.abort(),m(this,Gs,null)},Xf=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Le=function(t){Object.entries(t).some(([i,s])=>r(this,Oo)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(r(this,Oo),t)}),r(this,he)===at.HIGHLIGHT&&t.hasSelectedEditor===!1&&v(this,B,Us).call(this,[[et.HIGHLIGHT_FREE,!0]]))},Us=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},Yf=async function(){if(!r(this,Ys)){m(this,Ys,!0);const t=[];for(const e of r(this,ge).values())t.push(e.enable());await Promise.all(t);for(const e of r(this,ee).values())e.enable()}},Kf=function(){if(this.unselectAll(),r(this,Ys)){m(this,Ys,!1);for(const t of r(this,ge).values())t.disable();for(const t of r(this,ee).values())t.disable()}},Fc=function(t){const e=r(this,ge).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},Qf=function(){let t=null;for(t of r(this,Ct));return t},so=function(){if(r(this,ee).size===0)return!0;if(r(this,ee).size===1)for(const t of r(this,ee).values())return t.isEmpty();return!1},Dc=function(t){for(const e of r(this,Ct))e.unselect();r(this,Ct).clear();for(const e of t)e.isEmpty()||(r(this,Ct).add(e),e.select());v(this,B,Le).call(this,{hasSelectedEditor:this.hasSelection})},Z(Gr,"TRANSLATE_SMALL",1),Z(Gr,"TRANSLATE_BIG",10);let Pr=Gr;var ce,ji,xi,ra,zi,Ke,aa,$i,Ue,fs,Hn,Gi,Js,Di,no,rh;const Ie=class Ie{constructor(t){y(this,Di);y(this,ce,null);y(this,ji,!1);y(this,xi,null);y(this,ra,null);y(this,zi,null);y(this,Ke,null);y(this,aa,!1);y(this,$i,null);y(this,Ue,null);y(this,fs,null);y(this,Hn,null);y(this,Gi,!1);m(this,Ue,t),m(this,Gi,t._uiManager.useNewAltTextFlow),r(Ie,Js)||m(Ie,Js,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Ie._l10n??(Ie._l10n=t)}async render(){const t=m(this,xi,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=m(this,ra,document.createElement("span"));t.append(e),r(this,Gi)?(t.classList.add("new"),t.setAttribute("data-l10n-id",r(Ie,Js).missing),e.setAttribute("data-l10n-id",r(Ie,Js)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=r(this,Ue)._uiManager._signal;t.addEventListener("contextmenu",vi,{signal:i}),t.addEventListener("pointerdown",n=>n.stopPropagation(),{signal:i});const s=n=>{n.preventDefault(),r(this,Ue)._uiManager.editAltText(r(this,Ue)),r(this,Gi)&&r(this,Ue)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:r(this,Di,no)}})};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",n=>{n.target===t&&n.key==="Enter"&&(m(this,aa,!0),s(n))},{signal:i}),await v(this,Di,rh).call(this),t}finish(){r(this,xi)&&(r(this,xi).focus({focusVisible:r(this,aa)}),m(this,aa,!1))}isEmpty(){return r(this,Gi)?r(this,ce)===null:!r(this,ce)&&!r(this,ji)}hasData(){return r(this,Gi)?r(this,ce)!==null||!!r(this,fs):this.isEmpty()}get guessedText(){return r(this,fs)}async setGuessedText(t){r(this,ce)===null&&(m(this,fs,t),m(this,Hn,await Ie._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),v(this,Di,rh).call(this))}toggleAltTextBadge(t=!1){var e;if(!r(this,Gi)||r(this,ce)){(e=r(this,$i))==null||e.remove(),m(this,$i,null);return}if(!r(this,$i)){const i=m(this,$i,document.createElement("div"));i.className="noAltTextBadge",r(this,Ue).div.append(i)}r(this,$i).classList.toggle("hidden",!t)}serialize(t){let e=r(this,ce);return!t&&r(this,fs)===e&&(e=r(this,Hn)),{altText:e,decorative:r(this,ji),guessedText:r(this,fs),textWithDisclaimer:r(this,Hn)}}get data(){return{altText:r(this,ce),decorative:r(this,ji)}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:s,cancel:n=!1}){i&&(m(this,fs,i),m(this,Hn,s)),!(r(this,ce)===t&&r(this,ji)===e)&&(n||(m(this,ce,t),m(this,ji,e)),v(this,Di,rh).call(this))}toggle(t=!1){r(this,xi)&&(!t&&r(this,Ke)&&(clearTimeout(r(this,Ke)),m(this,Ke,null)),r(this,xi).disabled=!t)}shown(){r(this,Ue)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:r(this,Di,no)}})}destroy(){var t,e;(t=r(this,xi))==null||t.remove(),m(this,xi,null),m(this,ra,null),m(this,zi,null),(e=r(this,$i))==null||e.remove(),m(this,$i,null)}};ce=new WeakMap,ji=new WeakMap,xi=new WeakMap,ra=new WeakMap,zi=new WeakMap,Ke=new WeakMap,aa=new WeakMap,$i=new WeakMap,Ue=new WeakMap,fs=new WeakMap,Hn=new WeakMap,Gi=new WeakMap,Js=new WeakMap,Di=new WeakSet,no=function(){return r(this,ce)&&"added"||r(this,ce)===null&&this.guessedText&&"review"||"missing"},rh=async function(){var s,n,a;const t=r(this,xi);if(!t)return;if(r(this,Gi)){if(t.classList.toggle("done",!!r(this,ce)),t.setAttribute("data-l10n-id",r(Ie,Js)[r(this,Di,no)]),(s=r(this,ra))==null||s.setAttribute("data-l10n-id",r(Ie,Js)[`${r(this,Di,no)}-label`]),!r(this,ce)){(n=r(this,zi))==null||n.remove();return}}else{if(!r(this,ce)&&!r(this,ji)){t.classList.remove("done"),(a=r(this,zi))==null||a.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=r(this,zi);if(!e){m(this,zi,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${r(this,Ue).id}`;const o=100,l=r(this,Ue)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(r(this,Ke)),m(this,Ke,null)},{once:!0}),t.addEventListener("mouseenter",()=>{m(this,Ke,setTimeout(()=>{m(this,Ke,null),r(this,zi).classList.add("show"),r(this,Ue)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),t.addEventListener("mouseleave",()=>{var c;r(this,Ke)&&(clearTimeout(r(this,Ke)),m(this,Ke,null)),(c=r(this,zi))==null||c.classList.remove("show")},{signal:l})}r(this,ji)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=r(this,ce)),e.parentNode||t.append(e);const i=r(this,Ue).getImageForAltText();i==null||i.setAttribute("aria-describedby",e.id)},y(Ie,Js,null),Z(Ie,"_l10n",null);let Lh=Ie;var Wn,Ti,Ut,oa,Un,me,Vn,Zs,Bo,jn,tn,Ho,zn,ps,qi,la,ha,di,Wo,Uh,lt,Oc,Uo,Nc,Bc,Jf,Zf,Hc,Wc,Uc,tp,Vc,ep,ip,sp,jc,ro;const Et=class Et{constructor(t){y(this,lt);y(this,Wn,null);y(this,Ti,null);y(this,Ut,null);y(this,oa,!1);y(this,Un,!1);y(this,me,null);y(this,Vn,null);y(this,Zs,null);y(this,Bo,"");y(this,jn,!1);y(this,tn,null);y(this,Ho,!1);y(this,zn,!1);y(this,ps,!1);y(this,qi,null);y(this,la,0);y(this,ha,0);y(this,di,null);Z(this,"_editToolbar",null);Z(this,"_initialOptions",Object.create(null));Z(this,"_initialData",null);Z(this,"_isVisible",!0);Z(this,"_uiManager",null);Z(this,"_focusEventsAllowed",!0);y(this,Wo,!1);y(this,Uh,Et._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:n,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[n,a];const[o,l]=this.parentDimensions;this.x=t.x/o,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=Et.prototype._resizeWithKeyboard,e=Pr.TRANSLATE_SMALL,i=Pr.TRANSLATE_BIG;return gt(this,"_resizerKeyboardManager",new Wl([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Et.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return gt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new lv({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Et._l10n??(Et._l10n=t),Et._l10nResizer||(Et._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Et._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Et._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Bt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return r(this,Wo)}set _isDraggable(t){var e;m(this,Wo,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=r(this,Uh)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):v(this,lt,ro).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(r(this,jn)?m(this,jn,!1):this.parent.setSelected(this))}focusout(t){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[n,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/n,this.y=(e+s)/a,this.fixAndSetPosition()}translate(t,e){v(this,lt,Oc).call(this,this.parentDimensions,t,e)}translateInPage(t,e){r(this,tn)||m(this,tn,[this.x,this.y]),v(this,lt,Oc).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){r(this,tn)||m(this,tn,[this.x,this.y]);const[i,s]=this.parentDimensions;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:c,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:n,y:a}=this;const[o,l]=this.getBaseTranslation();n+=o,a+=l,this.div.style.left=`${(100*n).toFixed(2)}%`,this.div.style.top=`${(100*a).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!r(this,tn)&&(r(this,tn)[0]!==this.x||r(this,tn)[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Et,s=i/t,n=i/e;switch(this.rotation){case 90:return[-s,n];case 180:return[s,n];case 270:return[s,-n];default:return[-s,-n]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,i]=this.pageDimensions;let{x:s,y:n,width:a,height:o}=this;if(a*=e,o*=i,s*=e,n*=i,this._mustFixPosition)switch(t){case 0:s=Math.max(0,Math.min(e-a,s)),n=Math.max(0,Math.min(i-o,n));break;case 90:s=Math.max(0,Math.min(e-o,s)),n=Math.min(i,Math.max(a,n));break;case 180:s=Math.min(e,Math.max(a,s)),n=Math.min(i,Math.max(o,n));break;case 270:s=Math.min(e,Math.max(o,s)),n=Math.max(0,Math.min(i-a,n));break}this.x=s/=e,this.y=n/=i;const[l,c]=this.getBaseTranslation();s+=l,n+=c;const{style:d}=this.div;d.left=`${(100*s).toFixed(2)}%`,d.top=`${(100*n).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var i;return v(i=Et,Uo,Nc).call(i,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var i;return v(i=Et,Uo,Nc).call(i,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(t,e){const[i,s]=this.parentDimensions;this.div.style.width=`${(100*t/i).toFixed(2)}%`,r(this,Un)||(this.div.style.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,s=i.endsWith("%"),n=!r(this,Un)&&e.endsWith("%");if(s&&n)return;const[a,o]=this.parentDimensions;s||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!r(this,Un)&&!n&&(t.height=`${(100*parseFloat(e)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var t;(t=r(this,Ut))==null||t.finish()}async addEditToolbar(){return this._editToolbar||r(this,zn)?this._editToolbar:(this._editToolbar=new Tc(this),this.div.append(this._editToolbar.render()),r(this,Ut)&&await this._editToolbar.addAltText(r(this,Ut)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=r(this,Ut))==null||t.destroy())}addContainer(t){var i;const e=(i=this._editToolbar)==null?void 0:i.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){r(this,Ut)||(Lh.initialize(Et._l10n),m(this,Ut,new Lh(this)),r(this,Wn)&&(r(this,Ut).data=r(this,Wn),m(this,Wn,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=r(this,Ut))==null?void 0:t.data}set altTextData(t){r(this,Ut)&&(r(this,Ut).data=t)}get guessedAltText(){var t;return(t=r(this,Ut))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=r(this,Ut))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=r(this,Ut))==null?void 0:e.serialize(t)}hasAltText(){return!!r(this,Ut)&&!r(this,Ut).isEmpty()}hasAltTextData(){var t;return((t=r(this,Ut))==null?void 0:t.hasData())??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=r(this,oa)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),v(this,lt,Vc).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),Mh(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=De.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(m(this,jn,!0),this._isDraggable){v(this,lt,tp).call(this,t);return}v(this,lt,Uc).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}moveInDOM(){r(this,qi)&&clearTimeout(r(this,qi)),m(this,qi,setTimeout(()=>{var t;m(this,qi,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition()}getRect(t,e,i=this.rotation){const s=this.parentScale,[n,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=t/s,d=e/s,f=this.x*n,u=this.y*a,p=this.width*n,g=this.height*a;switch(i){case 0:return[f+c+o,a-u-d-g+l,f+c+p+o,a-u-d+l];case 90:return[f+d+o,a-u+c+l,f+d+g+o,a-u+c+p+l];case 180:return[f-c-p+o,a-u+d+l,f-c+o,a-u+d+g+l];case 270:return[f-d-g+o,a-u-c-p+l,f-d+o,a-u-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,n,a]=t,o=n-i,l=a-s;switch(this.rotation){case 0:return[i,e-a,o,l];case 90:return[i,e-s,l,o];case 180:return[n,e-s,o,l];case 270:return[n,e-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){m(this,zn,!0)}disableEditMode(){m(this,zn,!1)}isInEditMode(){return r(this,zn)}shouldGetKeyboardEvents(){return r(this,ps)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){v(this,lt,Vc).call(this)}rotate(t){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){Bt("An editor must be serializable")}static async deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});s.rotation=t.rotation,m(s,Wn,t.accessibilityData);const[n,a]=s.pageDimensions,[o,l,c,d]=s.getRectInCurrentCoords(t.rect,a);return s.x=o/n,s.y=l/a,s.width=c/n,s.height=d/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t;if((t=r(this,Zs))==null||t.abort(),m(this,Zs,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),r(this,qi)&&(clearTimeout(r(this,qi)),m(this,qi,null)),v(this,lt,ro).call(this),this.removeEditToolbar(),r(this,di)){for(const e of r(this,di).values())clearTimeout(e);m(this,di,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(v(this,lt,Jf).call(this),r(this,me).classList.remove("hidden"),Mh(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),m(this,Vn,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=r(this,me).children;if(!r(this,Ti)){m(this,Ti,Array.from(e));const a=v(this,lt,ep).bind(this),o=v(this,lt,ip).bind(this),l=this._uiManager._signal;for(const c of r(this,Ti)){const d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",v(this,lt,sp).bind(this,d),{signal:l}),c.setAttribute("data-l10n-id",Et._l10nResizer[d])}}const i=r(this,Ti)[0];let s=0;for(const a of e){if(a===i)break;s++}const n=(360-this.rotation+this.parentRotation)%360/90*(r(this,Ti).length/4);if(n!==s){if(n<s)for(let o=0;o<s-n;o++)r(this,me).append(r(this,me).firstChild);else if(n>s)for(let o=0;o<n-s;o++)r(this,me).firstChild.before(r(this,me).lastChild);let a=0;for(const o of e){const c=r(this,Ti)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Et._l10nResizer[c])}}v(this,lt,jc).call(this,0),m(this,ps,!0),r(this,me).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){r(this,ps)&&v(this,lt,Wc).call(this,r(this,Bo),{movementX:t,movementY:e})}_stopResizingWithKeyboard(){v(this,lt,ro).call(this),this.div.focus()}select(){var t,e,i;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,n;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((n=this._editToolbar)==null||n.show())});return}(e=this._editToolbar)==null||e.show(),(i=r(this,Ut))==null||i.toggleAltTextBadge(!1)}unselect(){var t,e,i,s,n;(t=r(this,me))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(n=r(this,Ut))==null||n.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return r(this,Ho)}set isEditing(t){m(this,Ho,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){m(this,Un,!0);const i=t/e,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){r(this,di)||m(this,di,new Map);const{action:i}=t;let s=r(this,di).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),r(this,di).delete(i),r(this,di).size===0&&m(this,di,null)},Et._telemetryTimeout),r(this,di).set(i,s);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),m(this,oa,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,oa,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};Wn=new WeakMap,Ti=new WeakMap,Ut=new WeakMap,oa=new WeakMap,Un=new WeakMap,me=new WeakMap,Vn=new WeakMap,Zs=new WeakMap,Bo=new WeakMap,jn=new WeakMap,tn=new WeakMap,Ho=new WeakMap,zn=new WeakMap,ps=new WeakMap,qi=new WeakMap,la=new WeakMap,ha=new WeakMap,di=new WeakMap,Wo=new WeakMap,Uh=new WeakMap,lt=new WeakSet,Oc=function([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this.fixAndSetPosition()},Uo=new WeakSet,Nc=function(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},Bc=function(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}},Jf=function(){if(r(this,me))return;m(this,me,document.createElement("div")),r(this,me).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const s=document.createElement("div");r(this,me).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",v(this,lt,Zf).bind(this,i),{signal:e}),s.addEventListener("contextmenu",vi,{signal:e}),s.tabIndex=-1}this.div.prepend(r(this,me))},Zf=function(t,e){var g;e.preventDefault();const{isMac:i}=De.platform;if(e.button!==0||e.ctrlKey&&i)return;(g=r(this,Ut))==null||g.toggle(!1);const s=this._isDraggable;this._isDraggable=!1;const n=new AbortController,a=this._uiManager.combinedSignal(n);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",v(this,lt,Wc).bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("contextmenu",vi,{signal:a});const o=this.x,l=this.y,c=this.width,d=this.height,f=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const p=()=>{var b;n.abort(),this.parent.togglePointerEvents(!0),(b=r(this,Ut))==null||b.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=f,this.div.style.cursor=u,v(this,lt,Hc).call(this,o,l,c,d)};window.addEventListener("pointerup",p,{signal:a}),window.addEventListener("blur",p,{signal:a})},Hc=function(t,e,i,s){const n=this.x,a=this.y,o=this.width,l=this.height;n===t&&a===e&&o===i&&l===s||this.addCommands({cmd:()=>{this.width=o,this.height=l,this.x=n,this.y=a;const[c,d]=this.parentDimensions;this.setDims(c*o,d*l),this.fixAndSetPosition()},undo:()=>{this.width=i,this.height=s,this.x=t,this.y=e;const[c,d]=this.parentDimensions;this.setDims(c*i,d*s),this.fixAndSetPosition()},mustExec:!0})},Wc=function(t,e){const[i,s]=this.parentDimensions,n=this.x,a=this.y,o=this.width,l=this.height,c=Et.MIN_SIZE/i,d=Et.MIN_SIZE/s,f=W=>Math.round(W*1e4)/1e4,u=v(this,lt,Bc).call(this,this.rotation),p=(W,G)=>[u[0]*W+u[2]*G,u[1]*W+u[3]*G],g=v(this,lt,Bc).call(this,360-this.rotation),b=(W,G)=>[g[0]*W+g[2]*G,g[1]*W+g[3]*G];let w,A,T=!1,S=!1;switch(t){case"topLeft":T=!0,w=(W,G)=>[0,0],A=(W,G)=>[W,G];break;case"topMiddle":w=(W,G)=>[W/2,0],A=(W,G)=>[W/2,G];break;case"topRight":T=!0,w=(W,G)=>[W,0],A=(W,G)=>[0,G];break;case"middleRight":S=!0,w=(W,G)=>[W,G/2],A=(W,G)=>[0,G/2];break;case"bottomRight":T=!0,w=(W,G)=>[W,G],A=(W,G)=>[0,0];break;case"bottomMiddle":w=(W,G)=>[W/2,G],A=(W,G)=>[W/2,0];break;case"bottomLeft":T=!0,w=(W,G)=>[0,G],A=(W,G)=>[W,0];break;case"middleLeft":S=!0,w=(W,G)=>[0,G/2],A=(W,G)=>[W,G/2];break}const x=w(o,l),P=A(o,l);let R=p(...P);const M=f(n+R[0]),L=f(a+R[1]);let F=1,D=1,[H,st]=this.screenToPageTranslation(e.movementX,e.movementY);if([H,st]=b(H/i,st/s),T){const W=Math.hypot(o,l);F=D=Math.max(Math.min(Math.hypot(P[0]-x[0]-H,P[1]-x[1]-st)/W,1/o,1/l),c/o,d/l)}else S?F=Math.max(c,Math.min(1,Math.abs(P[0]-x[0]-H)))/o:D=Math.max(d,Math.min(1,Math.abs(P[1]-x[1]-st)))/l;const q=f(o*F),$=f(l*D);R=p(...A(q,$));const J=M-R[0],K=L-R[1];this.width=q,this.height=$,this.x=J,this.y=K,this.setDims(i*q,s*$),this.fixAndSetPosition()},Uc=function(t){const{isMac:e}=De.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},tp=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();const i=new AbortController,s=this._uiManager.combinedSignal(i);if(e){this.div.classList.add("moving"),m(this,la,t.clientX),m(this,ha,t.clientY);const a=o=>{const{clientX:l,clientY:c}=o,[d,f]=this.screenToPageTranslation(l-r(this,la),c-r(this,ha));m(this,la,l),m(this,ha,c),this._uiManager.dragSelectedEditors(d,f)};window.addEventListener("pointermove",a,{passive:!0,capture:!0,signal:s})}const n=()=>{i.abort(),e&&this.div.classList.remove("moving"),m(this,jn,!1),this._uiManager.endDragSession()||v(this,lt,Uc).call(this,t)};window.addEventListener("pointerup",n,{signal:s}),window.addEventListener("blur",n,{signal:s})},Vc=function(){if(r(this,Zs)||!this.div)return;m(this,Zs,new AbortController);const t=this._uiManager.combinedSignal(r(this,Zs));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},ep=function(t){Et._resizerKeyboardManager.exec(this,t)},ip=function(t){var e;r(this,ps)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==r(this,me)&&v(this,lt,ro).call(this)},sp=function(t){m(this,Bo,r(this,ps)?t:"")},jc=function(t){if(r(this,Ti))for(const e of r(this,Ti))e.tabIndex=t},ro=function(){if(m(this,ps,!1),v(this,lt,jc).call(this,-1),r(this,Vn)){const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=r(this,Vn);v(this,lt,Hc).call(this,t,e,i,s),m(this,Vn,null)}},y(Et,Uo),Z(Et,"_l10n",null),Z(Et,"_l10nResizer",null),Z(Et,"_borderLineWidth",-1),Z(Et,"_colorManager",new Rc),Z(Et,"_zIndex",1),Z(Et,"_telemetryTimeout",1e3);let Rt=Et;class lv extends Rt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Zu=3285377520,hi=4294901760,Bi=65535;class np{constructor(t){this.h1=t?t&4294967295:Zu,this.h2=t?t&4294967295:Zu}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let b=0,w=t.length;b<w;b++){const A=t.charCodeAt(b);A<=255?e[i++]=A:(e[i++]=A>>>8,e[i++]=A&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,n=i-s*4,a=new Uint32Array(e.buffer,0,s);let o=0,l=0,c=this.h1,d=this.h2;const f=3432918353,u=461845907,p=f&Bi,g=u&Bi;for(let b=0;b<s;b++)b&1?(o=a[b],o=o*f&hi|o*p&Bi,o=o<<15|o>>>17,o=o*u&hi|o*g&Bi,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[b],l=l*f&hi|l*p&Bi,l=l<<15|l>>>17,l=l*u&hi|l*g&Bi,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(o=0,n){case 3:o^=e[s*4+2]<<16;case 2:o^=e[s*4+1]<<8;case 1:o^=e[s*4],o=o*f&hi|o*p&Bi,o=o<<15|o>>>17,o=o*u&hi|o*g&Bi,s&1?c^=o:d^=o}this.h1=c,this.h2=d}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&hi|t*36045&Bi,e=e*4283543511&hi|((e<<16|t>>>16)*2950163797&hi)>>>16,t^=e>>>1,t=t*444984403&hi|t*60499&Bi,e=e*3301882366&hi|((e<<16|t>>>16)*3120437893&hi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const zc=Object.freeze({map:null,hash:"",transfer:void 0});var $n,Gn,de,Vh,rp;class Qd{constructor(){y(this,Vh);y(this,$n,!1);y(this,Gn,null);y(this,de,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=r(this,de).get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return r(this,de).get(t)}remove(t){if(r(this,de).delete(t),r(this,de).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of r(this,de).values())if(e instanceof Rt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=r(this,de).get(t);let s=!1;if(i!==void 0)for(const[n,a]of Object.entries(e))i[n]!==a&&(s=!0,i[n]=a);else s=!0,r(this,de).set(t,e);s&&v(this,Vh,rp).call(this),e instanceof Rt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return r(this,de).has(t)}getAll(){return r(this,de).size>0?$d(r(this,de)):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return r(this,de).size}resetModified(){r(this,$n)&&(m(this,$n,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ap(this)}get serializable(){if(r(this,de).size===0)return zc;const t=new Map,e=new np,i=[],s=Object.create(null);let n=!1;for(const[a,o]of r(this,de)){const l=o instanceof Rt?o.serialize(!1,s):o;l&&(t.set(a,l),e.update(`${a}:${JSON.stringify(l)}`),n||(n=!!l.bitmap))}if(n)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:zc}get editorStats(){let t=null;const e=new Map;for(const i of r(this,de).values()){if(!(i instanceof Rt))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:n}=s;e.has(n)||e.set(n,Object.getPrototypeOf(i).constructor),t||(t=Object.create(null));const a=t[n]||(t[n]=new Map);for(const[o,l]of Object.entries(s)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const d=c.get(l)??0;c.set(l,d+1)}}for(const[i,s]of e)t[i]=s.computeTelemetryFinalData(t[i]);return t}resetModifiedIds(){m(this,Gn,null)}get modifiedIds(){if(r(this,Gn))return r(this,Gn);const t=[];for(const e of r(this,de).values())!(e instanceof Rt)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return m(this,Gn,{ids:new Set(t),hash:t.join(",")})}}$n=new WeakMap,Gn=new WeakMap,de=new WeakMap,Vh=new WeakSet,rp=function(){r(this,$n)||(m(this,$n,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Vo;class ap extends Qd{constructor(e){super();y(this,Vo);const{map:i,hash:s,transfer:n}=e.serializable,a=structuredClone(i,n?{transfer:n}:null);m(this,Vo,{map:a,hash:s,transfer:n})}get print(){Bt("Should not call PrintAnnotationStorage.print")}get serializable(){return r(this,Vo)}get modifiedIds(){return gt(this,"modifiedIds",{ids:new Set,hash:""})}}Vo=new WeakMap;var ca;class hv{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){y(this,ca,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),r(this,ca).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||r(this,ca).has(t.loadedName))){if(ne(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:n}=t,a=new FontFace(i,s,n);this.addNativeFontFace(a);try{await a.load(),r(this,ca).add(i),e==null||e(t)}catch{ht(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Bt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw ht(`Failed to load font '${i.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return gt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Pe||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),gt(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(ne(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const n=i.shift();setTimeout(n.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:e,callback:t};return i.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return gt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(x,P){return x.charCodeAt(P)<<24|x.charCodeAt(P+1)<<16|x.charCodeAt(P+2)<<8|x.charCodeAt(P+3)&255}function s(x,P,R,M){const L=x.substring(0,P),F=x.substring(P+R);return L+M+F}let n,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function d(x,P){if(++c>30){ht("Load test font never loaded."),P();return}if(l.font="30px "+x,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){P();return}setTimeout(d.bind(null,x,P))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let u=this._loadTestFont;u=s(u,976,f.length,f);const g=16,b=1482184792;let w=i(u,g);for(n=0,a=f.length-3;n<a;n+=4)w=w-b+i(f,n)|0;n<f.length&&(w=w-b+i(f+"XXX",n)|0),u=s(u,g,4,qb(w));const A=`url(data:font/opentype;base64,${btoa(u)});`,T=`@font-face {font-family:"${f}";src:${A}}`;this.insertRule(T);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const x of[t.loadedName,f]){const P=this._document.createElement("span");P.textContent="Hi",P.style.fontFamily=x,S.append(P)}this._document.body.append(S),d(f,()=>{S.remove(),e.complete()})}}ca=new WeakMap;class cv{constructor(t,{disableFontFace:e=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const s in t)this[s]=t[s];this.disableFontFace=e===!0,this._inspectFont=i}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Zb(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return(i=this._inspectFont)==null||i.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];let i;try{i=t.get(this.loadedName+"_path_"+e)}catch(n){ht(`getPathGenerator - ignoring character: "${n}".`)}if(!Array.isArray(i)||i.length===0)return this.compiledGlyphs[e]=function(n,a){};const s=[];for(let n=0,a=i.length;n<a;)switch(i[n++]){case rs.BEZIER_CURVE_TO:{const[o,l,c,d,f,u]=i.slice(n,n+6);s.push(p=>p.bezierCurveTo(o,l,c,d,f,u)),n+=6}break;case rs.MOVE_TO:{const[o,l]=i.slice(n,n+2);s.push(c=>c.moveTo(o,l)),n+=2}break;case rs.LINE_TO:{const[o,l]=i.slice(n,n+2);s.push(c=>c.lineTo(o,l)),n+=2}break;case rs.QUADRATIC_CURVE_TO:{const[o,l,c,d]=i.slice(n,n+4);s.push(f=>f.quadraticCurveTo(o,l,c,d)),n+=4}break;case rs.RESTORE:s.push(o=>o.restore());break;case rs.SAVE:s.push(o=>o.save());break;case rs.SCALE:ne(s.length===2,"Scale command is only valid at the third position.");break;case rs.TRANSFORM:{const[o,l,c,d,f,u]=i.slice(n,n+6);s.push(p=>p.transform(o,l,c,d,f,u)),n+=6}break;case rs.TRANSLATE:{const[o,l]=i.slice(n,n+2);s.push(c=>c.translate(o,l)),n+=2}break}return this.compiledGlyphs[e]=function(a,o){s[0](a),s[1](a),a.scale(o,-o);for(let l=2,c=s.length;l<c;l++)s[l](a)}}}var jo;class op{constructor({enableHWA:t=!1}){y(this,jo,!1);m(this,jo,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!r(this,jo)})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Bt("Abstract method `_createCanvas` called.")}}jo=new WeakMap;class dv extends op{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class lp{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Bt("Abstract method `_fetch` called.")}}class hp extends lp{async _fetch(t){const e=await nc(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):sc(e)}}class cp{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,n){return"none"}destroy(t=!1){}}var qn,Xn,Xi,gs,Se,jh,Yn,U,_e,Br,Hr,ah,Wr,dp,$c,Ur,ao,oo,Gc,lo;class uv extends cp{constructor({docId:e,ownerDocument:i=globalThis.document}){super();y(this,U);y(this,qn);y(this,Xn);y(this,Xi);y(this,gs);y(this,Se);y(this,jh);y(this,Yn,0);m(this,gs,e),m(this,Se,i)}addFilter(e){if(!e)return"none";let i=r(this,U,_e).get(e);if(i)return i;const[s,n,a]=v(this,U,ah).call(this,e),o=e.length===1?s:`${s}${n}${a}`;if(i=r(this,U,_e).get(o),i)return r(this,U,_e).set(e,i),i;const l=`g_${r(this,gs)}_transfer_map_${Me(this,Yn)._++}`,c=v(this,U,Wr).call(this,l);r(this,U,_e).set(e,c),r(this,U,_e).set(o,c);const d=v(this,U,Ur).call(this,l);return v(this,U,oo).call(this,s,n,a,d),c}addHCMFilter(e,i){var g;const s=`${e}-${i}`,n="base";let a=r(this,U,Br).get(n);if((a==null?void 0:a.key)===s||(a?((g=a.filter)==null||g.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},r(this,U,Br).set(n,a)),!e||!i))return a.url;const o=v(this,U,lo).call(this,e);e=z.makeHexColor(...o);const l=v(this,U,lo).call(this,i);if(i=z.makeHexColor(...l),r(this,U,Hr).style.color="",e==="#000000"&&i==="#ffffff"||e===i)return a.url;const c=new Array(256);for(let b=0;b<=255;b++){const w=b/255;c[b]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const d=c.join(","),f=`g_${r(this,gs)}_hcm_filter`,u=a.filter=v(this,U,Ur).call(this,f);v(this,U,oo).call(this,d,d,d,u),v(this,U,$c).call(this,u);const p=(b,w)=>{const A=o[b]/255,T=l[b]/255,S=new Array(w+1);for(let x=0;x<=w;x++)S[x]=A+x/w*(T-A);return S.join(",")};return v(this,U,oo).call(this,p(0,5),p(1,5),p(2,5),u),a.url=v(this,U,Wr).call(this,f),a.url}addAlphaFilter(e){let i=r(this,U,_e).get(e);if(i)return i;const[s]=v(this,U,ah).call(this,[e]),n=`alpha_${s}`;if(i=r(this,U,_e).get(n),i)return r(this,U,_e).set(e,i),i;const a=`g_${r(this,gs)}_alpha_map_${Me(this,Yn)._++}`,o=v(this,U,Wr).call(this,a);r(this,U,_e).set(e,o),r(this,U,_e).set(n,o);const l=v(this,U,Ur).call(this,a);return v(this,U,Gc).call(this,s,l),o}addLuminosityFilter(e){let i=r(this,U,_e).get(e||"luminosity");if(i)return i;let s,n;if(e?([s]=v(this,U,ah).call(this,[e]),n=`luminosity_${s}`):n="luminosity",i=r(this,U,_e).get(n),i)return r(this,U,_e).set(e,i),i;const a=`g_${r(this,gs)}_luminosity_map_${Me(this,Yn)._++}`,o=v(this,U,Wr).call(this,a);r(this,U,_e).set(e,o),r(this,U,_e).set(n,o);const l=v(this,U,Ur).call(this,a);return v(this,U,dp).call(this,l),e&&v(this,U,Gc).call(this,s,l),o}addHighlightHCMFilter(e,i,s,n,a){var T;const o=`${i}-${s}-${n}-${a}`;let l=r(this,U,Br).get(e);if((l==null?void 0:l.key)===o||(l?((T=l.filter)==null||T.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},r(this,U,Br).set(e,l)),!i||!s))return l.url;const[c,d]=[i,s].map(v(this,U,lo).bind(this));let f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),u=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,g]=[n,a].map(v(this,U,lo).bind(this));u<f&&([f,u,p,g]=[u,f,g,p]),r(this,U,Hr).style.color="";const b=(S,x,P)=>{const R=new Array(256),M=(u-f)/P,L=S/255,F=(x-S)/(255*P);let D=0;for(let H=0;H<=P;H++){const st=Math.round(f+H*M),q=L+H*F;for(let $=D;$<=st;$++)R[$]=q;D=st+1}for(let H=D;H<256;H++)R[H]=R[D-1];return R.join(",")},w=`g_${r(this,gs)}_hcm_${e}_filter`,A=l.filter=v(this,U,Ur).call(this,w);return v(this,U,$c).call(this,A),v(this,U,oo).call(this,b(p[0],g[0],5),b(p[1],g[1],5),b(p[2],g[2],5),A),l.url=v(this,U,Wr).call(this,w),l.url}destroy(e=!1){e&&r(this,U,Br).size!==0||(r(this,Xi)&&(r(this,Xi).parentNode.parentNode.remove(),m(this,Xi,null)),r(this,Xn)&&(r(this,Xn).clear(),m(this,Xn,null)),m(this,Yn,0))}}qn=new WeakMap,Xn=new WeakMap,Xi=new WeakMap,gs=new WeakMap,Se=new WeakMap,jh=new WeakMap,Yn=new WeakMap,U=new WeakSet,_e=function(){return r(this,Xn)||m(this,Xn,new Map)},Br=function(){return r(this,jh)||m(this,jh,new Map)},Hr=function(){if(!r(this,Xi)){const e=r(this,Se).createElement("div"),{style:i}=e;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=r(this,Se).createElementNS(os,"svg");s.setAttribute("width",0),s.setAttribute("height",0),m(this,Xi,r(this,Se).createElementNS(os,"defs")),e.append(s),s.append(r(this,Xi)),r(this,Se).body.append(e)}return r(this,Xi)},ah=function(e){if(e.length===1){const c=e[0],d=new Array(256);for(let u=0;u<256;u++)d[u]=c[u]/255;const f=d.join(",");return[f,f,f]}const[i,s,n]=e,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=i[c]/255,o[c]=s[c]/255,l[c]=n[c]/255;return[a.join(","),o.join(","),l.join(",")]},Wr=function(e){if(r(this,qn)===void 0){m(this,qn,"");const i=r(this,Se).URL;i!==r(this,Se).baseURI&&(rc(i)?ht('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,qn,i.split("#",1)[0]))}return`url(${r(this,qn)}#${e})`},dp=function(e){const i=r(this,Se).createElementNS(os,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(i)},$c=function(e){const i=r(this,Se).createElementNS(os,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(i)},Ur=function(e){const i=r(this,Se).createElementNS(os,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",e),r(this,U,Hr).append(i),i},ao=function(e,i,s){const n=r(this,Se).createElementNS(os,i);n.setAttribute("type","discrete"),n.setAttribute("tableValues",s),e.append(n)},oo=function(e,i,s,n){const a=r(this,Se).createElementNS(os,"feComponentTransfer");n.append(a),v(this,U,ao).call(this,a,"feFuncR",e),v(this,U,ao).call(this,a,"feFuncG",i),v(this,U,ao).call(this,a,"feFuncB",s)},Gc=function(e,i){const s=r(this,Se).createElementNS(os,"feComponentTransfer");i.append(s),v(this,U,ao).call(this,s,"feFuncA",e)},lo=function(e){return r(this,U,Hr).style.color=e,Kd(getComputedStyle(r(this,U,Hr)).getPropertyValue("color"))};class up{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Bt("Abstract method `_fetch` called.")}}class fp extends up{async _fetch(t){const e=await nc(t,"arraybuffer");return new Uint8Array(e)}}if(Pe){var qc=Promise.withResolvers(),wo=null;(async()=>{const t=await Gl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),e=await Gl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),i=await Gl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),s=await Gl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);let n,a;return new Map(Object.entries({fs:t,http:e,https:i,url:s,canvas:n,path2d:a}))})().then(t=>{wo=t,qc.resolve()},t=>{ht(`loadPackages: ${t}`),wo=new Map,qc.resolve()})}class yn{static get promise(){return qc.promise}static get(t){return wo==null?void 0:wo.get(t)}}async function pp(h){const e=await yn.get("fs").promises.readFile(h);return new Uint8Array(e)}class fv extends cp{}class pv extends op{_createCanvas(t,e){return yn.get("canvas").createCanvas(t,e)}}class gv extends lp{async _fetch(t){return pp(t)}}class mv extends up{async _fetch(t){return pp(t)}}const Fe={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Xc(h,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),h.clip(s)}class Jd{getPattern(){Bt("Abstract method `getPattern` called.")}}class bv extends Jd{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,s){let n;if(s===Fe.STROKE||s===Fe.FILL){const a=e.current.getClippedPathBoundingBox(s,jt(t))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=e.cachedCanvases.getCanvas("pattern",o,l),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),i=z.transform(i,[1,0,0,1,a[0],a[1]]),d.transform(...e.baseTransform),this.matrix&&d.transform(...this.matrix),Xc(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),n=t.createPattern(c.canvas,"no-repeat");const f=new DOMMatrix(i);n.setTransform(f)}else Xc(t,this._bbox),n=this._createGradient(t);return n}}function pc(h,t,e,i,s,n,a,o){const l=t.coords,c=t.colors,d=h.data,f=h.width*4;let u;l[e+1]>l[i+1]&&(u=e,e=i,i=u,u=n,n=a,a=u),l[i+1]>l[s+1]&&(u=i,i=s,s=u,u=a,a=o,o=u),l[e+1]>l[i+1]&&(u=e,e=i,i=u,u=n,n=a,a=u);const p=(l[e]+t.offsetX)*t.scaleX,g=(l[e+1]+t.offsetY)*t.scaleY,b=(l[i]+t.offsetX)*t.scaleX,w=(l[i+1]+t.offsetY)*t.scaleY,A=(l[s]+t.offsetX)*t.scaleX,T=(l[s+1]+t.offsetY)*t.scaleY;if(g>=T)return;const S=c[n],x=c[n+1],P=c[n+2],R=c[a],M=c[a+1],L=c[a+2],F=c[o],D=c[o+1],H=c[o+2],st=Math.round(g),q=Math.round(T);let $,J,K,W,G,ut,mt,Dt;for(let St=st;St<=q;St++){if(St<w){const ct=St<g?0:(g-St)/(g-w);$=p-(p-b)*ct,J=S-(S-R)*ct,K=x-(x-M)*ct,W=P-(P-L)*ct}else{let ct;St>T?ct=1:w===T?ct=0:ct=(w-St)/(w-T),$=b-(b-A)*ct,J=R-(R-F)*ct,K=M-(M-D)*ct,W=L-(L-H)*ct}let wt;St<g?wt=0:St>T?wt=1:wt=(g-St)/(g-T),G=p-(p-A)*wt,ut=S-(S-F)*wt,mt=x-(x-D)*wt,Dt=P-(P-H)*wt;const Zt=Math.round(Math.min($,G)),j=Math.round(Math.max($,G));let xt=f*St+Zt*4;for(let ct=Zt;ct<=j;ct++)wt=($-ct)/($-G),wt<0?wt=0:wt>1&&(wt=1),d[xt++]=J-(J-ut)*wt|0,d[xt++]=K-(K-mt)*wt|0,d[xt++]=W-(W-Dt)*wt|0,d[xt++]=255}}function vv(h,t,e){const i=t.coords,s=t.colors;let n,a;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(n=0;n<l;n++){let d=n*o;for(let f=0;f<c;f++,d++)pc(h,e,i[d],i[d+1],i[d+o],s[d],s[d+1],s[d+o]),pc(h,e,i[d+o+1],i[d+1],i[d+o],s[d+o+1],s[d+1],s[d+o])}break;case"triangles":for(n=0,a=i.length;n<a;n+=3)pc(h,e,i[n],i[n+1],i[n+2],s[n],s[n+1],s[n+2]);break;default:throw new Error("illegal figure")}}class yv extends Jd{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,d=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),u=Math.min(Math.ceil(Math.abs(d*t[1]*1.1)),3e3),p=c/f,g=d/u,b={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/p,scaleY:1/g},w=f+2*2,A=u+2*2,T=i.getCanvas("mesh",w,A),S=T.context,x=S.createImageData(f,u);if(e){const R=x.data;for(let M=0,L=R.length;M<L;M+=4)R[M]=e[0],R[M+1]=e[1],R[M+2]=e[2],R[M+3]=255}for(const R of this._figures)vv(x,R,b);return S.putImageData(x,2,2),{canvas:T.canvas,offsetX:o-2*p,offsetY:l-2*g,scaleX:p,scaleY:g}}getPattern(t,e,i,s){Xc(t,this._bbox);let n;if(s===Fe.SHADING)n=z.singularValueDecompose2dScale(jt(t));else if(n=z.singularValueDecompose2dScale(e.baseTransform),this.matrix){const o=z.singularValueDecompose2dScale(this.matrix);n=[n[0]*o[0],n[1]*o[1]]}const a=this._createMeshCanvas(n,s===Fe.SHADING?null:this._background,e.cachedCanvases);return s!==Fe.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class wv extends Jd{getPattern(){return"hotpink"}}function Av(h){switch(h[0]){case"RadialAxial":return new bv(h);case"Mesh":return new yv(h);case"Dummy":return new wv}throw new Error(`Unknown IR type: ${h[0]}`)}const tf={COLORED:1,UNCOLORED:2},zh=class zh{constructor(t,e,i,s,n){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=n}createPatternCanvas(t){const{bbox:e,operatorList:i,paintType:s,tilingType:n,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),ec("TilingType: "+n);const d=e[0],f=e[1],u=e[2],p=e[3],g=u-d,b=p-f,w=z.singularValueDecompose2dScale(this.matrix),A=z.singularValueDecompose2dScale(this.baseTransform),T=w[0]*A[0],S=w[1]*A[1];let x=g,P=b,R=!1,M=!1;const L=Math.ceil(l*T),F=Math.ceil(c*S),D=Math.ceil(g*T),H=Math.ceil(b*S);L>=D?x=l:R=!0,F>=H?P=c:M=!0;const st=this.getSizeAndScale(x,this.ctx.canvas.width,T),q=this.getSizeAndScale(P,this.ctx.canvas.height,S),$=t.cachedCanvases.getCanvas("pattern",st.size,q.size),J=$.context,K=o.createCanvasGraphics(J);if(K.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(K,s,a),J.translate(-st.scale*d,-q.scale*f),K.transform(st.scale,0,0,q.scale,0,0),J.save(),this.clipBbox(K,d,f,u,p),K.baseTransform=jt(K.ctx),K.executeOperatorList(i),K.endDrawing(),J.restore(),R||M){const W=$.canvas;R&&(x=l),M&&(P=c);const G=this.getSizeAndScale(x,this.ctx.canvas.width,T),ut=this.getSizeAndScale(P,this.ctx.canvas.height,S),mt=G.size,Dt=ut.size,St=t.cachedCanvases.getCanvas("pattern-workaround",mt,Dt),wt=St.context,Zt=R?Math.floor(g/l):0,j=M?Math.floor(b/c):0;for(let xt=0;xt<=Zt;xt++)for(let ct=0;ct<=j;ct++)wt.drawImage(W,mt*xt,Dt*ct,mt,Dt,0,0,mt,Dt);return{canvas:St.canvas,scaleX:G.scale,scaleY:ut.scale,offsetX:d,offsetY:f}}return{canvas:$.canvas,scaleX:st.scale,scaleY:q.scale,offsetX:d,offsetY:f}}getSizeAndScale(t,e,i){const s=Math.max(zh.MAX_PATTERN_SIZE,e);let n=Math.ceil(t*i);return n>=s?n=s:i=n/t,{scale:i,size:n}}clipBbox(t,e,i,s,n){const a=s-e,o=n-i;t.ctx.rect(e,i,a,o),t.current.updateRectMinMax(jt(t.ctx),[e,i,s,n]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,n=t.current;switch(e){case tf.COLORED:const a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,n.fillColor=a.fillStyle,n.strokeColor=a.strokeStyle;break;case tf.UNCOLORED:const o=z.makeHexColor(i[0],i[1],i[2]);s.fillStyle=o,s.strokeStyle=o,n.fillColor=o,n.strokeColor=o;break;default:throw new Gb(`Unsupported paint type: ${e}`)}}getPattern(t,e,i,s){let n=i;s!==Fe.SHADING&&(n=z.transform(n,e.baseTransform),this.matrix&&(n=z.transform(n,this.matrix)));const a=this.createPatternCanvas(e);let o=new DOMMatrix(n);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=t.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};Z(zh,"MAX_PATTERN_SIZE",3e3);let Yc=zh;function _v({src:h,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:n=4294967295,inverseDecode:a=!1}){const o=De.isLittleEndian?4278190080:255,[l,c]=a?[n,o]:[o,n],d=i>>3,f=i&7,u=h.length;e=new Uint32Array(e.buffer);let p=0;for(let g=0;g<s;g++){for(const w=t+d;t<w;t++){const A=t<u?h[t]:255;e[p++]=A&128?c:l,e[p++]=A&64?c:l,e[p++]=A&32?c:l,e[p++]=A&16?c:l,e[p++]=A&8?c:l,e[p++]=A&4?c:l,e[p++]=A&2?c:l,e[p++]=A&1?c:l}if(f===0)continue;const b=t<u?h[t++]:255;for(let w=0;w<f;w++)e[p++]=b&1<<7-w?c:l}return{srcPos:t,destPos:p}}const ef=16,sf=100,Ev=15,nf=10,rf=1e3,ze=16;function Sv(h,t){if(h._removeMirroring)throw new Error("Context is already forwarding operations.");h.__originalSave=h.save,h.__originalRestore=h.restore,h.__originalRotate=h.rotate,h.__originalScale=h.scale,h.__originalTranslate=h.translate,h.__originalTransform=h.transform,h.__originalSetTransform=h.setTransform,h.__originalResetTransform=h.resetTransform,h.__originalClip=h.clip,h.__originalMoveTo=h.moveTo,h.__originalLineTo=h.lineTo,h.__originalBezierCurveTo=h.bezierCurveTo,h.__originalRect=h.rect,h.__originalClosePath=h.closePath,h.__originalBeginPath=h.beginPath,h._removeMirroring=()=>{h.save=h.__originalSave,h.restore=h.__originalRestore,h.rotate=h.__originalRotate,h.scale=h.__originalScale,h.translate=h.__originalTranslate,h.transform=h.__originalTransform,h.setTransform=h.__originalSetTransform,h.resetTransform=h.__originalResetTransform,h.clip=h.__originalClip,h.moveTo=h.__originalMoveTo,h.lineTo=h.__originalLineTo,h.bezierCurveTo=h.__originalBezierCurveTo,h.rect=h.__originalRect,h.closePath=h.__originalClosePath,h.beginPath=h.__originalBeginPath,delete h._removeMirroring},h.save=function(){t.save(),this.__originalSave()},h.restore=function(){t.restore(),this.__originalRestore()},h.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},h.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},h.transform=function(i,s,n,a,o,l){t.transform(i,s,n,a,o,l),this.__originalTransform(i,s,n,a,o,l)},h.setTransform=function(i,s,n,a,o,l){t.setTransform(i,s,n,a,o,l),this.__originalSetTransform(i,s,n,a,o,l)},h.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},h.rotate=function(i){t.rotate(i),this.__originalRotate(i)},h.clip=function(i){t.clip(i),this.__originalClip(i)},h.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},h.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},h.bezierCurveTo=function(e,i,s,n,a,o){t.bezierCurveTo(e,i,s,n,a,o),this.__originalBezierCurveTo(e,i,s,n,a,o)},h.rect=function(e,i,s,n){t.rect(e,i,s,n),this.__originalRect(e,i,s,n)},h.closePath=function(){t.closePath(),this.__originalClosePath()},h.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class xv{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function ql(h,t,e,i,s,n,a,o,l,c){const[d,f,u,p,g,b]=jt(h);if(f===0&&u===0){const T=a*d+g,S=Math.round(T),x=o*p+b,P=Math.round(x),R=(a+l)*d+g,M=Math.abs(Math.round(R)-S)||1,L=(o+c)*p+b,F=Math.abs(Math.round(L)-P)||1;return h.setTransform(Math.sign(d),0,0,Math.sign(p),S,P),h.drawImage(t,e,i,s,n,0,0,M,F),h.setTransform(d,f,u,p,g,b),[M,F]}if(d===0&&p===0){const T=o*u+g,S=Math.round(T),x=a*f+b,P=Math.round(x),R=(o+c)*u+g,M=Math.abs(Math.round(R)-S)||1,L=(a+l)*f+b,F=Math.abs(Math.round(L)-P)||1;return h.setTransform(0,Math.sign(f),Math.sign(u),0,S,P),h.drawImage(t,e,i,s,n,0,0,F,M),h.setTransform(d,f,u,p,g,b),[F,M]}h.drawImage(t,e,i,s,n,a,o,l,c);const w=Math.hypot(d,f),A=Math.hypot(u,p);return[w*l,A*c]}function Tv(h){const{width:t,height:e}=h;if(t>rf||e>rf)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=t+1;let a=new Uint8Array(n*(e+1)),o,l,c;const d=t+7&-8;let f=new Uint8Array(d*e),u=0;for(const A of h.data){let T=128;for(;T>0;)f[u++]=A&T?0:255,T>>=1}let p=0;for(u=0,f[u]!==0&&(a[0]=1,++p),l=1;l<t;l++)f[u]!==f[u+1]&&(a[l]=f[u]?2:1,++p),u++;for(f[u]!==0&&(a[l]=2,++p),o=1;o<e;o++){u=o*d,c=o*n,f[u-d]!==f[u]&&(a[c]=f[u]?1:8,++p);let A=(f[u]?4:0)+(f[u-d]?8:0);for(l=1;l<t;l++)A=(A>>2)+(f[u+1]?4:0)+(f[u-d+1]?8:0),s[A]&&(a[c+l]=s[A],++p),u++;if(f[u-d]!==f[u]&&(a[c+l]=f[u]?2:4,++p),p>i)return null}for(u=d*(e-1),c=o*n,f[u]!==0&&(a[c]=8,++p),l=1;l<t;l++)f[u]!==f[u+1]&&(a[c+l]=f[u]?4:8,++p),u++;if(f[u]!==0&&(a[c+l]=4,++p),p>i)return null;const g=new Int32Array([0,n,-1,0,-n,0,0,0,1]),b=new Path2D;for(o=0;p&&o<=e;o++){let A=o*n;const T=A+t;for(;A<T&&!a[A];)A++;if(A===T)continue;b.moveTo(A%n,o);const S=A;let x=a[A];do{const P=g[x];do A+=P;while(!a[A]);const R=a[A];R!==5&&R!==10?(x=R,a[A]=0):(x=R&51*x>>4,a[A]&=x>>2|x<<2),b.lineTo(A%n,A/n|0),a[A]||--p}while(S!==A);--o}return f=null,a=null,function(A){A.save(),A.scale(1/t,-1/e),A.translate(0,-e),A.fill(b),A.beginPath(),A.restore()}}class af{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Mf,this.textMatrixScale=1,this.fontMatrix=Ac,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ae.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,i){[e,i]=z.applyTransform([e,i],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,e){const i=z.applyTransform(e,t),s=z.applyTransform(e.slice(2),t),n=z.applyTransform([e[0],e[3]],t),a=z.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],s[0],n[0],a[0]),this.minY=Math.min(this.minY,i[1],s[1],n[1],a[1]),this.maxX=Math.max(this.maxX,i[0],s[0],n[0],a[0]),this.maxY=Math.max(this.maxY,i[1],s[1],n[1],a[1])}updateScalingPathMinMax(t,e){z.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,i,s,n,a,o,l,c,d){const f=z.bezierBoundingBox(e,i,s,n,a,o,l,c,d);d||this.updateRectMinMax(t,f)}getPathBoundingBox(t=Fe.FILL,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===Fe.STROKE){e||Bt("Stroke bounding box must include transform.");const s=z.singularValueDecompose2dScale(e),n=s[0]*this.lineWidth/2,a=s[1]*this.lineWidth/2;i[0]-=n,i[1]-=a,i[2]+=n,i[3]+=a}return i}updateClipFromPath(){const t=z.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Fe.FILL,e=null){return z.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function of(h,t){if(typeof ImageData<"u"&&t instanceof ImageData){h.putImageData(t,0,0);return}const e=t.height,i=t.width,s=e%ze,n=(e-s)/ze,a=s===0?n:n+1,o=h.createImageData(i,ze);let l=0,c;const d=t.data,f=o.data;let u,p,g,b;if(t.kind===Zl.GRAYSCALE_1BPP){const w=d.byteLength,A=new Uint32Array(f.buffer,0,f.byteLength>>2),T=A.length,S=i+7>>3,x=4294967295,P=De.isLittleEndian?4278190080:255;for(u=0;u<a;u++){for(g=u<n?ze:s,c=0,p=0;p<g;p++){const R=w-l;let M=0;const L=R>S?i:R*8-7,F=L&-8;let D=0,H=0;for(;M<F;M+=8)H=d[l++],A[c++]=H&128?x:P,A[c++]=H&64?x:P,A[c++]=H&32?x:P,A[c++]=H&16?x:P,A[c++]=H&8?x:P,A[c++]=H&4?x:P,A[c++]=H&2?x:P,A[c++]=H&1?x:P;for(;M<L;M++)D===0&&(H=d[l++],D=128),A[c++]=H&D?x:P,D>>=1}for(;c<T;)A[c++]=0;h.putImageData(o,0,u*ze)}}else if(t.kind===Zl.RGBA_32BPP){for(p=0,b=i*ze*4,u=0;u<n;u++)f.set(d.subarray(l,l+b)),l+=b,h.putImageData(o,0,p),p+=ze;u<a&&(b=i*s*4,f.set(d.subarray(l,l+b)),h.putImageData(o,0,p))}else if(t.kind===Zl.RGB_24BPP)for(g=ze,b=i*g,u=0;u<a;u++){for(u>=n&&(g=s,b=i*g),c=0,p=b;p--;)f[c++]=d[l++],f[c++]=d[l++],f[c++]=d[l++],f[c++]=255;h.putImageData(o,0,u*ze)}else throw new Error(`bad image kind: ${t.kind}`)}function lf(h,t){if(t.bitmap){h.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,s=e%ze,n=(e-s)/ze,a=s===0?n:n+1,o=h.createImageData(i,ze);let l=0;const c=t.data,d=o.data;for(let f=0;f<a;f++){const u=f<n?ze:s;({srcPos:l}=_v({src:c,srcPos:l,dest:d,width:i,height:u,nonBlackColor:0})),h.putImageData(o,0,f*ze)}}function Ja(h,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)h[i]!==void 0&&(t[i]=h[i]);h.setLineDash!==void 0&&(t.setLineDash(h.getLineDash()),t.lineDashOffset=h.lineDashOffset)}function Xl(h){if(h.strokeStyle=h.fillStyle="#000000",h.fillRule="nonzero",h.globalAlpha=1,h.lineWidth=1,h.lineCap="butt",h.lineJoin="miter",h.miterLimit=10,h.globalCompositeOperation="source-over",h.font="10px sans-serif",h.setLineDash!==void 0&&(h.setLineDash([]),h.lineDashOffset=0),!Pe){const{filter:t}=h;t!=="none"&&t!==""&&(h.filter="none")}}function hf(h,t){if(t)return!0;const e=z.singularValueDecompose2dScale(h);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*vn.PDF_TO_CSS_UNITS);return e[0]<=i&&e[1]<=i}const Cv=["butt","round","square"],Pv=["miter","round","bevel"],Rv={},cf={};var An,Kc,Qc;const au=class au{constructor(t,e,i,s,n,{optionalContentConfig:a,markedContentStack:o=null},l,c){y(this,An);this.ctx=t,this.current=new af(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new xv(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const n=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,n,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",n,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...jt(this.compositeCtx))}this.ctx.save(),Xl(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=jt(this.ctx)}executeOperatorList(t,e,i,s){const n=t.argsArray,a=t.fnArray;let o=e||0;const l=n.length;if(l===o)return o;const c=l-o>nf&&typeof i=="function",d=c?Date.now()+Ev:0;let f=0;const u=this.commonObjs,p=this.objs;let g;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(g=a[o],g!==Ai.dependency)this[g].apply(this,n[o]);else for(const b of n[o]){const w=b.startsWith("g_")?u:p;if(!w.has(b))return w.get(b,i),o}if(o++,o===l)return o;if(c&&++f>nf){if(Date.now()>d)return i(),o;f=0}}}endDrawing(){v(this,An,Kc).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),v(this,An,Qc).call(this)}_scaleImage(t,e){const i=t.width??t.displayWidth,s=t.height??t.displayHeight;let n=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),o=i,l=s,c="prescale1",d,f;for(;n>2&&o>1||a>2&&l>1;){let u=o,p=l;n>2&&o>1&&(u=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),n/=o/u),a>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/p),d=this.cachedCanvases.getCanvas(c,u,p),f=d.context,f.clearRect(0,0,u,p),f.drawImage(t,0,0,o,l,0,0,u,p),t=d.canvas,o=u,l=p,c=c==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:l}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:s}=t,n=this.current.fillColor,a=this.current.patternFill,o=jt(e);let l,c,d,f;if((t.bitmap||t.data)&&t.count>1){const L=t.bitmap||t.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),n]),l=this._cachedBitmapsMap.get(L),l||(l=new Map,this._cachedBitmapsMap.set(L,l));const F=l.get(c);if(F&&!a){const D=Math.round(Math.min(o[0],o[2])+o[4]),H=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:F,offsetX:D,offsetY:H}}d=F}d||(f=this.cachedCanvases.getCanvas("maskCanvas",i,s),lf(f.context,t));let u=z.transform(o,[1/i,0,0,-1/s,0,0]);u=z.transform(u,[1,0,0,1,0,-s]);const[p,g,b,w]=z.getAxialAlignedBoundingBox([0,0,i,s],u),A=Math.round(b-p)||1,T=Math.round(w-g)||1,S=this.cachedCanvases.getCanvas("fillCanvas",A,T),x=S.context,P=p,R=g;x.translate(-P,-R),x.transform(...u),d||(d=this._scaleImage(f.canvas,as(x)),d=d.img,l&&a&&l.set(c,d)),x.imageSmoothingEnabled=hf(jt(x),t.interpolate),ql(x,d,0,0,d.width,d.height,0,0,i,s),x.globalCompositeOperation="source-in";const M=z.transform(as(x),[1,0,0,1,-P,-R]);return x.fillStyle=a?n.getPattern(e,this,M,Fe.FILL):n,x.fillRect(0,0,i,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,S.canvas)),{canvas:S.canvas,offsetX:Math.round(P),offsetY:Math.round(R)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Cv[t]}setLineJoin(t){this.ctx.lineJoin=Pv[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx,this.ctx=s.context;const n=this.ctx;n.setTransform(...jt(this.suspendedCtx)),Ja(this.suspendedCtx,n),Sv(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ja(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,s){const n=s[0],a=s[1],o=s[2]-n,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(e.context,i,o,l,e.subtype,e.backdrop,e.transferMap,n,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,n,a,o,l,c,d,f){let u=t.canvas,p=l-d,g=c-f;if(a){const w=z.makeHexColor(...a);if(p<0||g<0||p+i>u.width||g+s>u.height){const A=this.cachedCanvases.getCanvas("maskExtension",i,s),T=A.context;T.drawImage(u,-p,-g),T.globalCompositeOperation="destination-atop",T.fillStyle=w,T.fillRect(0,0,i,s),T.globalCompositeOperation="source-over",u=A.canvas,p=g=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(p,g,i,s),t.clip(A),t.globalCompositeOperation="destination-atop",t.fillStyle=w,t.fillRect(p,g,i,s),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),n==="Alpha"&&o?e.filter=this.filterFactory.addAlphaFilter(o):n==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(o));const b=new Path2D;b.rect(l,c,i,s),e.clip(b),e.globalCompositeOperation="destination-in",e.drawImage(u,p,g,i,s,l,c,i,s),e.restore()}save(){this.inSMaskMode?(Ja(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Ja(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,i,s,n,a){this.ctx.transform(t,e,i,s,n,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){const s=this.ctx,n=this.current;let a=n.x,o=n.y,l,c;const d=jt(s),f=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,u=f?i.slice(0):null;for(let p=0,g=0,b=t.length;p<b;p++)switch(t[p]|0){case Ai.rectangle:a=e[g++],o=e[g++];const w=e[g++],A=e[g++],T=a+w,S=o+A;s.moveTo(a,o),w===0||A===0?s.lineTo(T,S):(s.lineTo(T,o),s.lineTo(T,S),s.lineTo(a,S)),f||n.updateRectMinMax(d,[a,o,T,S]),s.closePath();break;case Ai.moveTo:a=e[g++],o=e[g++],s.moveTo(a,o),f||n.updatePathMinMax(d,a,o);break;case Ai.lineTo:a=e[g++],o=e[g++],s.lineTo(a,o),f||n.updatePathMinMax(d,a,o);break;case Ai.curveTo:l=a,c=o,a=e[g+4],o=e[g+5],s.bezierCurveTo(e[g],e[g+1],e[g+2],e[g+3],a,o),n.updateCurvePathMinMax(d,l,c,e[g],e[g+1],e[g+2],e[g+3],a,o,u),g+=6;break;case Ai.curveTo2:l=a,c=o,s.bezierCurveTo(a,o,e[g],e[g+1],e[g+2],e[g+3]),n.updateCurvePathMinMax(d,l,c,a,o,e[g],e[g+1],e[g+2],e[g+3],u),a=e[g+2],o=e[g+3],g+=4;break;case Ai.curveTo3:l=a,c=o,a=e[g+2],o=e[g+3],s.bezierCurveTo(e[g],e[g+1],a,o,a,o),n.updateCurvePathMinMax(d,l,c,e[g],e[g+1],a,o,a,o,u),g+=4;break;case Ai.closePath:s.closePath();break}f&&n.updateScalingPathMinMax(d,u),n.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(e.save(),e.strokeStyle=i.getPattern(e,this,as(e),Fe.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let n=!1;s&&(e.save(),e.fillStyle=i.getPattern(e,this,as(e),Fe.FILL),n=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),n&&e.restore(),t&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Rv}eoClip(){this.pendingClip=cf}beginText(){this.current.textMatrix=Mf,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}e.save(),e.beginPath();for(const i of t)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var d;const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||Ac,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&ht("Invalid font matrix for font "+t),e<0?(e=-e,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const n=i.loadedName||"sans-serif",a=((d=i.systemFontInfo)==null?void 0:d.css)||`"${n}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=e;e<ef?c=ef:e>sf&&(c=sf),this.current.fontSizeScale=e/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,s,n,a){this.current.textMatrix=[t,e,i,s,n,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,s){const n=this.ctx,a=this.current,o=a.font,l=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,d=l&Ae.FILL_STROKE_MASK,f=!!(l&Ae.ADD_TO_PATH_FLAG),u=a.patternFill&&!o.missingFile;let p;(o.disableFontFace||f||u)&&(p=o.getPathGenerator(this.commonObjs,t)),o.disableFontFace||u?(n.save(),n.translate(e,i),n.beginPath(),p(n,c),s&&n.setTransform(...s),(d===Ae.FILL||d===Ae.FILL_STROKE)&&n.fill(),(d===Ae.STROKE||d===Ae.FILL_STROKE)&&n.stroke(),n.restore()):((d===Ae.FILL||d===Ae.FILL_STROKE)&&n.fillText(t,e,i),(d===Ae.STROKE||d===Ae.FILL_STROKE)&&n.strokeText(t,e,i)),f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:jt(n),x:e,y:i,fontSize:c,addToPath:p})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return gt(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const s=e.fontSize;if(s===0)return;const n=this.ctx,a=e.fontSizeScale,o=e.charSpacing,l=e.wordSpacing,c=e.fontDirection,d=e.textHScale*c,f=t.length,u=i.vertical,p=u?1:-1,g=i.defaultVMetrics,b=s*e.fontMatrix[0],w=e.textRenderingMode===Ae.FILL&&!i.disableFontFace&&!e.patternFill;n.save(),n.transform(...e.textMatrix),n.translate(e.x,e.y+e.textRise),c>0?n.scale(d,-1):n.scale(d,1);let A;if(e.patternFill){n.save();const R=e.fillColor.getPattern(n,this,as(n),Fe.FILL);A=jt(n),n.restore(),n.fillStyle=R}let T=e.lineWidth;const S=e.textMatrixScale;if(S===0||T===0){const R=e.textRenderingMode&Ae.FILL_STROKE_MASK;(R===Ae.STROKE||R===Ae.FILL_STROKE)&&(T=this.getSinglePixelWidth())}else T/=S;if(a!==1&&(n.scale(a,a),T/=a),n.lineWidth=T,i.isInvalidPDFjsFont){const R=[];let M=0;for(const L of t)R.push(L.unicode),M+=L.width;n.fillText(R.join(""),0,0),e.x+=M*b*d,n.restore(),this.compose();return}let x=0,P;for(P=0;P<f;++P){const R=t[P];if(typeof R=="number"){x+=p*R*s/1e3;continue}let M=!1;const L=(R.isSpace?l:0)+o,F=R.fontChar,D=R.accent;let H,st,q=R.width;if(u){const J=R.vmetric||g,K=-(R.vmetric?J[1]:q*.5)*b,W=J[2]*b;q=J?-J[0]:q,H=K/a,st=(x+W)/a}else H=x/a,st=0;if(i.remeasure&&q>0){const J=n.measureText(F).width*1e3/s*a;if(q<J&&this.isFontSubpixelAAEnabled){const K=q/J;M=!0,n.save(),n.scale(K,1),H/=K}else q!==J&&(H+=(q-J)/2e3*s/a)}if(this.contentVisible&&(R.isInFont||i.missingFile)){if(w&&!D)n.fillText(F,H,st);else if(this.paintChar(F,H,st,A),D){const J=H+s*D.offset.x/a,K=st-s*D.offset.y/a;this.paintChar(D.fontChar,J,K,A)}}const $=u?q*b-L*c:q*b+L*c;x+=$,M&&n.restore()}u?e.y-=x:e.x+=x*d,n.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,s=i.font,n=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,d=i.textHScale*a,f=i.fontMatrix||Ac,u=t.length,p=i.textRenderingMode===Ae.INVISIBLE;let g,b,w,A;if(!(p||n===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(d,a),g=0;g<u;++g){if(b=t[g],typeof b=="number"){A=o*b*n/1e3,this.ctx.translate(A,0),i.x+=A*d;continue}const T=(b.isSpace?c:0)+l,S=s.charProcOperatorList[b.operatorListId];if(!S){ht(`Type3 character "${b.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=b,this.save(),e.scale(n,n),e.transform(...f),this.executeOperatorList(S),this.restore()),w=z.applyTransform([b.width,0],f)[0]*n+T,e.translate(w,0),i.x+=w*d}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,s,n,a){this.ctx.rect(i,s,n-i,a-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const i=t[1],s=this.baseTransform||jt(this.ctx),n={createCanvasGraphics:a=>new au(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Yc(t,i,this.ctx,n,s)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){this.ctx.strokeStyle=this.current.strokeColor=z.makeHexColor(t,e,i)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(t,e,i){this.ctx.fillStyle=this.current.fillColor=z.makeHexColor(t,e,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=Av(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,as(e),Fe.SHADING);const s=as(e);{const{width:n,height:a}=e.canvas,[o,l,c,d]=z.getAxialAlignedBoundingBox([0,0,n,a],s);this.ctx.fillRect(o,l,c-o,d-l)}this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Bt("Should not call beginInlineImage")}beginImageData(){Bt("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=jt(this.ctx),e)){const i=e[2]-e[0],s=e[3]-e[1];this.ctx.rect(e[0],e[1],i,s),this.current.updateRectMinMax(jt(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||ec("TODO: Support non-isolated groups."),t.knockout&&ht("Knockout groups not supported.");const i=jt(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=z.getAxialAlignedBoundingBox(t.bbox,jt(e));const n=[0,0,e.canvas.width,e.canvas.height];s=z.intersect(s,n)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),c=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(d,l,c),u=f.context;u.translate(-a,-o),u.transform(...i),t.smask?this.smaskStack.push({canvas:f.canvas,context:u,offsetX:a,offsetY:o,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,o),e.save()),Ja(e,u),this.ctx=u,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=jt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const n=z.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],s);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,e,i,s,n){if(v(this,An,Kc).call(this),Xl(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],o=e[3]-e[1];if(n&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=o;const[l,c]=z.singularValueDecompose2dScale(jt(this.ctx)),{viewportScale:d}=this,f=Math.ceil(a*this.outputScaleX*d),u=Math.ceil(o*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(f,u);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),Xl(this.ctx)}else Xl(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new af(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),v(this,An,Qc).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=Tv(t)),s.compiled)){s.compiled(i);return}const n=this._createMaskCanvas(t),a=n.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,n.offsetX,n.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,s=0,n,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const o=this.ctx;o.save();const l=jt(o);o.transform(e,i,s,n,0,0);const c=this._createMaskCanvas(t);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let d=0,f=a.length;d<f;d+=2){const u=z.transform(l,[e,i,s,n,a[d],a[d+1]]),[p,g]=z.applyTransform([0,0],u);o.drawImage(c.canvas,p,g)}o.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const n of t){const{data:a,width:o,height:l,transform:c}=n,d=this.cachedCanvases.getCanvas("maskCanvas",o,l),f=d.context;f.save();const u=this.getObject(a,n);lf(f,u),f.globalCompositeOperation="source-in",f.fillStyle=s?i.getPattern(f,this,as(e),Fe.FILL):i,f.fillRect(0,0,o,l),f.restore(),e.save(),e.transform(...c),e.scale(1,-1),ql(e,d.canvas,0,0,o,l,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){ht("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,i,s){if(!this.contentVisible)return;const n=this.getObject(t);if(!n){ht("Dependent image isn't ready yet");return}const a=n.width,o=n.height,l=[];for(let c=0,d=s.length;c<d;c+=2)l.push({transform:[e,0,0,i,s[c],s[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(n,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:s}=t,n=this.cachedCanvases.getCanvas("inlineImage",i,s),a=n.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",n.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,s=this.ctx;if(this.save(),!Pe){const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none")}s.scale(1/e,-1/i);let n;if(t.bitmap)n=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)n=t;else{const l=this.cachedCanvases.getCanvas("inlineImage",e,i).context;of(l,t),n=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(n,as(s));s.imageSmoothingEnabled=hf(jt(s),t.interpolate),ql(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const n=t.width,a=t.height,l=this.cachedCanvases.getCanvas("inlineImage",n,a).context;of(l,t),s=this.applyTransferMapsToCanvas(l)}for(const n of e)i.save(),i.transform(...n.transform),i.scale(1,-1),ql(i,s,n.x,n.y,n.w,n.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===cf?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=jt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:n}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const l=Math.abs(e),c=Math.abs(n);if(l===c)if(t===0)a=o=1/l;else{const d=l*t;a=o=d<1?1/d:1}else if(t===0)a=1/l,o=1/c;else{const d=l*t,f=c*t;a=d<1?1/d:1,o=f<1?1/f:1}}else{const l=Math.abs(e*n-i*s),c=Math.hypot(e,i),d=Math.hypot(s,n);if(t===0)a=d/l,o=c/l;else{const f=t*l;a=d>f?d/f:1,o=c>f?c/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:i}=this.current,[s,n]=this.getScaleForStroking();if(e.lineWidth=i||1,s===1&&n===1){e.stroke();return}const a=e.getLineDash();if(t&&e.save(),e.scale(s,n),a.length>0){const o=Math.max(s,n);e.setLineDash(a.map(l=>l/o)),e.lineDashOffset/=o}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};An=new WeakSet,Kc=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Qc=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}};let qr=au;for(const h in Ai)qr.prototype[h]!==void 0&&(qr.prototype[Ai[h]]=qr.prototype[h]);var zo,$o;class Fs{static get workerPort(){return r(this,zo)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");m(this,zo,t)}static get workerSrc(){return r(this,$o)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");m(this,$o,t)}}zo=new WeakMap,$o=new WeakMap,y(Fs,zo,null),y(Fs,$o,"");const Yl={UNKNOWN:0,DATA:1,ERROR:2},Kt={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Xe(h){switch(h instanceof Error||typeof h=="object"&&h!==null||Bt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),h.name){case"AbortException":return new Fr(h.message);case"MissingPDFException":return new Ir(h.message);case"PasswordException":return new _c(h.message,h.code);case"UnexpectedResponseException":return new ic(h.message,h.status);case"UnknownErrorException":return new Ec(h.message,h.details);default:return new Ec(h.message,h.toString())}}var da,bi,gp,mp,bp,oh;class ho{constructor(t,e,i){y(this,bi);y(this,da,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",v(this,bi,gp).bind(this),{signal:r(this,da).signal})}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,n=Promise.withResolvers();this.callbackCapabilities[s]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(a){n.reject(a)}return n.promise}sendWithStream(t,e,i,s){const n=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const d=Promise.withResolvers();return this.streamControllers[n]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:t,streamId:n,data:e,desiredSize:c.desiredSize},s),d.promise},pull:c=>{const d=Promise.withResolvers();return this.streamControllers[n].pullCall=d,l.postMessage({sourceName:a,targetName:o,stream:Kt.PULL,streamId:n,desiredSize:c.desiredSize}),d.promise},cancel:c=>{ne(c instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[n].cancelCall=d,this.streamControllers[n].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Kt.CANCEL,streamId:n,reason:Xe(c)}),d.promise}},i)}destroy(){var t;(t=r(this,da))==null||t.abort(),m(this,da,null)}}da=new WeakMap,bi=new WeakSet,gp=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){v(this,bi,bp).call(this,t);return}if(t.callback){const i=t.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===Yl.DATA)s.resolve(t.data);else if(t.callback===Yl.ERROR)s.reject(Xe(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,s=t.sourceName,n=this.comObj;new Promise(function(a){a(e(t.data))}).then(function(a){n.postMessage({sourceName:i,targetName:s,callback:Yl.DATA,callbackId:t.callbackId,data:a})},function(a){n.postMessage({sourceName:i,targetName:s,callback:Yl.ERROR,callbackId:t.callbackId,reason:Xe(a)})});return}if(t.streamId){v(this,bi,mp).call(this,t);return}e(t.data)},mp=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,n=this.comObj,a=this,o=this.actionHandler[t.action],l={enqueue(c,d=1,f){if(this.isCancelled)return;const u=this.desiredSize;this.desiredSize-=d,u>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),n.postMessage({sourceName:i,targetName:s,stream:Kt.ENQUEUE,streamId:e,chunk:c},f)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:Kt.CLOSE,streamId:e}),delete a.streamSinks[e])},error(c){ne(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:Kt.ERROR,streamId:e,reason:Xe(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[e]=l,new Promise(function(c){c(o(t.data,l))}).then(function(){n.postMessage({sourceName:i,targetName:s,stream:Kt.START_COMPLETE,streamId:e,success:!0})},function(c){n.postMessage({sourceName:i,targetName:s,stream:Kt.START_COMPLETE,streamId:e,reason:Xe(c)})})},bp=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,n=this.comObj,a=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case Kt.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(Xe(t.reason));break;case Kt.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(Xe(t.reason));break;case Kt.PULL:if(!o){n.postMessage({sourceName:i,targetName:s,stream:Kt.PULL_COMPLETE,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,new Promise(function(l){var c;l((c=o.onPull)==null?void 0:c.call(o))}).then(function(){n.postMessage({sourceName:i,targetName:s,stream:Kt.PULL_COMPLETE,streamId:e,success:!0})},function(l){n.postMessage({sourceName:i,targetName:s,stream:Kt.PULL_COMPLETE,streamId:e,reason:Xe(l)})});break;case Kt.ENQUEUE:if(ne(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case Kt.CLOSE:if(ne(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),v(this,bi,oh).call(this,a,e);break;case Kt.ERROR:ne(a,"error should have stream controller"),a.controller.error(Xe(t.reason)),v(this,bi,oh).call(this,a,e);break;case Kt.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(Xe(t.reason)),v(this,bi,oh).call(this,a,e);break;case Kt.CANCEL:if(!o)break;new Promise(function(l){var c;l((c=o.onCancel)==null?void 0:c.call(o,Xe(t.reason)))}).then(function(){n.postMessage({sourceName:i,targetName:s,stream:Kt.CANCEL_COMPLETE,streamId:e,success:!0})},function(l){n.postMessage({sourceName:i,targetName:s,stream:Kt.CANCEL_COMPLETE,streamId:e,reason:Xe(l)})}),o.sinkCapability.reject(Xe(t.reason)),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},oh=async function(t,e){var i,s,n;await Promise.allSettled([(i=t.startCall)==null?void 0:i.promise,(s=t.pullCall)==null?void 0:s.promise,(n=t.cancelCall)==null?void 0:n.promise]),delete this.streamControllers[e]};var Kn,Go;class kv{constructor({parsedData:t,rawData:e}){y(this,Kn);y(this,Go);m(this,Kn,t),m(this,Go,e)}getRaw(){return r(this,Go)}get(t){return r(this,Kn).get(t)??null}getAll(){return $d(r(this,Kn))}has(t){return r(this,Kn).has(t)}}Kn=new WeakMap,Go=new WeakMap;const Vr=Symbol("INTERNAL");var qo,Xo,Yo,ua;class Mv{constructor(t,{name:e,intent:i,usage:s,rbGroups:n}){y(this,qo,!1);y(this,Xo,!1);y(this,Yo,!1);y(this,ua,!0);m(this,qo,!!(t&si.DISPLAY)),m(this,Xo,!!(t&si.PRINT)),this.name=e,this.intent=i,this.usage=s,this.rbGroups=n}get visible(){if(r(this,Yo))return r(this,ua);if(!r(this,ua))return!1;const{print:t,view:e}=this.usage;return r(this,qo)?(e==null?void 0:e.viewState)!=="OFF":r(this,Xo)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,i=!1){t!==Vr&&Bt("Internal method `_setVisible` called."),m(this,Yo,i),m(this,ua,e)}}qo=new WeakMap,Xo=new WeakMap,Yo=new WeakMap,ua=new WeakMap;var en,Pt,fa,pa,Ko,Jc;class Lv{constructor(t,e=si.DISPLAY){y(this,Ko);y(this,en,null);y(this,Pt,new Map);y(this,fa,null);y(this,pa,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,m(this,pa,t.order);for(const i of t.groups)r(this,Pt).set(i.id,new Mv(e,i));if(t.baseState==="OFF")for(const i of r(this,Pt).values())i._setVisible(Vr,!1);for(const i of t.on)r(this,Pt).get(i)._setVisible(Vr,!0);for(const i of t.off)r(this,Pt).get(i)._setVisible(Vr,!1);m(this,fa,this.getHash())}}isVisible(t){if(r(this,Pt).size===0)return!0;if(!t)return ec("Optional content group not defined."),!0;if(t.type==="OCG")return r(this,Pt).has(t.id)?r(this,Pt).get(t.id).visible:(ht(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return v(this,Ko,Jc).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!r(this,Pt).has(e))return ht(`Optional content group not found: ${e}`),!0;if(r(this,Pt).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!r(this,Pt).has(e))return ht(`Optional content group not found: ${e}`),!0;if(!r(this,Pt).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!r(this,Pt).has(e))return ht(`Optional content group not found: ${e}`),!0;if(!r(this,Pt).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!r(this,Pt).has(e))return ht(`Optional content group not found: ${e}`),!0;if(r(this,Pt).get(e).visible)return!1}return!0}return ht(`Unknown optional content policy ${t.policy}.`),!0}return ht(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){var n;const s=r(this,Pt).get(t);if(!s){ht(`Optional content group not found: ${t}`);return}if(i&&e&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==t&&((n=r(this,Pt).get(o))==null||n._setVisible(Vr,!1,!0));s._setVisible(Vr,!!e,!0),m(this,en,null)}setOCGState({state:t,preserveRB:e}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const n=r(this,Pt).get(s);if(n)switch(i){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!n.visible,e);break}}m(this,en,null)}get hasInitialVisibility(){return r(this,fa)===null||this.getHash()===r(this,fa)}getOrder(){return r(this,Pt).size?r(this,pa)?r(this,pa).slice():[...r(this,Pt).keys()]:null}getGroups(){return r(this,Pt).size>0?$d(r(this,Pt)):null}getGroup(t){return r(this,Pt).get(t)||null}getHash(){if(r(this,en)!==null)return r(this,en);const t=new np;for(const[e,i]of r(this,Pt))t.update(`${e}:${i.visible}`);return m(this,en,t.hexdigest())}}en=new WeakMap,Pt=new WeakMap,fa=new WeakMap,pa=new WeakMap,Ko=new WeakSet,Jc=function(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let s=1;s<e;s++){const n=t[s];let a;if(Array.isArray(n))a=v(this,Ko,Jc).call(this,n);else if(r(this,Pt).has(n))a=r(this,Pt).get(n).visible;else return ht(`Optional content group not found: ${n}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class Iv{constructor(t,{disableRange:e=!1,disableStream:i=!1}){ne(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:n,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(n==null?void 0:n.length)>0){const l=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),t.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),t.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(n){return n._begin!==t?!1:(n._enqueue(i),!0)});ne(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,i,s,n;t.total===void 0?(i=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||i.call(e,{loaded:t.loaded}):(n=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||n.call(s,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){ne(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Fv(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Dv(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class Fv{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=Xd(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Dv{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Ov(h){let t=!0,e=i("filename\\*","i").exec(h);if(e){e=e[1];let d=o(e);return d=unescape(d),d=l(d),d=c(d),n(d)}if(e=a(h),e){const d=c(e);return n(d)}if(e=i("filename","i").exec(h),e){e=e[1];let d=o(e);return d=c(d),n(d)}function i(d,f){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(d,f){if(d){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const u=new TextDecoder(d,{fatal:!0}),p=sc(f);f=u.decode(p),t=!1}catch{}}return f}function n(d){return t&&/[\x80-\xff]/.test(d)&&(d=s("utf-8",d),t&&(d=s("iso-8859-1",d))),d}function a(d){const f=[];let u;const p=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=p.exec(d))!==null;){let[,b,w,A]=u;if(b=parseInt(b,10),b in f){if(b===0)break;continue}f[b]=[w,A]}const g=[];for(let b=0;b<f.length&&b in f;++b){let[w,A]=f[b];A=o(A),w&&(A=unescape(A),b===0&&(A=l(A))),g.push(A)}return g.join("")}function o(d){if(d.startsWith('"')){const f=d.slice(1).split('\\"');for(let u=0;u<f.length;++u){const p=f[u].indexOf('"');p!==-1&&(f[u]=f[u].slice(0,p),f.length=u+1),f[u]=f[u].replaceAll(/\\(.)/g,"$1")}d=f.join('"')}return d}function l(d){const f=d.indexOf("'");if(f===-1)return d;const u=d.slice(0,f),g=d.slice(f+1).replace(/^[^']*'/,"");return s(u,g)}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,u,p,g){if(p==="q"||p==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,w){return String.fromCharCode(parseInt(w,16))}),s(u,g);try{g=atob(g)}catch{}return s(u,g)})}return""}function Zd(h,t){const e=new Headers;if(!h||!t||typeof t!="object")return e;for(const i in t){const s=t[i];s!==void 0&&e.append(i,s)}return e}function tu({responseHeaders:h,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},n=parseInt(h.get("Content-Length"),10);return!Number.isInteger(n)||(s.suggestedLength=n,n<=2*e)||i||!t||h.get("Accept-Ranges")!=="bytes"||(h.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function eu(h){const t=h.get("Content-Disposition");if(t){let e=Ov(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Xd(e))return e}return null}function ac(h,t){return h===404||h===0&&t.startsWith("file:")?new Ir('Missing PDF "'+t+'".'):new ic(`Unexpected server response (${h}) while retrieving PDF "${t}".`,h)}function vp(h){return h===200||h===206}function yp(h,t,e){return{method:"GET",headers:h,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function wp(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:(ht(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class df{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Zd(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return ne(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Nv(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Bv(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Nv{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),s=e.url;fetch(s,yp(i,this._withCredentials,this._abortController)).then(n=>{if(!vp(n.status))throw ac(n.status,s);this._reader=n.body.getReader(),this._headersCapability.resolve();const a=n.headers,{allowRangeRequests:o,suggestedLength:l}=tu({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=eu(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Fr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:wp(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class Bv{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const n=new Headers(t.headers);n.append("Range",`bytes=${e}-${i-1}`);const a=s.url;fetch(a,yp(n,this._withCredentials,this._abortController)).then(o=>{if(!vp(o.status))throw ac(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:wp(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const gc=200,mc=206;function Hv(h){const t=h.response;return typeof t!="string"?t:sc(t).buffer}class Wv{constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Zd(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,i){const s={begin:t,end:e};for(const n in i)s[n]=i[n];return this.request(s)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[n,a]of this.headers)e.setRequestHeader(n,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=mc):s.expectedStatus=gc,e.responseType="arraybuffer",t.onError&&(e.onerror=function(n){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){var s;const i=this.pendingRequests[t];i&&((s=i.onProgress)==null||s.call(i,e))}onStateChange(t,e){var l,c,d;const i=this.pendingRequests[t];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){(l=i.onError)==null||l.call(i,s.status);return}const n=s.status||gc;if(!(n===gc&&i.expectedStatus===mc)&&n!==i.expectedStatus){(c=i.onError)==null||c.call(i,s.status);return}const o=Hv(s);if(n===mc){const f=s.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);i.onDone({begin:parseInt(u[1],10),chunk:o})}else o?i.onDone({begin:0,chunk:o}):(d=i.onError)==null||d.call(i,s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class Uv{constructor(t){this._source=t,this._manager=new Wv(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return ne(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Vv(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new jv(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Vv{constructor(t,e){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=new Headers(e.getAllResponseHeaders().trim().split(/[\r\n]+/).map(a=>{const[o,...l]=a.split(": ");return[o,l.join(": ")]})),{allowRangeRequests:s,suggestedLength:n}=tu({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=n||this._contentLength,this._filename=eu(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=ac(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class jv{constructor(t,e,i){this._manager=t;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,i,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=ac(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const zv=/^[a-z][a-z0-9\-+.]+:/i;function $v(h){if(zv.test(h))return new URL(h);const t=yn.get("url");return new URL(t.pathToFileURL(h))}function Ap(h,t,e){return h.protocol==="http:"?yn.get("http").request(h,{headers:t},e):yn.get("https").request(h,{headers:t},e)}class Gv{constructor(t){this.source=t,this.url=$v(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=Zd(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return ne(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Yv(this):new qv(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=this.isFsUrl?new Kv(this,t,e):new Xv(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class _p{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Fr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Ep{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class qv extends _p{constructor(t){super(t);const e=Object.fromEntries(t.headers),i=s=>{if(s.statusCode===404){const l=new Ir(`Missing PDF "${this._url}".`);this._storedError=l,this._headersCapability.reject(l);return}this._headersCapability.resolve(),this._setReadableStream(s);const n=new Headers(this._readableStream.headers),{allowRangeRequests:a,suggestedLength:o}=tu({responseHeaders:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=o||this._contentLength,this._filename=eu(n)};this._request=Ap(this._url,e,i),this._request.on("error",s=>{this._storedError=s,this._headersCapability.reject(s)}),this._request.end()}}class Xv extends Ep{constructor(t,e,i){super(t);const s=Object.fromEntries(t.headers);s.Range=`bytes=${e}-${i-1}`;const n=a=>{if(a.statusCode===404){const o=new Ir(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(a)};this._request=Ap(this._url,s,n),this._request.on("error",a=>{this._storedError=a}),this._request.end()}}class Yv extends _p{constructor(t){super(t);const e=yn.get("fs");e.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(e.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Ir(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}}class Kv extends Ep{constructor(t,e,i){super(t);const s=yn.get("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:i-1}))}}const Qv=1e5,He=30,Jv=.8;var Tf,sn,Ve,Qo,Jo,Qn,ms,Zo,tl,Jn,ga,ma,nn,ba,el,va,Zn,il,sl,$t,tr,er,nl,rn,ya,Bs,Sp,xp,td,ai,lh,ed,Tp,Cp;let Zc=($t=class{constructor({textContentSource:t,container:e,viewport:i}){y(this,Bs);y(this,sn,Promise.withResolvers());y(this,Ve,null);y(this,Qo,!1);y(this,Jo,!!((Tf=globalThis.FontInspector)!=null&&Tf.enabled));y(this,Qn,null);y(this,ms,null);y(this,Zo,0);y(this,tl,0);y(this,Jn,null);y(this,ga,null);y(this,ma,0);y(this,nn,0);y(this,ba,Object.create(null));y(this,el,[]);y(this,va,null);y(this,Zn,[]);y(this,il,new WeakMap);y(this,sl,null);var l;if(t instanceof ReadableStream)m(this,va,t);else if(typeof t=="object")m(this,va,new ReadableStream({start(c){c.enqueue(t),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');m(this,Ve,m(this,ga,e)),m(this,nn,i.scale*(globalThis.devicePixelRatio||1)),m(this,ma,i.rotation),m(this,ms,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:n,pageX:a,pageY:o}=i.rawDims;m(this,sl,[1,0,0,-1,-a,o+n]),m(this,tl,s),m(this,Zo,n),v(l=$t,ai,Tp).call(l),Cr(e,i),r(this,sn).promise.finally(()=>{r($t,ya).delete(this),m(this,ms,null),m(this,ba,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=De.platform;return gt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{r(this,Jn).read().then(({value:e,done:i})=>{if(i){r(this,sn).resolve();return}r(this,Qn)??m(this,Qn,e.lang),Object.assign(r(this,ba),e.styles),v(this,Bs,Sp).call(this,e.items),t()},r(this,sn).reject)};return m(this,Jn,r(this,va).getReader()),r($t,ya).add(this),t(),r(this,sn).promise}update({viewport:t,onBefore:e=null}){var n;const i=t.scale*(globalThis.devicePixelRatio||1),s=t.rotation;if(s!==r(this,ma)&&(e==null||e(),m(this,ma,s),Cr(r(this,ga),{rotation:s})),i!==r(this,nn)){e==null||e(),m(this,nn,i);const a={div:null,properties:null,ctx:v(n=$t,ai,lh).call(n,r(this,Qn))};for(const o of r(this,Zn))a.properties=r(this,il).get(o),a.div=o,v(this,Bs,td).call(this,a)}}cancel(){var e;const t=new Fr("TextLayer task cancelled.");(e=r(this,Jn))==null||e.cancel(t).catch(()=>{}),m(this,Jn,null),r(this,sn).reject(t)}get textDivs(){return r(this,Zn)}get textContentItemsStr(){return r(this,el)}static cleanup(){if(!(r(this,ya).size>0)){r(this,tr).clear();for(const{canvas:t}of r(this,er).values())t.remove();r(this,er).clear()}}},sn=new WeakMap,Ve=new WeakMap,Qo=new WeakMap,Jo=new WeakMap,Qn=new WeakMap,ms=new WeakMap,Zo=new WeakMap,tl=new WeakMap,Jn=new WeakMap,ga=new WeakMap,ma=new WeakMap,nn=new WeakMap,ba=new WeakMap,el=new WeakMap,va=new WeakMap,Zn=new WeakMap,il=new WeakMap,sl=new WeakMap,tr=new WeakMap,er=new WeakMap,nl=new WeakMap,rn=new WeakMap,ya=new WeakMap,Bs=new WeakSet,Sp=function(t){var s,n;if(r(this,Qo))return;(n=r(this,ms)).ctx??(n.ctx=v(s=$t,ai,lh).call(s,r(this,Qn)));const e=r(this,Zn),i=r(this,el);for(const a of t){if(e.length>Qv){ht("Ignoring additional textDivs for performance reasons."),m(this,Qo,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=r(this,Ve);m(this,Ve,document.createElement("span")),r(this,Ve).classList.add("markedContent"),a.id!==null&&r(this,Ve).setAttribute("id",`${a.id}`),o.append(r(this,Ve))}else a.type==="endMarkedContent"&&m(this,Ve,r(this,Ve).parentNode);continue}i.push(a.str),v(this,Bs,xp).call(this,a)}},xp=function(t){var b;const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};r(this,Zn).push(e);const s=z.transform(r(this,sl),t.transform);let n=Math.atan2(s[1],s[0]);const a=r(this,ba)[t.fontName];a.vertical&&(n+=Math.PI/2);let o=r(this,Jo)&&a.fontSubstitution||a.fontFamily;o=$t.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),c=l*v(b=$t,ai,Cp).call(b,o,r(this,Qn));let d,f;n===0?(d=s[4],f=s[5]-c):(d=s[4]+c*Math.sin(n),f=s[5]-c*Math.cos(n));const u="calc(var(--scale-factor)*",p=e.style;r(this,Ve)===r(this,ga)?(p.left=`${(100*d/r(this,tl)).toFixed(2)}%`,p.top=`${(100*f/r(this,Zo)).toFixed(2)}%`):(p.left=`${u}${d.toFixed(2)}px)`,p.top=`${u}${f.toFixed(2)}px)`),p.fontSize=`${u}${(r($t,rn)*l).toFixed(2)}px)`,p.fontFamily=o,i.fontSize=l,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,r(this,Jo)&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),n!==0&&(i.angle=n*(180/Math.PI));let g=!1;if(t.str.length>1)g=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),A=Math.abs(t.transform[3]);w!==A&&Math.max(w,A)/Math.min(w,A)>1.5&&(g=!0)}if(g&&(i.canvasWidth=a.vertical?t.height:t.width),r(this,il).set(e,i),r(this,ms).div=e,r(this,ms).properties=i,v(this,Bs,td).call(this,r(this,ms)),i.hasText&&r(this,Ve).append(e),i.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),r(this,Ve).append(w)}},td=function(t){var o;const{div:e,properties:i,ctx:s}=t,{style:n}=e;let a="";if(r($t,rn)>1&&(a=`scale(${1/r($t,rn)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=n,{canvasWidth:c,fontSize:d}=i;v(o=$t,ai,ed).call(o,s,d*r(this,nn),l);const{width:f}=s.measureText(e.textContent);f>0&&(a=`scaleX(${c*r(this,nn)/f}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(n.transform=a)},ai=new WeakSet,lh=function(t=null){let e=r(this,er).get(t||(t=""));if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),r(this,er).set(t,e),r(this,nl).set(e,{size:0,family:""})}return e},ed=function(t,e,i){const s=r(this,nl).get(t);e===s.size&&i===s.family||(t.font=`${e}px ${i}`,s.size=e,s.family=i)},Tp=function(){if(r(this,rn)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),m(this,rn,t.getBoundingClientRect().height),t.remove()},Cp=function(t,e){const i=r(this,tr).get(t);if(i)return i;const s=v(this,ai,lh).call(this,e);s.canvas.width=s.canvas.height=He,v(this,ai,ed).call(this,s,He,t);const n=s.measureText("");let a=n.fontBoundingBoxAscent,o=Math.abs(n.fontBoundingBoxDescent);if(a){const d=a/(a+o);return r(this,tr).set(t,d),s.canvas.width=s.canvas.height=0,d}s.strokeStyle="red",s.clearRect(0,0,He,He),s.strokeText("g",0,0);let l=s.getImageData(0,0,He,He).data;o=0;for(let d=l.length-1-3;d>=0;d-=4)if(l[d]>0){o=Math.ceil(d/4/He);break}s.clearRect(0,0,He,He),s.strokeText("A",0,He),l=s.getImageData(0,0,He,He).data,a=0;for(let d=0,f=l.length;d<f;d+=4)if(l[d]>0){a=He-Math.floor(d/4/He);break}s.canvas.width=s.canvas.height=0;const c=a?a/(a+o):Jv;return r(this,tr).set(t,c),c},y($t,ai),y($t,tr,new Map),y($t,er,new Map),y($t,nl,new WeakMap),y($t,rn,null),y($t,ya,new Set),$t);class _o{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function s(n){var l;if(!n)return;let a=null;const o=n.name;if(o==="#text")a=n.value;else if(_o.shouldBuildText(o))(l=n==null?void 0:n.attributes)!=null&&l.textContent?a=n.attributes.textContent:n.value&&(a=n.value);else return;if(a!==null&&e.push({str:a}),!!n.children)for(const c of n.children)s(c)}return s(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const Zv=65536,ty=100,ey=5e3,iy=Pe?pv:dv,sy=Pe?gv:hp,ny=Pe?fv:uv,ry=Pe?mv:fp;function ay(h={}){typeof h=="string"||h instanceof URL?h={url:h}:(h instanceof ArrayBuffer||ArrayBuffer.isView(h))&&(h={data:h});const t=new id,{docId:e}=t,i=h.url?oy(h.url):null,s=h.data?ly(h.data):null,n=h.httpHeaders||null,a=h.withCredentials===!0,o=h.password??null,l=h.range instanceof Pp?h.range:null,c=Number.isInteger(h.rangeChunkSize)&&h.rangeChunkSize>0?h.rangeChunkSize:Zv;let d=h.worker instanceof Xr?h.worker:null;const f=h.verbosity,u=typeof h.docBaseUrl=="string"&&!rc(h.docBaseUrl)?h.docBaseUrl:null,p=typeof h.cMapUrl=="string"?h.cMapUrl:null,g=h.cMapPacked!==!1,b=h.CMapReaderFactory||sy,w=typeof h.standardFontDataUrl=="string"?h.standardFontDataUrl:null,A=h.StandardFontDataFactory||ry,T=h.stopAtErrors!==!0,S=Number.isInteger(h.maxImageSize)&&h.maxImageSize>-1?h.maxImageSize:-1,x=h.isEvalSupported!==!1,P=typeof h.isOffscreenCanvasSupported=="boolean"?h.isOffscreenCanvasSupported:!Pe,R=typeof h.isChrome=="boolean"?h.isChrome:!De.platform.isFirefox&&typeof window<"u"&&!!(window!=null&&window.chrome),M=Number.isInteger(h.canvasMaxAreaInBytes)?h.canvasMaxAreaInBytes:-1,L=typeof h.disableFontFace=="boolean"?h.disableFontFace:Pe,F=h.fontExtraProperties===!0,D=h.enableXfa===!0,H=h.ownerDocument||globalThis.document,st=h.disableRange===!0,q=h.disableStream===!0,$=h.disableAutoFetch===!0,J=h.pdfBug===!0,K=h.CanvasFactory||iy,W=h.FilterFactory||ny,G=h.enableHWA===!0,ut=l?l.length:h.length??NaN,mt=typeof h.useSystemFonts=="boolean"?h.useSystemFonts:!Pe&&!L,Dt=typeof h.useWorkerFetch=="boolean"?h.useWorkerFetch:b===hp&&A===fp&&p&&w&&io(p,document.baseURI)&&io(w,document.baseURI);h.canvasFactory&&Ju("`canvasFactory`-instance option, please use `CanvasFactory` instead."),h.filterFactory&&Ju("`filterFactory`-instance option, please use `FilterFactory` instead.");const St=null;Vb(f);const wt={canvasFactory:new K({ownerDocument:H,enableHWA:G}),filterFactory:new W({docId:e,ownerDocument:H}),cMapReaderFactory:Dt?null:new b({baseUrl:p,isCompressed:g}),standardFontDataFactory:Dt?null:new A({baseUrl:w})};if(!d){const xt={verbosity:f,port:Fs.workerPort};d=xt.port?Xr.fromPort(xt):new Xr(xt),t._worker=d}const Zt={docId:e,apiVersion:"4.8.69",data:s,password:o,disableAutoFetch:$,rangeChunkSize:c,length:ut,docBaseUrl:u,enableXfa:D,evaluatorOptions:{maxImageSize:S,disableFontFace:L,ignoreErrors:T,isEvalSupported:x,isOffscreenCanvasSupported:P,isChrome:R,canvasMaxAreaInBytes:M,fontExtraProperties:F,useSystemFonts:mt,cMapUrl:Dt?p:null,standardFontDataUrl:Dt?w:null}},j={disableFontFace:L,fontExtraProperties:F,ownerDocument:H,pdfBug:J,styleElement:St,loadingParams:{disableAutoFetch:$,enableXfa:D}};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const xt=d.messageHandler.sendWithPromise("GetDocRequest",Zt,s?[s.buffer]:null);let ct;if(l)ct=new Iv(l,{disableRange:st,disableStream:q});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let Re;Pe?Re=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&io(i)?df:Gv:Re=io(i)?df:Uv,ct=new Re({url:i,length:ut,httpHeaders:n,withCredentials:a,rangeChunkSize:c,disableRange:st,disableStream:q})}return xt.then(Re=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const ue=new ho(e,Re,d.port),Tt=new uy(ue,t,ct,j,wt);t._transport=Tt,ue.send("Ready",null)})}).catch(t._capability.reject),t}function oy(h){if(h instanceof URL)return h.href;try{return new URL(h,window.location).href}catch{if(Pe&&typeof h=="string")return h}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function ly(h){if(Pe&&typeof Buffer<"u"&&h instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength)return h;if(typeof h=="string")return sc(h);if(h instanceof ArrayBuffer||ArrayBuffer.isView(h)||typeof h=="object"&&!isNaN(h==null?void 0:h.length))return new Uint8Array(h);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function uf(h){return typeof h=="object"&&Number.isInteger(h==null?void 0:h.num)&&h.num>=0&&Number.isInteger(h==null?void 0:h.gen)&&h.gen>=0}var $h;const Gh=class Gh{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Me(Gh,$h)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(s){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,s}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};$h=new WeakMap,y(Gh,$h,0);let id=Gh,Pp=class{constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const i of this._rangeListeners)i(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){Bt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class hy{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return gt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var an,bs,gi,jr,hh;class cy{constructor(t,e,i,s=!1){y(this,gi);y(this,an,null);y(this,bs,!1);this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new Qu:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new Rp,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:n=!1}={}){return new Hl({viewBox:this.view,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:n})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return gt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:s=js.ENABLE,transform:n=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:d=null,isEditing:f=!1}){var x,P;(x=this._stats)==null||x.time("Overall");const u=this._transport.getRenderingIntent(i,s,d,f),{renderingIntent:p,cacheKey:g}=u;m(this,bs,!1),v(this,gi,hh).call(this),o||(o=this._transport.getOptionalContentConfig(p));let b=this._intentStates.get(g);b||(b=Object.create(null),this._intentStates.set(g,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const w=!!(p&si.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(P=this._stats)==null||P.time("Page Request"),this._pumpOperatorList(u));const A=R=>{var M;b.renderTasks.delete(T),(this._maybeCleanupAfterRender||w)&&m(this,bs,!0),v(this,gi,jr).call(this,!w),R?(T.capability.reject(R),this._abortOperatorList({intentState:b,reason:R instanceof Error?R:new Error(R)})):T.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(M=globalThis.Stats)!=null&&M.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},T=new nd({callback:A,params:{canvasContext:t,viewport:e,transform:n,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:c});(b.renderTasks||(b.renderTasks=new Set)).add(T);const S=T.task;return Promise.all([b.displayReadyCapability.promise,o]).then(([R,M])=>{var L;if(this.destroyed){A();return}if((L=this._stats)==null||L.time("Rendering"),!(M.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");T.initializeGraphics({transparency:R,optionalContentConfig:M}),T.operatorListChanged()}).catch(A),S}getOperatorList({intent:t="display",annotationMode:e=js.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var c;function n(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(t,e,i,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=n,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>_o.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){function n(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),n()},s)}const a=e.getReader(),o={items:[],styles:Object.create(null),lang:null};n()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),m(this,bs,!1),v(this,gi,hh).call(this),Promise.all(t)}cleanup(t=!1){m(this,bs,!0);const e=v(this,gi,jr).call(this,!1);return t&&e&&this._stats&&(this._stats=new Qu),e}_startRenderPage(t,e){var s,n;const i=this._intentStates.get(e);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(n=i.displayReadyCapability)==null||n.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&v(this,gi,jr).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:s}){const{map:n,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:n,modifiedIds:s},a).getReader(),c=this._intentStates.get(e);c.streamReader=l;const d=()=>{l.read().then(({value:f,done:u})=>{if(u){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,c),d())},f=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const u of c.renderTasks)u.operatorListChanged();v(this,gi,jr).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(f);else if(c.opListReadCapability)c.opListReadCapability.reject(f);else throw f}})};d()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof qd){let s=ty;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new Fr(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,n]of this._intentStates)if(n===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}an=new WeakMap,bs=new WeakMap,gi=new WeakSet,jr=function(t=!1){if(v(this,gi,hh).call(this),!r(this,bs)||this.destroyed)return!1;if(t)return m(this,an,setTimeout(()=>{m(this,an,null),v(this,gi,jr).call(this,!1)},ey)),!1;for(const{renderTasks:e,operatorList:i}of this._intentStates.values())if(e.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,bs,!1),!0},hh=function(){r(this,an)&&(clearTimeout(r(this,an)),m(this,an,null))};var vs,qh;class dy{constructor(){y(this,vs,new Map);y(this,qh,Promise.resolve())}postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};r(this,qh).then(()=>{for(const[s]of r(this,vs))s.call(this,i)})}addEventListener(t,e,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:n}=i;if(n.aborted){ht("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);s=()=>n.removeEventListener("abort",a),n.addEventListener("abort",a)}r(this,vs).set(e,s)}removeEventListener(t,e){const i=r(this,vs).get(e);i==null||i(),r(this,vs).delete(e)}terminate(){for(const[,t]of r(this,vs))t==null||t();r(this,vs).clear()}}vs=new WeakMap,qh=new WeakMap;var Xh,ir,sr,wa,ch,Aa,dh;const Ht=class Ht{constructor({name:t=null,port:e=null,verbosity:i=jb()}={}){y(this,wa);var s;if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((s=r(Ht,sr))!=null&&s.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(r(Ht,sr)||m(Ht,sr,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return Pe?Promise.all([yn.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new ho("main","worker",t),this._messageHandler.on("ready",function(){}),v(this,wa,ch).call(this)}_initialize(){if(r(Ht,ir)||r(Ht,Aa,dh)){this._setupFakeWorker();return}let{workerSrc:t}=Ht;try{Ht._isSameOrigin(window.location.href,t)||(t=Ht._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new ho("main","worker",e),s=()=>{n.abort(),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=new AbortController;e.addEventListener("error",()=>{this._webWorker||s()},{signal:n.signal}),i.on("test",o=>{if(n.abort(),this.destroyed||!o){s();return}this._messageHandler=i,this._port=e,this._webWorker=e,v(this,wa,ch).call(this)}),i.on("ready",o=>{if(n.abort(),this.destroyed){s();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{ec("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){r(Ht,ir)||(ht("Setting up fake worker."),m(Ht,ir,!0)),Ht._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new dy;this._port=e;const i=`fake${Me(Ht,Xh)._++}`,s=new ho(i+"_worker",i,e);t.setup(s,e),this._messageHandler=new ho(i,i+"_worker",e),v(this,wa,ch).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(t=r(Ht,sr))==null||t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){var i;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(i=r(this,sr))==null?void 0:i.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Ht(t)}static get workerSrc(){if(Fs.workerSrc)return Fs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return gt(this,"_setupFakeWorkerGlobal",(async()=>r(this,Aa,dh)?r(this,Aa,dh):(await import(this.workerSrc)).WorkerMessageHandler)())}};Xh=new WeakMap,ir=new WeakMap,sr=new WeakMap,wa=new WeakSet,ch=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Aa=new WeakSet,dh=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},y(Ht,Aa),y(Ht,Xh,0),y(Ht,ir,!1),y(Ht,sr),Pe&&(m(Ht,ir,!0),Fs.workerSrc||(Fs.workerSrc="./pdf.worker.mjs")),Ht._isSameOrigin=(t,e)=>{let i;try{if(i=new URL(t),!i.origin||i.origin==="null")return!1}catch{return!1}const s=new URL(e,i);return i.origin===s.origin},Ht._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let Xr=Ht;var ys,Yi,_a,Ea,Ki,nr,co;class uy{constructor(t,e,i,s,n){y(this,nr);y(this,ys,new Map);y(this,Yi,new Map);y(this,_a,new Map);y(this,Ea,new Map);y(this,Ki,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Rp,this.fontLoader=new hv({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return gt(this,"annotationStorage",new Qd)}getRenderingIntent(t,e=js.ENABLE,i=null,s=!1,n=!1){let a=si.DISPLAY,o=zc;switch(t){case"any":a=si.ANY;break;case"display":break;case"print":a=si.PRINT;break;default:ht(`getRenderingIntent - invalid intent: ${t}`)}const l=a&si.PRINT&&i instanceof ap?i:this.annotationStorage;switch(e){case js.DISABLE:a+=si.ANNOTATIONS_DISABLE;break;case js.ENABLE:break;case js.ENABLE_FORMS:a+=si.ANNOTATIONS_FORMS;break;case js.ENABLE_STORAGE:a+=si.ANNOTATIONS_STORAGE,o=l.serializable;break;default:ht(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(a+=si.IS_EDITING),n&&(a+=si.OPLIST);const{ids:c,hash:d}=l.modifiedIds,f=[a,o.hash,d];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=r(this,Ki))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of r(this,Yi).values())t.push(s._destroy());r(this,Yi).clear(),r(this,_a).clear(),r(this,Ea).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var s;this.commonObjs.clear(),this.fontLoader.clear(),r(this,ys).clear(),this.filterFactory.destroy(),Zc.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Fr("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{ne(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},s.onPull=()=>{this._fullReader.read().then(function({value:n,done:a}){if(a){s.close();return}ne(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{s.error(n)})},s.onCancel=n=>{this._fullReader.cancel(n),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async i=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:n,contentLength:a}=this._fullReader;return(!s||!n)&&(this._lastProgress&&((o=e.onProgress)==null||o.call(e,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=e.onProgress)==null||c.call(e,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:n,contentLength:a}}),t.on("GetRangeReader",(i,s)=>{ne(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(i.begin,i.end);if(!n){s.close();return}s.onPull=()=>{n.read().then(function({value:a,done:o}){if(o){s.close();return}ne(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{n.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new hy(i,this))}),t.on("DocException",function(i){let s;switch(i.name){case"PasswordException":s=new _c(i.message,i.code);break;case"InvalidPDFException":s=new Lf(i.message);break;case"MissingPDFException":s=new Ir(i.message);break;case"UnexpectedResponseException":s=new ic(i.message,i.status);break;case"UnknownErrorException":s=new Ec(i.message,i.details);break;default:Bt("DocException - expected a valid Error.")}e._capability.reject(s)}),t.on("PasswordRequest",i=>{if(m(this,Ki,Promise.withResolvers()),e.onPassword){const s=n=>{n instanceof Error?r(this,Ki).reject(n):r(this,Ki).resolve({password:n})};try{e.onPassword(s,i.code)}catch(n){r(this,Ki).reject(n)}}else r(this,Ki).reject(new _c(i.message,i.code));return r(this,Ki).promise}),t.on("DataLoaded",i=>{var s;(s=e.onProgress)==null||s.call(e,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;r(this,Yi).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,n])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:o,fontExtraProperties:l,pdfBug:c}=this._params;if("error"in n){const p=n.error;ht(`Error during font loading: ${p}`),this.commonObjs.resolve(i,p);break}const d=c&&((a=globalThis.FontInspector)!=null&&a.enabled)?(p,g)=>globalThis.FontInspector.fontAdded(p,g):null,f=new cv(n,{disableFontFace:o,inspectFont:d});this.fontLoader.bind(f).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l&&f.data&&(f.data=null),this.commonObjs.resolve(i,f)});break;case"CopyLocalImage":const{imageRef:u}=n;ne(u,"The imageRef must be defined.");for(const p of r(this,Yi).values())for(const[,g]of p.objs)if((g==null?void 0:g.ref)===u)return g.dataLen?(this.commonObjs.resolve(i,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,n);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,n,a])=>{var l;if(this.destroyed)return;const o=r(this,Yi).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(n){case"Image":o.objs.resolve(i,a),(a==null?void 0:a.dataLen)>Bb&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${n}`)}}}),t.on("DocProgress",i=>{var s;this.destroyed||(s=e.onProgress)==null||s.call(e,{loaded:i.loaded,total:i.total})}),t.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),t.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&ht("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((i=this._fullReader)==null?void 0:i.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=r(this,_a).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&r(this,Ea).set(n.refStr,t);const a=new cy(e,n,this,this._params.pdfBug);return r(this,Yi).set(e,a),a});return r(this,_a).set(e,s),s}getPageIndex(t){return uf(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return v(this,nr,co).call(this,"GetFieldObjects")}hasJSActions(){return v(this,nr,co).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return v(this,nr,co).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return v(this,nr,co).call(this,"GetOptionalContentConfig").then(e=>new Lv(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=r(this,ys).get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>{var n,a;return{info:s[0],metadata:s[1]?new kv(s[1]):null,contentDispositionFilename:((n=this._fullReader)==null?void 0:n.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return r(this,ys).set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of r(this,Yi).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),r(this,ys).clear(),this.filterFactory.destroy(!0),Zc.cleanup()}}cachedPageNumber(t){if(!uf(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return r(this,Ea).get(e)??null}}ys=new WeakMap,Yi=new WeakMap,_a=new WeakMap,Ea=new WeakMap,Ki=new WeakMap,nr=new WeakSet,co=function(t,e=null){const i=r(this,ys).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return r(this,ys).set(t,s),s};const Kl=Symbol("INITIAL_DATA");var Ci,rl,sd;class Rp{constructor(){y(this,rl);y(this,Ci,Object.create(null))}get(t,e=null){if(e){const s=v(this,rl,sd).call(this,t);return s.promise.then(()=>e(s.data)),null}const i=r(this,Ci)[t];if(!i||i.data===Kl)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=r(this,Ci)[t];return!!e&&e.data!==Kl}resolve(t,e=null){const i=v(this,rl,sd).call(this,t);i.data=e,i.resolve()}clear(){var t;for(const e in r(this,Ci)){const{data:i}=r(this,Ci)[e];(t=i==null?void 0:i.bitmap)==null||t.close()}m(this,Ci,Object.create(null))}*[Symbol.iterator](){for(const t in r(this,Ci)){const{data:e}=r(this,Ci)[t];e!==Kl&&(yield[t,e])}}}Ci=new WeakMap,rl=new WeakSet,sd=function(t){var e;return(e=r(this,Ci))[t]||(e[t]={...Promise.withResolvers(),data:Kl})};var on;class fy{constructor(t){y(this,on,null);m(this,on,t),this.onContinue=null}get promise(){return r(this,on).capability.promise}cancel(t=0){r(this,on).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=r(this,on).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=r(this,on);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}on=new WeakMap;var ln,rr;const kn=class kn{constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:n,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:f=!1,pageColors:u=null}){y(this,ln,null);this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=f,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new fy(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var o,l;if(this.cancelled)return;if(this._canvas){if(r(kn,rr).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r(kn,rr).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:n,background:a}=this.params;this.gfx=new qr(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:n,viewport:s,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(t=null,e=0){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),r(this,ln)&&(window.cancelAnimationFrame(r(this,ln)),m(this,ln,null)),r(kn,rr).delete(this._canvas),this.callback(t||new qd(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,ln,window.requestAnimationFrame(()=>{m(this,ln,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),r(kn,rr).delete(this._canvas),this.callback())))}};ln=new WeakMap,rr=new WeakMap,y(kn,rr,new WeakSet);let nd=kn;const py="4.8.69",gy="3634dab10";function ff(h){return Math.floor(Math.max(0,Math.min(1,h))*255).toString(16).padStart(2,"0")}function Za(h){return Math.max(0,Math.min(255,255*h))}class pf{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Za(t),[t,t,t]}static G_HTML([t]){const e=ff(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Za)}static RGB_HTML(t){return`#${t.map(ff).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[Za(1-Math.min(1,t+s)),Za(1-Math.min(1,i+s)),Za(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,n=1-e,a=1-i,o=Math.min(s,n,a);return["CMYK",s,n,a,o]}}class my{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Bt("Abstract method `_createSVG` called.")}}class iu extends my{_createSVG(t){return document.createElementNS(os,t)}}class kp{static setupStorage(t,e,i,s,n){const a=s.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),n==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),n==="print")break;t.addEventListener("change",o=>{s.setValue(e,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),n==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(e,{value:c})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:n}){const{attributes:a}=e,o=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&t.setAttribute(l,c)}o&&n.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){var f,u;const e=t.annotationStorage,i=t.linkService,s=t.xfaHtml,n=t.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:n,linkService:i});const o=n!=="richText",l=t.div;if(l.append(a),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=p}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const p=document.createTextNode(s.value);a.append(p),o&&_o.shouldBuildText(s.name)&&c.push(p)}return{textDivs:c}}const d=[[s,-1,a]];for(;d.length>0;){const[p,g,b]=d.at(-1);if(g+1===p.children.length){d.pop();continue}const w=p.children[++d.at(-1)[1]];if(w===null)continue;const{name:A}=w;if(A==="#text"){const S=document.createTextNode(w.value);c.push(S),b.append(S);continue}const T=(f=w==null?void 0:w.attributes)!=null&&f.xmlns?document.createElementNS(w.attributes.xmlns,A):document.createElement(A);if(b.append(T),w.attributes&&this.setAttributes({html:T,element:w,storage:e,intent:n,linkService:i}),((u=w.children)==null?void 0:u.length)>0)d.push([w,-1,T]);else if(w.value){const S=document.createTextNode(w.value);o&&_o.shouldBuildText(A)&&c.push(S),T.append(S)}}for(const p of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Ul=1e3,by=9,Rr=new WeakSet;function Ds(h){return{width:h[2]-h[0],height:h[3]-h[1]}}class vy{static create(t){switch(t.data.annotationType){case te.LINK:return new Mp(t);case te.TEXT:return new yy(t);case te.WIDGET:switch(t.data.fieldType){case"Tx":return new wy(t);case"Btn":return t.data.radioButton?new Fp(t):t.data.checkBox?new _y(t):new Ey(t);case"Ch":return new Sy(t);case"Sig":return new Ay(t)}return new Dr(t);case te.POPUP:return new ad(t);case te.FREETEXT:return new Hp(t);case te.LINE:return new Ty(t);case te.SQUARE:return new Cy(t);case te.CIRCLE:return new Py(t);case te.POLYLINE:return new Wp(t);case te.CARET:return new ky(t);case te.INK:return new su(t);case te.POLYGON:return new Ry(t);case te.HIGHLIGHT:return new Up(t);case te.UNDERLINE:return new My(t);case te.SQUIGGLY:return new Ly(t);case te.STRIKEOUT:return new Iy(t);case te.STAMP:return new Vp(t);case te.FILEATTACHMENT:return new Fy(t);default:return new Xt(t)}}}var ar,Sa,xa,al,rd;const ou=class ou{constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){y(this,al);y(this,ar,null);y(this,Sa,!1);y(this,xa,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t!=null&&t.str||e!=null&&e.str||i!=null&&i.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ou._hasPopupData(this.data)}updateEdited(t){var i;if(!this.container)return;r(this,ar)||m(this,ar,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&v(this,al,rd).call(this,e),(i=r(this,xa))==null||i.popup.updateEdited(t)}resetEdited(){var t;r(this,ar)&&(v(this,al,rd).call(this,r(this,ar).rect),(t=r(this,xa))==null||t.popup.resetEdited(),m(this,ar,null))}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",e.id),this instanceof Dr||(n.tabIndex=Ul);const{style:a}=n;if(a.zIndex=this.parent.zIndex++,e.alternativeText&&(n.title=e.alternativeText),e.noRotate&&n.classList.add("norotate"),!e.rect||this instanceof ad){const{rotation:b}=e;return!e.hasOwnCanvas&&b!==0&&this.setRotation(b,n),n}const{width:o,height:l}=Ds(e.rect);if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const b=e.borderStyle.horizontalCornerRadius,w=e.borderStyle.verticalCornerRadius;if(b>0||w>0){const T=`calc(${b}px * var(--scale-factor)) / calc(${w}px * var(--scale-factor))`;a.borderRadius=T}else if(this instanceof Fp){const T=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=T}switch(e.borderStyle.style){case Qa.SOLID:a.borderStyle="solid";break;case Qa.DASHED:a.borderStyle="dashed";break;case Qa.BEVELED:ht("Unimplemented border style: beveled");break;case Qa.INSET:ht("Unimplemented border style: inset");break;case Qa.UNDERLINE:a.borderBottomStyle="solid";break}const A=e.borderColor||null;A?(m(this,Sa,!0),a.borderColor=z.makeHexColor(A[0]|0,A[1]|0,A[2]|0)):a.borderWidth=0}const c=z.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:d,pageHeight:f,pageX:u,pageY:p}=s.rawDims;a.left=`${100*(c[0]-u)/d}%`,a.top=`${100*(c[1]-p)/f}%`;const{rotation:g}=e;return e.hasOwnCanvas||g===0?(a.width=`${100*o/d}%`,a.height=`${100*l/f}%`):this.setRotation(g,n),n}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:n,height:a}=Ds(this.data.rect);let o,l;t%180===0?(o=100*n/i,l=100*a/s):(o=100*a/i,l=100*n/s),e.style.width=`${o}%`,e.style.height=`${l}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const n=s.detail[e],a=n[0],o=n.slice(1);s.target.style[i]=pf[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:pf[`${a}_rgb`](o)})};return gt(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail)){const n=t[s]||i[s];n==null||n(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,n]of Object.entries(e)){const a=i[s];if(a){const o={detail:{[s]:n},target:t};a(o),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,n]=this.data.rect.map(b=>Math.fround(b));if(t.length===8){const[b,w,A,T]=t.subarray(2,6);if(s===b&&n===w&&e===A&&i===T)return}const{style:a}=this.container;let o;if(r(this,Sa)){const{borderColor:b,borderWidth:w}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const l=s-e,c=n-i,{svgFactory:d}=this,f=d.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const u=d.createElement("defs");f.append(u);const p=d.createElement("clipPath"),g=`clippath_${this.data.id}`;p.setAttribute("id",g),p.setAttribute("clipPathUnits","objectBoundingBox"),u.append(p);for(let b=2,w=t.length;b<w;b+=8){const A=t[b],T=t[b+1],S=t[b+2],x=t[b+3],P=d.createElement("rect"),R=(S-e)/l,M=(n-T)/c,L=(A-S)/l,F=(T-x)/c;P.setAttribute("x",R),P.setAttribute("y",M),P.setAttribute("width",L),P.setAttribute("height",F),p.append(P),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${R}" y="${M}" width="${L}" height="${F}"/>`)}r(this,Sa)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:t}=this,e=m(this,xa,new ad({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){Bt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:n,id:a,exportValues:o}of s){if(n===-1||a===e)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Rr.has(c)){ht(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const s of document.getElementsByName(t)){const{exportValue:n}=s,a=s.getAttribute("data-element-id");a!==e&&Rr.has(s)&&i.push({id:a,exportValue:n,domElement:s})}return i}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};ar=new WeakMap,Sa=new WeakMap,xa=new WeakMap,al=new WeakSet,rd=function(t){const{container:{style:e},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:n,pageHeight:a,pageX:o,pageY:l}}}}=this;i==null||i.splice(0,4,...t);const{width:c,height:d}=Ds(t);e.left=`${100*(t[0]-o)/n}%`,e.top=`${100*(a-t[3]+l)/a}%`,s===0?(e.width=`${100*c/n}%`,e.height=`${100*d/a}%`):this.setRotation(s)};let Xt=ou;var ri,xn,Lp,Ip;class Mp extends Xt{constructor(e,i=null){super(e,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});y(this,ri);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let n=!1;return e.url?(i.addLinkAttributes(s,e.url,e.newWindow),n=!0):e.action?(this._bindNamedAction(s,e.action),n=!0):e.attachment?(v(this,ri,Lp).call(this,s,e.attachment,e.attachmentDest),n=!0):e.setOCGState?(v(this,ri,Ip).call(this,s,e.setOCGState),n=!0):e.dest?(this._bindLink(s,e.dest),n=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),n=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(s,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(s),this.container}_bindLink(e,i){e.href=this.linkService.getDestinationHash(i),e.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&v(this,ri,xn).call(this)}_bindNamedAction(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(i),!1),v(this,ri,xn).call(this)}_bindJSAction(e,i){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(i.actions)){const a=s.get(n);a&&(e[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:n}}),!1})}e.onclick||(e.onclick=()=>!1),v(this,ri,xn).call(this)}_bindResetFormAction(e,i){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),v(this,ri,xn).call(this),!this._fieldObjects){ht('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{var f;s==null||s();const{fields:n,refs:a,include:o}=i,l=[];if(n.length!==0||a.length!==0){const u=new Set(a);for(const p of n){const g=this._fieldObjects[p]||[];for(const{id:b}of g)u.add(b)}for(const p of Object.values(this._fieldObjects))for(const g of p)u.has(g.id)===o&&l.push(g)}else for(const u of Object.values(this._fieldObjects))l.push(...u);const c=this.annotationStorage,d=[];for(const u of l){const{id:p}=u;switch(d.push(p),u.type){case"text":{const b=u.defaultValue||"";c.setValue(p,{value:b});break}case"checkbox":case"radiobutton":{const b=u.defaultValue===u.exportValues;c.setValue(p,{value:b});break}case"combobox":case"listbox":{const b=u.defaultValue||"";c.setValue(p,{value:b});break}default:continue}const g=document.querySelector(`[data-element-id="${p}"]`);if(g){if(!Rr.has(g)){ht(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}ri=new WeakSet,xn=function(){this.container.setAttribute("data-internal-link","")},Lp=function(e,i,s=null){e.href=this.linkService.getAnchorUrl(""),i.description&&(e.title=i.description),e.onclick=()=>{var n;return(n=this.downloadManager)==null||n.openOrDownloadData(i.content,i.filename,s),!1},v(this,ri,xn).call(this)},Ip=function(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(i),!1),v(this,ri,xn).call(this)};class yy extends Xt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Dr extends Xt{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return De.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,n){i.includes("mouse")?t.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{var o;if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}n&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a)}}))})}_setEventListeners(t,e,i,s){var n,a,o;for(const[l,c]of i)(c==="Action"||(n=this.data.actions)!=null&&n[c])&&((c==="Focus"||c==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,l,c,s),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":z.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||by,n=t.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),d=Math.round(c/(dc*s))||1,f=c/d;a=Math.min(s,l(f/dc))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(c/dc))}n.fontSize=`calc(${a}px * var(--scale-factor))`,n.color=z.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(n.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class wy extends Dr{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,s){const n=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),n.setValue(a.id,{[s]:i})}render(){var s,n;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let o=a.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",c??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Rr.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=Ul,this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",u=>{t.setValue(e,{value:u.target.value}),this.setPropertyOnSiblings(i,"value",u.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",u=>{const p=this.data.defaultFieldValue??"";i.value=d.userValue=p,d.formattedValue=null});let f=u=>{const{formattedValue:p}=d;p!=null&&(u.target.value=p),u.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",p=>{var b;if(d.focused)return;const{target:g}=p;d.userValue&&(g.value=d.userValue),d.lastCommittedValue=g.value,d.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const g={value(b){d.userValue=b.detail.value??"",t.setValue(e,{value:d.userValue.toString()}),b.target.value=d.userValue},formattedValue(b){const{formattedValue:w}=b.detail;d.formattedValue=w,w!=null&&b.target!==document.activeElement&&(b.target.value=w),t.setValue(e,{formattedValue:w})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var S;const{charLimit:w}=b.detail,{target:A}=b;if(w===0){A.removeAttribute("maxLength");return}A.setAttribute("maxLength",w);let T=d.userValue;!T||T.length<=w||(T=T.slice(0,w),A.value=d.userValue=T,t.setValue(e,{value:T}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:T,willCommit:!0,commitKey:1,selStart:A.selectionStart,selEnd:A.selectionEnd}}))}};this._dispatchEventFromSandbox(g,p)}),i.addEventListener("keydown",p=>{var w;d.commitKey=1;let g=-1;if(p.key==="Escape"?g=0:p.key==="Enter"&&!this.data.multiLine?g=2:p.key==="Tab"&&(d.commitKey=3),g===-1)return;const{value:b}=p.target;d.lastCommittedValue!==b&&(d.lastCommittedValue=b,d.userValue=b,(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,willCommit:!0,commitKey:g,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const u=f;f=null,i.addEventListener("blur",p=>{var b,w;if(!d.focused||!p.relatedTarget)return;(b=this.data.actions)!=null&&b.Blur||(d.focused=!1);const{value:g}=p.target;d.userValue=g,d.lastCommittedValue!==g&&((w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:g,willCommit:!0,commitKey:d.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),u(p)}),(n=this.data.actions)!=null&&n.Keystroke&&i.addEventListener("beforeinput",p=>{var P;d.lastCommittedValue=null;const{data:g,target:b}=p,{value:w,selectionStart:A,selectionEnd:T}=b;let S=A,x=T;switch(p.inputType){case"deleteWordBackward":{const R=w.substring(0,A).match(/\w*[^\w]*$/);R&&(S-=R[0].length);break}case"deleteWordForward":{const R=w.substring(A).match(/^[^\w]*\w*/);R&&(x+=R[0].length);break}case"deleteContentBackward":A===T&&(S-=1);break;case"deleteContentForward":A===T&&(x+=1);break}p.preventDefault(),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:w,change:g||"",willCommit:!1,selStart:S,selEnd:x}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(f&&i.addEventListener("blur",f),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Ay extends Dr{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class _y extends Dr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const n=document.createElement("input");return Rr.add(n),n.setAttribute("data-element-id",i),n.disabled=e.readOnly,this._setRequired(n,this.data.required),n.type="checkbox",n.name=e.fieldName,s&&n.setAttribute("checked",!0),n.setAttribute("exportValue",e.exportValue),n.tabIndex=Ul,n.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const d=l&&c.exportValue===e.exportValue;c.domElement&&(c.domElement.checked=d),t.setValue(c.id,{value:d})}t.setValue(i,{value:l})}),n.addEventListener("resetform",a=>{const o=e.defaultFieldValue||"Off";a.target.checked=o===e.exportValue}),this.enableScripting&&this.hasJSActions&&(n.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",t.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Fp extends Dr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const n=document.createElement("input");if(Rr.add(n),n.setAttribute("data-element-id",i),n.disabled=e.readOnly,this._setRequired(n,this.data.required),n.type="radio",n.name=e.fieldName,s&&n.setAttribute("checked",!0),n.tabIndex=Ul,n.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))t.setValue(c.id,{value:!1});t.setValue(i,{value:l})}),n.addEventListener("resetform",a=>{const o=e.defaultFieldValue;a.target.checked=o!=null&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;n.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const d=a===c.detail.value;for(const f of this._getElementsByName(c.target.name)){const u=d&&f.id===i;f.domElement&&(f.domElement.checked=u),t.setValue(f.id,{value:u})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Ey extends Mp{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class Sy extends Dr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");Rr.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=Ul;let n=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",d=>{const f=this.data.defaultFieldValue;for(const u of s.options)u.selected=u.value===f});for(const d of this.data.options){const f=document.createElement("option");f.textContent=d.displayValue,f.value=d.exportValue,i.value.includes(d.exportValue)&&(f.setAttribute("selected",!0),n=!1),s.append(f)}let a=null;if(n){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),s.prepend(d),a=()=>{d.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=d=>{const f=d?"value":"textContent",{options:u,multiple:p}=s;return p?Array.prototype.filter.call(u,g=>g.selected).map(g=>g[f]):u.selectedIndex===-1?null:u[u.selectedIndex][f]};let l=o(!1);const c=d=>{const f=d.target.options;return Array.prototype.map.call(f,u=>({displayValue:u.textContent,exportValue:u.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",d=>{const f={value(u){a==null||a();const p=u.detail.value,g=new Set(Array.isArray(p)?p:[p]);for(const b of s.options)b.selected=g.has(b.value);t.setValue(e,{value:o(!0)}),l=o(!1)},multipleSelection(u){s.multiple=!0},remove(u){const p=s.options,g=u.detail.remove;p[g].selected=!1,s.remove(g),p.length>0&&Array.prototype.findIndex.call(p,w=>w.selected)===-1&&(p[0].selected=!0),t.setValue(e,{value:o(!0),items:c(u)}),l=o(!1)},clear(u){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),l=o(!1)},insert(u){const{index:p,displayValue:g,exportValue:b}=u.detail.insert,w=s.children[p],A=document.createElement("option");A.textContent=g,A.value=b,w?w.before(A):s.append(A),t.setValue(e,{value:o(!0),items:c(u)}),l=o(!1)},items(u){const{items:p}=u.detail;for(;s.length!==0;)s.remove(0);for(const g of p){const{displayValue:b,exportValue:w}=g,A=document.createElement("option");A.textContent=b,A.value=w,s.append(A)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:o(!0),items:c(u)}),l=o(!1)},indices(u){const p=new Set(u.detail.indices);for(const g of u.target.options)g.selected=p.has(g.index);t.setValue(e,{value:o(!0)}),l=o(!1)},editable(u){u.target.disabled=!u.detail.editable}};this._dispatchEventFromSandbox(f,d)}),s.addEventListener("input",d=>{var p;const f=o(!0),u=o(!1);t.setValue(e,{value:f}),d.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:l,change:u,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):s.addEventListener("input",function(d){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class ad extends Xt{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:Xt._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new xy({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${Gd}${i}`).join(",")),this.container}}var Ta,Yh,Kh,Ca,or,zt,ws,Pa,ol,ll,Ra,As,Pi,_s,hl,Es,cl,lr,hr,It,uh,od,Dp,Op,Np,Bp,fh,ph,ld;class xy{constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:n,contentsObj:a,richText:o,parent:l,rect:c,parentRect:d,open:f}){y(this,It);y(this,Ta,v(this,It,Np).bind(this));y(this,Yh,v(this,It,ld).bind(this));y(this,Kh,v(this,It,ph).bind(this));y(this,Ca,v(this,It,fh).bind(this));y(this,or,null);y(this,zt,null);y(this,ws,null);y(this,Pa,null);y(this,ol,null);y(this,ll,null);y(this,Ra,null);y(this,As,!1);y(this,Pi,null);y(this,_s,null);y(this,hl,null);y(this,Es,null);y(this,cl,null);y(this,lr,null);y(this,hr,!1);var u;m(this,zt,t),m(this,cl,s),m(this,ws,a),m(this,Es,o),m(this,ll,l),m(this,or,e),m(this,hl,c),m(this,Ra,d),m(this,ol,i),m(this,Pa,Yd.toDateObject(n)),this.trigger=i.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",r(this,Ca)),p.addEventListener("mouseenter",r(this,Kh)),p.addEventListener("mouseleave",r(this,Yh)),p.classList.add("popupTriggerArea");for(const p of i)(u=p.container)==null||u.addEventListener("keydown",r(this,Ta));r(this,zt).hidden=!0,f&&v(this,It,fh).call(this)}render(){if(r(this,Pi))return;const t=m(this,Pi,document.createElement("div"));if(t.className="popup",r(this,or)){const n=t.style.outlineColor=z.makeHexColor(...r(this,or));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`:t.style.backgroundColor=z.makeHexColor(...r(this,or).map(o=>Math.floor(.7*(255-o)+o)))}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),{dir:i.dir,str:i.textContent}=r(this,cl),t.append(e),r(this,Pa)){const n=document.createElement("span");n.classList.add("popupDate"),n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:r(this,Pa).valueOf()})),e.append(n)}const s=r(this,It,uh);if(s)kp.render({xfaHtml:s,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const n=this._formatContents(r(this,ws));t.append(n)}r(this,zt).append(t)}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let n=0,a=s.length;n<a;++n){const o=s[n];i.append(document.createTextNode(o)),n<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:t,popupContent:e}){var i;r(this,lr)||m(this,lr,{contentsObj:r(this,ws),richText:r(this,Es)}),t&&m(this,_s,null),e&&(m(this,Es,v(this,It,Op).call(this,e)),m(this,ws,null)),(i=r(this,Pi))==null||i.remove(),m(this,Pi,null)}resetEdited(){var t;r(this,lr)&&({contentsObj:Me(this,ws)._,richText:Me(this,Es)._}=r(this,lr),m(this,lr,null),(t=r(this,Pi))==null||t.remove(),m(this,Pi,null),m(this,_s,null))}forceHide(){m(this,hr,this.isVisible),r(this,hr)&&(r(this,zt).hidden=!0)}maybeShow(){r(this,hr)&&(r(this,Pi)||v(this,It,ph).call(this),m(this,hr,!1),r(this,zt).hidden=!1)}get isVisible(){return r(this,zt).hidden===!1}}Ta=new WeakMap,Yh=new WeakMap,Kh=new WeakMap,Ca=new WeakMap,or=new WeakMap,zt=new WeakMap,ws=new WeakMap,Pa=new WeakMap,ol=new WeakMap,ll=new WeakMap,Ra=new WeakMap,As=new WeakMap,Pi=new WeakMap,_s=new WeakMap,hl=new WeakMap,Es=new WeakMap,cl=new WeakMap,lr=new WeakMap,hr=new WeakMap,It=new WeakSet,uh=function(){const t=r(this,Es),e=r(this,ws);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&r(this,Es).html||null},od=function(){var t,e,i;return((i=(e=(t=r(this,It,uh))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.fontSize)||0},Dp=function(){var t,e,i;return((i=(e=(t=r(this,It,uh))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.color)||null},Op=function(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:r(this,It,Dp),fontSize:r(this,It,od)?`calc(${r(this,It,od)}px * var(--scale-factor))`:""}};for(const n of t.split(`
`))e.push({name:"span",value:n,attributes:s});return i},Np=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&r(this,As))&&v(this,It,fh).call(this)},Bp=function(){if(r(this,_s)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:s,pageY:n}}}=r(this,ll);let a=!!r(this,Ra),o=a?r(this,Ra):r(this,hl);for(const g of r(this,ol))if(!o||z.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const l=z.normalizeRect([o[0],t[3]-o[1]+t[1],o[2],t[3]-o[3]+t[1]]),d=a?o[2]-o[0]+5:0,f=l[0]+d,u=l[1];m(this,_s,[100*(f-s)/e,100*(u-n)/i]);const{style:p}=r(this,zt);p.left=`${r(this,_s)[0]}%`,p.top=`${r(this,_s)[1]}%`},fh=function(){m(this,As,!r(this,As)),r(this,As)?(v(this,It,ph).call(this),r(this,zt).addEventListener("click",r(this,Ca)),r(this,zt).addEventListener("keydown",r(this,Ta))):(v(this,It,ld).call(this),r(this,zt).removeEventListener("click",r(this,Ca)),r(this,zt).removeEventListener("keydown",r(this,Ta)))},ph=function(){r(this,Pi)||this.render(),this.isVisible?r(this,As)&&r(this,zt).classList.add("focused"):(v(this,It,Bp).call(this),r(this,zt).hidden=!1,r(this,zt).style.zIndex=parseInt(r(this,zt).style.zIndex)+1e3)},ld=function(){r(this,zt).classList.remove("focused"),!(r(this,As)||!this.isVisible)&&(r(this,zt).hidden=!0,r(this,zt).style.zIndex=parseInt(r(this,zt).style.zIndex)-1e3)};class Hp extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=at.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var dl;class Ty extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,dl,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:i,height:s}=Ds(e.rect),n=this.svgFactory.create(i,s,!0),a=m(this,dl,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,dl)}addHighlightArea(){this.container.classList.add("highlightArea")}}dl=new WeakMap;var ul;class Cy extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,ul,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:i,height:s}=Ds(e.rect),n=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=m(this,ul,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,ul)}addHighlightArea(){this.container.classList.add("highlightArea")}}ul=new WeakMap;var fl;class Py extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,fl,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:i,height:s}=Ds(e.rect),n=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=m(this,fl,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,fl)}addHighlightArea(){this.container.classList.add("highlightArea")}}fl=new WeakMap;var pl;class Wp extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,pl,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:i,borderStyle:s,popupRef:n}}=this;if(!i)return this.container;const{width:a,height:o}=Ds(e),l=this.svgFactory.create(a,o,!0);let c=[];for(let f=0,u=i.length;f<u;f+=2){const p=i[f]-e[0],g=e[3]-i[f+1];c.push(`${p},${g}`)}c=c.join(" ");const d=m(this,pl,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",c),d.setAttribute("stroke-width",s.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,pl)}addHighlightArea(){this.container.classList.add("highlightArea")}}pl=new WeakMap;class Ry extends Wp{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ky extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var gl;class su extends Xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,gl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?at.HIGHLIGHT:at.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,inkLists:i,borderStyle:s,popupRef:n}}=this,{width:a,height:o}=Ds(e),l=this.svgFactory.create(a,o,!0);for(const c of i){let d=[];for(let u=0,p=c.length;u<p;u+=2){const g=c[u]-e[0],b=e[3]-c[u+1];d.push(`${g},${b}`)}d=d.join(" ");const f=this.svgFactory.createElement(this.svgElementName);r(this,gl).push(f),f.setAttribute("points",d),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),l.append(f)}return!n&&this.hasPopupData&&this._createPopup(),this.container.append(l),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return r(this,gl)}addHighlightArea(){this.container.classList.add("highlightArea")}}gl=new WeakMap;class Up extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=at.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class My extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Ly extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Iy extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Vp extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=at.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ml,bl,hd;class Fy extends Xt{constructor(e){var s;super(e,{isRenderable:!0});y(this,bl);y(this,ml,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",v(this,bl,hd).bind(this)),m(this,ml,s);const{isMac:n}=De.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(n?a.metaKey:a.ctrlKey)&&v(this,bl,hd).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return r(this,ml)}addHighlightArea(){this.container.classList.add("highlightArea")}}ml=new WeakMap,bl=new WeakSet,hd=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var vl,cr,dr,yl,Mr,jp,cd,Cf;let Dy=(Cf=class{constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:s,page:n,viewport:a,structTreeLayer:o}){y(this,Mr);y(this,vl,null);y(this,cr,null);y(this,dr,new Map);y(this,yl,null);this.div=t,m(this,vl,e),m(this,cr,i),m(this,yl,o||null),this.page=n,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return r(this,dr).size>0}async render(t){var a;const{annotations:e}=t,i=this.div;Cr(i,this.viewport);const s=new Map,n={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new iu,annotationStorage:t.annotationStorage||new Qd,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const l=o.annotationType===te.POPUP;if(l){const f=s.get(o.id);if(!f)continue;n.elements=f}else{const{width:f,height:u}=Ds(o.rect);if(f<=0||u<=0)continue}n.data=o;const c=vy.create(n);if(!c.isRenderable)continue;if(!l&&o.popupRef){const f=s.get(o.popupRef);f?f.push(c):s.set(o.popupRef,[c])}const d=c.render();o.hidden&&(d.style.visibility="hidden"),await v(this,Mr,jp).call(this,d,o.id),c._isEditable&&(r(this,dr).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}v(this,Mr,cd).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,Cr(e,{rotation:t.rotation}),v(this,Mr,cd).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(r(this,dr).values())}getEditableAnnotation(t){return r(this,dr).get(t)}},vl=new WeakMap,cr=new WeakMap,dr=new WeakMap,yl=new WeakMap,Mr=new WeakSet,jp=async function(t,e){var a,o;const i=t.firstChild||t,s=i.id=`${Gd}${e}`,n=await((a=r(this,yl))==null?void 0:a.getAriaAttributes(s));if(n)for(const[l,c]of n)i.setAttribute(l,c);this.div.append(t),(o=r(this,vl))==null||o.moveElementInDOM(this.div,t,i,!1)},cd=function(){if(!r(this,cr))return;const t=this.div;for(const[e,i]of r(this,cr)){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:n}=s;n?n.nodeName==="CANVAS"?n.replaceWith(i):n.classList.contains("annotationContent")?n.after(i):n.before(i):s.append(i)}r(this,cr).clear()},Cf);const Ql=/\r\n?|\n/g;var Ri,Qe,wl,ur,Je,Jt,zp,$p,Gp,gh,Ns,mh,bh,qp,ud,Xp;const Ot=class Ot extends Rt{constructor(e){super({...e,name:"freeTextEditor"});y(this,Jt);y(this,Ri);y(this,Qe,"");y(this,wl,`${this.id}-editor`);y(this,ur,null);y(this,Je);m(this,Ri,e.color||Ot._defaultColor||Rt._defaultLineColor),m(this,Je,e.fontSize||Ot._defaultFontSize)}static get _keyboardManager(){const e=Ot.prototype,i=a=>a.isEmpty(),s=Pr.TRANSLATE_SMALL,n=Pr.TRANSLATE_BIG;return gt(this,"_keyboardManager",new Wl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:i}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[n,0],checker:i}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:i}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,n],checker:i}]]))}static initialize(e,i){Rt.initialize(e,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,i){switch(e){case et.FREETEXT_SIZE:Ot._defaultFontSize=i;break;case et.FREETEXT_COLOR:Ot._defaultColor=i;break}}updateParams(e,i){switch(e){case et.FREETEXT_SIZE:v(this,Jt,zp).call(this,i);break;case et.FREETEXT_COLOR:v(this,Jt,$p).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[et.FREETEXT_SIZE,Ot._defaultFontSize],[et.FREETEXT_COLOR,Ot._defaultColor||Rt._defaultLineColor]]}get propertiesToUpdate(){return[[et.FREETEXT_SIZE,r(this,Je)],[et.FREETEXT_COLOR,r(this,Ri)]]}_translateEmpty(e,i){this._uiManager.translateSelectedEditors(e,i,!0)}getInitialTranslation(){const e=this.parentScale;return[-Ot._internalPadding*e,-(Ot._internalPadding+r(this,Je))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(at.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,ur,new AbortController);const e=this._uiManager.combinedSignal(r(this,ur));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",r(this,wl)),this._isDraggable=!0,(e=r(this,ur))==null||e.abort(),m(this,ur,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width||(this.enableEditMode(),this.editorDiv.focus(),(e=this._initialOptions)!=null&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=r(this,Qe),i=m(this,Qe,v(this,Jt,Gp).call(this).trimEnd());if(e===i)return;const s=n=>{if(m(this,Qe,n),!n){this.remove();return}v(this,Jt,bh).call(this),this._uiManager.rebuild(this),v(this,Jt,gh).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(e)},mustExec:!1}),v(this,Jt,gh).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Ot._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",r(this,wl)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${r(this,Je)}px * var(--scale-factor))`,s.color=r(this,Ri),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Mh(this,this.div,["dblclick","keydown"]),this.width){const[n,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[d,f]=this.pageDimensions,[u,p]=this.pageTranslation;let g,b;switch(this.rotation){case 0:g=e+(o[0]-u)/d,b=i+this.height-(o[1]-p)/f;break;case 90:g=e+(o[0]-u)/d,b=i-(o[1]-p)/f,[l,c]=[c,-l];break;case 180:g=e-this.width+(o[0]-u)/d,b=i-(o[1]-p)/f,[l,c]=[-l,-c];break;case 270:g=e+(o[0]-u-this.height*f)/d,b=i+(o[1]-p-this.width*d)/f,[l,c]=[-c,l];break}this.setAt(g*n,b*a,l,c)}else this.setAt(e*n,i*a,this.width*n,this.height*a);v(this,Jt,bh).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var g,b,w;const i=e.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const n=v(g=Ot,Ns,ud).call(g,i.getData("text")||"").replaceAll(Ql,`
`);if(!n)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!n.includes(`
`)){o.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,d=[],f=[];if(l.nodeType===Node.TEXT_NODE){const A=l.parentElement;if(f.push(l.nodeValue.slice(c).replaceAll(Ql,"")),A!==this.editorDiv){let T=d;for(const S of this.editorDiv.childNodes){if(S===A){T=f;continue}T.push(v(b=Ot,Ns,mh).call(b,S))}}d.push(l.nodeValue.slice(0,c).replaceAll(Ql,""))}else if(l===this.editorDiv){let A=d,T=0;for(const S of this.editorDiv.childNodes)T++===c&&(A=f),A.push(v(w=Ot,Ns,mh).call(w,S))}m(this,Qe,`${d.join(`
`)}${n}${f.join(`
`)}`),v(this,Jt,bh).call(this);const u=new Range;let p=d.reduce((A,T)=>A+T.length,0);for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const T=A.nodeValue.length;if(p<=T){u.setStart(A,p),u.setEnd(A,p);break}p-=T}a.removeAllRanges(),a.addRange(u)}get contentDiv(){return this.editorDiv}static async deserialize(e,i,s){var o;let n=null;if(e instanceof Hp){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:d,rotation:f,id:u,popupRef:p},textContent:g,textPosition:b,parent:{page:{pageNumber:w}}}=e;if(!g||g.length===0)return null;n=e={annotationType:at.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:b,pageIndex:w-1,rect:d.slice(0),rotation:f,id:u,deleted:!1,popupRef:p}}const a=await super.deserialize(e,i,s);return m(a,Je,e.fontSize),m(a,Ri,z.makeHexColor(...e.color)),m(a,Qe,v(o=Ot,Ns,ud).call(o,e.value)),a.annotationElementId=e.id||null,a._initialData=n,a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Ot._internalPadding*this.parentScale,s=this.getRect(i,i),n=Rt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:r(this,Ri)),a={annotationType:at.FREETEXT,color:n,fontSize:r(this,Je),value:v(this,Jt,qp).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?a:this.annotationElementId&&!v(this,Jt,Xp).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(e){const i=super.renderAnnotationElement(e);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${r(this,Je)}px * var(--scale-factor))`,s.color=r(this,Ri),i.replaceChildren();for(const a of r(this,Qe).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const n=Ot._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(n,n),popupContent:r(this,Qe)}),i}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Ri=new WeakMap,Qe=new WeakMap,wl=new WeakMap,ur=new WeakMap,Je=new WeakMap,Jt=new WeakSet,zp=function(e){const i=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--scale-factor))`,this.translate(0,-(n-r(this,Je))*this.parentScale),m(this,Je,n),v(this,Jt,gh).call(this)},s=r(this,Je);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},$p=function(e){const i=n=>{m(this,Ri,this.editorDiv.style.color=n)},s=r(this,Ri);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Gp=function(){var s;const e=[];this.editorDiv.normalize();let i=null;for(const n of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(v(s=Ot,Ns,mh).call(s,n)),i=n);return e.join(`
`)},gh=function(){const[e,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:n,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",n.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/i):(this.width=s.height/e,this.height=s.width/i),this.fixAndSetPosition()},Ns=new WeakSet,mh=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Ql,"")},bh=function(){if(this.editorDiv.replaceChildren(),!!r(this,Qe))for(const e of r(this,Qe).split(`
`)){const i=document.createElement("div");i.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(i)}},qp=function(){return r(this,Qe).replaceAll(" "," ")},ud=function(e){return e.replaceAll(" "," ")},Xp=function(e){const{value:i,fontSize:s,color:n,pageIndex:a}=this._initialData;return this._hasBeenMoved||e.value!==i||e.fontSize!==s||e.color.some((o,l)=>o!==n[l])||e.pageIndex!==a},y(Ot,Ns),Z(Ot,"_freeTextDefaultContent",""),Z(Ot,"_internalPadding",0),Z(Ot,"_defaultColor",null),Z(Ot,"_defaultFontSize",10),Z(Ot,"_type","freetext"),Z(Ot,"_editorType",at.FREETEXT);let dd=Ot;class Yp{toSVGPath(){Bt("Abstract method `toSVGPath` must be implemented.")}get box(){Bt("Abstract getter `box` must be implemented.")}serialize(t,e){Bt("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){Bt("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){Bt("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}}var Ze,ki,ka,Ma,Qi,dt,fr,pr,Al,_l,La,Ia,hn,El,Qh,Jh,re,uo,Kp,Qp,Jp,Zp,tg,eg;const hs=class hs{constructor({x:t,y:e},i,s,n,a,o=0){y(this,re);y(this,Ze);y(this,ki,[]);y(this,ka);y(this,Ma);y(this,Qi,[]);y(this,dt,new Float64Array(18));y(this,fr);y(this,pr);y(this,Al);y(this,_l);y(this,La);y(this,Ia);y(this,hn,[]);m(this,Ze,i),m(this,Ia,n*s),m(this,Ma,a),r(this,dt).set([NaN,NaN,NaN,NaN,t,e],6),m(this,ka,o),m(this,_l,r(hs,El)*s),m(this,Al,r(hs,Jh)*s),m(this,La,s),r(this,hn).push(t,e)}isEmpty(){return isNaN(r(this,dt)[8])}add({x:t,y:e}){var F;m(this,fr,t),m(this,pr,e);const[i,s,n,a]=r(this,Ze);let[o,l,c,d]=r(this,dt).subarray(8,12);const f=t-c,u=e-d,p=Math.hypot(f,u);if(p<r(this,Al))return!1;const g=p-r(this,_l),b=g/p,w=b*f,A=b*u;let T=o,S=l;o=c,l=d,c+=w,d+=A,(F=r(this,hn))==null||F.push(t,e);const x=-A/g,P=w/g,R=x*r(this,Ia),M=P*r(this,Ia);return r(this,dt).set(r(this,dt).subarray(2,8),0),r(this,dt).set([c+R,d+M],4),r(this,dt).set(r(this,dt).subarray(14,18),12),r(this,dt).set([c-R,d-M],16),isNaN(r(this,dt)[6])?(r(this,Qi).length===0&&(r(this,dt).set([o+R,l+M],2),r(this,Qi).push(NaN,NaN,NaN,NaN,(o+R-i)/n,(l+M-s)/a),r(this,dt).set([o-R,l-M],14),r(this,ki).push(NaN,NaN,NaN,NaN,(o-R-i)/n,(l-M-s)/a)),r(this,dt).set([T,S,o,l,c,d],6),!this.isEmpty()):(r(this,dt).set([T,S,o,l,c,d],6),Math.abs(Math.atan2(S-l,T-o)-Math.atan2(A,w))<Math.PI/2?([o,l,c,d]=r(this,dt).subarray(2,6),r(this,Qi).push(NaN,NaN,NaN,NaN,((o+c)/2-i)/n,((l+d)/2-s)/a),[o,l,T,S]=r(this,dt).subarray(14,18),r(this,ki).push(NaN,NaN,NaN,NaN,((T+o)/2-i)/n,((S+l)/2-s)/a),!0):([T,S,o,l,c,d]=r(this,dt).subarray(0,6),r(this,Qi).push(((T+5*o)/6-i)/n,((S+5*l)/6-s)/a,((5*o+c)/6-i)/n,((5*l+d)/6-s)/a,((o+c)/2-i)/n,((l+d)/2-s)/a),[c,d,o,l,T,S]=r(this,dt).subarray(12,18),r(this,ki).push(((T+5*o)/6-i)/n,((S+5*l)/6-s)/a,((5*o+c)/6-i)/n,((5*l+d)/6-s)/a,((o+c)/2-i)/n,((l+d)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=r(this,Qi),e=r(this,ki);if(isNaN(r(this,dt)[6])&&!this.isEmpty())return v(this,re,Kp).call(this);const i=[];i.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);v(this,re,Jp).call(this,i);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return v(this,re,Qp).call(this,i),i.join(" ")}newFreeDrawOutline(t,e,i,s,n,a){return new ig(t,e,i,s,n,a)}getOutlines(){var f;const t=r(this,Qi),e=r(this,ki),i=r(this,dt),[s,n,a,o]=r(this,Ze),l=new Float64Array((((f=r(this,hn))==null?void 0:f.length)??0)+2);for(let u=0,p=l.length-2;u<p;u+=2)l[u]=(r(this,hn)[u]-s)/a,l[u+1]=(r(this,hn)[u+1]-n)/o;if(l[l.length-2]=(r(this,fr)-s)/a,l[l.length-1]=(r(this,pr)-n)/o,isNaN(i[6])&&!this.isEmpty())return v(this,re,Zp).call(this,l);const c=new Float64Array(r(this,Qi).length+24+r(this,ki).length);let d=t.length;for(let u=0;u<d;u+=2){if(isNaN(t[u])){c[u]=c[u+1]=NaN;continue}c[u]=t[u],c[u+1]=t[u+1]}d=v(this,re,eg).call(this,c,d);for(let u=e.length-6;u>=6;u-=6)for(let p=0;p<6;p+=2){if(isNaN(e[u+p])){c[d]=c[d+1]=NaN,d+=2;continue}c[d]=e[u+p],c[d+1]=e[u+p+1],d+=2}return v(this,re,tg).call(this,c,d),this.newFreeDrawOutline(c,l,r(this,Ze),r(this,La),r(this,ka),r(this,Ma))}};Ze=new WeakMap,ki=new WeakMap,ka=new WeakMap,Ma=new WeakMap,Qi=new WeakMap,dt=new WeakMap,fr=new WeakMap,pr=new WeakMap,Al=new WeakMap,_l=new WeakMap,La=new WeakMap,Ia=new WeakMap,hn=new WeakMap,El=new WeakMap,Qh=new WeakMap,Jh=new WeakMap,re=new WeakSet,uo=function(){const t=r(this,dt).subarray(4,6),e=r(this,dt).subarray(16,18),[i,s,n,a]=r(this,Ze);return[(r(this,fr)+(t[0]-e[0])/2-i)/n,(r(this,pr)+(t[1]-e[1])/2-s)/a,(r(this,fr)+(e[0]-t[0])/2-i)/n,(r(this,pr)+(e[1]-t[1])/2-s)/a]},Kp=function(){const[t,e,i,s]=r(this,Ze),[n,a,o,l]=v(this,re,uo).call(this);return`M${(r(this,dt)[2]-t)/i} ${(r(this,dt)[3]-e)/s} L${(r(this,dt)[4]-t)/i} ${(r(this,dt)[5]-e)/s} L${n} ${a} L${o} ${l} L${(r(this,dt)[16]-t)/i} ${(r(this,dt)[17]-e)/s} L${(r(this,dt)[14]-t)/i} ${(r(this,dt)[15]-e)/s} Z`},Qp=function(t){const e=r(this,ki);t.push(`L${e[4]} ${e[5]} Z`)},Jp=function(t){const[e,i,s,n]=r(this,Ze),a=r(this,dt).subarray(4,6),o=r(this,dt).subarray(16,18),[l,c,d,f]=v(this,re,uo).call(this);t.push(`L${(a[0]-e)/s} ${(a[1]-i)/n} L${l} ${c} L${d} ${f} L${(o[0]-e)/s} ${(o[1]-i)/n}`)},Zp=function(t){const e=r(this,dt),[i,s,n,a]=r(this,Ze),[o,l,c,d]=v(this,re,uo).call(this),f=new Float64Array(36);return f.set([NaN,NaN,NaN,NaN,(e[2]-i)/n,(e[3]-s)/a,NaN,NaN,NaN,NaN,(e[4]-i)/n,(e[5]-s)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,(e[16]-i)/n,(e[17]-s)/a,NaN,NaN,NaN,NaN,(e[14]-i)/n,(e[15]-s)/a],0),this.newFreeDrawOutline(f,t,r(this,Ze),r(this,La),r(this,ka),r(this,Ma))},tg=function(t,e){const i=r(this,ki);return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6},eg=function(t,e){const i=r(this,dt).subarray(4,6),s=r(this,dt).subarray(16,18),[n,a,o,l]=r(this,Ze),[c,d,f,u]=v(this,re,uo).call(this);return t.set([NaN,NaN,NaN,NaN,(i[0]-n)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,f,u,NaN,NaN,NaN,NaN,(s[0]-n)/o,(s[1]-a)/l],e),e+=24},y(hs,El,8),y(hs,Qh,2),y(hs,Jh,r(hs,El)+r(hs,Qh));let Ih=hs;var Fa,gr,Ss,Sl,ti,xl,qt,Ge,fo,po,sg;class ig extends Yp{constructor(e,i,s,n,a,o){super();y(this,Ge);y(this,Fa);y(this,gr,null);y(this,Ss);y(this,Sl);y(this,ti);y(this,xl);y(this,qt);m(this,qt,e),m(this,ti,i),m(this,Fa,s),m(this,xl,n),m(this,Ss,a),m(this,Sl,o),v(this,Ge,sg).call(this,o);const{x:l,y:c,width:d,height:f}=r(this,gr);for(let u=0,p=e.length;u<p;u+=2)e[u]=(e[u]-l)/d,e[u+1]=(e[u+1]-c)/f;for(let u=0,p=i.length;u<p;u+=2)i[u]=(i[u]-l)/d,i[u+1]=(i[u+1]-c)/f}toSVGPath(){const e=[`M${r(this,qt)[4]} ${r(this,qt)[5]}`];for(let i=6,s=r(this,qt).length;i<s;i+=6){if(isNaN(r(this,qt)[i])){e.push(`L${r(this,qt)[i+4]} ${r(this,qt)[i+5]}`);continue}e.push(`C${r(this,qt)[i]} ${r(this,qt)[i+1]} ${r(this,qt)[i+2]} ${r(this,qt)[i+3]} ${r(this,qt)[i+4]} ${r(this,qt)[i+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,i,s,n],a){const o=s-e,l=n-i;let c,d;switch(a){case 0:c=v(this,Ge,fo).call(this,r(this,qt),e,n,o,-l),d=v(this,Ge,fo).call(this,r(this,ti),e,n,o,-l);break;case 90:c=v(this,Ge,po).call(this,r(this,qt),e,i,o,l),d=v(this,Ge,po).call(this,r(this,ti),e,i,o,l);break;case 180:c=v(this,Ge,fo).call(this,r(this,qt),s,i,-o,l),d=v(this,Ge,fo).call(this,r(this,ti),s,i,-o,l);break;case 270:c=v(this,Ge,po).call(this,r(this,qt),s,n,-o,-l),d=v(this,Ge,po).call(this,r(this,ti),s,n,-o,-l);break}return{outline:Array.from(c),points:[Array.from(d)]}}get box(){return r(this,gr)}newOutliner(e,i,s,n,a,o=0){return new Ih(e,i,s,n,a,o)}getNewOutline(e,i){const{x:s,y:n,width:a,height:o}=r(this,gr),[l,c,d,f]=r(this,Fa),u=a*d,p=o*f,g=s*d+l,b=n*f+c,w=this.newOutliner({x:r(this,ti)[0]*u+g,y:r(this,ti)[1]*p+b},r(this,Fa),r(this,xl),e,r(this,Sl),i??r(this,Ss));for(let A=2;A<r(this,ti).length;A+=2)w.add({x:r(this,ti)[A]*u+g,y:r(this,ti)[A+1]*p+b});return w.getOutlines()}get mustRemoveSelfIntersections(){return!0}}Fa=new WeakMap,gr=new WeakMap,Ss=new WeakMap,Sl=new WeakMap,ti=new WeakMap,xl=new WeakMap,qt=new WeakMap,Ge=new WeakSet,fo=function(e,i,s,n,a){const o=new Float64Array(e.length);for(let l=0,c=e.length;l<c;l+=2)o[l]=i+e[l]*n,o[l+1]=s+e[l+1]*a;return o},po=function(e,i,s,n,a){const o=new Float64Array(e.length);for(let l=0,c=e.length;l<c;l+=2)o[l]=i+e[l+1]*n,o[l+1]=s+e[l]*a;return o},sg=function(e){const i=r(this,qt);let s=i[4],n=i[5],a=s,o=n,l=s,c=n,d=s,f=n;const u=e?Math.max:Math.min;for(let A=6,T=i.length;A<T;A+=6){if(isNaN(i[A]))a=Math.min(a,i[A+4]),o=Math.min(o,i[A+5]),l=Math.max(l,i[A+4]),c=Math.max(c,i[A+5]),f<i[A+5]?(d=i[A+4],f=i[A+5]):f===i[A+5]&&(d=u(d,i[A+4]));else{const S=z.bezierBoundingBox(s,n,...i.slice(A,A+6));a=Math.min(a,S[0]),o=Math.min(o,S[1]),l=Math.max(l,S[2]),c=Math.max(c,S[3]),f<S[3]?(d=S[2],f=S[3]):f===S[3]&&(d=u(d,S[2]))}s=i[A+4],n=i[A+5]}const p=a-r(this,Ss),g=o-r(this,Ss),b=l-a+2*r(this,Ss),w=c-o+2*r(this,Ss);m(this,gr,{x:p,y:g,width:b,height:w,lastPoint:[d,f]})};var Tl,cn,Mi,Ne,ng,vh,rg,ag,fd;class gf{constructor(t,e=0,i=0,s=!0){y(this,Ne);y(this,Tl);y(this,cn,[]);y(this,Mi,[]);let n=1/0,a=-1/0,o=1/0,l=-1/0;const d=10**-4;for(const{x:A,y:T,width:S,height:x}of t){const P=Math.floor((A-e)/d)*d,R=Math.ceil((A+S+e)/d)*d,M=Math.floor((T-e)/d)*d,L=Math.ceil((T+x+e)/d)*d,F=[P,M,L,!0],D=[R,M,L,!1];r(this,cn).push(F,D),n=Math.min(n,P),a=Math.max(a,R),o=Math.min(o,M),l=Math.max(l,L)}const f=a-n+2*i,u=l-o+2*i,p=n-i,g=o-i,b=r(this,cn).at(s?-1:-2),w=[b[0],b[2]];for(const A of r(this,cn)){const[T,S,x]=A;A[0]=(T-p)/f,A[1]=(S-g)/u,A[2]=(x-g)/u}m(this,Tl,{x:p,y:g,width:f,height:u,lastPoint:w})}getOutlines(){r(this,cn).sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of r(this,cn))e[3]?(t.push(...v(this,Ne,fd).call(this,e)),v(this,Ne,rg).call(this,e)):(v(this,Ne,ag).call(this,e),t.push(...v(this,Ne,fd).call(this,e)));return v(this,Ne,ng).call(this,t)}}Tl=new WeakMap,cn=new WeakMap,Mi=new WeakMap,Ne=new WeakSet,ng=function(t){const e=[],i=new Set;for(const a of t){const[o,l,c]=a;e.push([o,l,a],[o,c,a])}e.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=e.length;a<o;a+=2){const l=e[a][2],c=e[a+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const s=[];let n;for(;i.size>0;){const a=i.values().next().value;let[o,l,c,d,f]=a;i.delete(a);let u=o,p=l;for(n=[o,c],s.push(n);;){let g;if(i.has(d))g=d;else if(i.has(f))g=f;else break;i.delete(g),[o,l,c,d,f]=g,u!==o&&(n.push(u,p,o,p===l?l:c),u=o),p=p===l?c:l}n.push(u,p)}return new Oy(s,r(this,Tl))},vh=function(t){const e=r(this,Mi);let i=0,s=e.length-1;for(;i<=s;){const n=i+s>>1,a=e[n][0];if(a===t)return n;a<t?i=n+1:s=n-1}return s+1},rg=function([,t,e]){const i=v(this,Ne,vh).call(this,t);r(this,Mi).splice(i,0,[t,e])},ag=function([,t,e]){const i=v(this,Ne,vh).call(this,t);for(let s=i;s<r(this,Mi).length;s++){const[n,a]=r(this,Mi)[s];if(n!==t)break;if(n===t&&a===e){r(this,Mi).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[n,a]=r(this,Mi)[s];if(n!==t)break;if(n===t&&a===e){r(this,Mi).splice(s,1);return}}},fd=function(t){const[e,i,s]=t,n=[[e,i,s]],a=v(this,Ne,vh).call(this,s);for(let o=0;o<a;o++){const[l,c]=r(this,Mi)[o];for(let d=0,f=n.length;d<f;d++){const[,u,p]=n[d];if(!(c<=u||p<=l)){if(u>=l){if(p>c)n[d][1]=c;else{if(f===1)return[];n.splice(d,1),d--,f--}continue}n[d][2]=l,p>c&&n.push([e,c,p])}}}return n};var Cl,Da;class Oy extends Yp{constructor(e,i){super();y(this,Cl);y(this,Da);m(this,Da,e),m(this,Cl,i)}toSVGPath(){const e=[];for(const i of r(this,Da)){let[s,n]=i;e.push(`M${s} ${n}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===s?(e.push(`V${l}`),n=l):l===n&&(e.push(`H${o}`),s=o)}e.push("Z")}return e.join(" ")}serialize([e,i,s,n],a){const o=[],l=s-e,c=n-i;for(const d of r(this,Da)){const f=new Array(d.length);for(let u=0;u<d.length;u+=2)f[u]=e+d[u]*l,f[u+1]=n-d[u+1]*c;o.push(f)}return o}get box(){return r(this,Cl)}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}}Cl=new WeakMap,Da=new WeakMap;class pd extends Ih{newFreeDrawOutline(t,e,i,s,n,a){return new Ny(t,e,i,s,n,a)}get classNamesForDrawing(){return["highlight","free"]}}class Ny extends ig{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(t,e,i,s,n,a=0){return new pd(t,e,i,s,n,a)}}var Li,mr,Oa,ie,Pl,Na,Rl,kl,dn,Ii,Ba,Ml,Lt,gd,md,bd,Tn,og,Vs;const We=class We{constructor({editor:t=null,uiManager:e=null}){y(this,Lt);y(this,Li,null);y(this,mr,null);y(this,Oa);y(this,ie,null);y(this,Pl,!1);y(this,Na,!1);y(this,Rl,null);y(this,kl);y(this,dn,null);y(this,Ii,null);y(this,Ba);var i;t?(m(this,Na,!1),m(this,Ba,et.HIGHLIGHT_COLOR),m(this,Rl,t)):(m(this,Na,!0),m(this,Ba,et.HIGHLIGHT_DEFAULT_COLOR)),m(this,Ii,(t==null?void 0:t._uiManager)||e),m(this,kl,r(this,Ii)._eventBus),m(this,Oa,(t==null?void 0:t.color)||((i=r(this,Ii))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),r(We,Ml)||m(We,Ml,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return gt(this,"_keyboardManager",new Wl([[["Escape","mac+Escape"],We.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],We.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],We.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],We.prototype._moveToPrevious],[["Home","mac+Home"],We.prototype._moveToBeginning],[["End","mac+End"],We.prototype._moveToEnd]]))}renderButton(){const t=m(this,Li,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=r(this,Ii)._signal;t.addEventListener("click",v(this,Lt,Tn).bind(this),{signal:e}),t.addEventListener("keydown",v(this,Lt,bd).bind(this),{signal:e});const i=m(this,mr,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=r(this,Oa),t.append(i),t}renderMainDropdown(){const t=m(this,ie,v(this,Lt,gd).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===r(this,Li)){v(this,Lt,Tn).call(this,t);return}const e=t.target.getAttribute("data-color");e&&v(this,Lt,md).call(this,e,t)}_moveToNext(t){var e,i;if(!r(this,Lt,Vs)){v(this,Lt,Tn).call(this,t);return}if(t.target===r(this,Li)){(e=r(this,ie).firstChild)==null||e.focus();return}(i=t.target.nextSibling)==null||i.focus()}_moveToPrevious(t){var e,i;if(t.target===((e=r(this,ie))==null?void 0:e.firstChild)||t.target===r(this,Li)){r(this,Lt,Vs)&&this._hideDropdownFromKeyboard();return}r(this,Lt,Vs)||v(this,Lt,Tn).call(this,t),(i=t.target.previousSibling)==null||i.focus()}_moveToBeginning(t){var e;if(!r(this,Lt,Vs)){v(this,Lt,Tn).call(this,t);return}(e=r(this,ie).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!r(this,Lt,Vs)){v(this,Lt,Tn).call(this,t);return}(e=r(this,ie).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=r(this,ie))==null||t.classList.add("hidden"),(e=r(this,dn))==null||e.abort(),m(this,dn,null)}_hideDropdownFromKeyboard(){var t;if(!r(this,Na)){if(!r(this,Lt,Vs)){(t=r(this,Rl))==null||t.unselect();return}this.hideDropdown(),r(this,Li).focus({preventScroll:!0,focusVisible:r(this,Pl)})}}updateColor(t){if(r(this,mr)&&(r(this,mr).style.backgroundColor=t),!r(this,ie))return;const e=r(this,Ii).highlightColors.values();for(const i of r(this,ie).children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=r(this,Li))==null||t.remove(),m(this,Li,null),m(this,mr,null),(e=r(this,ie))==null||e.remove(),m(this,ie,null)}};Li=new WeakMap,mr=new WeakMap,Oa=new WeakMap,ie=new WeakMap,Pl=new WeakMap,Na=new WeakMap,Rl=new WeakMap,kl=new WeakMap,dn=new WeakMap,Ii=new WeakMap,Ba=new WeakMap,Ml=new WeakMap,Lt=new WeakSet,gd=function(){const t=document.createElement("div"),e=r(this,Ii)._signal;t.addEventListener("contextmenu",vi,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of r(this,Ii).highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",s),n.title=i,n.setAttribute("data-l10n-id",r(We,Ml)[i]);const a=document.createElement("span");n.append(a),a.className="swatch",a.style.backgroundColor=s,n.setAttribute("aria-selected",s===r(this,Oa)),n.addEventListener("click",v(this,Lt,md).bind(this,s),{signal:e}),t.append(n)}return t.addEventListener("keydown",v(this,Lt,bd).bind(this),{signal:e}),t},md=function(t,e){e.stopPropagation(),r(this,kl).dispatch("switchannotationeditorparams",{source:this,type:r(this,Ba),value:t})},bd=function(t){We._keyboardManager.exec(this,t)},Tn=function(t){if(r(this,Lt,Vs)){this.hideDropdown();return}if(m(this,Pl,t.detail===0),r(this,dn)||(m(this,dn,new AbortController),window.addEventListener("pointerdown",v(this,Lt,og).bind(this),{signal:r(this,Ii).combinedSignal(r(this,dn))})),r(this,ie)){r(this,ie).classList.remove("hidden");return}const e=m(this,ie,v(this,Lt,gd).call(this));r(this,Li).append(e)},og=function(t){var e;(e=r(this,ie))!=null&&e.contains(t.target)||this.hideDropdown()},Vs=function(){return r(this,ie)&&!r(this,ie).classList.contains("hidden")},y(We,Ml,null);let Fh=We;var Ha,Ll,xs,br,Wa,ui,Il,Fl,vr,Fi,xe,je,Ua,Ts,se,Va,fi,Dl,nt,vd,yh,lg,hg,cg,yd,Cn,mi,zr,dg,wh,go,ug,fg,pg,gg,mg;const _t=class _t extends Rt{constructor(e){super({...e,name:"highlightEditor"});y(this,nt);y(this,Ha,null);y(this,Ll,0);y(this,xs);y(this,br,null);y(this,Wa,null);y(this,ui,null);y(this,Il,null);y(this,Fl,0);y(this,vr,null);y(this,Fi,null);y(this,xe,null);y(this,je,!1);y(this,Ua,null);y(this,Ts);y(this,se,null);y(this,Va,"");y(this,fi);y(this,Dl,"");this.color=e.color||_t._defaultColor,m(this,fi,e.thickness||_t._defaultThickness),m(this,Ts,e.opacity||_t._defaultOpacity),m(this,xs,e.boxes||null),m(this,Dl,e.methodOfCreation||""),m(this,Va,e.text||""),this._isDraggable=!1,e.highlightId>-1?(m(this,je,!0),v(this,nt,yh).call(this,e),v(this,nt,Cn).call(this)):r(this,xs)&&(m(this,Ha,e.anchorNode),m(this,Ll,e.anchorOffset),m(this,Il,e.focusNode),m(this,Fl,e.focusOffset),v(this,nt,vd).call(this),v(this,nt,Cn).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=_t.prototype;return gt(this,"_keyboardManager",new Wl([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:r(this,je)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:r(this,fi),methodOfCreation:r(this,Dl)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,i){var s;Rt.initialize(e,i),_t._defaultColor||(_t._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(e,i){switch(e){case et.HIGHLIGHT_DEFAULT_COLOR:_t._defaultColor=i;break;case et.HIGHLIGHT_THICKNESS:_t._defaultThickness=i;break}}translateInPage(e,i){}get toolbarPosition(){return r(this,Ua)}updateParams(e,i){switch(e){case et.HIGHLIGHT_COLOR:v(this,nt,lg).call(this,i);break;case et.HIGHLIGHT_THICKNESS:v(this,nt,hg).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[et.HIGHLIGHT_DEFAULT_COLOR,_t._defaultColor],[et.HIGHLIGHT_THICKNESS,_t._defaultThickness]]}get propertiesToUpdate(){return[[et.HIGHLIGHT_COLOR,this.color||_t._defaultColor],[et.HIGHLIGHT_THICKNESS,r(this,fi)||_t._defaultThickness],[et.HIGHLIGHT_FREE,r(this,je)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(m(this,Wa,new Fh({editor:this})),e.addColorPicker(r(this,Wa))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(v(this,nt,go).call(this))}getBaseTranslation(){return[0,0]}getRect(e,i){return super.getRect(e,i,v(this,nt,go).call(this))}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){v(this,nt,yd).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(v(this,nt,Cn).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var s;let i=!1;this.parent&&!e?v(this,nt,yd).call(this):e&&(v(this,nt,Cn).call(this,e),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),i&&this.select()}rotate(e){var n,a,o;const{drawLayer:i}=this.parent;let s;r(this,je)?(e=(e-this.rotation+360)%360,s=v(n=_t,mi,zr).call(n,r(this,Fi).box,e)):s=v(a=_t,mi,zr).call(a,this,e),i.rotate(r(this,xe),e),i.rotate(r(this,se),e),i.updateBox(r(this,xe),s),i.updateBox(r(this,se),v(o=_t,mi,zr).call(o,r(this,ui).box,e))}render(){if(this.div)return this.div;const e=super.render();r(this,Va)&&(e.setAttribute("aria-label",r(this,Va)),e.setAttribute("role","mark")),r(this,je)?e.classList.add("free"):this.div.addEventListener("keydown",v(this,nt,dg).bind(this),{signal:this._uiManager._signal});const i=m(this,vr,document.createElement("div"));e.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=r(this,br);const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),Mh(this,r(this,vr),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent.drawLayer.addClass(r(this,se),"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(r(this,se),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:v(this,nt,wh).call(this,!0);break;case 1:case 3:v(this,nt,wh).call(this,!1);break}}select(){var e,i;super.select(),r(this,se)&&((e=this.parent)==null||e.drawLayer.removeClass(r(this,se),"hovered"),(i=this.parent)==null||i.drawLayer.addClass(r(this,se),"selected"))}unselect(){var e;super.unselect(),r(this,se)&&((e=this.parent)==null||e.drawLayer.removeClass(r(this,se),"selected"),r(this,je)||v(this,nt,wh).call(this,!1))}get _mustFixPosition(){return!r(this,je)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(r(this,xe),e),this.parent.drawLayer.show(r(this,se),e))}static startHighlighting(e,i,{target:s,x:n,y:a}){const{x:o,y:l,width:c,height:d}=s.getBoundingClientRect(),f=new AbortController,u=e.combinedSignal(f),p=b=>{b.preventDefault(),b.stopPropagation()},g=b=>{f.abort(),v(this,mi,gg).call(this,e,b)};window.addEventListener("blur",g,{signal:u}),window.addEventListener("pointerup",g,{signal:u}),window.addEventListener("pointerdown",p,{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",vi,{signal:u}),s.addEventListener("pointermove",v(this,mi,pg).bind(this,e),{signal:u}),this._freeHighlight=new pd({x:n,y:a},[o,l,c,d],e.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static async deserialize(e,i,s){var b,w,A,T;let n=null;if(e instanceof Up){const{data:{quadPoints:S,rect:x,rotation:P,id:R,color:M,opacity:L,popupRef:F},parent:{page:{pageNumber:D}}}=e;n=e={annotationType:at.HIGHLIGHT,color:Array.from(M),opacity:L,quadPoints:S,boxes:null,pageIndex:D-1,rect:x.slice(0),rotation:P,id:R,deleted:!1,popupRef:F}}else if(e instanceof su){const{data:{inkLists:S,rect:x,rotation:P,id:R,color:M,borderStyle:{rawWidth:L},popupRef:F},parent:{page:{pageNumber:D}}}=e;n=e={annotationType:at.HIGHLIGHT,color:Array.from(M),thickness:L,inkLists:S,boxes:null,pageIndex:D-1,rect:x.slice(0),rotation:P,id:R,deleted:!1,popupRef:F}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=e,d=await super.deserialize(e,i,s);d.color=z.makeHexColor(...a),m(d,Ts,c||1),l&&m(d,fi,e.thickness),d.annotationElementId=e.id||null,d._initialData=n;const[f,u]=d.pageDimensions,[p,g]=d.pageTranslation;if(o){const S=m(d,xs,[]);for(let x=0;x<o.length;x+=8)S.push({x:(o[x]-p)/f,y:1-(o[x+1]-g)/u,width:(o[x+2]-o[x])/f,height:(o[x+1]-o[x+5])/u});v(b=d,nt,vd).call(b),v(w=d,nt,Cn).call(w),d.rotate(d.rotation)}else if(l){m(d,je,!0);const S=l[0],x={x:S[0]-p,y:u-(S[1]-g)},P=new pd(x,[0,0,f,u],1,r(d,fi)/2,!0,.001);for(let L=0,F=S.length;L<F;L+=2)x.x=S[L]-p,x.y=u-(S[L+1]-g),P.add(x);const{id:R,clipPathId:M}=i.drawLayer.draw(P,d.color,d._defaultOpacity,!0);v(A=d,nt,yh).call(A,{highlightOutlines:P.getOutlines(),highlightId:R,clipPathId:M}),v(T=d,nt,Cn).call(T)}return d}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=Rt._colorManager.convert(this.color),n={annotationType:at.HIGHLIGHT,color:s,opacity:r(this,Ts),thickness:r(this,fi),quadPoints:v(this,nt,ug).call(this),outlines:v(this,nt,fg).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:v(this,nt,go).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!v(this,nt,mg).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ha=new WeakMap,Ll=new WeakMap,xs=new WeakMap,br=new WeakMap,Wa=new WeakMap,ui=new WeakMap,Il=new WeakMap,Fl=new WeakMap,vr=new WeakMap,Fi=new WeakMap,xe=new WeakMap,je=new WeakMap,Ua=new WeakMap,Ts=new WeakMap,se=new WeakMap,Va=new WeakMap,fi=new WeakMap,Dl=new WeakMap,nt=new WeakSet,vd=function(){const e=new gf(r(this,xs),.001);m(this,Fi,e.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=r(this,Fi).box;const i=new gf(r(this,xs),.0025,.001,this._uiManager.direction==="ltr");m(this,ui,i.getOutlines());const{lastPoint:s}=r(this,ui).box;m(this,Ua,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},yh=function({highlightOutlines:e,highlightId:i,clipPathId:s}){var f,u;if(m(this,Fi,e),m(this,ui,e.getNewOutline(r(this,fi)/2+1.5,.0025)),i>=0)m(this,xe,i),m(this,br,s),this.parent.drawLayer.finalizeLine(i,e),m(this,se,this.parent.drawLayer.drawOutline(r(this,ui)));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(r(this,xe),e),this.parent.drawLayer.updateBox(r(this,xe),v(f=_t,mi,zr).call(f,r(this,Fi).box,(p-this.rotation+360)%360)),this.parent.drawLayer.updateLine(r(this,se),r(this,ui)),this.parent.drawLayer.updateBox(r(this,se),v(u=_t,mi,zr).call(u,r(this,ui).box,p))}const{x:a,y:o,width:l,height:c}=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[p,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*g/p,this.height=c*p/g;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[p,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*g/p,this.height=c*p/g;break}}const{lastPoint:d}=r(this,ui).box;m(this,Ua,[(d[0]-a)/l,(d[1]-o)/c])},lg=function(e){const i=(a,o)=>{var l,c,d;this.color=a,(l=this.parent)==null||l.drawLayer.changeColor(r(this,xe),a),(c=r(this,Wa))==null||c.updateColor(a),m(this,Ts,o),(d=this.parent)==null||d.drawLayer.changeOpacity(r(this,xe),o)},s=this.color,n=r(this,Ts);this.addCommands({cmd:i.bind(this,e,_t._defaultOpacity),undo:i.bind(this,s,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},hg=function(e){const i=r(this,fi),s=n=>{m(this,fi,n),v(this,nt,cg).call(this,n)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},cg=function(e){if(!r(this,je))return;v(this,nt,yh).call(this,{highlightOutlines:r(this,Fi).getNewOutline(e/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},yd=function(){r(this,xe)===null||!this.parent||(this.parent.drawLayer.remove(r(this,xe)),m(this,xe,null),this.parent.drawLayer.remove(r(this,se)),m(this,se,null))},Cn=function(e=this.parent){r(this,xe)===null&&({id:Me(this,xe)._,clipPathId:Me(this,br)._}=e.drawLayer.draw(r(this,Fi),this.color,r(this,Ts)),m(this,se,e.drawLayer.drawOutline(r(this,ui))),r(this,vr)&&(r(this,vr).style.clipPath=r(this,br)))},mi=new WeakSet,zr=function({x:e,y:i,width:s,height:n},a){switch(a){case 90:return{x:1-i-n,y:e,width:n,height:s};case 180:return{x:1-e-s,y:1-i-n,width:s,height:n};case 270:return{x:i,y:1-e-s,width:n,height:s}}return{x:e,y:i,width:s,height:n}},dg=function(e){_t._keyboardManager.exec(this,e)},wh=function(e){if(!r(this,Ha))return;const i=window.getSelection();e?i.setPosition(r(this,Ha),r(this,Ll)):i.setPosition(r(this,Il),r(this,Fl))},go=function(){return r(this,je)?this.rotation:0},ug=function(){if(r(this,je))return null;const[e,i]=this.pageDimensions,[s,n]=this.pageTranslation,a=r(this,xs),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:d,width:f,height:u}of a){const p=c*e+s,g=(1-d-u)*i+n;o[l]=o[l+4]=p,o[l+1]=o[l+3]=g,o[l+2]=o[l+6]=p+f*e,o[l+5]=o[l+7]=g+u*i,l+=8}return o},fg=function(e){return r(this,Fi).serialize(e,v(this,nt,go).call(this))},pg=function(e,i){this._freeHighlight.add(i)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},gg=function(e,i){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},mg=function(e){const{color:i}=this._initialData;return e.color.some((s,n)=>s!==i[n])},y(_t,mi),Z(_t,"_defaultColor",null),Z(_t,"_defaultOpacity",1),Z(_t,"_defaultThickness",12),Z(_t,"_type","highlight"),Z(_t,"_editorType",at.HIGHLIGHT),Z(_t,"_freeHighlightId",-1),Z(_t,"_freeHighlight",null),Z(_t,"_freeHighlightClipId","");let Dh=_t;var yr,wr,Ji,Cs,pi,Ar,_r,Er,Ps,ja,Sr,xr,un,N,bg,vg,yg,wg,Ad,Ag,_d,_g,Eg,Sg,xg,Tg,Pn,Ed,Sd,xd,Ah,_h,$r,Td,Eh,Hs,Cg,Cd,Pg,Rg,Pd,Sh,mo;const Wt=class Wt extends Rt{constructor(e){super({...e,name:"inkEditor"});y(this,N);y(this,yr,0);y(this,wr,0);y(this,Ji,null);y(this,Cs,new Path2D);y(this,pi,!1);y(this,Ar,null);y(this,_r,!1);y(this,Er,!1);y(this,Ps,null);y(this,ja,null);y(this,Sr,0);y(this,xr,0);y(this,un,null);this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,i){Rt.initialize(e,i)}static updateDefaultParams(e,i){switch(e){case et.INK_THICKNESS:Wt._defaultThickness=i;break;case et.INK_COLOR:Wt._defaultColor=i;break;case et.INK_OPACITY:Wt._defaultOpacity=i/100;break}}updateParams(e,i){switch(e){case et.INK_THICKNESS:v(this,N,bg).call(this,i);break;case et.INK_COLOR:v(this,N,vg).call(this,i);break;case et.INK_OPACITY:v(this,N,yg).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[et.INK_THICKNESS,Wt._defaultThickness],[et.INK_COLOR,Wt._defaultColor||Rt._defaultLineColor],[et.INK_OPACITY,Math.round(Wt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[et.INK_THICKNESS,this.thickness||Wt._defaultThickness],[et.INK_COLOR,this.color||Wt._defaultColor||Rt._defaultLineColor],[et.INK_OPACITY,Math.round(100*(this.opacity??Wt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(v(this,N,Ah).call(this),v(this,N,_h).call(this)),this.isAttachedToDOM||(this.parent.add(this),v(this,N,$r).call(this)),v(this,N,mo).call(this)))}remove(){var e;this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,r(this,Ji)&&(clearTimeout(r(this,Ji)),m(this,Ji,null)),(e=r(this,Ps))==null||e.disconnect(),m(this,Ps,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,i]=this.parentDimensions,s=this.width*e,n=this.height*i;this.setDimensions(s,n)}enableEditMode(){r(this,pi)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,v(this,N,Ed).call(this))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),v(this,N,Sd).call(this))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){r(this,pi)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),m(this,pi,!0),this.div.classList.add("disabled"),v(this,N,mo).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||r(this,pi)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),v(this,N,Ag).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),v(this,N,_d).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),v(this,N,xd).call(this,e)}canvasPointerleave(e){v(this,N,xd).call(this,e)}get isResizable(){return!this.isEmpty()&&r(this,pi)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[s,n,a,o]=v(this,N,wg).call(this);if(this.setAt(s,n,0,0),this.setDims(a,o),v(this,N,Ah).call(this),this.width){const[l,c]=this.parentDimensions;this.setAspectRatio(this.width*l,this.height*c),this.setAt(e*l,i*c,this.width*l,this.height*c),m(this,Er,!0),v(this,N,$r).call(this),this.setDims(this.width*l,this.height*c),v(this,N,Pn).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return v(this,N,_h).call(this),this.div}setDimensions(e,i){const s=Math.round(e),n=Math.round(i);if(r(this,Sr)===s&&r(this,xr)===n)return;m(this,Sr,s),m(this,xr,n),this.canvas.style.visibility="hidden";const[a,o]=this.parentDimensions;this.width=e/a,this.height=i/o,this.fixAndSetPosition(),r(this,pi)&&v(this,N,Td).call(this,e,i),v(this,N,$r).call(this),v(this,N,Pn).call(this),this.canvas.style.visibility="visible",this.fixDims()}static async deserialize(e,i,s){var w,A,T;if(e instanceof su)return null;const n=await super.deserialize(e,i,s);n.thickness=e.thickness,n.color=z.makeHexColor(...e.color),n.opacity=e.opacity;const[a,o]=n.pageDimensions,l=n.width*a,c=n.height*o,d=n.parentScale,f=e.thickness/2;m(n,pi,!0),m(n,Sr,Math.round(l)),m(n,xr,Math.round(c));const{paths:u,rect:p,rotation:g}=e;for(let{bezier:S}of u){S=v(w=Wt,Hs,Pg).call(w,S,p,g);const x=[];n.paths.push(x);let P=d*(S[0]-f),R=d*(S[1]-f);for(let L=2,F=S.length;L<F;L+=6){const D=d*(S[L]-f),H=d*(S[L+1]-f),st=d*(S[L+2]-f),q=d*(S[L+3]-f),$=d*(S[L+4]-f),J=d*(S[L+5]-f);x.push([[P,R],[D,H],[st,q],[$,J]]),P=$,R=J}const M=v(this,Hs,Cg).call(this,x);n.bezierPath2D.push(M)}const b=v(A=n,N,Pd).call(A);return m(n,wr,Math.max(Rt.MIN_SIZE,b[2]-b[0])),m(n,yr,Math.max(Rt.MIN_SIZE,b[3]-b[1])),v(T=n,N,Td).call(T,l,c),n}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),i=Rt._colorManager.convert(this.ctx.strokeStyle);return{annotationType:at.INK,color:i,thickness:this.thickness,opacity:this.opacity,paths:v(this,N,Rg).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};yr=new WeakMap,wr=new WeakMap,Ji=new WeakMap,Cs=new WeakMap,pi=new WeakMap,Ar=new WeakMap,_r=new WeakMap,Er=new WeakMap,Ps=new WeakMap,ja=new WeakMap,Sr=new WeakMap,xr=new WeakMap,un=new WeakMap,N=new WeakSet,bg=function(e){const i=n=>{this.thickness=n,v(this,N,mo).call(this)},s=this.thickness;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},vg=function(e){const i=n=>{this.color=n,v(this,N,Pn).call(this)},s=this.color;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},yg=function(e){const i=n=>{this.opacity=n,v(this,N,Pn).call(this)};e/=100;const s=this.opacity;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},wg=function(){const{parentRotation:e,parentDimensions:[i,s]}=this;switch(e){case 90:return[0,s,s,i];case 180:return[i,s,i,s];case 270:return[i,0,s,i];default:return[0,0,i,s]}},Ad=function(){const{ctx:e,color:i,opacity:s,thickness:n,parentScale:a,scaleFactor:o}=this;e.lineWidth=n*a/o,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${i}${rv(s)}`},Ag=function(e,i){this.canvas.addEventListener("contextmenu",vi,{signal:this._uiManager._signal}),v(this,N,Sd).call(this),m(this,Ar,new AbortController);const s=this._uiManager.combinedSignal(r(this,Ar));this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:s}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:s}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:s}),this.isEditing=!0,r(this,Er)||(m(this,Er,!0),v(this,N,$r).call(this),this.thickness||(this.thickness=Wt._defaultThickness),this.color||(this.color=Wt._defaultColor||Rt._defaultLineColor),this.opacity??(this.opacity=Wt._defaultOpacity)),this.currentPath.push([e,i]),m(this,_r,!1),v(this,N,Ad).call(this),m(this,un,()=>{v(this,N,Sg).call(this),r(this,un)&&window.requestAnimationFrame(r(this,un))}),window.requestAnimationFrame(r(this,un))},_d=function(e,i){const[s,n]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===s&&i===n)return;const a=this.currentPath;let o=r(this,Cs);if(a.push([e,i]),m(this,_r,!0),a.length<=2){o.moveTo(...a[0]),o.lineTo(e,i);return}a.length===3&&(m(this,Cs,o=new Path2D),o.moveTo(...a[0])),v(this,N,xg).call(this,o,...a.at(-3),...a.at(-2),e,i)},_g=function(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);r(this,Cs).lineTo(...e)},Eg=function(e,i){m(this,un,null),e=Math.min(Math.max(e,0),this.canvas.width),i=Math.min(Math.max(i,0),this.canvas.height),v(this,N,_d).call(this,e,i),v(this,N,_g).call(this);let s;if(this.currentPath.length!==1)s=v(this,N,Tg).call(this);else{const c=[e,i];s=[[c,c.slice(),c.slice(),c]]}const n=r(this,Cs),a=this.currentPath;this.currentPath=[],m(this,Cs,new Path2D);const o=()=>{this.allRawPaths.push(a),this.paths.push(s),this.bezierPath2D.push(n),this._uiManager.rebuild(this)},l=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(v(this,N,Ah).call(this),v(this,N,_h).call(this)),v(this,N,mo).call(this))};this.addCommands({cmd:o,undo:l,mustExec:!0})},Sg=function(){if(!r(this,_r))return;m(this,_r,!1);const e=Math.ceil(this.thickness*this.parentScale),i=this.currentPath.slice(-3),s=i.map(o=>o[0]),n=i.map(o=>o[1]);Math.min(...s)-e,Math.max(...s)+e,Math.min(...n)-e,Math.max(...n)+e;const{ctx:a}=this;a.save(),a.clearRect(0,0,this.canvas.width,this.canvas.height);for(const o of this.bezierPath2D)a.stroke(o);a.stroke(r(this,Cs)),a.restore()},xg=function(e,i,s,n,a,o,l){const c=(i+n)/2,d=(s+a)/2,f=(n+o)/2,u=(a+l)/2;e.bezierCurveTo(c+2*(n-c)/3,d+2*(a-d)/3,f+2*(n-f)/3,u+2*(a-u)/3,f,u)},Tg=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const i=[];let s,[n,a]=e[0];for(s=1;s<e.length-2;s++){const[p,g]=e[s],[b,w]=e[s+1],A=(p+b)/2,T=(g+w)/2,S=[n+2*(p-n)/3,a+2*(g-a)/3],x=[A+2*(p-A)/3,T+2*(g-T)/3];i.push([[n,a],S,x,[A,T]]),[n,a]=[A,T]}const[o,l]=e[s],[c,d]=e[s+1],f=[n+2*(o-n)/3,a+2*(l-a)/3],u=[c+2*(o-c)/3,d+2*(l-d)/3];return i.push([[n,a],f,u,[c,d]]),i},Pn=function(){if(this.isEmpty()){v(this,N,Eh).call(this);return}v(this,N,Ad).call(this);const{canvas:e,ctx:i}=this;i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),v(this,N,Eh).call(this);for(const s of this.bezierPath2D)i.stroke(s)},Ed=function(){if(r(this,ja))return;m(this,ja,new AbortController);const e=this._uiManager.combinedSignal(r(this,ja));this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})},Sd=function(){var e;(e=this.pointerdownAC)==null||e.abort(),this.pointerdownAC=null},xd=function(e){var i;(i=r(this,Ar))==null||i.abort(),m(this,Ar,null),v(this,N,Ed).call(this),r(this,Ji)&&clearTimeout(r(this,Ji)),m(this,Ji,setTimeout(()=>{m(this,Ji,null),this.canvas.removeEventListener("contextmenu",vi)},10)),v(this,N,Eg).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Ah=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},_h=function(){m(this,Ps,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&this.setDimensions(i.width,i.height)})),r(this,Ps).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=r(this,Ps))==null||e.disconnect(),m(this,Ps,null)},{once:!0})},$r=function(){if(!r(this,Er))return;const[e,i]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*i),v(this,N,Eh).call(this)},Td=function(e,i){const s=v(this,N,Sh).call(this),n=(e-s)/r(this,wr),a=(i-s)/r(this,yr);this.scaleFactor=Math.min(n,a)},Eh=function(){const e=v(this,N,Sh).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},Hs=new WeakSet,Cg=function(e){const i=new Path2D;for(let s=0,n=e.length;s<n;s++){const[a,o,l,c]=e[s];s===0&&i.moveTo(...a),i.bezierCurveTo(o[0],o[1],l[0],l[1],c[0],c[1])}return i},Cd=function(e,i,s){const[n,a,o,l]=i;switch(s){case 0:for(let c=0,d=e.length;c<d;c+=2)e[c]+=n,e[c+1]=l-e[c+1];break;case 90:for(let c=0,d=e.length;c<d;c+=2){const f=e[c];e[c]=e[c+1]+n,e[c+1]=f+a}break;case 180:for(let c=0,d=e.length;c<d;c+=2)e[c]=o-e[c],e[c+1]+=a;break;case 270:for(let c=0,d=e.length;c<d;c+=2){const f=e[c];e[c]=o-e[c+1],e[c+1]=l-f}break;default:throw new Error("Invalid rotation")}return e},Pg=function(e,i,s){const[n,a,o,l]=i;switch(s){case 0:for(let c=0,d=e.length;c<d;c+=2)e[c]-=n,e[c+1]=l-e[c+1];break;case 90:for(let c=0,d=e.length;c<d;c+=2){const f=e[c];e[c]=e[c+1]-a,e[c+1]=f-n}break;case 180:for(let c=0,d=e.length;c<d;c+=2)e[c]=o-e[c],e[c+1]-=a;break;case 270:for(let c=0,d=e.length;c<d;c+=2){const f=e[c];e[c]=l-e[c+1],e[c+1]=o-f}break;default:throw new Error("Invalid rotation")}return e},Rg=function(e,i,s,n){var d,f;const a=[],o=this.thickness/2,l=e*i+o,c=e*s+o;for(const u of this.paths){const p=[],g=[];for(let b=0,w=u.length;b<w;b++){const[A,T,S,x]=u[b];if(A[0]===x[0]&&A[1]===x[1]&&w===1){const q=e*A[0]+l,$=e*A[1]+c;p.push(q,$),g.push(q,$);break}const P=e*A[0]+l,R=e*A[1]+c,M=e*T[0]+l,L=e*T[1]+c,F=e*S[0]+l,D=e*S[1]+c,H=e*x[0]+l,st=e*x[1]+c;b===0&&(p.push(P,R),g.push(P,R)),p.push(M,L,F,D,H,st),g.push(M,L),b===w-1&&g.push(H,st)}a.push({bezier:v(d=Wt,Hs,Cd).call(d,p,n,this.rotation),points:v(f=Wt,Hs,Cd).call(f,g,n,this.rotation)})}return a},Pd=function(){let e=1/0,i=-1/0,s=1/0,n=-1/0;for(const a of this.paths)for(const[o,l,c,d]of a){const f=z.bezierBoundingBox(...o,...l,...c,...d);e=Math.min(e,f[0]),s=Math.min(s,f[1]),i=Math.max(i,f[2]),n=Math.max(n,f[3])}return[e,s,i,n]},Sh=function(){return r(this,pi)?Math.ceil(this.thickness*this.parentScale):0},mo=function(e=!1){if(this.isEmpty())return;if(!r(this,pi)){v(this,N,Pn).call(this);return}const i=v(this,N,Pd).call(this),s=v(this,N,Sh).call(this);m(this,wr,Math.max(Rt.MIN_SIZE,i[2]-i[0])),m(this,yr,Math.max(Rt.MIN_SIZE,i[3]-i[1]));const n=Math.ceil(s+r(this,wr)*this.scaleFactor),a=Math.ceil(s+r(this,yr)*this.scaleFactor),[o,l]=this.parentDimensions;this.width=n/o,this.height=a/l,this.setAspectRatio(n,a);const c=this.translationX,d=this.translationY;this.translationX=-i[0],this.translationY=-i[1],v(this,N,$r).call(this),v(this,N,Pn).call(this),m(this,Sr,n),m(this,xr,a),this.setDims(n,a);const f=e?s/this.scaleFactor/2:0;this.translate(c-this.translationX-f,d-this.translationY-f)},y(Wt,Hs),Z(Wt,"_defaultColor",null),Z(Wt,"_defaultOpacity",1),Z(Wt,"_defaultThickness",1),Z(Wt,"_type","ink"),Z(Wt,"_editorType",at.INK);let wd=Wt;var Vt,be,fn,Rs,pn,za,Zi,ks,ts,ei,$a,pt,bo,vo,xh,kd,kg,Th,Md,Ch,Mg,Lg;const Ao=class Ao extends Rt{constructor(e){super({...e,name:"stampEditor"});y(this,pt);y(this,Vt,null);y(this,be,null);y(this,fn,null);y(this,Rs,null);y(this,pn,null);y(this,za,"");y(this,Zi,null);y(this,ks,null);y(this,ts,null);y(this,ei,!1);y(this,$a,!1);m(this,Rs,e.bitmapUrl),m(this,pn,e.bitmapFile)}static initialize(e,i){Rt.initialize(e,i)}static get supportedTypes(){return gt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return gt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,i){i.pasteEditor(at.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const i=e.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(e=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:a,height:o}=e||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:n,width:a,height:o,channels:n.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),i&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var e,i;r(this,be)&&(m(this,Vt,null),this._uiManager.imageManager.deleteId(r(this,be)),(e=r(this,Zi))==null||e.remove(),m(this,Zi,null),(i=r(this,ks))==null||i.disconnect(),m(this,ks,null),r(this,ts)&&(clearTimeout(r(this,ts)),m(this,ts,null))),super.remove()}rebuild(){if(!this.parent){r(this,be)&&v(this,pt,xh).call(this);return}super.rebuild(),this.div!==null&&(r(this,be)&&r(this,Zi)===null&&v(this,pt,xh).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(r(this,fn)||r(this,Vt)||r(this,Rs)||r(this,pn)||r(this,be))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,i;if(this.width&&(e=this.x,i=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),r(this,Vt)?v(this,pt,kd).call(this):v(this,pt,xh).call(this),this.width&&!this.annotationElementId){const[s,n]=this.parentDimensions;this.setAt(e*s,i*n,this.width*s,this.height*n)}return this.div}copyCanvas(e,i,s=!1){var p;e||(e=224);const{width:n,height:a}=r(this,Vt),o=new xc;let l=r(this,Vt),c=n,d=a,f=null;if(i){if(n>i||a>i){const L=Math.min(i/n,i/a);c=Math.floor(n*L),d=Math.floor(a*L)}f=document.createElement("canvas");const g=f.width=Math.ceil(c*o.sx),b=f.height=Math.ceil(d*o.sy);r(this,ei)||(l=v(this,pt,Th).call(this,g,b));const w=f.getContext("2d");w.filter=this._uiManager.hcmFilter;let A="white",T="#cfcfd8";this._uiManager.hcmFilter!=="none"?T="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(A="#8f8f9d",T="#42414d");const S=15,x=S*o.sx,P=S*o.sy,R=new OffscreenCanvas(x*2,P*2),M=R.getContext("2d");M.fillStyle=A,M.fillRect(0,0,x*2,P*2),M.fillStyle=T,M.fillRect(0,0,x,P),M.fillRect(x,P,x,P),w.fillStyle=w.createPattern(R,"repeat"),w.fillRect(0,0,g,b),w.drawImage(l,0,0,l.width,l.height,0,0,g,b)}let u=null;if(s){let g,b;if(o.symmetric&&l.width<e&&l.height<e)g=l.width,b=l.height;else if(l=r(this,Vt),n>e||a>e){const T=Math.min(e/n,e/a);g=Math.floor(n*T),b=Math.floor(a*T),r(this,ei)||(l=v(this,pt,Th).call(this,g,b))}const A=new OffscreenCanvas(g,b).getContext("2d",{willReadFrequently:!0});A.drawImage(l,0,0,l.width,l.height,0,0,g,b),u={width:g,height:b,data:A.getImageData(0,0,g,b).data}}return{canvas:f,width:c,height:d,imageData:u}}getImageForAltText(){return r(this,Zi)}static async deserialize(e,i,s){var b;let n=null;if(e instanceof Vp){const{data:{rect:w,rotation:A,id:T,structParent:S,popupRef:x},container:P,parent:{page:{pageNumber:R}}}=e,M=P.querySelector("canvas"),L=s.imageManager.getFromCanvas(P.id,M);M.remove();const F=((b=await i._structTree.getAriaAttributes(`${Gd}${T}`))==null?void 0:b.get("aria-label"))||"";n=e={annotationType:at.STAMP,bitmapId:L.id,bitmap:L.bitmap,pageIndex:R-1,rect:w.slice(0),rotation:A,id:T,deleted:!1,accessibilityData:{decorative:!1,altText:F},isSvg:!1,structParent:S,popupRef:x}}const a=await super.deserialize(e,i,s),{rect:o,bitmap:l,bitmapUrl:c,bitmapId:d,isSvg:f,accessibilityData:u}=e;d&&s.imageManager.isValidId(d)?(m(a,be,d),l&&m(a,Vt,l)):m(a,Rs,c),m(a,ei,f);const[p,g]=a.pageDimensions;return a.width=(o[2]-o[0])/p,a.height=(o[3]-o[1])/g,a.annotationElementId=e.id||null,u&&(a.altTextData=u),a._initialData=n,m(a,$a,!!n),a}serialize(e=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:at.STAMP,bitmapId:r(this,be),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:r(this,ei),structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=v(this,pt,Ch).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:n,altText:a}=this.serializeAltText(!1);if(!n&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=v(this,pt,Lg).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const o=r(this,ei)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(r(this,be)))i.stamps.set(r(this,be),{area:o,serialized:s}),s.bitmap=v(this,pt,Ch).call(this,!1);else if(r(this,ei)){const l=i.stamps.get(r(this,be));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=v(this,pt,Ch).call(this,!1))}return s}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}};Vt=new WeakMap,be=new WeakMap,fn=new WeakMap,Rs=new WeakMap,pn=new WeakMap,za=new WeakMap,Zi=new WeakMap,ks=new WeakMap,ts=new WeakMap,ei=new WeakMap,$a=new WeakMap,pt=new WeakSet,bo=function(e,i=!1){if(!e){this.remove();return}m(this,Vt,e.bitmap),i||(m(this,be,e.id),m(this,ei,e.isSvg)),e.file&&m(this,za,e.file.name),v(this,pt,kd).call(this)},vo=function(){if(m(this,fn,null),this._uiManager.enableWaiting(!1),!!r(this,Zi)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Vt)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Vt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},xh=function(){if(r(this,be)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(r(this,be)).then(s=>v(this,pt,bo).call(this,s,!0)).finally(()=>v(this,pt,vo).call(this));return}if(r(this,Rs)){const s=r(this,Rs);m(this,Rs,null),this._uiManager.enableWaiting(!0),m(this,fn,this._uiManager.imageManager.getFromUrl(s).then(n=>v(this,pt,bo).call(this,n)).finally(()=>v(this,pt,vo).call(this)));return}if(r(this,pn)){const s=r(this,pn);m(this,pn,null),this._uiManager.enableWaiting(!0),m(this,fn,this._uiManager.imageManager.getFromFile(s).then(n=>v(this,pt,bo).call(this,n)).finally(()=>v(this,pt,vo).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Ao.supportedTypesStr;const i=this._uiManager._signal;m(this,fn,new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),v(this,pt,bo).call(this,n)}s()},{signal:i}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>v(this,pt,vo).call(this))),e.click()},kd=function(){const{div:e}=this;let{width:i,height:s}=r(this,Vt);const[n,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*n,s=this.height*a;else if(i>o*n||s>o*a){const f=Math.min(o*n/i,o*a/s);i*=f,s*=f}const[l,c]=this.parentDimensions;this.setDims(i*l/n,s*c/a),this._uiManager.enableWaiting(!1);const d=m(this,Zi,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),v(this,pt,Md).call(this,i,s),v(this,pt,Mg).call(this),r(this,$a)||(this.parent.addUndoableEditor(this),m(this,$a,!0)),this._reportTelemetry({action:"inserted_image"}),r(this,za)&&d.setAttribute("aria-label",r(this,za))},kg=function(e,i){var o;const[s,n]=this.parentDimensions;this.width=e/s,this.height=i/n,(o=this._initialOptions)!=null&&o.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,r(this,ts)!==null&&clearTimeout(r(this,ts)),m(this,ts,setTimeout(()=>{m(this,ts,null),v(this,pt,Md).call(this,e,i)},200))},Th=function(e,i){const{width:s,height:n}=r(this,Vt);let a=s,o=n,l=r(this,Vt);for(;a>2*e||o>2*i;){const c=a,d=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,c,d,0,0,a,o),l=f.transferToImageBitmap()}return l},Md=function(e,i){const s=new xc,n=Math.ceil(e*s.sx),a=Math.ceil(i*s.sy),o=r(this,Zi);if(!o||o.width===n&&o.height===a)return;o.width=n,o.height=a;const l=r(this,ei)?r(this,Vt):v(this,pt,Th).call(this,n,a),c=o.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,n,a)},Ch=function(e){if(e){if(r(this,ei)){const n=this._uiManager.imageManager.getSvgUrl(r(this,be));if(n)return n}const i=document.createElement("canvas");return{width:i.width,height:i.height}=r(this,Vt),i.getContext("2d").drawImage(r(this,Vt),0,0),i.toDataURL()}if(r(this,ei)){const[i,s]=this.pageDimensions,n=Math.round(this.width*i*vn.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*vn.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(n,a);return o.getContext("2d").drawImage(r(this,Vt),0,0,r(this,Vt).width,r(this,Vt).height,0,0,n,a),o.transferToImageBitmap()}return structuredClone(r(this,Vt))},Mg=function(){this._uiManager._signal&&(m(this,ks,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&v(this,pt,kg).call(this,i.width,i.height)})),r(this,ks).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=r(this,ks))==null||e.disconnect(),m(this,ks,null)},{once:!0}))},Lg=function(e){var c;const{rect:i,pageIndex:s,accessibilityData:{altText:n}}=this._initialData,a=e.rect.every((d,f)=>Math.abs(d-i[f])<1),o=e.pageIndex===s,l=(((c=e.accessibilityData)==null?void 0:c.alt)||"")===n;return{isSame:a&&o&&l,isSameAltText:l}},Z(Ao,"_type","stamp"),Z(Ao,"_editorType",at.STAMP);let Rd=Ao;var Tr,Ga,es,gn,Ms,ii,mn,qa,Xa,Te,Ls,X,bn,ve,Ig,Id,Fd,Dd,Ph;const wi=class wi{constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:s,accessibilityManager:n,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:d}){y(this,ve);y(this,Tr);y(this,Ga,!1);y(this,es,null);y(this,gn,null);y(this,Ms,null);y(this,ii,new Map);y(this,mn,!1);y(this,qa,!1);y(this,Xa,!1);y(this,Te,null);y(this,Ls,null);y(this,X);const f=[...r(wi,bn).values()];if(!wi._initialized){wi._initialized=!0;for(const u of f)u.initialize(d,t)}t.registerEditorTypes(f),m(this,X,t),this.pageIndex=e,this.div=i,m(this,Tr,n),m(this,es,a),this.viewport=c,m(this,Te,l),this.drawLayer=o,this._structTree=s,r(this,X).addLayer(this)}get isEmpty(){return r(this,ii).size===0}get isInvisible(){return this.isEmpty&&r(this,X).getMode()===at.NONE}updateToolbar(t){r(this,X).updateToolbar(t)}updateMode(t=r(this,X).getMode()){switch(v(this,ve,Ph).call(this),t){case at.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case at.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case at.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of r(wi,bn).values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=r(this,Te))==null?void 0:e.div)}addInkEditorIfNeeded(t){if(r(this,X).getMode()!==at.INK)return;if(!t){for(const i of r(this,ii).values())if(i.isEmpty()){i.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){r(this,X).setEditingState(t)}addCommands(t){r(this,X).addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=r(this,es))==null||e.div.classList.toggle("disabled",!t)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of r(this,ii).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(r(this,X).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!r(this,es))return;const e=r(this,es).getEditableAnnotations();for(const i of e){if(i.hide(),r(this,X).isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}}disable(){var s;m(this,Xa,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const n of r(this,ii).values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){t.set(n.annotationElementId,n);continue}else e.set(n.annotationElementId,n);(s=this.getEditableAnnotation(n.annotationElementId))==null||s.show(),n.remove()}if(r(this,es)){const n=r(this,es).getEditableAnnotations();for(const a of n){const{id:o}=a.data;if(r(this,X).isDeletedAnnotationElement(o))continue;let l=e.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=t.get(o),l&&(r(this,X).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}v(this,ve,Ph).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const n of r(wi,bn).values())i.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),m(this,Xa,!1)}getEditableAnnotation(t){var e;return((e=r(this,es))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){r(this,X).getActive()!==t&&r(this,X).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=r(this,Te))!=null&&t.div&&!r(this,Ls)){m(this,Ls,new AbortController);const e=r(this,X).combinedSignal(r(this,Ls));r(this,Te).div.addEventListener("pointerdown",v(this,ve,Ig).bind(this),{signal:e}),r(this,Te).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=r(this,Te))!=null&&t.div&&r(this,Ls)&&(r(this,Ls).abort(),m(this,Ls,null),r(this,Te).div.classList.remove("highlighting"))}enableClick(){if(r(this,gn))return;m(this,gn,new AbortController);const t=r(this,X).combinedSignal(r(this,gn));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){var t;(t=r(this,gn))==null||t.abort(),m(this,gn,null)}attach(t){r(this,ii).set(t.id,t);const{annotationElementId:e}=t;e&&r(this,X).isDeletedAnnotationElement(e)&&r(this,X).removeDeletedAnnotationElement(t)}detach(t){var e;r(this,ii).delete(t.id),(e=r(this,Tr))==null||e.removePointerInTextLayer(t.contentDiv),!r(this,Xa)&&t.annotationElementId&&r(this,X).addDeletedAnnotationElement(t)}remove(t){this.detach(t),r(this,X).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,r(this,qa)||this.addInkEditorIfNeeded(!1)}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(r(this,X).addDeletedAnnotationElement(t.annotationElementId),Rt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),r(this,X).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),r(this,X).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var i;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!r(this,Ms)&&(t._focusEventsAllowed=!1,m(this,Ms,setTimeout(()=>{m(this,Ms,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:r(this,X)._signal}),e.focus())},0))),t._structTreeParentId=(i=r(this,Tr))==null?void 0:i.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return r(this,X).getId()}combinedSignal(t){return r(this,X).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=r(this,ve,Id))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){r(this,X).updateToolbar(t),r(this,X).updateMode(t);const{offsetX:i,offsetY:s}=v(this,ve,Dd).call(this),n=this.getNextId(),a=v(this,ve,Fd).call(this,{parent:this,id:n,x:i,y:s,uiManager:r(this,X),isCentered:!0,...e});a&&this.add(a)}async deserialize(t){var e;return await((e=r(wi,bn).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,r(this,X)))||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),n=v(this,ve,Fd).call(this,{parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:r(this,X),isCentered:e,...i});return n&&this.add(n),n}addNewEditor(){this.createAndAddNewEditor(v(this,ve,Dd).call(this),!0)}setSelected(t){r(this,X).setSelected(t)}toggleSelected(t){r(this,X).toggleSelected(t)}unselect(t){r(this,X).unselect(t)}pointerup(t){const{isMac:e}=De.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&r(this,mn)){if(m(this,mn,!1),!r(this,Ga)){m(this,Ga,!0);return}if(r(this,X).getMode()===at.STAMP){r(this,X).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(r(this,X).getMode()===at.HIGHLIGHT&&this.enableTextSelection(),r(this,mn)){m(this,mn,!1);return}const{isMac:e}=De.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;m(this,mn,!0);const i=r(this,X).getActive();m(this,Ga,!i||i.isEmpty())}findNewParent(t,e,i){const s=r(this,X).findParent(e,i);return s===null||s===this?!1:(s.changeParent(t),!0)}destroy(){var t,e;((t=r(this,X).getActive())==null?void 0:t.parent)===this&&(r(this,X).commitOrRemove(),r(this,X).setActiveEditor(null)),r(this,Ms)&&(clearTimeout(r(this,Ms)),m(this,Ms,null));for(const i of r(this,ii).values())(e=r(this,Tr))==null||e.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,r(this,ii).clear(),r(this,X).removeLayer(this)}render({viewport:t}){this.viewport=t,Cr(this.div,t);for(const e of r(this,X).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){r(this,X).commitOrRemove(),v(this,ve,Ph).call(this);const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Cr(this.div,{rotation:i}),e!==i)for(const s of r(this,ii).values())s.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return r(this,X).viewParameters.realScale}};Tr=new WeakMap,Ga=new WeakMap,es=new WeakMap,gn=new WeakMap,Ms=new WeakMap,ii=new WeakMap,mn=new WeakMap,qa=new WeakMap,Xa=new WeakMap,Te=new WeakMap,Ls=new WeakMap,X=new WeakMap,bn=new WeakMap,ve=new WeakSet,Ig=function(t){r(this,X).unselectAll();const{target:e}=t;if(e===r(this,Te).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&r(this,Te).div.contains(e)){const{isMac:i}=De.platform;if(t.button!==0||t.ctrlKey&&i)return;r(this,X).showAllEditors("highlight",!0,!0),r(this,Te).div.classList.add("free"),this.toggleDrawing(),Dh.startHighlighting(this,r(this,X).direction==="ltr",{target:r(this,Te).div,x:t.x,y:t.y}),r(this,Te).div.addEventListener("pointerup",()=>{r(this,Te).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:r(this,X)._signal}),t.preventDefault()}},Id=function(){return r(wi,bn).get(r(this,X).getMode())},Fd=function(t){const e=r(this,ve,Id);return e?new e.prototype.constructor(t):null},Dd=function(){const{x:t,y:e,width:i,height:s}=this.div.getBoundingClientRect(),n=Math.max(0,t),a=Math.max(0,e),o=Math.min(window.innerWidth,t+i),l=Math.min(window.innerHeight,e+s),c=(n+o)/2-t,d=(a+l)/2-e,[f,u]=this.viewport.rotation%180===0?[c,d]:[d,c];return{offsetX:f,offsetY:u}},Ph=function(){m(this,qa,!0);for(const t of r(this,ii).values())t.isEmpty()&&t.remove();m(this,qa,!1)},Z(wi,"_initialized",!1),y(wi,bn,new Map([dd,wd,Rd,Dh].map(t=>[t._editorType,t])));let Ld=wi;var is,Ol,Qt,Is,Nl,Nd,Lr,Bd,Fg;const pe=class pe{constructor({pageIndex:t}){y(this,Lr);y(this,is,null);y(this,Ol,0);y(this,Qt,new Map);y(this,Is,new Map);this.pageIndex=t}setParent(t){if(!r(this,is)){m(this,is,t);return}if(r(this,is)!==t){if(r(this,Qt).size>0)for(const e of r(this,Qt).values())e.remove(),t.append(e);m(this,is,t)}}static get _svgFactory(){return gt(this,"_svgFactory",new iu)}draw(t,e,i,s=!1){const n=Me(this,Ol)._++,a=v(this,Lr,Bd).call(this,t.box);a.classList.add(...t.classNamesForDrawing);const o=pe._svgFactory.createElement("defs");a.append(o);const l=pe._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("d",t.toSVGPath()),s&&r(this,Is).set(n,l);const d=v(this,Lr,Fg).call(this,o,c),f=pe._svgFactory.createElement("use");return a.append(f),a.setAttribute("fill",e),a.setAttribute("fill-opacity",i),f.setAttribute("href",`#${c}`),r(this,Qt).set(n,a),{id:n,clipPathId:`url(#${d})`}}drawOutline(t){const e=Me(this,Ol)._++,i=v(this,Lr,Bd).call(this,t.box);i.classList.add(...t.classNamesForOutlining);const s=pe._svgFactory.createElement("defs");i.append(s);const n=pe._svgFactory.createElement("path");s.append(n);const a=`path_p${this.pageIndex}_${e}`;n.setAttribute("id",a),n.setAttribute("d",t.toSVGPath()),n.setAttribute("vector-effect","non-scaling-stroke");let o;if(t.mustRemoveSelfIntersections){const d=pe._svgFactory.createElement("mask");s.append(d),o=`mask_p${this.pageIndex}_${e}`,d.setAttribute("id",o),d.setAttribute("maskUnits","objectBoundingBox");const f=pe._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const u=pe._svgFactory.createElement("use");d.append(u),u.setAttribute("href",`#${a}`),u.setAttribute("stroke","none"),u.setAttribute("fill","black"),u.setAttribute("fill-rule","nonzero"),u.classList.add("mask")}const l=pe._svgFactory.createElement("use");i.append(l),l.setAttribute("href",`#${a}`),o&&l.setAttribute("mask",`url(#${o})`);const c=l.cloneNode();return i.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),r(this,Qt).set(e,i),e}finalizeLine(t,e){const i=r(this,Is).get(t);r(this,Is).delete(t),this.updateBox(t,e.box),i.setAttribute("d",e.toSVGPath())}updateLine(t,e){r(this,Qt).get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}updatePath(t,e){r(this,Is).get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){var i;v(i=pe,Nl,Nd).call(i,r(this,Qt).get(t),e)}show(t,e){r(this,Qt).get(t).classList.toggle("hidden",!e)}rotate(t,e){r(this,Qt).get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){r(this,Qt).get(t).setAttribute("fill",e)}changeOpacity(t,e){r(this,Qt).get(t).setAttribute("fill-opacity",e)}addClass(t,e){r(this,Qt).get(t).classList.add(e)}removeClass(t,e){r(this,Qt).get(t).classList.remove(e)}getSVGRoot(t){return r(this,Qt).get(t)}remove(t){r(this,Is).delete(t),r(this,is)!==null&&(r(this,Qt).get(t).remove(),r(this,Qt).delete(t))}destroy(){m(this,is,null);for(const t of r(this,Qt).values())t.remove();r(this,Qt).clear(),r(this,Is).clear()}};is=new WeakMap,Ol=new WeakMap,Qt=new WeakMap,Is=new WeakMap,Nl=new WeakSet,Nd=function(t,{x:e=0,y:i=0,width:s=1,height:n=1}={}){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*s}%`,a.height=`${100*n}%`},Lr=new WeakSet,Bd=function(t){var i;const e=pe._svgFactory.create(1,1,!0);return r(this,is).append(e),e.setAttribute("aria-hidden",!0),v(i=pe,Nl,Nd).call(i,e,t),e},Fg=function(t,e){const i=pe._svgFactory.createElement("clipPath");t.append(i);const s=`clip_${e}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const n=pe._svgFactory.createElement("use");return i.append(n),n.setAttribute("href",`#${e}`),n.classList.add("clip"),s},y(pe,Nl);let Od=pe;var By=it.AbortException,Hy=it.AnnotationEditorLayer,Wy=it.AnnotationEditorParamsType,Uy=it.AnnotationEditorType,Vy=it.AnnotationEditorUIManager,Dg=it.AnnotationLayer,Og=it.AnnotationMode,jy=it.ColorPicker,zy=it.DOMSVGFactory,$y=it.DrawLayer,Gy=it.FeatureTest,nu=it.GlobalWorkerOptions,qy=it.ImageKind,Xy=it.InvalidPDFException,Yy=it.MissingPDFException,Ky=it.OPS,Qy=it.OutputScale,Jy=it.PDFDataRangeTransport,Zy=it.PDFDateString,tw=it.PDFWorker,ew=it.PasswordResponses,iw=it.PermissionFlag,sw=it.PixelsPerInch,nw=it.RenderingCancelledException,Ng=it.TextLayer,rw=it.UnexpectedResponseException,aw=it.Util,ow=it.VerbosityLevel,lw=it.XfaLayer,hw=it.build,cw=it.createValidAbsoluteUrl,dw=it.fetchData,Bg=it.getDocument,uw=it.getFilenameFromUrl,fw=it.getPdfFilenameFromUrl,pw=it.getXfaPageViewport,gw=it.isDataScheme,mw=it.isPdfFile,bw=it.noContextMenu,vw=it.normalizeUnicode,yw=it.setLayerDimensions,ww=it.shadow,Hg=it.version;const Aw=Object.freeze(Object.defineProperty({__proto__:null,AbortException:By,AnnotationEditorLayer:Hy,AnnotationEditorParamsType:Wy,AnnotationEditorType:Uy,AnnotationEditorUIManager:Vy,AnnotationLayer:Dg,AnnotationMode:Og,ColorPicker:jy,DOMSVGFactory:zy,DrawLayer:$y,FeatureTest:Gy,GlobalWorkerOptions:nu,ImageKind:qy,InvalidPDFException:Xy,MissingPDFException:Yy,OPS:Ky,OutputScale:Qy,PDFDataRangeTransport:Jy,PDFDateString:Zy,PDFWorker:tw,PasswordResponses:ew,PermissionFlag:iw,PixelsPerInch:sw,RenderingCancelledException:nw,TextLayer:Ng,UnexpectedResponseException:rw,Util:aw,VerbosityLevel:ow,XfaLayer:lw,build:hw,createValidAbsoluteUrl:cw,fetchData:dw,getDocument:Bg,getFilenameFromUrl:uw,getPdfFilenameFromUrl:fw,getXfaPageViewport:pw,isDataScheme:gw,isPdfFile:mw,noContextMenu:bw,normalizeUnicode:vw,setLayerDimensions:yw,shadow:ww,version:Hg},Symbol.toStringTag,{value:"Module"}));var ae=function(h,t,e){if(e||arguments.length===2)for(var i=0,s=t.length,n;i<s;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return h.concat(n||Array.prototype.slice.call(t))},_w=["onCopy","onCut","onPaste"],Ew=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],Sw=["onFocus","onBlur"],xw=["onInput","onInvalid","onReset","onSubmit"],Tw=["onLoad","onError"],Cw=["onKeyDown","onKeyPress","onKeyUp"],Pw=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],Rw=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],kw=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],Mw=["onSelect"],Lw=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],Iw=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],Fw=["onScroll"],Dw=["onWheel"],Ow=["onAnimationStart","onAnimationEnd","onAnimationIteration"],Nw=["onTransitionEnd"],Bw=["onToggle"],Hw=["onChange"],Ww=ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae(ae([],_w,!0),Ew,!0),Sw,!0),xw,!0),Tw,!0),Cw,!0),Pw,!0),Rw,!0),kw,!0),Mw,!0),Lw,!0),Iw,!0),Fw,!0),Dw,!0),Ow,!0),Nw,!0),Hw,!0),Bw,!0);function Wg(h,t){var e={};return Ww.forEach(function(i){var s=h[i];s&&(t?e[i]=function(n){return s(n,t(i))}:e[i]=s)}),e}function Vl(h){var t=!1,e=new Promise(function(i,s){h.then(function(n){return!t&&i(n)}).catch(function(n){return!t&&s(n)})});return{promise:e,cancel:function(){t=!0}}}var Uw="Invariant failed";function Ft(h,t){if(!h)throw new Error(Uw)}var bc,mf;function Vw(){if(mf)return bc;mf=1;var h=function(){};return bc=h,bc}var jw=Vw();const Ce=ab(jw);var bf=Object.prototype.hasOwnProperty;function vf(h,t,e){for(e of h.keys())if(Yr(e,t))return e}function Yr(h,t){var e,i,s;if(h===t)return!0;if(h&&t&&(e=h.constructor)===t.constructor){if(e===Date)return h.getTime()===t.getTime();if(e===RegExp)return h.toString()===t.toString();if(e===Array){if((i=h.length)===t.length)for(;i--&&Yr(h[i],t[i]););return i===-1}if(e===Set){if(h.size!==t.size)return!1;for(i of h)if(s=i,s&&typeof s=="object"&&(s=vf(t,s),!s)||!t.has(s))return!1;return!0}if(e===Map){if(h.size!==t.size)return!1;for(i of h)if(s=i[0],s&&typeof s=="object"&&(s=vf(t,s),!s)||!Yr(i[1],t.get(s)))return!1;return!0}if(e===ArrayBuffer)h=new Uint8Array(h),t=new Uint8Array(t);else if(e===DataView){if((i=h.byteLength)===t.byteLength)for(;i--&&h.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(h)){if((i=h.byteLength)===t.byteLength)for(;i--&&h[i]===t[i];);return i===-1}if(!e||typeof h=="object"){i=0;for(e in h)if(bf.call(h,e)&&++i&&!bf.call(t,e)||!(e in t)||!Yr(h[e],t[e]))return!1;return Object.keys(t).length===i}}return h!==h&&t!==t}const Ug=O.createContext(null);function Kr({children:h,type:t}){return Mt.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:h})}const zw="noopener noreferrer nofollow";class $w{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Ft(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){Ft(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{Ft(this.pdfDocument),Ft(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{Ft(Array.isArray(e));const i=e[0];new Promise(s=>{Ft(this.pdfDocument),i instanceof Object?this.pdfDocument.getPageIndex(i).then(n=>{s(n)}).catch(()=>{Ft(!1)}):typeof i=="number"?s(i):Ft(!1)}).then(s=>{const n=s+1;Ft(this.pdfViewer),Ft(n>=1&&n<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:s,pageNumber:n})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;Ft(this.pdfViewer),Ft(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||zw,t.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const yf={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},oc=typeof window<"u",Vg=oc&&window.location.protocol==="file:";function Gw(h){return typeof h<"u"}function Sn(h){return Gw(h)&&h!==null}function qw(h){return typeof h=="string"}function Xw(h){return h instanceof ArrayBuffer}function Yw(h){return Ft(oc),h instanceof Blob}function Hd(h){return qw(h)&&/^data:/.test(h)}function wf(h){Ft(Hd(h));const[t="",e=""]=h.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function Kw(){return oc&&window.devicePixelRatio||1}const jg="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function Af(){Ce(!Vg,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${jg}`)}function Qw(){Ce(!Vg,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${jg}`)}function kr(h){h!=null&&h.cancel&&h.cancel()}function Wd(h,t){return Object.defineProperty(h,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(h,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(h,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(h,"originalHeight",{get(){return this.view[3]},configurable:!0}),h}function Jw(h){return h.name==="RenderingCancelledException"}function Zw(h){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=s=>{if(!s.target)return e(new Error("Error while reading a file."));const{error:n}=s.target;if(!n)return e(new Error("Error while reading a file."));switch(n.code){case n.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case n.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case n.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(h)})}function tA(h,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return h}}function Ya(){return O.useReducer(tA,{value:void 0,error:void 0})}var eA=function(h,t,e,i){function s(n){return n instanceof e?n:new e(function(a){a(n)})}return new(e||(e=Promise))(function(n,a){function o(d){try{c(i.next(d))}catch(f){a(f)}}function l(d){try{c(i.throw(d))}catch(f){a(f)}}function c(d){d.done?n(d.value):s(d.value).then(o,l)}c((i=i.apply(h,t||[])).next())})},_f=function(h,t){var e={};for(var i in h)Object.prototype.hasOwnProperty.call(h,i)&&t.indexOf(i)<0&&(e[i]=h[i]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(h);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(h,i[s])&&(e[i[s]]=h[i[s]]);return e};const{PDFDataRangeTransport:iA}=Aw,sA=(h,t)=>{switch(t){case yf.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");h(e);break}case yf.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");h(e);break}}};function Ef(h){return typeof h=="object"&&h!==null&&("data"in h||"range"in h||"url"in h)}const Ud=O.forwardRef(function(t,e){var{children:i,className:s,error:n="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:d,loading:f="Loading PDF…",noData:u="No PDF file specified.",onItemClick:p,onLoadError:g,onLoadProgress:b,onLoadSuccess:w,onPassword:A=sA,onSourceError:T,onSourceSuccess:S,options:x,renderMode:P,rotate:R}=t,M=_f(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[L,F]=Ya(),{value:D,error:H}=L,[st,q]=Ya(),{value:$,error:J}=st,K=O.useRef(new $w),W=O.useRef([]),G=O.useRef(void 0),ut=O.useRef(void 0);l&&l!==G.current&&Ef(l)&&(Ce(!Yr(l,G.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),G.current=l),x&&x!==ut.current&&(Ce(!Yr(x,ut.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),ut.current=x);const mt=O.useRef({scrollPageIntoView:At=>{const{dest:kt,pageNumber:Gt,pageIndex:Nt=Gt-1}=At;if(p){p({dest:kt,pageIndex:Nt,pageNumber:Gt});return}const ke=W.current[Nt];if(ke){ke.scrollIntoView();return}Ce(!1,`An internal link leading to page ${Gt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});O.useImperativeHandle(e,()=>({linkService:K,pages:W,viewer:mt}),[]);function Dt(){S&&S()}function St(){H&&(Ce(!1,H.toString()),T&&T(H))}function wt(){F({type:"RESET"})}O.useEffect(wt,[l,F]);const Zt=O.useCallback(()=>eA(this,void 0,void 0,function*(){if(!l)return null;if(typeof l=="string")return Hd(l)?{data:wf(l)}:(Af(),{url:l});if(l instanceof iA)return{range:l};if(Xw(l))return{data:l};if(oc&&Yw(l))return{data:yield Zw(l)};if(Ft(typeof l=="object"),Ft(Ef(l)),"url"in l&&typeof l.url=="string"){if(Hd(l.url)){const{url:At}=l,kt=_f(l,["url"]),Gt=wf(At);return Object.assign({data:Gt},kt)}Af()}return l}),[l]);O.useEffect(()=>{const At=Vl(Zt());return At.promise.then(kt=>{F({type:"RESOLVE",value:kt})}).catch(kt=>{F({type:"REJECT",error:kt})}),()=>{kr(At)}},[Zt,F]),O.useEffect(()=>{if(!(typeof D>"u")){if(D===!1){St();return}Dt()}},[D]);function j(){$&&(w&&w($),W.current=new Array($.numPages),K.current.setDocument($))}function xt(){J&&(Ce(!1,J.toString()),g&&g(J))}O.useEffect(function(){q({type:"RESET"})},[q,D]),O.useEffect(function(){if(!D)return;const kt=x?Object.assign(Object.assign({},D),x):D,Gt=Bg(kt);b&&(Gt.onProgress=b),A&&(Gt.onPassword=A);const Nt=Gt,ke=Nt.promise.then(li=>{q({type:"RESOLVE",value:li})}).catch(li=>{Nt.destroyed||q({type:"REJECT",error:li})});return()=>{ke.finally(()=>Nt.destroy())}},[x,q,D]),O.useEffect(()=>{if(!(typeof $>"u")){if($===!1){xt();return}j()}},[$]),O.useEffect(function(){K.current.setViewer(mt.current),K.current.setExternalLinkRel(a),K.current.setExternalLinkTarget(o)},[a,o]);const ct=O.useCallback((At,kt)=>{W.current[At]=kt},[]),Re=O.useCallback(At=>{delete W.current[At]},[]),ue=O.useMemo(()=>({imageResourcesPath:d,linkService:K.current,onItemClick:p,pdf:$,registerPage:ct,renderMode:P,rotate:R,unregisterPage:Re}),[d,p,$,ct,P,R,Re]),Tt=O.useMemo(()=>Wg(M,()=>$),[M,$]);function ss(){return Mt.jsx(Ug.Provider,{value:ue,children:i})}function oi(){return l?$==null?Mt.jsx(Kr,{type:"loading",children:typeof f=="function"?f():f}):$===!1?Mt.jsx(Kr,{type:"error",children:typeof n=="function"?n():n}):ss():Mt.jsx(Kr,{type:"no-data",children:typeof u=="function"?u():u})}return Mt.jsx("div",Object.assign({className:Bl("react-pdf__Document",s),ref:c,style:{"--scale-factor":"1"}},Tt,{children:oi()}))});function zg(){return O.useContext(Ug)}function $g(){for(var h=[],t=0;t<arguments.length;t++)h[t]=arguments[t];var e=h.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(n){e.forEach(function(a){typeof a=="function"?a(n):a&&(a.current=n)})}}const Gg=O.createContext(null),qg={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},nA=/^H(\d+)$/;function rA(h){return h in qg}function lc(h){return"children"in h}function Xg(h){return lc(h)?h.children.length===1&&0 in h.children&&"id"in h.children[0]:!1}function aA(h){const t={};if(lc(h)){const{role:e}=h,i=e.match(nA);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(rA(e)){const s=qg[e];s&&(t.role=s)}}return t}function Yg(h){const t={};if(lc(h)){if(h.alt!==void 0&&(t["aria-label"]=h.alt),h.lang!==void 0&&(t.lang=h.lang),Xg(h)){const[e]=h.children;if(e){const i=Yg(e);return Object.assign(Object.assign({},t),i)}}}else"id"in h&&(t["aria-owns"]=h.id);return t}function oA(h){return h?Object.assign(Object.assign({},aA(h)),Yg(h)):null}function Kg({className:h,node:t}){const e=O.useMemo(()=>oA(t),[t]),i=O.useMemo(()=>!lc(t)||Xg(t)?null:t.children.map((s,n)=>Mt.jsx(Kg,{node:s},n)),[t]);return Mt.jsx("span",Object.assign({className:h},e,{children:i}))}function hc(){return O.useContext(Gg)}function lA(){const h=hc();Ft(h);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=h,[i,s]=Ya(),{value:n,error:a}=i,{customTextRenderer:o,page:l}=h;function c(){n&&e&&e(n)}function d(){a&&(Ce(!1,a.toString()),t&&t(a))}return O.useEffect(function(){s({type:"RESET"})},[s,l]),O.useEffect(function(){if(o||!l)return;const u=Vl(l.getStructTree()),p=u;return u.promise.then(g=>{s({type:"RESOLVE",value:g})}).catch(g=>{s({type:"REJECT",error:g})}),()=>kr(p)},[o,l,s]),O.useEffect(()=>{if(n!==void 0){if(n===!1){d();return}c()}},[n]),n?Mt.jsx(Kg,{className:"react-pdf__Page__structTree structTree",node:n}):null}const Sf=Og;function hA(h){const t=hc();Ft(t);const e=Object.assign(Object.assign({},t),h),{_className:i,canvasBackground:s,devicePixelRatio:n=Kw(),onRenderError:a,onRenderSuccess:o,page:l,renderForms:c,renderTextLayer:d,rotate:f,scale:u}=e,{canvasRef:p}=h;Ft(l);const g=O.useRef(null);function b(){l&&o&&o(Wd(l,u))}function w(x){Jw(x)||(Ce(!1,x.toString()),a&&a(x))}const A=O.useMemo(()=>l.getViewport({scale:u*n,rotation:f}),[n,l,f,u]),T=O.useMemo(()=>l.getViewport({scale:u,rotation:f}),[l,f,u]);O.useEffect(function(){if(!l)return;l.cleanup();const{current:P}=g;if(!P)return;P.width=A.width,P.height=A.height,P.style.width=`${Math.floor(T.width)}px`,P.style.height=`${Math.floor(T.height)}px`,P.style.visibility="hidden";const R={annotationMode:c?Sf.ENABLE_FORMS:Sf.ENABLE,canvasContext:P.getContext("2d",{alpha:!1}),viewport:A};s&&(R.background=s);const M=l.render(R),L=M;return M.promise.then(()=>{P.style.visibility="",b()}).catch(w),()=>kr(L)},[s,l,c,A,T]);const S=O.useCallback(()=>{const{current:x}=g;x&&(x.width=0,x.height=0)},[]);return O.useEffect(()=>S,[S]),Mt.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:$g(p,g),style:{display:"block",userSelect:"none"},children:d?Mt.jsx(lA,{}):null})}function cA(h){return"str"in h}function dA(){const h=hc();Ft(h);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:s,onRenderTextLayerSuccess:n,page:a,pageIndex:o,pageNumber:l,rotate:c,scale:d}=h;Ft(a);const[f,u]=Ya(),{value:p,error:g}=f,b=O.useRef(null);Ce(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function w(){p&&i&&i(p)}function A(){g&&(Ce(!1,g.toString()),e&&e(g))}O.useEffect(function(){u({type:"RESET"})},[a,u]),O.useEffect(function(){if(!a)return;const L=Vl(a.getTextContent()),F=L;return L.promise.then(D=>{u({type:"RESOLVE",value:D})}).catch(D=>{u({type:"REJECT",error:D})}),()=>kr(F)},[a,u]),O.useEffect(()=>{if(p!==void 0){if(p===!1){A();return}w()}},[p]);const T=O.useCallback(()=>{n&&n()},[n]),S=O.useCallback(M=>{Ce(!1,M.toString()),s&&s(M)},[s]);function x(){const M=b.current;M&&M.classList.add("selecting")}function P(){const M=b.current;M&&M.classList.remove("selecting")}const R=O.useMemo(()=>a.getViewport({scale:d,rotation:c}),[a,c,d]);return O.useLayoutEffect(function(){if(!a||!p)return;const{current:L}=b;if(!L)return;L.innerHTML="";const F=a.streamTextContent({includeMarkedContent:!0}),D={container:L,textContentSource:F,viewport:R},H=new Ng(D),st=H;return H.render().then(()=>{const q=document.createElement("div");q.className="endOfContent",L.append(q);const $=L.querySelectorAll('[role="presentation"]');if(t){let J=0;p.items.forEach((K,W)=>{if(!cA(K))return;const G=$[J];if(!G)return;const ut=t(Object.assign({pageIndex:o,pageNumber:l,itemIndex:W},K));G.innerHTML=ut,J+=K.str&&K.hasEOL?2:1})}T()}).catch(S),()=>kr(st)},[t,S,T,a,o,l,p,R]),Mt.jsx("div",{className:Bl("react-pdf__Page__textContent","textLayer"),onMouseUp:P,onMouseDown:x,ref:b})}function uA(){const h=zg(),t=hc();Ft(t);const e=Object.assign(Object.assign({},h),t),{imageResourcesPath:i,linkService:s,onGetAnnotationsError:n,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:o,onRenderAnnotationLayerSuccess:l,page:c,pdf:d,renderForms:f,rotate:u,scale:p=1}=e;Ft(d),Ft(c),Ft(s);const[g,b]=Ya(),{value:w,error:A}=g,T=O.useRef(null);Ce(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function S(){w&&a&&a(w)}function x(){A&&(Ce(!1,A.toString()),n&&n(A))}O.useEffect(function(){b({type:"RESET"})},[b,c]),O.useEffect(function(){if(!c)return;const F=Vl(c.getAnnotations()),D=F;return F.promise.then(H=>{b({type:"RESOLVE",value:H})}).catch(H=>{b({type:"REJECT",error:H})}),()=>{kr(D)}},[b,c]),O.useEffect(()=>{if(w!==void 0){if(w===!1){x();return}S()}},[w]);function P(){l&&l()}function R(L){Ce(!1,`${L}`),o&&o(L)}const M=O.useMemo(()=>c.getViewport({scale:p,rotation:u}),[c,u,p]);return O.useEffect(function(){if(!d||!c||!s||!w)return;const{current:F}=T;if(!F)return;const D=M.clone({dontFlip:!0}),H={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:F,l10n:null,page:c,structTreeLayer:null,viewport:D},st={annotations:w,annotationStorage:d.annotationStorage,div:F,imageResourcesPath:i,linkService:s,page:c,renderForms:f,viewport:D};F.innerHTML="";try{new Dg(H).render(st),P()}catch(q){R(q)}return()=>{}},[w,i,s,c,d,f,M]),Mt.jsx("div",{className:Bl("react-pdf__Page__annotations","annotationLayer"),ref:T})}var fA=function(h,t){var e={};for(var i in h)Object.prototype.hasOwnProperty.call(h,i)&&t.indexOf(i)<0&&(e[i]=h[i]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(h);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(h,i[s])&&(e[i[s]]=h[i[s]]);return e};const xf=1;function Vd(h){const t=zg(),e=Object.assign(Object.assign({},t),h),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:n,canvasRef:a,children:o,className:l,customRenderer:c,customTextRenderer:d,devicePixelRatio:f,error:u="Failed to load the page.",height:p,inputRef:g,loading:b="Loading page…",noData:w="No page specified.",onGetAnnotationsError:A,onGetAnnotationsSuccess:T,onGetStructTreeError:S,onGetStructTreeSuccess:x,onGetTextError:P,onGetTextSuccess:R,onLoadError:M,onLoadSuccess:L,onRenderAnnotationLayerError:F,onRenderAnnotationLayerSuccess:D,onRenderError:H,onRenderSuccess:st,onRenderTextLayerError:q,onRenderTextLayerSuccess:$,pageIndex:J,pageNumber:K,pdf:W,registerPage:G,renderAnnotationLayer:ut=!0,renderForms:mt=!1,renderMode:Dt="canvas",renderTextLayer:St=!0,rotate:wt,scale:Zt=xf,unregisterPage:j,width:xt}=e,ct=fA(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Re,ue]=Ya(),{value:Tt,error:ss}=Re,oi=O.useRef(null);Ft(W);const At=Sn(K)?K-1:J??null,kt=K??(Sn(J)?J+1:null),Gt=wt??(Tt?Tt.rotate:null),Nt=O.useMemo(()=>{if(!Tt)return null;let Y=1;const vt=Zt??xf;if(xt||p){const we=Tt.getViewport({scale:1,rotation:Gt});xt?Y=xt/we.width:p&&(Y=p/we.height)}return vt*Y},[p,Tt,Gt,Zt,xt]);O.useEffect(function(){return()=>{Sn(At)&&s&&j&&j(At)}},[s,W,At,j]);function ke(){if(L){if(!Tt||!Nt)return;L(Wd(Tt,Nt))}if(s&&G){if(!Sn(At)||!oi.current)return;G(At,oi.current)}}function li(){ss&&(Ce(!1,ss.toString()),M&&M(ss))}O.useEffect(function(){ue({type:"RESET"})},[ue,W,At]),O.useEffect(function(){if(!W||!kt)return;const vt=Vl(W.getPage(kt)),we=vt;return vt.promise.then(fe=>{ue({type:"RESOLVE",value:fe})}).catch(fe=>{ue({type:"REJECT",error:fe})}),()=>kr(we)},[ue,W,kt]),O.useEffect(()=>{if(Tt!==void 0){if(Tt===!1){li();return}ke()}},[Tt,Nt]);const Ws=O.useMemo(()=>Tt&&Sn(At)&&kt&&Sn(Gt)&&Sn(Nt)?{_className:i,canvasBackground:n,customTextRenderer:d,devicePixelRatio:f,onGetAnnotationsError:A,onGetAnnotationsSuccess:T,onGetStructTreeError:S,onGetStructTreeSuccess:x,onGetTextError:P,onGetTextSuccess:R,onRenderAnnotationLayerError:F,onRenderAnnotationLayerSuccess:D,onRenderError:H,onRenderSuccess:st,onRenderTextLayerError:q,onRenderTextLayerSuccess:$,page:Tt,pageIndex:At,pageNumber:kt,renderForms:mt,renderTextLayer:St,rotate:Gt,scale:Nt}:null,[i,n,d,f,A,T,S,x,P,R,F,D,H,st,q,$,Tt,At,kt,mt,St,Gt,Nt]),En=O.useMemo(()=>Wg(ct,()=>Tt&&(Nt?Wd(Tt,Nt):void 0)),[ct,Tt,Nt]),Oi=`${At}@${Nt}/${Gt}`;function ye(){switch(Dt){case"custom":return Ft(c),Mt.jsx(c,{},`${Oi}_custom`);case"none":return null;case"canvas":default:return Mt.jsx(hA,{canvasRef:a},`${Oi}_canvas`)}}function yi(){return St?Mt.jsx(dA,{},`${Oi}_text`):null}function ns(){return ut?Mt.jsx(uA,{},`${Oi}_annotations`):null}function ot(){return Mt.jsxs(Gg.Provider,{value:Ws,children:[ye(),yi(),ns(),o]})}function bt(){return kt?W===null||Tt===void 0||Tt===null?Mt.jsx(Kr,{type:"loading",children:typeof b=="function"?b():b}):W===!1||Tt===!1?Mt.jsx(Kr,{type:"error",children:typeof u=="function"?u():u}):ot():Mt.jsx(Kr,{type:"no-data",children:typeof w=="function"?w():w})}return Mt.jsx("div",Object.assign({className:Bl(i,l),"data-page-number":kt,ref:$g(g,oi),style:{"--scale-factor":`${Nt}`,backgroundColor:n||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},En,{children:bt()}))}Qw();nu.workerSrc="pdf.worker.mjs";nu.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${Hg}/pdf.worker.min.mjs`;function pA({file:h,documentDimension:t}){const[e,i]=O.useState(null),[s,n]=O.useState(1),[a,o]=O.useState(1),l=()=>{o(g=>g+.2)},c=()=>{a!==1&&o(g=>g-.2)};function d({numPages:g}){i(g)}function f(g){n(b=>b+g)}function u(){f(-1)}function p(){f(1)}return O.useEffect(()=>{n(1)},[h]),h?$e("div",{children:[$e(qu,{id:"scaleButton",sx:{my:"1em"},children:[tt(to,{onClick:l,variant:"outlined",children:"+"}),tt(to,{onClick:c,variant:"outlined",disabled:a<=1,children:"-"})]}),tt(Ud,{file:h,onLoadSuccess:d,loading:tt("div",{style:{height:t.height,width:t.width},children:tt(kh,{})}),children:tt(Vd,{renderTextLayer:!1,className:"page",scale:a,height:t.height,width:t.width,pageNumber:s,loading:tt("div",{style:{height:t.height,width:t.width},children:tt(kh,{})})})}),$e("p",{style:{color:"black"},children:["Page ",s||(e?1:"--")," of ",e||"--"]}),$e(qu,{id:"pageButton",children:[tt(to,{variant:"outlined",disabled:s<=1,onClick:u,children:"Previous"}),tt(to,{variant:"outlined",disabled:s>=e,onClick:p,children:"Next"})]})]}):tt("p",{children:"해당 날짜의 주보가 존재하지 않습니다."})}const Rh=new Date("2022/04/03"),gA=({isOpen:h,onClose:t,setParentDate:e})=>{const{openSnackbar:i}=ob(),[s,n]=O.useState(kb(Rf(new Date),{days:1})),[a,o]=O.useState(null),[l,c]=O.useState(null),d=()=>{o(null),c(null),t()},f=T=>{o(T[0])},u=T=>{c(T[0])},[p,g]=O.useState(null);O.useEffect(()=>{const T=()=>{const S=wc.isMobile?document.documentElement.clientWidth:window.innerWidth;g(Math.min(S*.8,1300)/2-24)};return T(),window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]);const b=async()=>{try{A(!0);const T=new FormData;T.append("pdfs",a),T.append("pdfs",l),await hb(yc(s,"yyyyMMdd"),T),i("success","Uploaded Succesfully!"),e(s),d()}catch(T){console.log(T),i("error","Error Occured. Please contact to the administrator.")}finally{A(!1)}},[w,A]=O.useState(!1);return tt(lb,{isOpen:h,onClose:d,maxHeight:"85vh",maxWidth:"1300px",children:w?tt(kh,{}):$e(vc,{children:[tt("h1",{style:{marginTop:0},children:"주보 업로드"}),tt(kf,{value:s,minDate:Rh,onChange:n,disableDate:T=>!Jl(T)}),$e("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"},children:[$e("div",{style:{width:"49%"},children:[tt("h3",{children:"헌금 내역 미포함"}),$e("div",{style:{height:"40svh"},children:[tt("p",{children:a==null?void 0:a.name}),tt(Ud,{file:a,noData:"파일을 선택해주세요.",children:tt(Vd,{renderTextLayer:!1,className:"page",width:p,pageNumber:1})})]}),tt("div",{style:{height:"12.75svh"},children:tt(Gu,{accept:{"application/pdf":[]},handleChangeFile:f})})]}),$e("div",{style:{width:"49%"},children:[tt("h3",{children:"헌금 내역 포함"}),$e("div",{style:{height:"40svh"},children:[tt("p",{children:l==null?void 0:l.name}),tt(Ud,{file:l,noData:"파일을 선택해주세요.",children:tt(Vd,{renderTextLayer:!1,className:"page",width:p,pageNumber:1})})]}),tt("div",{style:{height:"12.75svh"},children:tt(Gu,{accept:{"application/pdf":[]},handleChangeFile:u})})]})]}),tt(to,{fullWidth:!0,variant:"outlined",onClick:b,disabled:!a||!l,sx:{mt:"1.5em"},children:"Upload"})]})})},mA={backgroundImage:'url("/img/News/WeeklyUpdate/WeeklyUpdate.webp")'},MA=()=>{const{openModal:h}=cb(),t=db(),e=ub(S=>S.authToken.authenticated),{maxDate:i,queryDate:s}=fb(),[n,a]=O.useState(null),[o,l]=O.useState(s),[c,d]=O.useState(!0),[f,u]=O.useState(!1),p=O.useCallback(async()=>{d(!0);try{const S=await pb(o);a(S.data)}catch(S){console.log(S),a(null)}finally{d(!1)}},[o]),g=async()=>{const S=await mb(o);l(bb(JSON.stringify(S.data),"yyyyMMdd",new Date))},b=()=>{l(S=>Jl(S)?Mb(S,7):vb(S,{weekStartsOn:0}))},w=()=>{l(S=>Jl(S)?jd(S,7):Rf(S,{weekStartsOn:1}))};O.useEffect(()=>{p(),t("/weeklyupdate/"+yc(o,"yyyyMMdd"))},[o,e,p,t]);const[A,T]=O.useState({width:null,height:null});return O.useEffect(()=>{const S=()=>{const x=wc.isMobile?document.documentElement.clientWidth:window.innerWidth,P=wc.isMobile?document.documentElement.clientHeight:window.innerHeight,M=P/x>=16/10;T({width:M?x-30:null,height:M?null:P})};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]),$e(vc,{children:[tt("div",{className:"title-wrapper",style:mA,children:tt("div",{className:"title",children:tt(gb,{variant:"h4",fontWeight:830,sx:{letterSpacing:"0.4em",pl:"0.4em",color:"white"},children:"주보"})})}),tt("div",{className:"container-wrapper",children:$e("div",{className:"container",style:{textAlign:"center",paddingLeft:0,paddingRight:0},children:[$e(vc,{children:[tt(ju,{id:"previousBulletin",onClick:b,disabled:zu(o,Rh)||Ab(o,Rh)||c,children:tt(Lb,{})}),tt(kf,{value:o,minDate:Rh,maxDate:i,onChange:l,disableDate:S=>!Jl(S)}),tt(ju,{id:"nextBulletin",onClick:w,disabled:zu(o,i)||_b(o,i)||c,children:tt(Ib,{})})]}),c?tt("div",{style:{height:"100vh"},children:tt(kh,{sx:{mt:2}})}):tt(pA,{file:n,documentDimension:A})]})}),$e(Eb,{children:[tt($u,{id:"uploadBulletinButton",onClick:()=>h(gA,{setParentDate:l}),children:tt(Fb,{})}),tt($u,{id:"deleteBulletinButton",sx:{backgroundColor:"#d10000",color:"white",":hover":{backgroundColor:"#ff0000"}},onClick:()=>u(!0),children:tt(yb,{})}),tt(Sb,{title:"삭제하시겠습니까?",body:`${yc(o,"yyyyMMdd")} 주보가 삭제됩니다`,isOpen:f,onClose:()=>u(!1),onConfirm:g})]})]})};export{MA as default};
