var zm=Object.defineProperty;var Bu=h=>{throw TypeError(h)};var $m=(h,t,e)=>t in h?zm(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var tt=(h,t,e)=>$m(h,typeof t!="symbol"?t+"":t,e),lc=(h,t,e)=>t.has(h)||Bu("Cannot "+e);var r=(h,t,e)=>(lc(h,t,"read from private field"),e?e.call(h):t.get(h)),y=(h,t,e)=>t.has(h)?Bu("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(h):t.set(h,e),m=(h,t,e,i)=>(lc(h,t,"write to private field"),i?i.call(h,e):t.set(h,e),e),v=(h,t,e)=>(lc(h,t,"access private method"),e);var ke=(h,t,e,i)=>({set _(s){m(h,t,s,e)},get _(){return r(h,t,i)}});import{r as N,g as Gm,a as qm,s as Xm,m as Ym,H as Hu,e as Km,u as Qm,j as F,c as Ol,J as Jm,K as Zm,d as ii,b as tb,L as xf,M as jd,O as eb,k as Wd,h as ib,_ as zl,i as sb,B as Ja,z as nb,F as rb,P as ab,C as mc,x as ob,y as lb,Q as hb,t as cb,R as db,T as ub,I as ju,S as fb,U as pb,V as gb}from"./index-DfAFzQot.js";import{D as mb}from"./Delete-BSmMN0S5.js";import{a as bb,e as Tf,B as Cf,i as Wu,b as vb,c as yb}from"./ButtonDatePicker-CKDO0S6s.js";import{C as Ph}from"./CircularProgress-BV9zfnbF.js";import{A as wb,F as Uu}from"./AdminComponent-Dcdy2Ig9.js";import{F as Vu}from"./FileUploadComponent-Duudxr8a.js";import{C as Ab}from"./CustomConfirmDialog-335q2rpr.js";import"./useThemeProps-DAersxlR.js";import"./index-DUi0R1Rg.js";import"./Popper-kNDdwcpe.js";import"./ListItem-CGHGVAdN.js";function _b(h){return N.Children.toArray(h).filter(t=>N.isValidElement(t))}function Eb(h){return qm("MuiButtonGroup",h)}const rt=Gm("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),Sb=(h,t)=>{const{ownerState:e}=h;return[{[`& .${rt.grouped}`]:t.grouped},{[`& .${rt.grouped}`]:t[`grouped${ii(e.orientation)}`]},{[`& .${rt.grouped}`]:t[`grouped${ii(e.variant)}`]},{[`& .${rt.grouped}`]:t[`grouped${ii(e.variant)}${ii(e.orientation)}`]},{[`& .${rt.grouped}`]:t[`grouped${ii(e.variant)}${ii(e.color)}`]},{[`& .${rt.firstButton}`]:t.firstButton},{[`& .${rt.lastButton}`]:t.lastButton},{[`& .${rt.middleButton}`]:t.middleButton},t.root,t[e.variant],e.disableElevation===!0&&t.disableElevation,e.fullWidth&&t.fullWidth,e.orientation==="vertical"&&t.vertical]},xb=h=>{const{classes:t,color:e,disabled:i,disableElevation:s,fullWidth:n,orientation:a,variant:o}=h,l={root:["root",o,a,n&&"fullWidth",s&&"disableElevation",`color${ii(e)}`],grouped:["grouped",`grouped${ii(a)}`,`grouped${ii(o)}`,`grouped${ii(o)}${ii(a)}`,`grouped${ii(o)}${ii(e)}`,i&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return tb(l,Eb,t)},Tb=Xm("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:Sb})(Ym(({theme:h})=>({display:"inline-flex",borderRadius:(h.vars||h).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(h.vars||h).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${rt.lastButton},& .${rt.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${rt.lastButton},& .${rt.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderRight:h.vars?`1px solid rgba(${h.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${h.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${rt.disabled}`]:{borderRight:`1px solid ${(h.vars||h).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderBottom:h.vars?`1px solid rgba(${h.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${h.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${rt.disabled}`]:{borderBottom:`1px solid ${(h.vars||h).palette.action.disabled}`}}}},...Object.entries(h.palette).filter(Hu()).flatMap(([t])=>[{props:{variant:"text",color:t},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderColor:h.vars?`rgba(${h.vars.palette[t].mainChannel} / 0.5)`:Km(h.palette[t].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${rt.lastButton},& .${rt.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${rt.lastButton},& .${rt.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderRight:`1px solid ${(h.vars||h).palette.grey[400]}`,[`&.${rt.disabled}`]:{borderRight:`1px solid ${(h.vars||h).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderBottom:`1px solid ${(h.vars||h).palette.grey[400]}`,[`&.${rt.disabled}`]:{borderBottom:`1px solid ${(h.vars||h).palette.action.disabled}`}}}},...Object.entries(h.palette).filter(Hu(["dark"])).map(([t])=>({props:{variant:"contained",color:t},style:{[`& .${rt.firstButton},& .${rt.middleButton}`]:{borderColor:(h.vars||h).palette[t].dark}}}))],[`& .${rt.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),zu=N.forwardRef(function(t,e){const i=Qm({props:t,name:"MuiButtonGroup"}),{children:s,className:n,color:a="primary",component:o="div",disabled:l=!1,disableElevation:c=!1,disableFocusRipple:d=!1,disableRipple:f=!1,fullWidth:u=!1,orientation:p="horizontal",size:g="medium",variant:b="outlined",...w}=i,A={...i,color:a,component:o,disabled:l,disableElevation:c,disableFocusRipple:d,disableRipple:f,fullWidth:u,orientation:p,size:g,variant:b},T=xb(A),S=N.useMemo(()=>({className:T.grouped,color:a,disabled:l,disableElevation:c,disableFocusRipple:d,disableRipple:f,fullWidth:u,size:g,variant:b}),[a,l,c,d,f,u,g,b,T.grouped]),x=_b(s),P=x.length,R=M=>{const L=M===0,D=M===P-1;return L&&D?"":L?T.firstButton:D?T.lastButton:T.middleButton};return F.jsx(Tb,{as:o,role:"group",className:Ol(T.root,n),ref:e,ownerState:A,...w,children:F.jsx(Jm.Provider,{value:S,children:x.map((M,L)=>F.jsx(Zm.Provider,{value:R(L),children:M},L))})})});function Cb(h,t,e){const{years:i=0,months:s=0,weeks:n=0,days:a=0,hours:o=0,minutes:l=0,seconds:c=0}=t,d=xf(h,e==null?void 0:e.in),f=s||i?bb(d,s+i*12):d,u=a||n?jd(f,a+n*7):f,p=l+o*60,b=(c+p*60)*1e3;return eb(h,+u+b)}function Kl(h,t){return xf(h,t==null?void 0:t.in).getDay()===0}function Pb(h,t,e){return jd(h,-t,e)}const Rb=Wd(F.jsx("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos"),kb=Wd(F.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos"),Mb=Wd(F.jsx("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"}),"Upload");var V={},Za={exports:{}},Lb=Za.exports,$u;function Ib(){return $u||($u=1,function(h,t){(function(e,i){var s="1.0.35",n="",a="?",o="function",l="undefined",c="object",d="string",f="major",u="model",p="name",g="type",b="vendor",w="version",A="architecture",T="console",S="mobile",x="tablet",P="smarttv",R="wearable",M="embedded",L=350,D="Amazon",O="Apple",j="ASUS",st="BlackBerry",X="Browser",G="Chrome",Z="Edge",Q="Firefox",W="Google",q="Huawei",ut="LG",mt="Microsoft",Ft="Motorola",St="Opera",wt="Samsung",Jt="Sharp",z="Sony",xt="Xiaomi",ct="Zebra",Pe="Facebook",de="Chromium OS",Tt="Mac OS",es=function(ot,bt){var K={};for(var vt in ot)bt[vt]&&bt[vt].length%2===0?K[vt]=bt[vt].concat(ot[vt]):K[vt]=ot[vt];return K},ri=function(ot){for(var bt={},K=0;K<ot.length;K++)bt[ot[K].toUpperCase()]=ot[K];return bt},At=function(ot,bt){return typeof ot===d?kt(bt).indexOf(kt(ot))!==-1:!1},kt=function(ot){return ot.toLowerCase()},$t=function(ot){return typeof ot===d?ot.replace(/[^\d\.]/g,n).split(".")[0]:i},Ot=function(ot,bt){if(typeof ot===d)return ot=ot.replace(/^\s\s*/,n),typeof bt===l?ot:ot.substring(0,L)},Re=function(ot,bt){for(var K=0,vt,ye,ue,yt,J,$e;K<bt.length&&!J;){var Fr=bt[K],Xa=bt[K+1];for(vt=ye=0;vt<Fr.length&&!J&&Fr[vt];)if(J=Fr[vt++].exec(ot),J)for(ue=0;ue<Xa.length;ue++)$e=J[++ye],yt=Xa[ue],typeof yt===c&&yt.length>0?yt.length===2?typeof yt[1]==o?this[yt[0]]=yt[1].call(this,$e):this[yt[0]]=yt[1]:yt.length===3?typeof yt[1]===o&&!(yt[1].exec&&yt[1].test)?this[yt[0]]=$e?yt[1].call(this,$e,yt[2]):i:this[yt[0]]=$e?$e.replace(yt[1],yt[2]):i:yt.length===4&&(this[yt[0]]=$e?yt[3].call(this,$e.replace(yt[1],yt[2])):i):this[yt]=$e||i;K+=2}},ai=function(ot,bt){for(var K in bt)if(typeof bt[K]===c&&bt[K].length>0){for(var vt=0;vt<bt[K].length;vt++)if(At(bt[K][vt],ot))return K===a?i:K}else if(At(bt[K],ot))return K===a?i:K;return ot},Bs={"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},An={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Fi={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[w,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[w,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,w],[/opios[\/ ]+([\w\.]+)/i],[w,[p,St+" Mini"]],[/\bopr\/([\w\.]+)/i],[w,[p,St]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,w],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[w,[p,"UC"+X]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[w,[p,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[w,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[w,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[w,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[w,[p,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+X],w],[/\bfocus\/([\w\.]+)/i],[w,[p,Q+" Focus"]],[/\bopt\/([\w\.]+)/i],[w,[p,St+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[w,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[w,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[w,[p,St+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[w,[p,"MIUI "+X]],[/fxios\/([-\w\.]+)/i],[w,[p,Q]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+X]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+X],w],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],w],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[p,w],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,Pe],w],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[p,w],[/\bgsa\/([\w\.]+) .*safari\//i],[w,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[w,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[w,[p,G+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,G+" WebView"],w],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[w,[p,"Android "+X]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,w],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[w,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[w,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[w,ai,Bs]],[/(webkit|khtml)\/([\w\.]+)/i],[p,w],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],w],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[w,[p,Q+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,w],[/(cobalt)\/([\w\.]+)/i],[p,[w,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[A,"amd64"]],[/(ia32(?=;))/i],[[A,kt]],[/((?:i[346]|x)86)[;\)]/i],[[A,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[A,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[A,"armhf"]],[/windows (ce|mobile); ppc;/i],[[A,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[A,/ower/,n,kt]],[/(sun4\w)[;\)]/i],[[A,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[A,kt]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[b,wt],[g,x]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[b,wt],[g,S]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[b,O],[g,S]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[b,O],[g,x]],[/(macintosh);/i],[u,[b,O]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[b,Jt],[g,S]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[b,q],[g,x]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[b,q],[g,S]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[b,xt],[g,S]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[b,xt],[g,x]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[b,"OPPO"],[g,S]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[b,"Vivo"],[g,S]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[u,[b,"Realme"],[g,S]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[b,Ft],[g,S]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[b,Ft],[g,x]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[b,ut],[g,x]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[b,ut],[g,S]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[b,"Lenovo"],[g,x]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[b,"Nokia"],[g,S]],[/(pixel c)\b/i],[u,[b,W],[g,x]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[b,W],[g,S]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[b,z],[g,S]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[b,z],[g,x]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[b,"OnePlus"],[g,S]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[b,D],[g,x]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[b,D],[g,S]],[/(playbook);[-\w\),; ]+(rim)/i],[u,b,[g,x]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[b,st],[g,S]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[b,j],[g,x]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[b,j],[g,S]],[/(nexus 9)/i],[u,[b,"HTC"],[g,x]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[b,[u,/_/g," "],[g,S]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[b,"Acer"],[g,x]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[b,"Meizu"],[g,S]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[b,u,[g,S]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[b,u,[g,x]],[/(surface duo)/i],[u,[b,mt],[g,x]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[b,"Fairphone"],[g,S]],[/(u304aa)/i],[u,[b,"AT&T"],[g,S]],[/\bsie-(\w*)/i],[u,[b,"Siemens"],[g,S]],[/\b(rct\w+) b/i],[u,[b,"RCA"],[g,x]],[/\b(venue[\d ]{2,7}) b/i],[u,[b,"Dell"],[g,x]],[/\b(q(?:mv|ta)\w+) b/i],[u,[b,"Verizon"],[g,x]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[b,"Barnes & Noble"],[g,x]],[/\b(tm\d{3}\w+) b/i],[u,[b,"NuVision"],[g,x]],[/\b(k88) b/i],[u,[b,"ZTE"],[g,x]],[/\b(nx\d{3}j) b/i],[u,[b,"ZTE"],[g,S]],[/\b(gen\d{3}) b.+49h/i],[u,[b,"Swiss"],[g,S]],[/\b(zur\d{3}) b/i],[u,[b,"Swiss"],[g,x]],[/\b((zeki)?tb.*\b) b/i],[u,[b,"Zeki"],[g,x]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[b,"Dragon Touch"],u,[g,x]],[/\b(ns-?\w{0,9}) b/i],[u,[b,"Insignia"],[g,x]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[b,"NextBook"],[g,x]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[b,"Voice"],u,[g,S]],[/\b(lvtel\-)?(v1[12]) b/i],[[b,"LvTel"],u,[g,S]],[/\b(ph-1) /i],[u,[b,"Essential"],[g,S]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[b,"Envizen"],[g,x]],[/\b(trio[-\w\. ]+) b/i],[u,[b,"MachSpeed"],[g,x]],[/\btu_(1491) b/i],[u,[b,"Rotor"],[g,x]],[/(shield[\w ]+) b/i],[u,[b,"Nvidia"],[g,x]],[/(sprint) (\w+)/i],[b,u,[g,S]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[b,mt],[g,S]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[b,ct],[g,x]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[b,ct],[g,S]],[/smart-tv.+(samsung)/i],[b,[g,P]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[b,wt],[g,P]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[b,ut],[g,P]],[/(apple) ?tv/i],[b,[u,O+" TV"],[g,P]],[/crkey/i],[[u,G+"cast"],[b,W],[g,P]],[/droid.+aft(\w)( bui|\))/i],[u,[b,D],[g,P]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[b,Jt],[g,P]],[/(bravia[\w ]+)( bui|\))/i],[u,[b,z],[g,P]],[/(mitv-\w{5}) bui/i],[u,[b,xt],[g,P]],[/Hbbtv.*(technisat) (.*);/i],[b,u,[g,P]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[b,Ot],[u,Ot],[g,P]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[g,P]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[b,u,[g,T]],[/droid.+; (shield) bui/i],[u,[b,"Nvidia"],[g,T]],[/(playstation [345portablevi]+)/i],[u,[b,z],[g,T]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[b,mt],[g,T]],[/((pebble))app/i],[b,u,[g,R]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[b,O],[g,R]],[/droid.+; (glass) \d/i],[u,[b,W],[g,R]],[/droid.+; (wt63?0{2,3})\)/i],[u,[b,ct],[g,R]],[/(quest( 2| pro)?)/i],[u,[b,Pe],[g,R]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[b,[g,M]],[/(aeobc)\b/i],[u,[b,D],[g,M]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[u,[g,S]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[g,x]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[g,x]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[g,S]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[b,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[w,[p,Z+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[w,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,w],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[w,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,w],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[p,[w,ai,An]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,"Windows"],[w,ai,An]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[w,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,Tt],[w,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[w,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,w],[/\(bb(10);/i],[w,[p,st]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[w,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[w,[p,Q+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[w,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[w,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[w,[p,G+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,de],w],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,w],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],w],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,w]]},ve=function(ot,bt){if(typeof ot===c&&(bt=ot,ot=i),!(this instanceof ve))return new ve(ot,bt).getResult();var K=typeof e!==l&&e.navigator?e.navigator:i,vt=ot||(K&&K.userAgent?K.userAgent:n),ye=K&&K.userAgentData?K.userAgentData:i,ue=bt?es(Fi,bt):Fi,yt=K&&K.userAgent==vt;return this.getBrowser=function(){var J={};return J[p]=i,J[w]=i,Re.call(J,vt,ue.browser),J[f]=$t(J[w]),yt&&K&&K.brave&&typeof K.brave.isBrave==o&&(J[p]="Brave"),J},this.getCPU=function(){var J={};return J[A]=i,Re.call(J,vt,ue.cpu),J},this.getDevice=function(){var J={};return J[b]=i,J[u]=i,J[g]=i,Re.call(J,vt,ue.device),yt&&!J[g]&&ye&&ye.mobile&&(J[g]=S),yt&&J[u]=="Macintosh"&&K&&typeof K.standalone!==l&&K.maxTouchPoints&&K.maxTouchPoints>2&&(J[u]="iPad",J[g]=x),J},this.getEngine=function(){var J={};return J[p]=i,J[w]=i,Re.call(J,vt,ue.engine),J},this.getOS=function(){var J={};return J[p]=i,J[w]=i,Re.call(J,vt,ue.os),yt&&!J[p]&&ye&&ye.platform!="Unknown"&&(J[p]=ye.platform.replace(/chrome os/i,de).replace(/macos/i,Tt)),J},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return vt},this.setUA=function(J){return vt=typeof J===d&&J.length>L?Ot(J,L):J,this},this.setUA(vt),this};ve.VERSION=s,ve.BROWSER=ri([p,w,f]),ve.CPU=ri([A]),ve.DEVICE=ri([u,b,g,T,S,P,x,R,M]),ve.ENGINE=ve.OS=ri([p,w]),h.exports&&(t=h.exports=ve),t.UAParser=ve;var bi=typeof e!==l&&(e.jQuery||e.Zepto);if(bi&&!bi.ua){var is=new ve;bi.ua=is.getResult(),bi.ua.get=function(){return is.getUA()},bi.ua.set=function(ot){is.setUA(ot);var bt=is.getResult();for(var K in bt)bi.ua[K]=bt[K]}}})(typeof window=="object"?window:Lb)}(Za,Za.exports)),Za.exports}var Gu;function Fb(){if(Gu)return V;Gu=1,Object.defineProperty(V,"__esModule",{value:!0});function h(C){return C&&typeof C=="object"&&"default"in C?C.default:C}var t=ib(),e=h(t),i=Ib(),s=new i,n=s.getBrowser(),a=s.getCPU(),o=s.getDevice(),l=s.getEngine(),c=s.getOS(),d=s.getUA(),f=function(_){return s.setUA(_)},u=function(_){if(!_){console.error("No userAgent string was provided");return}var E=new i(_);return{UA:E,browser:E.getBrowser(),cpu:E.getCPU(),device:E.getDevice(),engine:E.getEngine(),os:E.getOS(),ua:E.getUA(),setUserAgent:function(I){return E.setUA(I)}}},p=Object.freeze({ClientUAInstance:s,browser:n,cpu:a,device:o,engine:l,os:c,ua:d,setUa:f,parseUserAgent:u});function g(C,_){var E=Object.keys(C);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(C);_&&(k=k.filter(function(I){return Object.getOwnPropertyDescriptor(C,I).enumerable})),E.push.apply(E,k)}return E}function b(C){for(var _=1;_<arguments.length;_++){var E=arguments[_]!=null?arguments[_]:{};_%2?g(Object(E),!0).forEach(function(k){x(C,k,E[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(E)):g(Object(E)).forEach(function(k){Object.defineProperty(C,k,Object.getOwnPropertyDescriptor(E,k))})}return C}function w(C){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?w=function(_){return typeof _}:w=function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},w(C)}function A(C,_){if(!(C instanceof _))throw new TypeError("Cannot call a class as a function")}function T(C,_){for(var E=0;E<_.length;E++){var k=_[E];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(C,k.key,k)}}function S(C,_,E){return T(C.prototype,_),C}function x(C,_,E){return _ in C?Object.defineProperty(C,_,{value:E,enumerable:!0,configurable:!0,writable:!0}):C[_]=E,C}function P(){return P=Object.assign||function(C){for(var _=1;_<arguments.length;_++){var E=arguments[_];for(var k in E)Object.prototype.hasOwnProperty.call(E,k)&&(C[k]=E[k])}return C},P.apply(this,arguments)}function R(C,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(_&&_.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),_&&L(C,_)}function M(C){return M=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)},M(C)}function L(C,_){return L=Object.setPrototypeOf||function(k,I){return k.__proto__=I,k},L(C,_)}function D(C,_){if(C==null)return{};var E={},k=Object.keys(C),I,ft;for(ft=0;ft<k.length;ft++)I=k[ft],!(_.indexOf(I)>=0)&&(E[I]=C[I]);return E}function O(C,_){if(C==null)return{};var E=D(C,_),k,I;if(Object.getOwnPropertySymbols){var ft=Object.getOwnPropertySymbols(C);for(I=0;I<ft.length;I++)k=ft[I],!(_.indexOf(k)>=0)&&Object.prototype.propertyIsEnumerable.call(C,k)&&(E[k]=C[k])}return E}function j(C){if(C===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C}function st(C,_){if(_&&(typeof _=="object"||typeof _=="function"))return _;if(_!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j(C)}function X(C,_){return G(C)||Z(C,_)||Q(C,_)||q()}function G(C){if(Array.isArray(C))return C}function Z(C,_){var E=C==null?null:typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(E!=null){var k=[],I=!0,ft=!1,Xt,Ne;try{for(E=E.call(C);!(I=(Xt=E.next()).done)&&(k.push(Xt.value),!(_&&k.length===_));I=!0);}catch(Vl){ft=!0,Ne=Vl}finally{try{!I&&E.return!=null&&E.return()}finally{if(ft)throw Ne}}return k}}function Q(C,_){if(C){if(typeof C=="string")return W(C,_);var E=Object.prototype.toString.call(C).slice(8,-1);if(E==="Object"&&C.constructor&&(E=C.constructor.name),E==="Map"||E==="Set")return Array.from(C);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return W(C,_)}}function W(C,_){(_==null||_>C.length)&&(_=C.length);for(var E=0,k=new Array(_);E<_;E++)k[E]=C[E];return k}function q(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ut={Mobile:"mobile",Tablet:"tablet",SmartTv:"smarttv",Console:"console",Wearable:"wearable",Embedded:"embedded",Browser:void 0},mt={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",EdgeChromium:"Edge Chromium",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},Ft={IOS:"iOS",Android:"Android",WindowsPhone:"Windows Phone",Windows:"Windows",MAC_OS:"Mac OS"},St={isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1},wt=function(_){switch(_){case ut.Mobile:return{isMobile:!0};case ut.Tablet:return{isTablet:!0};case ut.SmartTv:return{isSmartTV:!0};case ut.Console:return{isConsole:!0};case ut.Wearable:return{isWearable:!0};case ut.Browser:return{isBrowser:!0};case ut.Embedded:return{isEmbedded:!0};default:return St}},Jt=function(_){return f(_)},z=function(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none";return _||E},xt=function(){return typeof window<"u"&&(window.navigator||navigator)?window.navigator||navigator:!1},ct=function(_){var E=xt();return E&&E.platform&&(E.platform.indexOf(_)!==-1||E.platform==="MacIntel"&&E.maxTouchPoints>1&&!window.MSStream)},Pe=function(_,E,k,I,ft){return{isBrowser:_,browserMajorVersion:z(E.major),browserFullVersion:z(E.version),browserName:z(E.name),engineName:z(k.name),engineVersion:z(k.version),osName:z(I.name),osVersion:z(I.version),userAgent:z(ft)}},de=function(_,E,k,I){return b({},_,{vendor:z(E.vendor),model:z(E.model),os:z(k.name),osVersion:z(k.version),ua:z(I)})},Tt=function(_,E,k,I){return{isSmartTV:_,engineName:z(E.name),engineVersion:z(E.version),osName:z(k.name),osVersion:z(k.version),userAgent:z(I)}},es=function(_,E,k,I){return{isConsole:_,engineName:z(E.name),engineVersion:z(E.version),osName:z(k.name),osVersion:z(k.version),userAgent:z(I)}},ri=function(_,E,k,I){return{isWearable:_,engineName:z(E.name),engineVersion:z(E.version),osName:z(k.name),osVersion:z(k.version),userAgent:z(I)}},At=function(_,E,k,I,ft){return{isEmbedded:_,vendor:z(E.vendor),model:z(E.model),engineName:z(k.name),engineVersion:z(k.version),osName:z(I.name),osVersion:z(I.version),userAgent:z(ft)}};function kt(C){var _=C?u(C):p,E=_.device,k=_.browser,I=_.engine,ft=_.os,Xt=_.ua,Ne=wt(E.type),Vl=Ne.isBrowser,Um=Ne.isMobile,Vm=Ne.isTablet,Fu=Ne.isSmartTV,Du=Ne.isConsole,Ou=Ne.isWearable,Nu=Ne.isEmbedded;if(Vl)return Pe(Vl,k,I,ft,Xt);if(Fu)return Tt(Fu,I,ft,Xt);if(Du)return es(Du,I,ft,Xt);if(Um||Vm)return de(Ne,E,ft,Xt);if(Ou)return ri(Ou,I,ft,Xt);if(Nu)return At(Nu,E,I,ft,Xt)}var $t=function(_){var E=_.type;return E===ut.Mobile},Ot=function(_){var E=_.type;return E===ut.Tablet},Re=function(_){var E=_.type;return E===ut.Mobile||E===ut.Tablet},ai=function(_){var E=_.type;return E===ut.SmartTv},Bs=function(_){var E=_.type;return E===ut.Browser},An=function(_){var E=_.type;return E===ut.Wearable},Fi=function(_){var E=_.type;return E===ut.Console},ve=function(_){var E=_.type;return E===ut.Embedded},bi=function(_){var E=_.vendor;return z(E)},is=function(_){var E=_.model;return z(E)},ot=function(_){var E=_.type;return z(E,"browser")},bt=function(_){var E=_.name;return E===Ft.Android},K=function(_){var E=_.name;return E===Ft.Windows},vt=function(_){var E=_.name;return E===Ft.MAC_OS},ye=function(_){var E=_.name;return E===Ft.WindowsPhone},ue=function(_){var E=_.name;return E===Ft.IOS},yt=function(_){var E=_.version;return z(E)},J=function(_){var E=_.name;return z(E)},$e=function(_){var E=_.name;return E===mt.Chrome},Fr=function(_){var E=_.name;return E===mt.Firefox},Xa=function(_){var E=_.name;return E===mt.Chromium},Wl=function(_){var E=_.name;return E===mt.Edge},ru=function(_){var E=_.name;return E===mt.Yandex},au=function(_){var E=_.name;return E===mt.Safari||E===mt.MobileSafari},ou=function(_){var E=_.name;return E===mt.MobileSafari},lu=function(_){var E=_.name;return E===mt.Opera},hu=function(_){var E=_.name;return E===mt.InternetExplorer||E===mt.Ie},cu=function(_){var E=_.name;return E===mt.MIUI},du=function(_){var E=_.name;return E===mt.SamsungBrowser},uu=function(_){var E=_.version;return z(E)},fu=function(_){var E=_.major;return z(E)},pu=function(_){var E=_.name;return z(E)},gu=function(_){var E=_.name;return z(E)},mu=function(_){var E=_.version;return z(E)},bu=function(){var _=xt(),E=_&&_.userAgent&&_.userAgent.toLowerCase();return typeof E=="string"?/electron/.test(E):!1},Dr=function(_){return typeof _=="string"&&_.indexOf("Edg/")!==-1},vu=function(){var _=xt();return _&&(/iPad|iPhone|iPod/.test(_.platform)||_.platform==="MacIntel"&&_.maxTouchPoints>1)&&!window.MSStream},Di=function(){return ct("iPad")},yu=function(){return ct("iPhone")},wu=function(){return ct("iPod")},Au=function(_){return z(_)};function _u(C){var _=C||p,E=_.device,k=_.browser,I=_.os,ft=_.engine,Xt=_.ua;return{isSmartTV:ai(E),isConsole:Fi(E),isWearable:An(E),isEmbedded:ve(E),isMobileSafari:ou(k)||Di(),isChromium:Xa(k),isMobile:Re(E)||Di(),isMobileOnly:$t(E),isTablet:Ot(E)||Di(),isBrowser:Bs(E),isDesktop:Bs(E),isAndroid:bt(I),isWinPhone:ye(I),isIOS:ue(I)||Di(),isChrome:$e(k),isFirefox:Fr(k),isSafari:au(k),isOpera:lu(k),isIE:hu(k),osVersion:yt(I),osName:J(I),fullBrowserVersion:uu(k),browserVersion:fu(k),browserName:pu(k),mobileVendor:bi(E),mobileModel:is(E),engineName:gu(ft),engineVersion:mu(ft),getUA:Au(Xt),isEdge:Wl(k)||Dr(Xt),isYandex:ru(k),deviceType:ot(E),isIOS13:vu(),isIPad13:Di(),isIPhone13:yu(),isIPod13:wu(),isElectron:bu(),isEdgeChromium:Dr(Xt),isLegacyEdge:Wl(k)&&!Dr(Xt),isWindows:K(I),isMacOs:vt(I),isMIUI:cu(k),isSamsungBrowser:du(k)}}var Eu=ai(o),Su=Fi(o),xu=An(o),Xg=ve(o),Yg=ou(n)||Di(),Kg=Xa(n),Ul=Re(o)||Di(),Tu=$t(o),Cu=Ot(o)||Di(),Pu=Bs(o),Qg=Bs(o),Ru=bt(c),ku=ye(c),Mu=ue(c)||Di(),Jg=$e(n),Zg=Fr(n),tm=au(n),em=lu(n),Lu=hu(n),im=yt(c),sm=J(c),nm=uu(n),rm=fu(n),am=pu(n),om=bi(o),lm=is(o),hm=gu(l),cm=mu(l),dm=Au(d),um=Wl(n)||Dr(d),fm=ru(n),pm=ot(o),gm=vu(),mm=Di(),bm=yu(),vm=wu(),ym=bu(),wm=Dr(d),Am=Wl(n)&&!Dr(d),_m=K(c),Em=vt(c),Sm=cu(n),xm=du(n),Tm=function(_){if(!_||typeof _!="string"){console.error("No valid user agent string was provided");return}var E=u(_),k=E.device,I=E.browser,ft=E.os,Xt=E.engine,Ne=E.ua;return _u({device:k,browser:I,os:ft,engine:Xt,ua:Ne})},Cm=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return Ru?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Pm=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return Pu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Rm=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return Lu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},km=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return Mu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Mm=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return Ul?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Lm=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return Cu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Im=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return ku?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Fm=function(_){var E=_.renderWithFragment,k=_.children;_.viewClassName,_.style;var I=O(_,["renderWithFragment","children","viewClassName","style"]);return Tu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Dm=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return Eu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Om=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return Su?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Nm=function(_){var E=_.renderWithFragment,k=_.children,I=O(_,["renderWithFragment","children"]);return xu?E?e.createElement(t.Fragment,null,k):e.createElement("div",I,k):null},Bm=function(_){var E=_.renderWithFragment,k=_.children;_.viewClassName,_.style;var I=_.condition,ft=O(_,["renderWithFragment","children","viewClassName","style","condition"]);return I?E?e.createElement(t.Fragment,null,k):e.createElement("div",ft,k):null};function Hm(C){return function(_){R(E,_);function E(k){var I;return A(this,E),I=st(this,M(E).call(this,k)),I.isEventListenerAdded=!1,I.handleOrientationChange=I.handleOrientationChange.bind(j(I)),I.onOrientationChange=I.onOrientationChange.bind(j(I)),I.onPageLoad=I.onPageLoad.bind(j(I)),I.state={isLandscape:!1,isPortrait:!1},I}return S(E,[{key:"handleOrientationChange",value:function(){this.isEventListenerAdded||(this.isEventListenerAdded=!0);var I=window.innerWidth>window.innerHeight?90:0;this.setState({isPortrait:I===0,isLandscape:I===90})}},{key:"onOrientationChange",value:function(){this.handleOrientationChange()}},{key:"onPageLoad",value:function(){this.handleOrientationChange()}},{key:"componentDidMount",value:function(){(typeof window>"u"?"undefined":w(window))!==void 0&&Ul&&(this.isEventListenerAdded?window.removeEventListener("load",this.onPageLoad,!1):(this.handleOrientationChange(),window.addEventListener("load",this.onPageLoad,!1)),window.addEventListener("resize",this.onOrientationChange,!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onOrientationChange,!1)}},{key:"render",value:function(){return e.createElement(C,P({},this.props,{isLandscape:this.state.isLandscape,isPortrait:this.state.isPortrait}))}}]),E}(e.Component)}function jm(){var C=t.useState(function(){var ft=window.innerWidth>window.innerHeight?90:0;return{isPortrait:ft===0,isLandscape:ft===90,orientation:ft===0?"portrait":"landscape"}}),_=X(C,2),E=_[0],k=_[1],I=t.useCallback(function(){var ft=window.innerWidth>window.innerHeight?90:0,Xt={isPortrait:ft===0,isLandscape:ft===90,orientation:ft===0?"portrait":"landscape"};E.orientation!==Xt.orientation&&k(Xt)},[E.orientation]);return t.useEffect(function(){return(typeof window>"u"?"undefined":w(window))!==void 0&&Ul&&(I(),window.addEventListener("load",I,!1),window.addEventListener("resize",I,!1)),function(){window.removeEventListener("resize",I,!1),window.removeEventListener("load",I,!1)}},[I]),E}function Iu(C){var _=C||window.navigator.userAgent;return u(_)}function Wm(C){var _=C||window.navigator.userAgent,E=Iu(_),k=_u(E);return[k,E]}return V.AndroidView=Cm,V.BrowserTypes=mt,V.BrowserView=Pm,V.ConsoleView=Om,V.CustomView=Bm,V.IEView=Rm,V.IOSView=km,V.MobileOnlyView=Fm,V.MobileView=Mm,V.OsTypes=Ft,V.SmartTVView=Dm,V.TabletView=Lm,V.WearableView=Nm,V.WinPhoneView=Im,V.browserName=am,V.browserVersion=rm,V.deviceDetect=kt,V.deviceType=pm,V.engineName=hm,V.engineVersion=cm,V.fullBrowserVersion=nm,V.getSelectorsByUserAgent=Tm,V.getUA=dm,V.isAndroid=Ru,V.isBrowser=Pu,V.isChrome=Jg,V.isChromium=Kg,V.isConsole=Su,V.isDesktop=Qg,V.isEdge=um,V.isEdgeChromium=wm,V.isElectron=ym,V.isEmbedded=Xg,V.isFirefox=Zg,V.isIE=Lu,V.isIOS=Mu,V.isIOS13=gm,V.isIPad13=mm,V.isIPhone13=bm,V.isIPod13=vm,V.isLegacyEdge=Am,V.isMIUI=Sm,V.isMacOs=Em,V.isMobile=Ul,V.isMobileOnly=Tu,V.isMobileSafari=Yg,V.isOpera=em,V.isSafari=tm,V.isSamsungBrowser=xm,V.isSmartTV=Eu,V.isTablet=Cu,V.isWearable=xu,V.isWinPhone=ku,V.isWindows=_m,V.isYandex=fm,V.mobileModel=lm,V.mobileVendor=om,V.osName=sm,V.osVersion=im,V.parseUserAgent=u,V.setUserAgent=Jt,V.useDeviceData=Iu,V.useDeviceSelectors=Wm,V.useMobileOrientation=jm,V.withOrientationChange=Hm,V}var bc=Fb(),bo={};bo.d=(h,t)=>{for(var e in t)bo.o(t,e)&&!bo.o(h,e)&&Object.defineProperty(h,e,{enumerable:!0,get:t[e]})};bo.o=(h,t)=>Object.prototype.hasOwnProperty.call(h,t);var it=globalThis.pdfjsLib={};bo.d(it,{AbortException:()=>Lr,AnnotationEditorLayer:()=>Rd,AnnotationEditorParamsType:()=>et,AnnotationEditorType:()=>at,AnnotationEditorUIManager:()=>Tr,AnnotationLayer:()=>Ly,AnnotationMode:()=>Ws,ColorPicker:()=>Lh,DOMSVGFactory:()=>Zd,DrawLayer:()=>Id,FeatureTest:()=>Fe,GlobalWorkerOptions:()=>Ls,ImageKind:()=>Ql,InvalidPDFException:()=>Rf,MissingPDFException:()=>Mr,OPS:()=>yi,OutputScale:()=>_c,PDFDataRangeTransport:()=>xp,PDFDateString:()=>Gd,PDFWorker:()=>Gr,PasswordResponses:()=>Bb,PermissionFlag:()=>Nb,PixelsPerInch:()=>mn,RenderingCancelledException:()=>zd,TextLayer:()=>Kc,UnexpectedResponseException:()=>tc,Util:()=>$,VerbosityLevel:()=>Qh,XfaLayer:()=>Cp,build:()=>uy,createValidAbsoluteUrl:()=>Ub,fetchData:()=>ic,getDocument:()=>sy,getFilenameFromUrl:()=>Qb,getPdfFilenameFromUrl:()=>Jb,getXfaPageViewport:()=>Zb,isDataScheme:()=>sc,isPdfFile:()=>$d,noContextMenu:()=>mi,normalizeUnicode:()=>Xb,setLayerDimensions:()=>xr,shadow:()=>gt,version:()=>dy});const Ce=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Pf=[1,0,0,1,0,0],vc=[.001,0,0,.001,0,0],Db=1e7,hc=1.35,ei={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ws={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Ob="pdfjs_internal_editor_",at={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},et={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},Nb={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},we={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ql={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Zt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Ya={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Qh={ERRORS:0,WARNINGS:1,INFOS:5},yi={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Bb={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Jh=Qh.WARNINGS;function Hb(h){Number.isInteger(h)&&(Jh=h)}function jb(){return Jh}function Zh(h){Jh>=Qh.INFOS&&console.log(`Info: ${h}`)}function ht(h){Jh>=Qh.WARNINGS&&console.log(`Warning: ${h}`)}function Nt(h){throw new Error(h)}function se(h,t){h||Nt(t)}function Wb(h){switch(h==null?void 0:h.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Ub(h,t=null,e=null){if(!h)return null;try{if(e&&typeof h=="string"){if(e.addDefaultProtocol&&h.startsWith("www.")){const s=h.match(/\./g);(s==null?void 0:s.length)>=2&&(h=`http://${h}`)}if(e.tryConvertEncoding)try{h=qb(h)}catch{}}const i=t?new URL(h,t):new URL(h);if(Wb(i))return i}catch{}return null}function gt(h,t,e,i=!1){return Object.defineProperty(h,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const wn=function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t}();class yc extends wn{constructor(t,e){super(t,"PasswordException"),this.code=e}}class wc extends wn{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Rf extends wn{constructor(t){super(t,"InvalidPDFException")}}class Mr extends wn{constructor(t){super(t,"MissingPDFException")}}class tc extends wn{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class Vb extends wn{constructor(t){super(t,"FormatError")}}class Lr extends wn{constructor(t){super(t,"AbortException")}}function kf(h){(typeof h!="object"||(h==null?void 0:h.length)===void 0)&&Nt("Invalid argument for bytesToString");const t=h.length,e=8192;if(t<e)return String.fromCharCode.apply(null,h);const i=[];for(let s=0;s<t;s+=e){const n=Math.min(s+e,t),a=h.subarray(s,n);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function ec(h){typeof h!="string"&&Nt("Invalid argument for stringToBytes");const t=h.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=h.charCodeAt(i)&255;return e}function zb(h){return String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,h&255)}function Ud(h){const t=Object.create(null);for(const[e,i]of h)t[e]=i;return t}function $b(){const h=new Uint8Array(4);return h[0]=1,new Uint32Array(h.buffer,0,1)[0]===1}function Gb(){try{return new Function(""),!0}catch{return!1}}class Fe{static get isLittleEndian(){return gt(this,"isLittleEndian",$b())}static get isEvalSupported(){return gt(this,"isEvalSupported",Gb())}static get isOffscreenCanvasSupported(){return gt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?gt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):gt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return gt(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const cc=Array.from(Array(256).keys(),h=>h.toString(16).padStart(2,"0"));var Fs,Jl,Ac;class ${static makeHexColor(t,e,i){return`#${cc[t]}${cc[e]}${cc[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const i=t[0]*e[0]+t[1]*e[2]+e[4],s=t[0]*e[1]+t[1]*e[3]+e[5];return[i,s]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2],s=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,n=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i;return[s,n]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),s=this.applyTransform(t.slice(2,4),e),n=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],s[0],n[0],a[0]),Math.min(i[1],s[1],n[1],a[1]),Math.max(i[0],s[0],n[0],a[0]),Math.max(i[1],s[1],n[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],s=t[0]*e[1]+t[1]*e[3],n=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],o=(i+a)/2,l=Math.sqrt((i+a)**2-4*(i*a-n*s))/2,c=o+l||1,d=o-l||1;return[Math.sqrt(c),Math.sqrt(d)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const n=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return n>a?null:[i,n,s,a]}static bezierBoundingBox(t,e,i,s,n,a,o,l,c){return c?(c[0]=Math.min(c[0],t,o),c[1]=Math.min(c[1],e,l),c[2]=Math.max(c[2],t,o),c[3]=Math.max(c[3],e,l)):c=[Math.min(t,o),Math.min(e,l),Math.max(t,o),Math.max(e,l)],v(this,Fs,Ac).call(this,t,i,n,o,e,s,a,l,3*(-t+3*(i-n)+o),6*(t-2*i+n),3*(i-t),c),v(this,Fs,Ac).call(this,t,i,n,o,e,s,a,l,3*(-e+3*(s-a)+l),6*(e-2*s+a),3*(s-e),c),c}}Fs=new WeakSet,Jl=function(t,e,i,s,n,a,o,l,c,d){if(c<=0||c>=1)return;const f=1-c,u=c*c,p=u*c,g=f*(f*(f*t+3*c*e)+3*u*i)+p*s,b=f*(f*(f*n+3*c*a)+3*u*o)+p*l;d[0]=Math.min(d[0],g),d[1]=Math.min(d[1],b),d[2]=Math.max(d[2],g),d[3]=Math.max(d[3],b)},Ac=function(t,e,i,s,n,a,o,l,c,d,f,u){if(Math.abs(c)<1e-12){Math.abs(d)>=1e-12&&v(this,Fs,Jl).call(this,t,e,i,s,n,a,o,l,-f/d,u);return}const p=d**2-4*f*c;if(p<0)return;const g=Math.sqrt(p),b=2*c;v(this,Fs,Jl).call(this,t,e,i,s,n,a,o,l,(-d+g)/b,u),v(this,Fs,Jl).call(this,t,e,i,s,n,a,o,l,(-d-g)/b,u)},y($,Fs);function qb(h){return decodeURIComponent(escape(h))}let dc=null,qu=null;function Xb(h){return dc||(dc=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,qu=new Map([["ﬅ","ſt"]])),h.replaceAll(dc,(t,e,i)=>e?e.normalize("NFKC"):qu.get(i))}function Yb(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const h=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(h);else for(let t=0;t<32;t++)h[t]=Math.floor(Math.random()*255);return kf(h)}const Vd="pdfjs_internal_id_",ss={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function Kb(h){return Uint8Array.prototype.toBase64?h.toBase64():btoa(kf(h))}const rs="http://www.w3.org/2000/svg",Cn=class Cn{};tt(Cn,"CSS",96),tt(Cn,"PDF",72),tt(Cn,"PDF_TO_CSS_UNITS",Cn.CSS/Cn.PDF);let mn=Cn;async function ic(h,t="text"){if(to(h,document.baseURI)){const e=await fetch(h);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",h,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class Nl{constructor({viewBox:t,scale:e,rotation:i,offsetX:s=0,offsetY:n=0,dontFlip:a=!1}){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=s,this.offsetY=n;const o=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let c,d,f,u;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,d=0,f=0,u=1;break;case 90:c=0,d=1,f=1,u=0;break;case 270:c=0,d=-1,f=-1,u=0;break;case 0:c=1,d=0,f=0,u=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(f=-f,u=-u);let p,g,b,w;c===0?(p=Math.abs(l-t[1])*e+s,g=Math.abs(o-t[0])*e+n,b=(t[3]-t[1])*e,w=(t[2]-t[0])*e):(p=Math.abs(o-t[0])*e+s,g=Math.abs(l-t[1])*e+n,b=(t[2]-t[0])*e,w=(t[3]-t[1])*e),this.transform=[c*e,d*e,f*e,u*e,p-c*e*o-f*e*l,g-d*e*o-u*e*l],this.width=b,this.height=w}get rawDims(){const{viewBox:t}=this;return gt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:n=!1}={}){return new Nl({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:n})}convertToViewportPoint(t,e){return $.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=$.applyTransform([t[0],t[1]],this.transform),i=$.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return $.applyInverseTransform([t,e],this.transform)}}class zd extends wn{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function sc(h){const t=h.length;let e=0;for(;e<t&&h[e].trim()==="";)e++;return h.substring(e,e+5).toLowerCase()==="data:"}function $d(h){return typeof h=="string"&&/\.pdf$/i.test(h)}function Qb(h){return[h]=h.split(/[#?]/,1),h.substring(h.lastIndexOf("/")+1)}function Jb(h,t="document.pdf"){if(typeof h!="string")return t;if(sc(h))return ht('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=e.exec(h);let n=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(n&&(n=n[0],n.includes("%")))try{n=i.exec(decodeURIComponent(n))[0]}catch{}return n||t}class Xu{constructor(){tt(this,"started",Object.create(null));tt(this,"times",[])}time(t){t in this.started&&ht(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ht(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:n}of this.times)t.push(`${i.padEnd(e)} ${n-s}ms
`);return t.join("")}}function to(h,t){try{const{protocol:e}=t?new URL(h,t):new URL(h);return e==="http:"||e==="https:"}catch{return!1}}function mi(h){h.preventDefault()}function Yu(h){console.log("Deprecated API usage: "+h)}var Ao;class Gd{static toDateObject(t){if(!t||typeof t!="string")return null;r(this,Ao)||m(this,Ao,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=r(this,Ao).exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let n=parseInt(e[3],10);n=n>=1&&n<=31?n:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const c=e[7]||"Z";let d=parseInt(e[8],10);d=d>=0&&d<=23?d:0;let f=parseInt(e[9],10)||0;return f=f>=0&&f<=59?f:0,c==="-"?(a+=d,o+=f):c==="+"&&(a-=d,o-=f),new Date(Date.UTC(i,s,n,a,o,l))}}Ao=new WeakMap,y(Gd,Ao);function Zb(h,{scale:t=1,rotation:e=0}){const{width:i,height:s}=h.attributes.style,n=[0,0,parseInt(i),parseInt(s)];return new Nl({viewBox:n,scale:t,rotation:e})}function qd(h){if(h.startsWith("#")){const t=parseInt(h.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return h.startsWith("rgb(")?h.slice(4,-1).split(",").map(t=>parseInt(t)):h.startsWith("rgba(")?h.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ht(`Not a valid color format: "${h}"`),[0,0,0])}function tv(h){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of h.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;h.set(e,qd(i))}t.remove()}function Ut(h){const{a:t,b:e,c:i,d:s,e:n,f:a}=h.getTransform();return[t,e,i,s,n,a]}function ns(h){const{a:t,b:e,c:i,d:s,e:n,f:a}=h.getTransform().invertSelf();return[t,e,i,s,n,a]}function xr(h,t,e=!1,i=!0){if(t instanceof Nl){const{pageWidth:s,pageHeight:n}=t.rawDims,{style:a}=h,o=Fe.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,c=`var(--scale-factor) * ${n}px`,d=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,f=o?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!e||t.rotation%180===0?(a.width=d,a.height=f):(a.width=f,a.height=d)}i&&h.setAttribute("data-main-rotation",t.rotation)}class _c{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Us,Rn,wi,kn,_o,Eo,Fh,Mf,De,Lf,If,Zl,Ff,Sc;const as=class as{constructor(t){y(this,De);y(this,Us,null);y(this,Rn,null);y(this,wi);y(this,kn,null);y(this,_o,null);m(this,wi,t),r(as,Eo)||m(as,Eo,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=m(this,Us,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=r(this,wi)._uiManager._signal;t.addEventListener("contextmenu",mi,{signal:e}),t.addEventListener("pointerdown",v(as,Fh,Mf),{signal:e});const i=m(this,kn,document.createElement("div"));i.className="buttons",t.append(i);const s=r(this,wi).toolbarPosition;if(s){const{style:n}=t,a=r(this,wi)._uiManager.direction==="ltr"?1-s[0]:s[0];n.insetInlineEnd=`${100*a}%`,n.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return v(this,De,Ff).call(this),t}get div(){return r(this,Us)}hide(){var t;r(this,Us).classList.add("hidden"),(t=r(this,Rn))==null||t.hideDropdown()}show(){var t;r(this,Us).classList.remove("hidden"),(t=r(this,_o))==null||t.shown()}async addAltText(t){const e=await t.render();v(this,De,Zl).call(this,e),r(this,kn).prepend(e,r(this,De,Sc)),m(this,_o,t)}addColorPicker(t){m(this,Rn,t);const e=t.renderButton();v(this,De,Zl).call(this,e),r(this,kn).prepend(e,r(this,De,Sc))}remove(){var t;r(this,Us).remove(),(t=r(this,Rn))==null||t.destroy(),m(this,Rn,null)}};Us=new WeakMap,Rn=new WeakMap,wi=new WeakMap,kn=new WeakMap,_o=new WeakMap,Eo=new WeakMap,Fh=new WeakSet,Mf=function(t){t.stopPropagation()},De=new WeakSet,Lf=function(t){r(this,wi)._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()},If=function(t){r(this,wi)._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()},Zl=function(t){const e=r(this,wi)._uiManager._signal;t.addEventListener("focusin",v(this,De,Lf).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",v(this,De,If).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",mi,{signal:e})},Ff=function(){const{editorType:t,_uiManager:e}=r(this,wi),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",r(as,Eo)[t]),v(this,De,Zl).call(this,i),i.addEventListener("click",s=>{e.delete()},{signal:e._signal}),r(this,kn).append(i)},Sc=function(){const t=document.createElement("div");return t.className="divider",t},y(as,Fh),y(as,Eo,null);let Ec=as;var So,Mn,Ln,vn,Df,Of,Nf;class ev{constructor(t){y(this,vn);y(this,So,null);y(this,Mn,null);y(this,Ln);m(this,Ln,t)}show(t,e,i){const[s,n]=v(this,vn,Of).call(this,e,i),{style:a}=r(this,Mn)||m(this,Mn,v(this,vn,Df).call(this));t.append(r(this,Mn)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*n}% + var(--editor-toolbar-vert-offset))`}hide(){r(this,Mn).remove()}}So=new WeakMap,Mn=new WeakMap,Ln=new WeakMap,vn=new WeakSet,Df=function(){const t=m(this,Mn,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",mi,{signal:r(this,Ln)._signal});const e=m(this,So,document.createElement("div"));return e.className="buttons",t.append(e),v(this,vn,Nf).call(this),t},Of=function(t,e){let i=0,s=0;for(const n of t){const a=n.y+n.height;if(a<i)continue;const o=n.x+(e?n.width:0);if(a>i){s=o,i=a;continue}e?o>s&&(s=o):o<s&&(s=o)}return[e?1-s:s,i]},Nf=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=r(this,Ln)._signal;t.addEventListener("contextmenu",mi,{signal:i}),t.addEventListener("click",()=>{r(this,Ln).highlightSelection("floating_button")},{signal:i}),r(this,So).append(t)};function Rh(h,t,e){for(const i of e)t.addEventListener(i,h[i].bind(h))}function iv(h){return Math.round(Math.min(255,Math.max(1,255*h))).toString(16).padStart(2,"0")}var Dh;class sv{constructor(){y(this,Dh,0)}get id(){return`${Ob}${ke(this,Dh)._++}`}}Dh=new WeakMap;var Yr,xo,_e,Kr,th;const iu=class iu{constructor(){y(this,Kr);y(this,Yr,Yb());y(this,xo,0);y(this,_e,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const n=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return gt(this,"_isSVGFittingCanvas",n)}async getFromFile(t){const{lastModified:e,name:i,size:s,type:n}=t;return v(this,Kr,th).call(this,`${e}_${i}_${s}_${n}`,t)}async getFromUrl(t){return v(this,Kr,th).call(this,t,t)}async getFromBlob(t,e){const i=await e;return v(this,Kr,th).call(this,t,i)}async getFromId(t){r(this,_e)||m(this,_e,new Map);const e=r(this,_e).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){r(this,_e)||m(this,_e,new Map);let i=r(this,_e).get(t);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${r(this,Yr)}_${ke(this,xo)._++}`,refCounter:1,isSvg:!1},r(this,_e).set(t,i),r(this,_e).set(i.id,i),i}getSvgUrl(t){const e=r(this,_e).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var s;r(this,_e)||m(this,_e,new Map);const e=r(this,_e).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const n=new OffscreenCanvas(i.width,i.height);n.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=n.convertToBlob()}(s=i.close)==null||s.call(i),e.bitmap=null}isValidId(t){return t.startsWith(`image_${r(this,Yr)}_`)}};Yr=new WeakMap,xo=new WeakMap,_e=new WeakMap,Kr=new WeakSet,th=async function(t,e){r(this,_e)||m(this,_e,new Map);let i=r(this,_e).get(t);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${r(this,Yr)}_${ke(this,xo)._++}`,refCounter:0,isSvg:!1});let s;if(typeof e=="string"?(i.url=e,s=await ic(e,"blob")):e instanceof File?s=i.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const n=iu._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,d)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,c()},a.onload=async()=>{const f=i.svgUrl=a.result;o.src=await n?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=d});a.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){console.error(s),i=null}return r(this,_e).set(t,i),i&&r(this,_e).set(i.id,i),i};let xc=iu;var ae,Vs,To,oe;class nv{constructor(t=128){y(this,ae,[]);y(this,Vs,!1);y(this,To);y(this,oe,-1);m(this,To,t)}add({cmd:t,undo:e,post:i,mustExec:s,type:n=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&t(),r(this,Vs))return;const l={cmd:t,undo:e,post:i,type:n};if(r(this,oe)===-1){r(this,ae).length>0&&(r(this,ae).length=0),m(this,oe,0),r(this,ae).push(l);return}if(a&&r(this,ae)[r(this,oe)].type===n){o&&(l.undo=r(this,ae)[r(this,oe)].undo),r(this,ae)[r(this,oe)]=l;return}const c=r(this,oe)+1;c===r(this,To)?r(this,ae).splice(0,1):(m(this,oe,c),c<r(this,ae).length&&r(this,ae).splice(c)),r(this,ae).push(l)}undo(){if(r(this,oe)===-1)return;m(this,Vs,!0);const{undo:t,post:e}=r(this,ae)[r(this,oe)];t(),e==null||e(),m(this,Vs,!1),m(this,oe,r(this,oe)-1)}redo(){if(r(this,oe)<r(this,ae).length-1){m(this,oe,r(this,oe)+1),m(this,Vs,!0);const{cmd:t,post:e}=r(this,ae)[r(this,oe)];t(),e==null||e(),m(this,Vs,!1)}}hasSomethingToUndo(){return r(this,oe)!==-1}hasSomethingToRedo(){return r(this,oe)<r(this,ae).length-1}destroy(){m(this,ae,null)}}ae=new WeakMap,Vs=new WeakMap,To=new WeakMap,oe=new WeakMap;var Oh,Bf;class Bl{constructor(t){y(this,Oh);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Fe.platform;for(const[i,s,n={}]of t)for(const a of i){const o=a.startsWith("mac+");e&&o?(this.callbacks.set(a.slice(4),{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1))):!e&&!o&&(this.callbacks.set(a,{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(v(this,Oh,Bf).call(this,e));if(!i)return;const{callback:s,options:{bubbles:n=!1,args:a=[],checker:o=null}}=i;o&&!o(t,e)||(s.bind(t,...a,e)(),n||(e.stopPropagation(),e.preventDefault()))}}Oh=new WeakSet,Bf=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const Nh=class Nh{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return tv(t),gt(this,"_colors",t)}convert(t){const e=qd(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((n,a)=>n===e[a]))return Nh._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?$.makeHexColor(...e):t}};tt(Nh,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Tc=Nh;var Qr,qe,te,pe,Jr,ls,Zr,Ai,zs,ta,In,Ni,_i,Fn,Co,Po,ea,Ro,Bi,$s,ia,Gs,Hi,Bh,qs,ko,Xs,Dn,Mo,Lo,le,Ct,hs,On,Io,Fo,Ys,ji,cs,Do,li,H,eh,Cc,Hf,jf,ih,Wf,Uf,Vf,Pc,zf,Rc,kc,$f,Me,Hs,Gf,qf,Mc,Xf,eo,Lc;const zr=class zr{constructor(t,e,i,s,n,a,o,l,c,d,f){y(this,H);y(this,Qr,new AbortController);y(this,qe,null);y(this,te,new Map);y(this,pe,new Map);y(this,Jr,null);y(this,ls,null);y(this,Zr,null);y(this,Ai,new nv);y(this,zs,null);y(this,ta,0);y(this,In,new Set);y(this,Ni,null);y(this,_i,null);y(this,Fn,new Set);y(this,Co,!1);y(this,Po,!1);y(this,ea,!1);y(this,Ro,null);y(this,Bi,null);y(this,$s,null);y(this,ia,null);y(this,Gs,!1);y(this,Hi,null);y(this,Bh,new sv);y(this,qs,!1);y(this,ko,!1);y(this,Xs,null);y(this,Dn,null);y(this,Mo,null);y(this,Lo,null);y(this,le,at.NONE);y(this,Ct,new Set);y(this,hs,null);y(this,On,null);y(this,Io,null);y(this,Fo,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});y(this,Ys,[0,0]);y(this,ji,null);y(this,cs,null);y(this,Do,null);y(this,li,null);const u=this._signal=r(this,Qr).signal;m(this,cs,t),m(this,Do,e),m(this,Jr,i),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:u}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:u}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:u}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:u}),s._on("setpreference",this.onSetPreference.bind(this),{signal:u}),s._on("switchannotationeditorparams",p=>this.updateParams(p.type,p.value),{signal:u}),v(this,H,Wf).call(this),v(this,H,$f).call(this),v(this,H,Pc).call(this),m(this,ls,n.annotationStorage),m(this,Ro,n.filterFactory),m(this,On,a),m(this,ia,o||null),m(this,Co,l),m(this,Po,c),m(this,ea,d),m(this,Lo,f||null),this.viewParameters={realScale:mn.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const t=zr.prototype,e=a=>r(a,cs).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,n=this.TRANSLATE_BIG;return gt(this,"_keyboardManager",new Bl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&r(a,cs).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&r(a,cs).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}]]))}destroy(){var t,e,i,s;(t=r(this,li))==null||t.resolve(),m(this,li,null),(e=r(this,Qr))==null||e.abort(),m(this,Qr,null),this._signal=null;for(const n of r(this,pe).values())n.destroy();r(this,pe).clear(),r(this,te).clear(),r(this,Fn).clear(),m(this,qe,null),r(this,Ct).clear(),r(this,Ai).destroy(),(i=r(this,Jr))==null||i.destroy(),(s=r(this,Hi))==null||s.hide(),m(this,Hi,null),r(this,Bi)&&(clearTimeout(r(this,Bi)),m(this,Bi,null)),r(this,ji)&&(clearTimeout(r(this,ji)),m(this,ji,null))}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return r(this,Lo)}get useNewAltTextFlow(){return r(this,Po)}get useNewAltTextWhenAddingImage(){return r(this,ea)}get hcmFilter(){return gt(this,"hcmFilter",r(this,On)?r(this,Ro).addHCMFilter(r(this,On).foreground,r(this,On).background):"none")}get direction(){return gt(this,"direction",getComputedStyle(r(this,cs)).direction)}get highlightColors(){return gt(this,"highlightColors",r(this,ia)?new Map(r(this,ia).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return gt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){m(this,Mo,t)}editAltText(t,e=!1){var i;(i=r(this,Jr))==null||i.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":m(this,ea,e);break}}onPageChanging({pageNumber:t}){m(this,ta,t-1)}focusMainContainer(){r(this,cs).focus()}findParent(t,e){for(const i of r(this,pe).values()){const{x:s,y:n,width:a,height:o}=i.div.getBoundingClientRect();if(t>=s&&t<=s+a&&e>=n&&e<=n+o)return i}return null}disableUserSelect(t=!1){r(this,Do).classList.toggle("noUserSelect",t)}addShouldRescale(t){r(this,Fn).add(t)}removeShouldRescale(t){r(this,Fn).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*mn.PDF_TO_CSS_UNITS;for(const e of r(this,Fn))e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:n,focusOffset:a}=e,o=e.toString(),c=v(this,H,eh).call(this,e).closest(".textLayer"),d=this.getSelectionBoxes(c);if(!d)return;e.empty();const f=v(this,H,Cc).call(this,c),u=r(this,le)===at.NONE,p=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:i,anchorOffset:s,focusNode:n,focusOffset:a,text:o}),u&&this.showAllEditors("highlight",!0,!0)};if(u){this.switchToMode(at.HIGHLIGHT,p);return}p()}addToAnnotationStorage(t){!t.isEmpty()&&r(this,ls)&&!r(this,ls).has(t.id)&&r(this,ls).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,r(this,Gs)&&(m(this,Gs,!1),v(this,H,ih).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of r(this,Ct))if(e.div.contains(t)){m(this,Dn,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!r(this,Dn))return;const[t,e]=r(this,Dn);m(this,Dn,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){v(this,H,Pc).call(this),v(this,H,Rc).call(this)}removeEditListeners(){v(this,H,zf).call(this),v(this,H,kc).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of r(this,_i))if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of r(this,_i))if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var i;if(t.preventDefault(),(i=r(this,qe))==null||i.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of r(this,Ct)){const n=s.serialize(!0);n&&e.push(n)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const n of e.items)for(const a of r(this,_i))if(a.isHandlingMimeForPasting(n.type)){a.paste(n,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(n){ht(`paste: "${n.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const n=[];for(const l of i){const c=await s.deserialize(l);if(!c)return;n.push(c)}const a=()=>{for(const l of n)v(this,H,Mc).call(this,l);v(this,H,Lc).call(this,n)},o=()=>{for(const l of n)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(n){ht(`paste: "${n.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),r(this,le)!==at.NONE&&!this.isEditorHandlingKeyboard&&zr._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,r(this,Gs)&&(m(this,Gs,!1),v(this,H,ih).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(v(this,H,Uf).call(this),v(this,H,Rc).call(this),v(this,H,Me).call(this,{isEditing:r(this,le)!==at.NONE,isEmpty:v(this,H,eo).call(this),hasSomethingToUndo:r(this,Ai).hasSomethingToUndo(),hasSomethingToRedo:r(this,Ai).hasSomethingToRedo(),hasSelectedEditor:!1})):(v(this,H,Vf).call(this),v(this,H,kc).call(this),v(this,H,Me).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!r(this,_i)){m(this,_i,t);for(const e of r(this,_i))v(this,H,Hs).call(this,e.defaultPropertiesToUpdate)}}getId(){return r(this,Bh).id}get currentLayer(){return r(this,pe).get(r(this,ta))}getLayer(t){return r(this,pe).get(t)}get currentPageIndex(){return r(this,ta)}addLayer(t){r(this,pe).set(t.pageIndex,t),r(this,qs)?t.enable():t.disable()}removeLayer(t){r(this,pe).delete(t.pageIndex)}async updateMode(t,e=null,i=!1){if(r(this,le)!==t&&!(r(this,li)&&(await r(this,li).promise,!r(this,li)))){if(m(this,li,Promise.withResolvers()),m(this,le,t),t===at.NONE){this.setEditingState(!1),v(this,H,qf).call(this),r(this,li).resolve();return}this.setEditingState(!0),await v(this,H,Gf).call(this),this.unselectAll();for(const s of r(this,pe).values())s.updateMode(t);if(!e){i&&this.addNewEditorFromKeyboard(),r(this,li).resolve();return}for(const s of r(this,te).values())s.annotationElementId===e?(this.setSelected(s),s.enterInEditMode()):s.unselect();r(this,li).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==r(this,le)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var i;if(r(this,_i)){switch(t){case et.CREATE:this.currentLayer.addNewEditor();return;case et.HIGHLIGHT_DEFAULT_COLOR:(i=r(this,Mo))==null||i.updateColor(e);break;case et.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(r(this,Io)||m(this,Io,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const s of r(this,Ct))s.updateParams(t,e);for(const s of r(this,_i))s.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){var n;for(const a of r(this,te).values())a.editorType===t&&a.show(e);(((n=r(this,Io))==null?void 0:n.get(et.HIGHLIGHT_SHOW_ALL))??!0)!==e&&v(this,H,Hs).call(this,[[et.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(r(this,ko)!==t){m(this,ko,t);for(const e of r(this,pe).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const i of r(this,te).values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return r(this,te).get(t)}addEditor(t){r(this,te).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(r(this,Bi)&&clearTimeout(r(this,Bi)),m(this,Bi,setTimeout(()=>{this.focusMainContainer(),m(this,Bi,null)},0))),r(this,te).delete(t.id),this.unselect(t),(!t.annotationElementId||!r(this,In).has(t.annotationElementId))&&((e=r(this,ls))==null||e.remove(t.id))}addDeletedAnnotationElement(t){r(this,In).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return r(this,In).has(t)}removeDeletedAnnotationElement(t){r(this,In).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){r(this,qe)!==t&&(m(this,qe,t),t&&v(this,H,Hs).call(this,t.propertiesToUpdate))}updateUI(t){r(this,H,Xf)===t&&v(this,H,Hs).call(this,t.propertiesToUpdate)}toggleSelected(t){if(r(this,Ct).has(t)){r(this,Ct).delete(t),t.unselect(),v(this,H,Me).call(this,{hasSelectedEditor:this.hasSelection});return}r(this,Ct).add(t),t.select(),v(this,H,Hs).call(this,t.propertiesToUpdate),v(this,H,Me).call(this,{hasSelectedEditor:!0})}setSelected(t){for(const e of r(this,Ct))e!==t&&e.unselect();r(this,Ct).clear(),r(this,Ct).add(t),t.select(),v(this,H,Hs).call(this,t.propertiesToUpdate),v(this,H,Me).call(this,{hasSelectedEditor:!0})}isSelected(t){return r(this,Ct).has(t)}get firstSelectedEditor(){return r(this,Ct).values().next().value}unselect(t){t.unselect(),r(this,Ct).delete(t),v(this,H,Me).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return r(this,Ct).size!==0}get isEnterHandled(){return r(this,Ct).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){r(this,Ai).undo(),v(this,H,Me).call(this,{hasSomethingToUndo:r(this,Ai).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:v(this,H,eo).call(this)})}redo(){r(this,Ai).redo(),v(this,H,Me).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:r(this,Ai).hasSomethingToRedo(),isEmpty:v(this,H,eo).call(this)})}addCommands(t){r(this,Ai).add(t),v(this,H,Me).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:v(this,H,eo).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...r(this,Ct)],e=()=>{for(const s of t)s.remove()},i=()=>{for(const s of t)v(this,H,Mc).call(this,s)};this.addCommands({cmd:e,undo:i,mustExec:!0})}commitOrRemove(){var t;(t=r(this,qe))==null||t.commitOrRemove()}hasSomethingToControl(){return r(this,qe)||this.hasSelection}selectAll(){for(const t of r(this,Ct))t.commit();v(this,H,Lc).call(this,r(this,te).values())}unselectAll(){if(!(r(this,qe)&&(r(this,qe).commitOrRemove(),r(this,le)!==at.NONE))&&this.hasSelection){for(const t of r(this,Ct))t.unselect();r(this,Ct).clear(),v(this,H,Me).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;r(this,Ys)[0]+=t,r(this,Ys)[1]+=e;const[s,n]=r(this,Ys),a=[...r(this,Ct)],o=1e3;r(this,ji)&&clearTimeout(r(this,ji)),m(this,ji,setTimeout(()=>{m(this,ji,null),r(this,Ys)[0]=r(this,Ys)[1]=0,this.addCommands({cmd:()=>{for(const l of a)r(this,te).has(l.id)&&l.translateInPage(s,n)},undo:()=>{for(const l of a)r(this,te).has(l.id)&&l.translateInPage(-s,-n)},mustExec:!1})},o));for(const l of a)l.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,Ni,new Map);for(const t of r(this,Ct))r(this,Ni).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!r(this,Ni))return!1;this.disableUserSelect(!1);const t=r(this,Ni);m(this,Ni,null);let e=!1;for(const[{x:s,y:n,pageIndex:a},o]of t)o.newX=s,o.newY=n,o.newPageIndex=a,e||(e=s!==o.savedX||n!==o.savedY||a!==o.savedPageIndex);if(!e)return!1;const i=(s,n,a,o)=>{if(r(this,te).has(s.id)){const l=r(this,pe).get(o);l?s._setParentAndPosition(l,n,a):(s.pageIndex=o,s.x=n,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:n,newY:a,newPageIndex:o}]of t)i(s,n,a,o)},undo:()=>{for(const[s,{savedX:n,savedY:a,savedPageIndex:o}]of t)i(s,n,a,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(r(this,Ni))for(const i of r(this,Ni).keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||r(this,Ct).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return r(this,qe)===t}getActive(){return r(this,qe)}getMode(){return r(this,le)}get imageManager(){return gt(this,"imageManager",new xc)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let c=0,d=e.rangeCount;c<d;c++)if(!t.contains(e.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:n,height:a}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(c,d,f,u)=>({x:(d-s)/a,y:1-(c+f-i)/n,width:u/a,height:f/n});break;case"180":o=(c,d,f,u)=>({x:1-(c+f-i)/n,y:1-(d+u-s)/a,width:f/n,height:u/a});break;case"270":o=(c,d,f,u)=>({x:1-(d+u-s)/a,y:(c-i)/n,width:u/a,height:f/n});break;default:o=(c,d,f,u)=>({x:(c-i)/n,y:(d-s)/a,width:f/n,height:u/a});break}const l=[];for(let c=0,d=e.rangeCount;c<d;c++){const f=e.getRangeAt(c);if(!f.collapsed)for(const{x:u,y:p,width:g,height:b}of f.getClientRects())g===0||b===0||l.push(o(u,p,g,b))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:e}){(r(this,Zr)||m(this,Zr,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=r(this,Zr))==null||e.delete(t)}renderAnnotationElement(t){var s;const e=(s=r(this,Zr))==null?void 0:s.get(t.data.id);if(!e)return;const i=r(this,ls).getRawValue(e);i&&(r(this,le)===at.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}};Qr=new WeakMap,qe=new WeakMap,te=new WeakMap,pe=new WeakMap,Jr=new WeakMap,ls=new WeakMap,Zr=new WeakMap,Ai=new WeakMap,zs=new WeakMap,ta=new WeakMap,In=new WeakMap,Ni=new WeakMap,_i=new WeakMap,Fn=new WeakMap,Co=new WeakMap,Po=new WeakMap,ea=new WeakMap,Ro=new WeakMap,Bi=new WeakMap,$s=new WeakMap,ia=new WeakMap,Gs=new WeakMap,Hi=new WeakMap,Bh=new WeakMap,qs=new WeakMap,ko=new WeakMap,Xs=new WeakMap,Dn=new WeakMap,Mo=new WeakMap,Lo=new WeakMap,le=new WeakMap,Ct=new WeakMap,hs=new WeakMap,On=new WeakMap,Io=new WeakMap,Fo=new WeakMap,Ys=new WeakMap,ji=new WeakMap,cs=new WeakMap,Do=new WeakMap,li=new WeakMap,H=new WeakSet,eh=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},Cc=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of r(this,pe).values())if(i.hasTextLayer(t))return i;return null},Hf=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=v(this,H,eh).call(this,t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(r(this,Hi)||m(this,Hi,new ev(this)),r(this,Hi).show(i,s,this.direction==="ltr"))},jf=function(){var n,a,o;const t=document.getSelection();if(!t||t.isCollapsed){r(this,hs)&&((n=r(this,Hi))==null||n.hide(),m(this,hs,null),v(this,H,Me).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===r(this,hs))return;const s=v(this,H,eh).call(this,t).closest(".textLayer");if(!s){r(this,hs)&&((a=r(this,Hi))==null||a.hide(),m(this,hs,null),v(this,H,Me).call(this,{hasSelectedText:!1}));return}if((o=r(this,Hi))==null||o.hide(),m(this,hs,e),v(this,H,Me).call(this,{hasSelectedText:!0}),!(r(this,le)!==at.HIGHLIGHT&&r(this,le)!==at.NONE)&&(r(this,le)===at.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,Gs,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=r(this,le)===at.HIGHLIGHT?v(this,H,Cc).call(this,s):null;l==null||l.toggleDrawing();const c=new AbortController,d=this.combinedSignal(c),f=u=>{u.type==="pointerup"&&u.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),u.type==="pointerup"&&v(this,H,ih).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}},ih=function(t=""){r(this,le)===at.HIGHLIGHT?this.highlightSelection(t):r(this,Co)&&v(this,H,Hf).call(this)},Wf=function(){document.addEventListener("selectionchange",v(this,H,jf).bind(this),{signal:this._signal})},Uf=function(){if(r(this,$s))return;m(this,$s,new AbortController);const t=this.combinedSignal(r(this,$s));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},Vf=function(){var t;(t=r(this,$s))==null||t.abort(),m(this,$s,null)},Pc=function(){if(r(this,Xs))return;m(this,Xs,new AbortController);const t=this.combinedSignal(r(this,Xs));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},zf=function(){var t;(t=r(this,Xs))==null||t.abort(),m(this,Xs,null)},Rc=function(){if(r(this,zs))return;m(this,zs,new AbortController);const t=this.combinedSignal(r(this,zs));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},kc=function(){var t;(t=r(this,zs))==null||t.abort(),m(this,zs,null)},$f=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Me=function(t){Object.entries(t).some(([i,s])=>r(this,Fo)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(r(this,Fo),t)}),r(this,le)===at.HIGHLIGHT&&t.hasSelectedEditor===!1&&v(this,H,Hs).call(this,[[et.HIGHLIGHT_FREE,!0]]))},Hs=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},Gf=async function(){if(!r(this,qs)){m(this,qs,!0);const t=[];for(const e of r(this,pe).values())t.push(e.enable());await Promise.all(t);for(const e of r(this,te).values())e.enable()}},qf=function(){if(this.unselectAll(),r(this,qs)){m(this,qs,!1);for(const t of r(this,pe).values())t.disable();for(const t of r(this,te).values())t.disable()}},Mc=function(t){const e=r(this,pe).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},Xf=function(){let t=null;for(t of r(this,Ct));return t},eo=function(){if(r(this,te).size===0)return!0;if(r(this,te).size===1)for(const t of r(this,te).values())return t.isEmpty();return!1},Lc=function(t){for(const e of r(this,Ct))e.unselect();r(this,Ct).clear();for(const e of t)e.isEmpty()||(r(this,Ct).add(e),e.select());v(this,H,Me).call(this,{hasSelectedEditor:this.hasSelection})},tt(zr,"TRANSLATE_SMALL",1),tt(zr,"TRANSLATE_BIG",10);let Tr=zr;var he,Wi,Ei,sa,Ui,Xe,na,Vi,je,ds,Nn,zi,Ks,Ii,io,sh;const Le=class Le{constructor(t){y(this,Ii);y(this,he,null);y(this,Wi,!1);y(this,Ei,null);y(this,sa,null);y(this,Ui,null);y(this,Xe,null);y(this,na,!1);y(this,Vi,null);y(this,je,null);y(this,ds,null);y(this,Nn,null);y(this,zi,!1);m(this,je,t),m(this,zi,t._uiManager.useNewAltTextFlow),r(Le,Ks)||m(Le,Ks,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Le._l10n??(Le._l10n=t)}async render(){const t=m(this,Ei,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=m(this,sa,document.createElement("span"));t.append(e),r(this,zi)?(t.classList.add("new"),t.setAttribute("data-l10n-id",r(Le,Ks).missing),e.setAttribute("data-l10n-id",r(Le,Ks)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=r(this,je)._uiManager._signal;t.addEventListener("contextmenu",mi,{signal:i}),t.addEventListener("pointerdown",n=>n.stopPropagation(),{signal:i});const s=n=>{n.preventDefault(),r(this,je)._uiManager.editAltText(r(this,je)),r(this,zi)&&r(this,je)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:r(this,Ii,io)}})};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",n=>{n.target===t&&n.key==="Enter"&&(m(this,na,!0),s(n))},{signal:i}),await v(this,Ii,sh).call(this),t}finish(){r(this,Ei)&&(r(this,Ei).focus({focusVisible:r(this,na)}),m(this,na,!1))}isEmpty(){return r(this,zi)?r(this,he)===null:!r(this,he)&&!r(this,Wi)}hasData(){return r(this,zi)?r(this,he)!==null||!!r(this,ds):this.isEmpty()}get guessedText(){return r(this,ds)}async setGuessedText(t){r(this,he)===null&&(m(this,ds,t),m(this,Nn,await Le._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),v(this,Ii,sh).call(this))}toggleAltTextBadge(t=!1){var e;if(!r(this,zi)||r(this,he)){(e=r(this,Vi))==null||e.remove(),m(this,Vi,null);return}if(!r(this,Vi)){const i=m(this,Vi,document.createElement("div"));i.className="noAltTextBadge",r(this,je).div.append(i)}r(this,Vi).classList.toggle("hidden",!t)}serialize(t){let e=r(this,he);return!t&&r(this,ds)===e&&(e=r(this,Nn)),{altText:e,decorative:r(this,Wi),guessedText:r(this,ds),textWithDisclaimer:r(this,Nn)}}get data(){return{altText:r(this,he),decorative:r(this,Wi)}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:s,cancel:n=!1}){i&&(m(this,ds,i),m(this,Nn,s)),!(r(this,he)===t&&r(this,Wi)===e)&&(n||(m(this,he,t),m(this,Wi,e)),v(this,Ii,sh).call(this))}toggle(t=!1){r(this,Ei)&&(!t&&r(this,Xe)&&(clearTimeout(r(this,Xe)),m(this,Xe,null)),r(this,Ei).disabled=!t)}shown(){r(this,je)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:r(this,Ii,io)}})}destroy(){var t,e;(t=r(this,Ei))==null||t.remove(),m(this,Ei,null),m(this,sa,null),m(this,Ui,null),(e=r(this,Vi))==null||e.remove(),m(this,Vi,null)}};he=new WeakMap,Wi=new WeakMap,Ei=new WeakMap,sa=new WeakMap,Ui=new WeakMap,Xe=new WeakMap,na=new WeakMap,Vi=new WeakMap,je=new WeakMap,ds=new WeakMap,Nn=new WeakMap,zi=new WeakMap,Ks=new WeakMap,Ii=new WeakSet,io=function(){return r(this,he)&&"added"||r(this,he)===null&&this.guessedText&&"review"||"missing"},sh=async function(){var s,n,a;const t=r(this,Ei);if(!t)return;if(r(this,zi)){if(t.classList.toggle("done",!!r(this,he)),t.setAttribute("data-l10n-id",r(Le,Ks)[r(this,Ii,io)]),(s=r(this,sa))==null||s.setAttribute("data-l10n-id",r(Le,Ks)[`${r(this,Ii,io)}-label`]),!r(this,he)){(n=r(this,Ui))==null||n.remove();return}}else{if(!r(this,he)&&!r(this,Wi)){t.classList.remove("done"),(a=r(this,Ui))==null||a.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=r(this,Ui);if(!e){m(this,Ui,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${r(this,je).id}`;const o=100,l=r(this,je)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(r(this,Xe)),m(this,Xe,null)},{once:!0}),t.addEventListener("mouseenter",()=>{m(this,Xe,setTimeout(()=>{m(this,Xe,null),r(this,Ui).classList.add("show"),r(this,je)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),t.addEventListener("mouseleave",()=>{var c;r(this,Xe)&&(clearTimeout(r(this,Xe)),m(this,Xe,null)),(c=r(this,Ui))==null||c.classList.remove("show")},{signal:l})}r(this,Wi)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=r(this,he)),e.parentNode||t.append(e);const i=r(this,je).getImageForAltText();i==null||i.setAttribute("aria-describedby",e.id)},y(Le,Ks,null),tt(Le,"_l10n",null);let kh=Le;var Bn,Si,jt,ra,Hn,ge,jn,Qs,Oo,Wn,Js,No,Un,us,$i,aa,oa,hi,Bo,Hh,lt,Ic,Ho,Fc,Dc,Yf,Kf,Oc,Nc,Bc,Qf,Hc,Jf,Zf,tp,jc,so;const Et=class Et{constructor(t){y(this,lt);y(this,Bn,null);y(this,Si,null);y(this,jt,null);y(this,ra,!1);y(this,Hn,!1);y(this,ge,null);y(this,jn,null);y(this,Qs,null);y(this,Oo,"");y(this,Wn,!1);y(this,Js,null);y(this,No,!1);y(this,Un,!1);y(this,us,!1);y(this,$i,null);y(this,aa,0);y(this,oa,0);y(this,hi,null);tt(this,"_editToolbar",null);tt(this,"_initialOptions",Object.create(null));tt(this,"_initialData",null);tt(this,"_isVisible",!0);tt(this,"_uiManager",null);tt(this,"_focusEventsAllowed",!0);y(this,Bo,!1);y(this,Hh,Et._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:n,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[n,a];const[o,l]=this.parentDimensions;this.x=t.x/o,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=Et.prototype._resizeWithKeyboard,e=Tr.TRANSLATE_SMALL,i=Tr.TRANSLATE_BIG;return gt(this,"_resizerKeyboardManager",new Bl([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Et.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return gt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new rv({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Et._l10n??(Et._l10n=t),Et._l10nResizer||(Et._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Et._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Et._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Nt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return r(this,Bo)}set _isDraggable(t){var e;m(this,Bo,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=r(this,Hh)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):v(this,lt,so).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(r(this,Wn)?m(this,Wn,!1):this.parent.setSelected(this))}focusout(t){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[n,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/n,this.y=(e+s)/a,this.fixAndSetPosition()}translate(t,e){v(this,lt,Ic).call(this,this.parentDimensions,t,e)}translateInPage(t,e){r(this,Js)||m(this,Js,[this.x,this.y]),v(this,lt,Ic).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){r(this,Js)||m(this,Js,[this.x,this.y]);const[i,s]=this.parentDimensions;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:c,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:n,y:a}=this;const[o,l]=this.getBaseTranslation();n+=o,a+=l,this.div.style.left=`${(100*n).toFixed(2)}%`,this.div.style.top=`${(100*a).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!r(this,Js)&&(r(this,Js)[0]!==this.x||r(this,Js)[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Et,s=i/t,n=i/e;switch(this.rotation){case 90:return[-s,n];case 180:return[s,n];case 270:return[s,-n];default:return[-s,-n]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,i]=this.pageDimensions;let{x:s,y:n,width:a,height:o}=this;if(a*=e,o*=i,s*=e,n*=i,this._mustFixPosition)switch(t){case 0:s=Math.max(0,Math.min(e-a,s)),n=Math.max(0,Math.min(i-o,n));break;case 90:s=Math.max(0,Math.min(e-o,s)),n=Math.min(i,Math.max(a,n));break;case 180:s=Math.min(e,Math.max(a,s)),n=Math.min(i,Math.max(o,n));break;case 270:s=Math.min(e,Math.max(o,s)),n=Math.max(0,Math.min(i-a,n));break}this.x=s/=e,this.y=n/=i;const[l,c]=this.getBaseTranslation();s+=l,n+=c;const{style:d}=this.div;d.left=`${(100*s).toFixed(2)}%`,d.top=`${(100*n).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var i;return v(i=Et,Ho,Fc).call(i,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var i;return v(i=Et,Ho,Fc).call(i,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(t,e){const[i,s]=this.parentDimensions;this.div.style.width=`${(100*t/i).toFixed(2)}%`,r(this,Hn)||(this.div.style.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,s=i.endsWith("%"),n=!r(this,Hn)&&e.endsWith("%");if(s&&n)return;const[a,o]=this.parentDimensions;s||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!r(this,Hn)&&!n&&(t.height=`${(100*parseFloat(e)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var t;(t=r(this,jt))==null||t.finish()}async addEditToolbar(){return this._editToolbar||r(this,Un)?this._editToolbar:(this._editToolbar=new Ec(this),this.div.append(this._editToolbar.render()),r(this,jt)&&await this._editToolbar.addAltText(r(this,jt)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=r(this,jt))==null||t.destroy())}addContainer(t){var i;const e=(i=this._editToolbar)==null?void 0:i.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){r(this,jt)||(kh.initialize(Et._l10n),m(this,jt,new kh(this)),r(this,Bn)&&(r(this,jt).data=r(this,Bn),m(this,Bn,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=r(this,jt))==null?void 0:t.data}set altTextData(t){r(this,jt)&&(r(this,jt).data=t)}get guessedAltText(){var t;return(t=r(this,jt))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=r(this,jt))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=r(this,jt))==null?void 0:e.serialize(t)}hasAltText(){return!!r(this,jt)&&!r(this,jt).isEmpty()}hasAltTextData(){var t;return((t=r(this,jt))==null?void 0:t.hasData())??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=r(this,ra)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),v(this,lt,Hc).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),Rh(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=Fe.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(m(this,Wn,!0),this._isDraggable){v(this,lt,Qf).call(this,t);return}v(this,lt,Bc).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}moveInDOM(){r(this,$i)&&clearTimeout(r(this,$i)),m(this,$i,setTimeout(()=>{var t;m(this,$i,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition()}getRect(t,e,i=this.rotation){const s=this.parentScale,[n,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=t/s,d=e/s,f=this.x*n,u=this.y*a,p=this.width*n,g=this.height*a;switch(i){case 0:return[f+c+o,a-u-d-g+l,f+c+p+o,a-u-d+l];case 90:return[f+d+o,a-u+c+l,f+d+g+o,a-u+c+p+l];case 180:return[f-c-p+o,a-u+d+l,f-c+o,a-u+d+g+l];case 270:return[f-d-g+o,a-u-c-p+l,f-d+o,a-u-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,n,a]=t,o=n-i,l=a-s;switch(this.rotation){case 0:return[i,e-a,o,l];case 90:return[i,e-s,l,o];case 180:return[n,e-s,o,l];case 270:return[n,e-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){m(this,Un,!0)}disableEditMode(){m(this,Un,!1)}isInEditMode(){return r(this,Un)}shouldGetKeyboardEvents(){return r(this,us)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){v(this,lt,Hc).call(this)}rotate(t){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){Nt("An editor must be serializable")}static async deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});s.rotation=t.rotation,m(s,Bn,t.accessibilityData);const[n,a]=s.pageDimensions,[o,l,c,d]=s.getRectInCurrentCoords(t.rect,a);return s.x=o/n,s.y=l/a,s.width=c/n,s.height=d/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t;if((t=r(this,Qs))==null||t.abort(),m(this,Qs,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),r(this,$i)&&(clearTimeout(r(this,$i)),m(this,$i,null)),v(this,lt,so).call(this),this.removeEditToolbar(),r(this,hi)){for(const e of r(this,hi).values())clearTimeout(e);m(this,hi,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(v(this,lt,Yf).call(this),r(this,ge).classList.remove("hidden"),Rh(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),m(this,jn,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=r(this,ge).children;if(!r(this,Si)){m(this,Si,Array.from(e));const a=v(this,lt,Jf).bind(this),o=v(this,lt,Zf).bind(this),l=this._uiManager._signal;for(const c of r(this,Si)){const d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",v(this,lt,tp).bind(this,d),{signal:l}),c.setAttribute("data-l10n-id",Et._l10nResizer[d])}}const i=r(this,Si)[0];let s=0;for(const a of e){if(a===i)break;s++}const n=(360-this.rotation+this.parentRotation)%360/90*(r(this,Si).length/4);if(n!==s){if(n<s)for(let o=0;o<s-n;o++)r(this,ge).append(r(this,ge).firstChild);else if(n>s)for(let o=0;o<n-s;o++)r(this,ge).firstChild.before(r(this,ge).lastChild);let a=0;for(const o of e){const c=r(this,Si)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Et._l10nResizer[c])}}v(this,lt,jc).call(this,0),m(this,us,!0),r(this,ge).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){r(this,us)&&v(this,lt,Nc).call(this,r(this,Oo),{movementX:t,movementY:e})}_stopResizingWithKeyboard(){v(this,lt,so).call(this),this.div.focus()}select(){var t,e,i;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,n;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((n=this._editToolbar)==null||n.show())});return}(e=this._editToolbar)==null||e.show(),(i=r(this,jt))==null||i.toggleAltTextBadge(!1)}unselect(){var t,e,i,s,n;(t=r(this,ge))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(n=r(this,jt))==null||n.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return r(this,No)}set isEditing(t){m(this,No,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){m(this,Hn,!0);const i=t/e,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){r(this,hi)||m(this,hi,new Map);const{action:i}=t;let s=r(this,hi).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),r(this,hi).delete(i),r(this,hi).size===0&&m(this,hi,null)},Et._telemetryTimeout),r(this,hi).set(i,s);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),m(this,ra,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,ra,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};Bn=new WeakMap,Si=new WeakMap,jt=new WeakMap,ra=new WeakMap,Hn=new WeakMap,ge=new WeakMap,jn=new WeakMap,Qs=new WeakMap,Oo=new WeakMap,Wn=new WeakMap,Js=new WeakMap,No=new WeakMap,Un=new WeakMap,us=new WeakMap,$i=new WeakMap,aa=new WeakMap,oa=new WeakMap,hi=new WeakMap,Bo=new WeakMap,Hh=new WeakMap,lt=new WeakSet,Ic=function([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this.fixAndSetPosition()},Ho=new WeakSet,Fc=function(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},Dc=function(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}},Yf=function(){if(r(this,ge))return;m(this,ge,document.createElement("div")),r(this,ge).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const s=document.createElement("div");r(this,ge).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",v(this,lt,Kf).bind(this,i),{signal:e}),s.addEventListener("contextmenu",mi,{signal:e}),s.tabIndex=-1}this.div.prepend(r(this,ge))},Kf=function(t,e){var g;e.preventDefault();const{isMac:i}=Fe.platform;if(e.button!==0||e.ctrlKey&&i)return;(g=r(this,jt))==null||g.toggle(!1);const s=this._isDraggable;this._isDraggable=!1;const n=new AbortController,a=this._uiManager.combinedSignal(n);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",v(this,lt,Nc).bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("contextmenu",mi,{signal:a});const o=this.x,l=this.y,c=this.width,d=this.height,f=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const p=()=>{var b;n.abort(),this.parent.togglePointerEvents(!0),(b=r(this,jt))==null||b.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=f,this.div.style.cursor=u,v(this,lt,Oc).call(this,o,l,c,d)};window.addEventListener("pointerup",p,{signal:a}),window.addEventListener("blur",p,{signal:a})},Oc=function(t,e,i,s){const n=this.x,a=this.y,o=this.width,l=this.height;n===t&&a===e&&o===i&&l===s||this.addCommands({cmd:()=>{this.width=o,this.height=l,this.x=n,this.y=a;const[c,d]=this.parentDimensions;this.setDims(c*o,d*l),this.fixAndSetPosition()},undo:()=>{this.width=i,this.height=s,this.x=t,this.y=e;const[c,d]=this.parentDimensions;this.setDims(c*i,d*s),this.fixAndSetPosition()},mustExec:!0})},Nc=function(t,e){const[i,s]=this.parentDimensions,n=this.x,a=this.y,o=this.width,l=this.height,c=Et.MIN_SIZE/i,d=Et.MIN_SIZE/s,f=W=>Math.round(W*1e4)/1e4,u=v(this,lt,Dc).call(this,this.rotation),p=(W,q)=>[u[0]*W+u[2]*q,u[1]*W+u[3]*q],g=v(this,lt,Dc).call(this,360-this.rotation),b=(W,q)=>[g[0]*W+g[2]*q,g[1]*W+g[3]*q];let w,A,T=!1,S=!1;switch(t){case"topLeft":T=!0,w=(W,q)=>[0,0],A=(W,q)=>[W,q];break;case"topMiddle":w=(W,q)=>[W/2,0],A=(W,q)=>[W/2,q];break;case"topRight":T=!0,w=(W,q)=>[W,0],A=(W,q)=>[0,q];break;case"middleRight":S=!0,w=(W,q)=>[W,q/2],A=(W,q)=>[0,q/2];break;case"bottomRight":T=!0,w=(W,q)=>[W,q],A=(W,q)=>[0,0];break;case"bottomMiddle":w=(W,q)=>[W/2,q],A=(W,q)=>[W/2,0];break;case"bottomLeft":T=!0,w=(W,q)=>[0,q],A=(W,q)=>[W,0];break;case"middleLeft":S=!0,w=(W,q)=>[0,q/2],A=(W,q)=>[W,q/2];break}const x=w(o,l),P=A(o,l);let R=p(...P);const M=f(n+R[0]),L=f(a+R[1]);let D=1,O=1,[j,st]=this.screenToPageTranslation(e.movementX,e.movementY);if([j,st]=b(j/i,st/s),T){const W=Math.hypot(o,l);D=O=Math.max(Math.min(Math.hypot(P[0]-x[0]-j,P[1]-x[1]-st)/W,1/o,1/l),c/o,d/l)}else S?D=Math.max(c,Math.min(1,Math.abs(P[0]-x[0]-j)))/o:O=Math.max(d,Math.min(1,Math.abs(P[1]-x[1]-st)))/l;const X=f(o*D),G=f(l*O);R=p(...A(X,G));const Z=M-R[0],Q=L-R[1];this.width=X,this.height=G,this.x=Z,this.y=Q,this.setDims(i*X,s*G),this.fixAndSetPosition()},Bc=function(t){const{isMac:e}=Fe.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},Qf=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();const i=new AbortController,s=this._uiManager.combinedSignal(i);if(e){this.div.classList.add("moving"),m(this,aa,t.clientX),m(this,oa,t.clientY);const a=o=>{const{clientX:l,clientY:c}=o,[d,f]=this.screenToPageTranslation(l-r(this,aa),c-r(this,oa));m(this,aa,l),m(this,oa,c),this._uiManager.dragSelectedEditors(d,f)};window.addEventListener("pointermove",a,{passive:!0,capture:!0,signal:s})}const n=()=>{i.abort(),e&&this.div.classList.remove("moving"),m(this,Wn,!1),this._uiManager.endDragSession()||v(this,lt,Bc).call(this,t)};window.addEventListener("pointerup",n,{signal:s}),window.addEventListener("blur",n,{signal:s})},Hc=function(){if(r(this,Qs)||!this.div)return;m(this,Qs,new AbortController);const t=this._uiManager.combinedSignal(r(this,Qs));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Jf=function(t){Et._resizerKeyboardManager.exec(this,t)},Zf=function(t){var e;r(this,us)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==r(this,ge)&&v(this,lt,so).call(this)},tp=function(t){m(this,Oo,r(this,us)?t:"")},jc=function(t){if(r(this,Si))for(const e of r(this,Si))e.tabIndex=t},so=function(){if(m(this,us,!1),v(this,lt,jc).call(this,-1),r(this,jn)){const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=r(this,jn);v(this,lt,Oc).call(this,t,e,i,s),m(this,jn,null)}},y(Et,Ho),tt(Et,"_l10n",null),tt(Et,"_l10nResizer",null),tt(Et,"_borderLineWidth",-1),tt(Et,"_colorManager",new Tc),tt(Et,"_zIndex",1),tt(Et,"_telemetryTimeout",1e3);let Rt=Et;class rv extends Rt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ku=3285377520,oi=4294901760,Oi=65535;class ep{constructor(t){this.h1=t?t&4294967295:Ku,this.h2=t?t&4294967295:Ku}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let b=0,w=t.length;b<w;b++){const A=t.charCodeAt(b);A<=255?e[i++]=A:(e[i++]=A>>>8,e[i++]=A&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,n=i-s*4,a=new Uint32Array(e.buffer,0,s);let o=0,l=0,c=this.h1,d=this.h2;const f=3432918353,u=461845907,p=f&Oi,g=u&Oi;for(let b=0;b<s;b++)b&1?(o=a[b],o=o*f&oi|o*p&Oi,o=o<<15|o>>>17,o=o*u&oi|o*g&Oi,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[b],l=l*f&oi|l*p&Oi,l=l<<15|l>>>17,l=l*u&oi|l*g&Oi,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(o=0,n){case 3:o^=e[s*4+2]<<16;case 2:o^=e[s*4+1]<<8;case 1:o^=e[s*4],o=o*f&oi|o*p&Oi,o=o<<15|o>>>17,o=o*u&oi|o*g&Oi,s&1?c^=o:d^=o}this.h1=c,this.h2=d}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&oi|t*36045&Oi,e=e*4283543511&oi|((e<<16|t>>>16)*2950163797&oi)>>>16,t^=e>>>1,t=t*444984403&oi|t*60499&Oi,e=e*3301882366&oi|((e<<16|t>>>16)*3120437893&oi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Wc=Object.freeze({map:null,hash:"",transfer:void 0});var Vn,zn,ce,jh,ip;class Xd{constructor(){y(this,jh);y(this,Vn,!1);y(this,zn,null);y(this,ce,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=r(this,ce).get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return r(this,ce).get(t)}remove(t){if(r(this,ce).delete(t),r(this,ce).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of r(this,ce).values())if(e instanceof Rt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=r(this,ce).get(t);let s=!1;if(i!==void 0)for(const[n,a]of Object.entries(e))i[n]!==a&&(s=!0,i[n]=a);else s=!0,r(this,ce).set(t,e);s&&v(this,jh,ip).call(this),e instanceof Rt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return r(this,ce).has(t)}getAll(){return r(this,ce).size>0?Ud(r(this,ce)):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return r(this,ce).size}resetModified(){r(this,Vn)&&(m(this,Vn,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new sp(this)}get serializable(){if(r(this,ce).size===0)return Wc;const t=new Map,e=new ep,i=[],s=Object.create(null);let n=!1;for(const[a,o]of r(this,ce)){const l=o instanceof Rt?o.serialize(!1,s):o;l&&(t.set(a,l),e.update(`${a}:${JSON.stringify(l)}`),n||(n=!!l.bitmap))}if(n)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:Wc}get editorStats(){let t=null;const e=new Map;for(const i of r(this,ce).values()){if(!(i instanceof Rt))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:n}=s;e.has(n)||e.set(n,Object.getPrototypeOf(i).constructor),t||(t=Object.create(null));const a=t[n]||(t[n]=new Map);for(const[o,l]of Object.entries(s)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const d=c.get(l)??0;c.set(l,d+1)}}for(const[i,s]of e)t[i]=s.computeTelemetryFinalData(t[i]);return t}resetModifiedIds(){m(this,zn,null)}get modifiedIds(){if(r(this,zn))return r(this,zn);const t=[];for(const e of r(this,ce).values())!(e instanceof Rt)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return m(this,zn,{ids:new Set(t),hash:t.join(",")})}}Vn=new WeakMap,zn=new WeakMap,ce=new WeakMap,jh=new WeakSet,ip=function(){r(this,Vn)||(m(this,Vn,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var jo;class sp extends Xd{constructor(e){super();y(this,jo);const{map:i,hash:s,transfer:n}=e.serializable,a=structuredClone(i,n?{transfer:n}:null);m(this,jo,{map:a,hash:s,transfer:n})}get print(){Nt("Should not call PrintAnnotationStorage.print")}get serializable(){return r(this,jo)}get modifiedIds(){return gt(this,"modifiedIds",{ids:new Set,hash:""})}}jo=new WeakMap;var la;class av{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){y(this,la,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),r(this,la).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||r(this,la).has(t.loadedName))){if(se(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:n}=t,a=new FontFace(i,s,n);this.addNativeFontFace(a);try{await a.load(),r(this,la).add(i),e==null||e(t)}catch{ht(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Nt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw ht(`Failed to load font '${i.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return gt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Ce||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),gt(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(se(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const n=i.shift();setTimeout(n.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:e,callback:t};return i.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return gt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(x,P){return x.charCodeAt(P)<<24|x.charCodeAt(P+1)<<16|x.charCodeAt(P+2)<<8|x.charCodeAt(P+3)&255}function s(x,P,R,M){const L=x.substring(0,P),D=x.substring(P+R);return L+M+D}let n,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function d(x,P){if(++c>30){ht("Load test font never loaded."),P();return}if(l.font="30px "+x,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){P();return}setTimeout(d.bind(null,x,P))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let u=this._loadTestFont;u=s(u,976,f.length,f);const g=16,b=1482184792;let w=i(u,g);for(n=0,a=f.length-3;n<a;n+=4)w=w-b+i(f,n)|0;n<f.length&&(w=w-b+i(f+"XXX",n)|0),u=s(u,g,4,zb(w));const A=`url(data:font/opentype;base64,${btoa(u)});`,T=`@font-face {font-family:"${f}";src:${A}}`;this.insertRule(T);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const x of[t.loadedName,f]){const P=this._document.createElement("span");P.textContent="Hi",P.style.fontFamily=x,S.append(P)}this._document.body.append(S),d(f,()=>{S.remove(),e.complete()})}}la=new WeakMap;class ov{constructor(t,{disableFontFace:e=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const s in t)this[s]=t[s];this.disableFontFace=e===!0,this._inspectFont=i}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Kb(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return(i=this._inspectFont)==null||i.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];let i;try{i=t.get(this.loadedName+"_path_"+e)}catch(n){ht(`getPathGenerator - ignoring character: "${n}".`)}if(!Array.isArray(i)||i.length===0)return this.compiledGlyphs[e]=function(n,a){};const s=[];for(let n=0,a=i.length;n<a;)switch(i[n++]){case ss.BEZIER_CURVE_TO:{const[o,l,c,d,f,u]=i.slice(n,n+6);s.push(p=>p.bezierCurveTo(o,l,c,d,f,u)),n+=6}break;case ss.MOVE_TO:{const[o,l]=i.slice(n,n+2);s.push(c=>c.moveTo(o,l)),n+=2}break;case ss.LINE_TO:{const[o,l]=i.slice(n,n+2);s.push(c=>c.lineTo(o,l)),n+=2}break;case ss.QUADRATIC_CURVE_TO:{const[o,l,c,d]=i.slice(n,n+4);s.push(f=>f.quadraticCurveTo(o,l,c,d)),n+=4}break;case ss.RESTORE:s.push(o=>o.restore());break;case ss.SAVE:s.push(o=>o.save());break;case ss.SCALE:se(s.length===2,"Scale command is only valid at the third position.");break;case ss.TRANSFORM:{const[o,l,c,d,f,u]=i.slice(n,n+6);s.push(p=>p.transform(o,l,c,d,f,u)),n+=6}break;case ss.TRANSLATE:{const[o,l]=i.slice(n,n+2);s.push(c=>c.translate(o,l)),n+=2}break}return this.compiledGlyphs[e]=function(a,o){s[0](a),s[1](a),a.scale(o,-o);for(let l=2,c=s.length;l<c;l++)s[l](a)}}}var Wo;class np{constructor({enableHWA:t=!1}){y(this,Wo,!1);m(this,Wo,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!r(this,Wo)})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Nt("Abstract method `_createCanvas` called.")}}Wo=new WeakMap;class lv extends np{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class rp{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Nt("Abstract method `_fetch` called.")}}class ap extends rp{async _fetch(t){const e=await ic(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):ec(e)}}class op{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,n){return"none"}destroy(t=!1){}}var $n,Gn,Gi,fs,Ee,Wh,qn,U,Ae,Or,Nr,nh,Br,lp,Uc,Hr,no,ro,Vc,ao;class hv extends op{constructor({docId:e,ownerDocument:i=globalThis.document}){super();y(this,U);y(this,$n);y(this,Gn);y(this,Gi);y(this,fs);y(this,Ee);y(this,Wh);y(this,qn,0);m(this,fs,e),m(this,Ee,i)}addFilter(e){if(!e)return"none";let i=r(this,U,Ae).get(e);if(i)return i;const[s,n,a]=v(this,U,nh).call(this,e),o=e.length===1?s:`${s}${n}${a}`;if(i=r(this,U,Ae).get(o),i)return r(this,U,Ae).set(e,i),i;const l=`g_${r(this,fs)}_transfer_map_${ke(this,qn)._++}`,c=v(this,U,Br).call(this,l);r(this,U,Ae).set(e,c),r(this,U,Ae).set(o,c);const d=v(this,U,Hr).call(this,l);return v(this,U,ro).call(this,s,n,a,d),c}addHCMFilter(e,i){var g;const s=`${e}-${i}`,n="base";let a=r(this,U,Or).get(n);if((a==null?void 0:a.key)===s||(a?((g=a.filter)==null||g.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},r(this,U,Or).set(n,a)),!e||!i))return a.url;const o=v(this,U,ao).call(this,e);e=$.makeHexColor(...o);const l=v(this,U,ao).call(this,i);if(i=$.makeHexColor(...l),r(this,U,Nr).style.color="",e==="#000000"&&i==="#ffffff"||e===i)return a.url;const c=new Array(256);for(let b=0;b<=255;b++){const w=b/255;c[b]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const d=c.join(","),f=`g_${r(this,fs)}_hcm_filter`,u=a.filter=v(this,U,Hr).call(this,f);v(this,U,ro).call(this,d,d,d,u),v(this,U,Uc).call(this,u);const p=(b,w)=>{const A=o[b]/255,T=l[b]/255,S=new Array(w+1);for(let x=0;x<=w;x++)S[x]=A+x/w*(T-A);return S.join(",")};return v(this,U,ro).call(this,p(0,5),p(1,5),p(2,5),u),a.url=v(this,U,Br).call(this,f),a.url}addAlphaFilter(e){let i=r(this,U,Ae).get(e);if(i)return i;const[s]=v(this,U,nh).call(this,[e]),n=`alpha_${s}`;if(i=r(this,U,Ae).get(n),i)return r(this,U,Ae).set(e,i),i;const a=`g_${r(this,fs)}_alpha_map_${ke(this,qn)._++}`,o=v(this,U,Br).call(this,a);r(this,U,Ae).set(e,o),r(this,U,Ae).set(n,o);const l=v(this,U,Hr).call(this,a);return v(this,U,Vc).call(this,s,l),o}addLuminosityFilter(e){let i=r(this,U,Ae).get(e||"luminosity");if(i)return i;let s,n;if(e?([s]=v(this,U,nh).call(this,[e]),n=`luminosity_${s}`):n="luminosity",i=r(this,U,Ae).get(n),i)return r(this,U,Ae).set(e,i),i;const a=`g_${r(this,fs)}_luminosity_map_${ke(this,qn)._++}`,o=v(this,U,Br).call(this,a);r(this,U,Ae).set(e,o),r(this,U,Ae).set(n,o);const l=v(this,U,Hr).call(this,a);return v(this,U,lp).call(this,l),e&&v(this,U,Vc).call(this,s,l),o}addHighlightHCMFilter(e,i,s,n,a){var T;const o=`${i}-${s}-${n}-${a}`;let l=r(this,U,Or).get(e);if((l==null?void 0:l.key)===o||(l?((T=l.filter)==null||T.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},r(this,U,Or).set(e,l)),!i||!s))return l.url;const[c,d]=[i,s].map(v(this,U,ao).bind(this));let f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),u=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,g]=[n,a].map(v(this,U,ao).bind(this));u<f&&([f,u,p,g]=[u,f,g,p]),r(this,U,Nr).style.color="";const b=(S,x,P)=>{const R=new Array(256),M=(u-f)/P,L=S/255,D=(x-S)/(255*P);let O=0;for(let j=0;j<=P;j++){const st=Math.round(f+j*M),X=L+j*D;for(let G=O;G<=st;G++)R[G]=X;O=st+1}for(let j=O;j<256;j++)R[j]=R[O-1];return R.join(",")},w=`g_${r(this,fs)}_hcm_${e}_filter`,A=l.filter=v(this,U,Hr).call(this,w);return v(this,U,Uc).call(this,A),v(this,U,ro).call(this,b(p[0],g[0],5),b(p[1],g[1],5),b(p[2],g[2],5),A),l.url=v(this,U,Br).call(this,w),l.url}destroy(e=!1){e&&r(this,U,Or).size!==0||(r(this,Gi)&&(r(this,Gi).parentNode.parentNode.remove(),m(this,Gi,null)),r(this,Gn)&&(r(this,Gn).clear(),m(this,Gn,null)),m(this,qn,0))}}$n=new WeakMap,Gn=new WeakMap,Gi=new WeakMap,fs=new WeakMap,Ee=new WeakMap,Wh=new WeakMap,qn=new WeakMap,U=new WeakSet,Ae=function(){return r(this,Gn)||m(this,Gn,new Map)},Or=function(){return r(this,Wh)||m(this,Wh,new Map)},Nr=function(){if(!r(this,Gi)){const e=r(this,Ee).createElement("div"),{style:i}=e;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=r(this,Ee).createElementNS(rs,"svg");s.setAttribute("width",0),s.setAttribute("height",0),m(this,Gi,r(this,Ee).createElementNS(rs,"defs")),e.append(s),s.append(r(this,Gi)),r(this,Ee).body.append(e)}return r(this,Gi)},nh=function(e){if(e.length===1){const c=e[0],d=new Array(256);for(let u=0;u<256;u++)d[u]=c[u]/255;const f=d.join(",");return[f,f,f]}const[i,s,n]=e,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=i[c]/255,o[c]=s[c]/255,l[c]=n[c]/255;return[a.join(","),o.join(","),l.join(",")]},Br=function(e){if(r(this,$n)===void 0){m(this,$n,"");const i=r(this,Ee).URL;i!==r(this,Ee).baseURI&&(sc(i)?ht('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,$n,i.split("#",1)[0]))}return`url(${r(this,$n)}#${e})`},lp=function(e){const i=r(this,Ee).createElementNS(rs,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(i)},Uc=function(e){const i=r(this,Ee).createElementNS(rs,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(i)},Hr=function(e){const i=r(this,Ee).createElementNS(rs,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",e),r(this,U,Nr).append(i),i},no=function(e,i,s){const n=r(this,Ee).createElementNS(rs,i);n.setAttribute("type","discrete"),n.setAttribute("tableValues",s),e.append(n)},ro=function(e,i,s,n){const a=r(this,Ee).createElementNS(rs,"feComponentTransfer");n.append(a),v(this,U,no).call(this,a,"feFuncR",e),v(this,U,no).call(this,a,"feFuncG",i),v(this,U,no).call(this,a,"feFuncB",s)},Vc=function(e,i){const s=r(this,Ee).createElementNS(rs,"feComponentTransfer");i.append(s),v(this,U,no).call(this,s,"feFuncA",e)},ao=function(e){return r(this,U,Nr).style.color=e,qd(getComputedStyle(r(this,U,Nr)).getPropertyValue("color"))};class hp{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Nt("Abstract method `_fetch` called.")}}class cp extends hp{async _fetch(t){const e=await ic(t,"arraybuffer");return new Uint8Array(e)}}if(Ce){var zc=Promise.withResolvers(),vo=null;(async()=>{const t=await zl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),e=await zl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),i=await zl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),s=await zl(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);let n,a;return new Map(Object.entries({fs:t,http:e,https:i,url:s,canvas:n,path2d:a}))})().then(t=>{vo=t,zc.resolve()},t=>{ht(`loadPackages: ${t}`),vo=new Map,zc.resolve()})}class bn{static get promise(){return zc.promise}static get(t){return vo==null?void 0:vo.get(t)}}async function dp(h){const e=await bn.get("fs").promises.readFile(h);return new Uint8Array(e)}class cv extends op{}class dv extends np{_createCanvas(t,e){return bn.get("canvas").createCanvas(t,e)}}class uv extends rp{async _fetch(t){return dp(t)}}class fv extends hp{async _fetch(t){return dp(t)}}const Ie={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function $c(h,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),h.clip(s)}class Yd{getPattern(){Nt("Abstract method `getPattern` called.")}}class pv extends Yd{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,s){let n;if(s===Ie.STROKE||s===Ie.FILL){const a=e.current.getClippedPathBoundingBox(s,Ut(t))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=e.cachedCanvases.getCanvas("pattern",o,l),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),i=$.transform(i,[1,0,0,1,a[0],a[1]]),d.transform(...e.baseTransform),this.matrix&&d.transform(...this.matrix),$c(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),n=t.createPattern(c.canvas,"no-repeat");const f=new DOMMatrix(i);n.setTransform(f)}else $c(t,this._bbox),n=this._createGradient(t);return n}}function uc(h,t,e,i,s,n,a,o){const l=t.coords,c=t.colors,d=h.data,f=h.width*4;let u;l[e+1]>l[i+1]&&(u=e,e=i,i=u,u=n,n=a,a=u),l[i+1]>l[s+1]&&(u=i,i=s,s=u,u=a,a=o,o=u),l[e+1]>l[i+1]&&(u=e,e=i,i=u,u=n,n=a,a=u);const p=(l[e]+t.offsetX)*t.scaleX,g=(l[e+1]+t.offsetY)*t.scaleY,b=(l[i]+t.offsetX)*t.scaleX,w=(l[i+1]+t.offsetY)*t.scaleY,A=(l[s]+t.offsetX)*t.scaleX,T=(l[s+1]+t.offsetY)*t.scaleY;if(g>=T)return;const S=c[n],x=c[n+1],P=c[n+2],R=c[a],M=c[a+1],L=c[a+2],D=c[o],O=c[o+1],j=c[o+2],st=Math.round(g),X=Math.round(T);let G,Z,Q,W,q,ut,mt,Ft;for(let St=st;St<=X;St++){if(St<w){const ct=St<g?0:(g-St)/(g-w);G=p-(p-b)*ct,Z=S-(S-R)*ct,Q=x-(x-M)*ct,W=P-(P-L)*ct}else{let ct;St>T?ct=1:w===T?ct=0:ct=(w-St)/(w-T),G=b-(b-A)*ct,Z=R-(R-D)*ct,Q=M-(M-O)*ct,W=L-(L-j)*ct}let wt;St<g?wt=0:St>T?wt=1:wt=(g-St)/(g-T),q=p-(p-A)*wt,ut=S-(S-D)*wt,mt=x-(x-O)*wt,Ft=P-(P-j)*wt;const Jt=Math.round(Math.min(G,q)),z=Math.round(Math.max(G,q));let xt=f*St+Jt*4;for(let ct=Jt;ct<=z;ct++)wt=(G-ct)/(G-q),wt<0?wt=0:wt>1&&(wt=1),d[xt++]=Z-(Z-ut)*wt|0,d[xt++]=Q-(Q-mt)*wt|0,d[xt++]=W-(W-Ft)*wt|0,d[xt++]=255}}function gv(h,t,e){const i=t.coords,s=t.colors;let n,a;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(n=0;n<l;n++){let d=n*o;for(let f=0;f<c;f++,d++)uc(h,e,i[d],i[d+1],i[d+o],s[d],s[d+1],s[d+o]),uc(h,e,i[d+o+1],i[d+1],i[d+o],s[d+o+1],s[d+1],s[d+o])}break;case"triangles":for(n=0,a=i.length;n<a;n+=3)uc(h,e,i[n],i[n+1],i[n+2],s[n],s[n+1],s[n+2]);break;default:throw new Error("illegal figure")}}class mv extends Yd{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,d=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),u=Math.min(Math.ceil(Math.abs(d*t[1]*1.1)),3e3),p=c/f,g=d/u,b={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/p,scaleY:1/g},w=f+2*2,A=u+2*2,T=i.getCanvas("mesh",w,A),S=T.context,x=S.createImageData(f,u);if(e){const R=x.data;for(let M=0,L=R.length;M<L;M+=4)R[M]=e[0],R[M+1]=e[1],R[M+2]=e[2],R[M+3]=255}for(const R of this._figures)gv(x,R,b);return S.putImageData(x,2,2),{canvas:T.canvas,offsetX:o-2*p,offsetY:l-2*g,scaleX:p,scaleY:g}}getPattern(t,e,i,s){$c(t,this._bbox);let n;if(s===Ie.SHADING)n=$.singularValueDecompose2dScale(Ut(t));else if(n=$.singularValueDecompose2dScale(e.baseTransform),this.matrix){const o=$.singularValueDecompose2dScale(this.matrix);n=[n[0]*o[0],n[1]*o[1]]}const a=this._createMeshCanvas(n,s===Ie.SHADING?null:this._background,e.cachedCanvases);return s!==Ie.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class bv extends Yd{getPattern(){return"hotpink"}}function vv(h){switch(h[0]){case"RadialAxial":return new pv(h);case"Mesh":return new mv(h);case"Dummy":return new bv}throw new Error(`Unknown IR type: ${h[0]}`)}const Qu={COLORED:1,UNCOLORED:2},Uh=class Uh{constructor(t,e,i,s,n){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=n}createPatternCanvas(t){const{bbox:e,operatorList:i,paintType:s,tilingType:n,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),Zh("TilingType: "+n);const d=e[0],f=e[1],u=e[2],p=e[3],g=u-d,b=p-f,w=$.singularValueDecompose2dScale(this.matrix),A=$.singularValueDecompose2dScale(this.baseTransform),T=w[0]*A[0],S=w[1]*A[1];let x=g,P=b,R=!1,M=!1;const L=Math.ceil(l*T),D=Math.ceil(c*S),O=Math.ceil(g*T),j=Math.ceil(b*S);L>=O?x=l:R=!0,D>=j?P=c:M=!0;const st=this.getSizeAndScale(x,this.ctx.canvas.width,T),X=this.getSizeAndScale(P,this.ctx.canvas.height,S),G=t.cachedCanvases.getCanvas("pattern",st.size,X.size),Z=G.context,Q=o.createCanvasGraphics(Z);if(Q.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Q,s,a),Z.translate(-st.scale*d,-X.scale*f),Q.transform(st.scale,0,0,X.scale,0,0),Z.save(),this.clipBbox(Q,d,f,u,p),Q.baseTransform=Ut(Q.ctx),Q.executeOperatorList(i),Q.endDrawing(),Z.restore(),R||M){const W=G.canvas;R&&(x=l),M&&(P=c);const q=this.getSizeAndScale(x,this.ctx.canvas.width,T),ut=this.getSizeAndScale(P,this.ctx.canvas.height,S),mt=q.size,Ft=ut.size,St=t.cachedCanvases.getCanvas("pattern-workaround",mt,Ft),wt=St.context,Jt=R?Math.floor(g/l):0,z=M?Math.floor(b/c):0;for(let xt=0;xt<=Jt;xt++)for(let ct=0;ct<=z;ct++)wt.drawImage(W,mt*xt,Ft*ct,mt,Ft,0,0,mt,Ft);return{canvas:St.canvas,scaleX:q.scale,scaleY:ut.scale,offsetX:d,offsetY:f}}return{canvas:G.canvas,scaleX:st.scale,scaleY:X.scale,offsetX:d,offsetY:f}}getSizeAndScale(t,e,i){const s=Math.max(Uh.MAX_PATTERN_SIZE,e);let n=Math.ceil(t*i);return n>=s?n=s:i=n/t,{scale:i,size:n}}clipBbox(t,e,i,s,n){const a=s-e,o=n-i;t.ctx.rect(e,i,a,o),t.current.updateRectMinMax(Ut(t.ctx),[e,i,s,n]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,n=t.current;switch(e){case Qu.COLORED:const a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,n.fillColor=a.fillStyle,n.strokeColor=a.strokeStyle;break;case Qu.UNCOLORED:const o=$.makeHexColor(i[0],i[1],i[2]);s.fillStyle=o,s.strokeStyle=o,n.fillColor=o,n.strokeColor=o;break;default:throw new Vb(`Unsupported paint type: ${e}`)}}getPattern(t,e,i,s){let n=i;s!==Ie.SHADING&&(n=$.transform(n,e.baseTransform),this.matrix&&(n=$.transform(n,this.matrix)));const a=this.createPatternCanvas(e);let o=new DOMMatrix(n);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=t.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};tt(Uh,"MAX_PATTERN_SIZE",3e3);let Gc=Uh;function yv({src:h,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:n=4294967295,inverseDecode:a=!1}){const o=Fe.isLittleEndian?4278190080:255,[l,c]=a?[n,o]:[o,n],d=i>>3,f=i&7,u=h.length;e=new Uint32Array(e.buffer);let p=0;for(let g=0;g<s;g++){for(const w=t+d;t<w;t++){const A=t<u?h[t]:255;e[p++]=A&128?c:l,e[p++]=A&64?c:l,e[p++]=A&32?c:l,e[p++]=A&16?c:l,e[p++]=A&8?c:l,e[p++]=A&4?c:l,e[p++]=A&2?c:l,e[p++]=A&1?c:l}if(f===0)continue;const b=t<u?h[t++]:255;for(let w=0;w<f;w++)e[p++]=b&1<<7-w?c:l}return{srcPos:t,destPos:p}}const Ju=16,Zu=100,wv=15,tf=10,ef=1e3,Ve=16;function Av(h,t){if(h._removeMirroring)throw new Error("Context is already forwarding operations.");h.__originalSave=h.save,h.__originalRestore=h.restore,h.__originalRotate=h.rotate,h.__originalScale=h.scale,h.__originalTranslate=h.translate,h.__originalTransform=h.transform,h.__originalSetTransform=h.setTransform,h.__originalResetTransform=h.resetTransform,h.__originalClip=h.clip,h.__originalMoveTo=h.moveTo,h.__originalLineTo=h.lineTo,h.__originalBezierCurveTo=h.bezierCurveTo,h.__originalRect=h.rect,h.__originalClosePath=h.closePath,h.__originalBeginPath=h.beginPath,h._removeMirroring=()=>{h.save=h.__originalSave,h.restore=h.__originalRestore,h.rotate=h.__originalRotate,h.scale=h.__originalScale,h.translate=h.__originalTranslate,h.transform=h.__originalTransform,h.setTransform=h.__originalSetTransform,h.resetTransform=h.__originalResetTransform,h.clip=h.__originalClip,h.moveTo=h.__originalMoveTo,h.lineTo=h.__originalLineTo,h.bezierCurveTo=h.__originalBezierCurveTo,h.rect=h.__originalRect,h.closePath=h.__originalClosePath,h.beginPath=h.__originalBeginPath,delete h._removeMirroring},h.save=function(){t.save(),this.__originalSave()},h.restore=function(){t.restore(),this.__originalRestore()},h.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},h.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},h.transform=function(i,s,n,a,o,l){t.transform(i,s,n,a,o,l),this.__originalTransform(i,s,n,a,o,l)},h.setTransform=function(i,s,n,a,o,l){t.setTransform(i,s,n,a,o,l),this.__originalSetTransform(i,s,n,a,o,l)},h.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},h.rotate=function(i){t.rotate(i),this.__originalRotate(i)},h.clip=function(i){t.clip(i),this.__originalClip(i)},h.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},h.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},h.bezierCurveTo=function(e,i,s,n,a,o){t.bezierCurveTo(e,i,s,n,a,o),this.__originalBezierCurveTo(e,i,s,n,a,o)},h.rect=function(e,i,s,n){t.rect(e,i,s,n),this.__originalRect(e,i,s,n)},h.closePath=function(){t.closePath(),this.__originalClosePath()},h.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class _v{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function $l(h,t,e,i,s,n,a,o,l,c){const[d,f,u,p,g,b]=Ut(h);if(f===0&&u===0){const T=a*d+g,S=Math.round(T),x=o*p+b,P=Math.round(x),R=(a+l)*d+g,M=Math.abs(Math.round(R)-S)||1,L=(o+c)*p+b,D=Math.abs(Math.round(L)-P)||1;return h.setTransform(Math.sign(d),0,0,Math.sign(p),S,P),h.drawImage(t,e,i,s,n,0,0,M,D),h.setTransform(d,f,u,p,g,b),[M,D]}if(d===0&&p===0){const T=o*u+g,S=Math.round(T),x=a*f+b,P=Math.round(x),R=(o+c)*u+g,M=Math.abs(Math.round(R)-S)||1,L=(a+l)*f+b,D=Math.abs(Math.round(L)-P)||1;return h.setTransform(0,Math.sign(f),Math.sign(u),0,S,P),h.drawImage(t,e,i,s,n,0,0,D,M),h.setTransform(d,f,u,p,g,b),[D,M]}h.drawImage(t,e,i,s,n,a,o,l,c);const w=Math.hypot(d,f),A=Math.hypot(u,p);return[w*l,A*c]}function Ev(h){const{width:t,height:e}=h;if(t>ef||e>ef)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=t+1;let a=new Uint8Array(n*(e+1)),o,l,c;const d=t+7&-8;let f=new Uint8Array(d*e),u=0;for(const A of h.data){let T=128;for(;T>0;)f[u++]=A&T?0:255,T>>=1}let p=0;for(u=0,f[u]!==0&&(a[0]=1,++p),l=1;l<t;l++)f[u]!==f[u+1]&&(a[l]=f[u]?2:1,++p),u++;for(f[u]!==0&&(a[l]=2,++p),o=1;o<e;o++){u=o*d,c=o*n,f[u-d]!==f[u]&&(a[c]=f[u]?1:8,++p);let A=(f[u]?4:0)+(f[u-d]?8:0);for(l=1;l<t;l++)A=(A>>2)+(f[u+1]?4:0)+(f[u-d+1]?8:0),s[A]&&(a[c+l]=s[A],++p),u++;if(f[u-d]!==f[u]&&(a[c+l]=f[u]?2:4,++p),p>i)return null}for(u=d*(e-1),c=o*n,f[u]!==0&&(a[c]=8,++p),l=1;l<t;l++)f[u]!==f[u+1]&&(a[c+l]=f[u]?4:8,++p),u++;if(f[u]!==0&&(a[c+l]=4,++p),p>i)return null;const g=new Int32Array([0,n,-1,0,-n,0,0,0,1]),b=new Path2D;for(o=0;p&&o<=e;o++){let A=o*n;const T=A+t;for(;A<T&&!a[A];)A++;if(A===T)continue;b.moveTo(A%n,o);const S=A;let x=a[A];do{const P=g[x];do A+=P;while(!a[A]);const R=a[A];R!==5&&R!==10?(x=R,a[A]=0):(x=R&51*x>>4,a[A]&=x>>2|x<<2),b.lineTo(A%n,A/n|0),a[A]||--p}while(S!==A);--o}return f=null,a=null,function(A){A.save(),A.scale(1/t,-1/e),A.translate(0,-e),A.fill(b),A.beginPath(),A.restore()}}class sf{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Pf,this.textMatrixScale=1,this.fontMatrix=vc,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=we.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,i){[e,i]=$.applyTransform([e,i],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,e){const i=$.applyTransform(e,t),s=$.applyTransform(e.slice(2),t),n=$.applyTransform([e[0],e[3]],t),a=$.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],s[0],n[0],a[0]),this.minY=Math.min(this.minY,i[1],s[1],n[1],a[1]),this.maxX=Math.max(this.maxX,i[0],s[0],n[0],a[0]),this.maxY=Math.max(this.maxY,i[1],s[1],n[1],a[1])}updateScalingPathMinMax(t,e){$.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,i,s,n,a,o,l,c,d){const f=$.bezierBoundingBox(e,i,s,n,a,o,l,c,d);d||this.updateRectMinMax(t,f)}getPathBoundingBox(t=Ie.FILL,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===Ie.STROKE){e||Nt("Stroke bounding box must include transform.");const s=$.singularValueDecompose2dScale(e),n=s[0]*this.lineWidth/2,a=s[1]*this.lineWidth/2;i[0]-=n,i[1]-=a,i[2]+=n,i[3]+=a}return i}updateClipFromPath(){const t=$.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Ie.FILL,e=null){return $.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function nf(h,t){if(typeof ImageData<"u"&&t instanceof ImageData){h.putImageData(t,0,0);return}const e=t.height,i=t.width,s=e%Ve,n=(e-s)/Ve,a=s===0?n:n+1,o=h.createImageData(i,Ve);let l=0,c;const d=t.data,f=o.data;let u,p,g,b;if(t.kind===Ql.GRAYSCALE_1BPP){const w=d.byteLength,A=new Uint32Array(f.buffer,0,f.byteLength>>2),T=A.length,S=i+7>>3,x=4294967295,P=Fe.isLittleEndian?4278190080:255;for(u=0;u<a;u++){for(g=u<n?Ve:s,c=0,p=0;p<g;p++){const R=w-l;let M=0;const L=R>S?i:R*8-7,D=L&-8;let O=0,j=0;for(;M<D;M+=8)j=d[l++],A[c++]=j&128?x:P,A[c++]=j&64?x:P,A[c++]=j&32?x:P,A[c++]=j&16?x:P,A[c++]=j&8?x:P,A[c++]=j&4?x:P,A[c++]=j&2?x:P,A[c++]=j&1?x:P;for(;M<L;M++)O===0&&(j=d[l++],O=128),A[c++]=j&O?x:P,O>>=1}for(;c<T;)A[c++]=0;h.putImageData(o,0,u*Ve)}}else if(t.kind===Ql.RGBA_32BPP){for(p=0,b=i*Ve*4,u=0;u<n;u++)f.set(d.subarray(l,l+b)),l+=b,h.putImageData(o,0,p),p+=Ve;u<a&&(b=i*s*4,f.set(d.subarray(l,l+b)),h.putImageData(o,0,p))}else if(t.kind===Ql.RGB_24BPP)for(g=Ve,b=i*g,u=0;u<a;u++){for(u>=n&&(g=s,b=i*g),c=0,p=b;p--;)f[c++]=d[l++],f[c++]=d[l++],f[c++]=d[l++],f[c++]=255;h.putImageData(o,0,u*Ve)}else throw new Error(`bad image kind: ${t.kind}`)}function rf(h,t){if(t.bitmap){h.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,s=e%Ve,n=(e-s)/Ve,a=s===0?n:n+1,o=h.createImageData(i,Ve);let l=0;const c=t.data,d=o.data;for(let f=0;f<a;f++){const u=f<n?Ve:s;({srcPos:l}=yv({src:c,srcPos:l,dest:d,width:i,height:u,nonBlackColor:0})),h.putImageData(o,0,f*Ve)}}function Ka(h,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)h[i]!==void 0&&(t[i]=h[i]);h.setLineDash!==void 0&&(t.setLineDash(h.getLineDash()),t.lineDashOffset=h.lineDashOffset)}function Gl(h){if(h.strokeStyle=h.fillStyle="#000000",h.fillRule="nonzero",h.globalAlpha=1,h.lineWidth=1,h.lineCap="butt",h.lineJoin="miter",h.miterLimit=10,h.globalCompositeOperation="source-over",h.font="10px sans-serif",h.setLineDash!==void 0&&(h.setLineDash([]),h.lineDashOffset=0),!Ce){const{filter:t}=h;t!=="none"&&t!==""&&(h.filter="none")}}function af(h,t){if(t)return!0;const e=$.singularValueDecompose2dScale(h);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*mn.PDF_TO_CSS_UNITS);return e[0]<=i&&e[1]<=i}const Sv=["butt","round","square"],xv=["miter","round","bevel"],Tv={},of={};var yn,qc,Xc;const su=class su{constructor(t,e,i,s,n,{optionalContentConfig:a,markedContentStack:o=null},l,c){y(this,yn);this.ctx=t,this.current=new sf(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new _v(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const n=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,n,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",n,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Ut(this.compositeCtx))}this.ctx.save(),Gl(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Ut(this.ctx)}executeOperatorList(t,e,i,s){const n=t.argsArray,a=t.fnArray;let o=e||0;const l=n.length;if(l===o)return o;const c=l-o>tf&&typeof i=="function",d=c?Date.now()+wv:0;let f=0;const u=this.commonObjs,p=this.objs;let g;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(g=a[o],g!==yi.dependency)this[g].apply(this,n[o]);else for(const b of n[o]){const w=b.startsWith("g_")?u:p;if(!w.has(b))return w.get(b,i),o}if(o++,o===l)return o;if(c&&++f>tf){if(Date.now()>d)return i(),o;f=0}}}endDrawing(){v(this,yn,qc).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),v(this,yn,Xc).call(this)}_scaleImage(t,e){const i=t.width??t.displayWidth,s=t.height??t.displayHeight;let n=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),o=i,l=s,c="prescale1",d,f;for(;n>2&&o>1||a>2&&l>1;){let u=o,p=l;n>2&&o>1&&(u=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),n/=o/u),a>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/p),d=this.cachedCanvases.getCanvas(c,u,p),f=d.context,f.clearRect(0,0,u,p),f.drawImage(t,0,0,o,l,0,0,u,p),t=d.canvas,o=u,l=p,c=c==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:l}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:s}=t,n=this.current.fillColor,a=this.current.patternFill,o=Ut(e);let l,c,d,f;if((t.bitmap||t.data)&&t.count>1){const L=t.bitmap||t.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),n]),l=this._cachedBitmapsMap.get(L),l||(l=new Map,this._cachedBitmapsMap.set(L,l));const D=l.get(c);if(D&&!a){const O=Math.round(Math.min(o[0],o[2])+o[4]),j=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:D,offsetX:O,offsetY:j}}d=D}d||(f=this.cachedCanvases.getCanvas("maskCanvas",i,s),rf(f.context,t));let u=$.transform(o,[1/i,0,0,-1/s,0,0]);u=$.transform(u,[1,0,0,1,0,-s]);const[p,g,b,w]=$.getAxialAlignedBoundingBox([0,0,i,s],u),A=Math.round(b-p)||1,T=Math.round(w-g)||1,S=this.cachedCanvases.getCanvas("fillCanvas",A,T),x=S.context,P=p,R=g;x.translate(-P,-R),x.transform(...u),d||(d=this._scaleImage(f.canvas,ns(x)),d=d.img,l&&a&&l.set(c,d)),x.imageSmoothingEnabled=af(Ut(x),t.interpolate),$l(x,d,0,0,d.width,d.height,0,0,i,s),x.globalCompositeOperation="source-in";const M=$.transform(ns(x),[1,0,0,1,-P,-R]);return x.fillStyle=a?n.getPattern(e,this,M,Ie.FILL):n,x.fillRect(0,0,i,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,S.canvas)),{canvas:S.canvas,offsetX:Math.round(P),offsetY:Math.round(R)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Sv[t]}setLineJoin(t){this.ctx.lineJoin=xv[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx,this.ctx=s.context;const n=this.ctx;n.setTransform(...Ut(this.suspendedCtx)),Ka(this.suspendedCtx,n),Av(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ka(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,s){const n=s[0],a=s[1],o=s[2]-n,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(e.context,i,o,l,e.subtype,e.backdrop,e.transferMap,n,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,n,a,o,l,c,d,f){let u=t.canvas,p=l-d,g=c-f;if(a){const w=$.makeHexColor(...a);if(p<0||g<0||p+i>u.width||g+s>u.height){const A=this.cachedCanvases.getCanvas("maskExtension",i,s),T=A.context;T.drawImage(u,-p,-g),T.globalCompositeOperation="destination-atop",T.fillStyle=w,T.fillRect(0,0,i,s),T.globalCompositeOperation="source-over",u=A.canvas,p=g=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(p,g,i,s),t.clip(A),t.globalCompositeOperation="destination-atop",t.fillStyle=w,t.fillRect(p,g,i,s),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),n==="Alpha"&&o?e.filter=this.filterFactory.addAlphaFilter(o):n==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(o));const b=new Path2D;b.rect(l,c,i,s),e.clip(b),e.globalCompositeOperation="destination-in",e.drawImage(u,p,g,i,s,l,c,i,s),e.restore()}save(){this.inSMaskMode?(Ka(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Ka(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,i,s,n,a){this.ctx.transform(t,e,i,s,n,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){const s=this.ctx,n=this.current;let a=n.x,o=n.y,l,c;const d=Ut(s),f=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,u=f?i.slice(0):null;for(let p=0,g=0,b=t.length;p<b;p++)switch(t[p]|0){case yi.rectangle:a=e[g++],o=e[g++];const w=e[g++],A=e[g++],T=a+w,S=o+A;s.moveTo(a,o),w===0||A===0?s.lineTo(T,S):(s.lineTo(T,o),s.lineTo(T,S),s.lineTo(a,S)),f||n.updateRectMinMax(d,[a,o,T,S]),s.closePath();break;case yi.moveTo:a=e[g++],o=e[g++],s.moveTo(a,o),f||n.updatePathMinMax(d,a,o);break;case yi.lineTo:a=e[g++],o=e[g++],s.lineTo(a,o),f||n.updatePathMinMax(d,a,o);break;case yi.curveTo:l=a,c=o,a=e[g+4],o=e[g+5],s.bezierCurveTo(e[g],e[g+1],e[g+2],e[g+3],a,o),n.updateCurvePathMinMax(d,l,c,e[g],e[g+1],e[g+2],e[g+3],a,o,u),g+=6;break;case yi.curveTo2:l=a,c=o,s.bezierCurveTo(a,o,e[g],e[g+1],e[g+2],e[g+3]),n.updateCurvePathMinMax(d,l,c,a,o,e[g],e[g+1],e[g+2],e[g+3],u),a=e[g+2],o=e[g+3],g+=4;break;case yi.curveTo3:l=a,c=o,a=e[g+2],o=e[g+3],s.bezierCurveTo(e[g],e[g+1],a,o,a,o),n.updateCurvePathMinMax(d,l,c,e[g],e[g+1],a,o,a,o,u),g+=4;break;case yi.closePath:s.closePath();break}f&&n.updateScalingPathMinMax(d,u),n.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(e.save(),e.strokeStyle=i.getPattern(e,this,ns(e),Ie.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let n=!1;s&&(e.save(),e.fillStyle=i.getPattern(e,this,ns(e),Ie.FILL),n=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),n&&e.restore(),t&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Tv}eoClip(){this.pendingClip=of}beginText(){this.current.textMatrix=Pf,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}e.save(),e.beginPath();for(const i of t)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var d;const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||vc,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&ht("Invalid font matrix for font "+t),e<0?(e=-e,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const n=i.loadedName||"sans-serif",a=((d=i.systemFontInfo)==null?void 0:d.css)||`"${n}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=e;e<Ju?c=Ju:e>Zu&&(c=Zu),this.current.fontSizeScale=e/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,s,n,a){this.current.textMatrix=[t,e,i,s,n,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,s){const n=this.ctx,a=this.current,o=a.font,l=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,d=l&we.FILL_STROKE_MASK,f=!!(l&we.ADD_TO_PATH_FLAG),u=a.patternFill&&!o.missingFile;let p;(o.disableFontFace||f||u)&&(p=o.getPathGenerator(this.commonObjs,t)),o.disableFontFace||u?(n.save(),n.translate(e,i),n.beginPath(),p(n,c),s&&n.setTransform(...s),(d===we.FILL||d===we.FILL_STROKE)&&n.fill(),(d===we.STROKE||d===we.FILL_STROKE)&&n.stroke(),n.restore()):((d===we.FILL||d===we.FILL_STROKE)&&n.fillText(t,e,i),(d===we.STROKE||d===we.FILL_STROKE)&&n.strokeText(t,e,i)),f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ut(n),x:e,y:i,fontSize:c,addToPath:p})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return gt(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const s=e.fontSize;if(s===0)return;const n=this.ctx,a=e.fontSizeScale,o=e.charSpacing,l=e.wordSpacing,c=e.fontDirection,d=e.textHScale*c,f=t.length,u=i.vertical,p=u?1:-1,g=i.defaultVMetrics,b=s*e.fontMatrix[0],w=e.textRenderingMode===we.FILL&&!i.disableFontFace&&!e.patternFill;n.save(),n.transform(...e.textMatrix),n.translate(e.x,e.y+e.textRise),c>0?n.scale(d,-1):n.scale(d,1);let A;if(e.patternFill){n.save();const R=e.fillColor.getPattern(n,this,ns(n),Ie.FILL);A=Ut(n),n.restore(),n.fillStyle=R}let T=e.lineWidth;const S=e.textMatrixScale;if(S===0||T===0){const R=e.textRenderingMode&we.FILL_STROKE_MASK;(R===we.STROKE||R===we.FILL_STROKE)&&(T=this.getSinglePixelWidth())}else T/=S;if(a!==1&&(n.scale(a,a),T/=a),n.lineWidth=T,i.isInvalidPDFjsFont){const R=[];let M=0;for(const L of t)R.push(L.unicode),M+=L.width;n.fillText(R.join(""),0,0),e.x+=M*b*d,n.restore(),this.compose();return}let x=0,P;for(P=0;P<f;++P){const R=t[P];if(typeof R=="number"){x+=p*R*s/1e3;continue}let M=!1;const L=(R.isSpace?l:0)+o,D=R.fontChar,O=R.accent;let j,st,X=R.width;if(u){const Z=R.vmetric||g,Q=-(R.vmetric?Z[1]:X*.5)*b,W=Z[2]*b;X=Z?-Z[0]:X,j=Q/a,st=(x+W)/a}else j=x/a,st=0;if(i.remeasure&&X>0){const Z=n.measureText(D).width*1e3/s*a;if(X<Z&&this.isFontSubpixelAAEnabled){const Q=X/Z;M=!0,n.save(),n.scale(Q,1),j/=Q}else X!==Z&&(j+=(X-Z)/2e3*s/a)}if(this.contentVisible&&(R.isInFont||i.missingFile)){if(w&&!O)n.fillText(D,j,st);else if(this.paintChar(D,j,st,A),O){const Z=j+s*O.offset.x/a,Q=st-s*O.offset.y/a;this.paintChar(O.fontChar,Z,Q,A)}}const G=u?X*b-L*c:X*b+L*c;x+=G,M&&n.restore()}u?e.y-=x:e.x+=x*d,n.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,s=i.font,n=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,d=i.textHScale*a,f=i.fontMatrix||vc,u=t.length,p=i.textRenderingMode===we.INVISIBLE;let g,b,w,A;if(!(p||n===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(d,a),g=0;g<u;++g){if(b=t[g],typeof b=="number"){A=o*b*n/1e3,this.ctx.translate(A,0),i.x+=A*d;continue}const T=(b.isSpace?c:0)+l,S=s.charProcOperatorList[b.operatorListId];if(!S){ht(`Type3 character "${b.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=b,this.save(),e.scale(n,n),e.transform(...f),this.executeOperatorList(S),this.restore()),w=$.applyTransform([b.width,0],f)[0]*n+T,e.translate(w,0),i.x+=w*d}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,s,n,a){this.ctx.rect(i,s,n-i,a-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const i=t[1],s=this.baseTransform||Ut(this.ctx),n={createCanvasGraphics:a=>new su(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Gc(t,i,this.ctx,n,s)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){this.ctx.strokeStyle=this.current.strokeColor=$.makeHexColor(t,e,i)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(t,e,i){this.ctx.fillStyle=this.current.fillColor=$.makeHexColor(t,e,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=vv(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,ns(e),Ie.SHADING);const s=ns(e);{const{width:n,height:a}=e.canvas,[o,l,c,d]=$.getAxialAlignedBoundingBox([0,0,n,a],s);this.ctx.fillRect(o,l,c-o,d-l)}this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Nt("Should not call beginInlineImage")}beginImageData(){Nt("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Ut(this.ctx),e)){const i=e[2]-e[0],s=e[3]-e[1];this.ctx.rect(e[0],e[1],i,s),this.current.updateRectMinMax(Ut(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Zh("TODO: Support non-isolated groups."),t.knockout&&ht("Knockout groups not supported.");const i=Ut(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=$.getAxialAlignedBoundingBox(t.bbox,Ut(e));const n=[0,0,e.canvas.width,e.canvas.height];s=$.intersect(s,n)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),c=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(d,l,c),u=f.context;u.translate(-a,-o),u.transform(...i),t.smask?this.smaskStack.push({canvas:f.canvas,context:u,offsetX:a,offsetY:o,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,o),e.save()),Ka(e,u),this.ctx=u,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=Ut(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const n=$.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],s);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,e,i,s,n){if(v(this,yn,qc).call(this),Gl(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],o=e[3]-e[1];if(n&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=o;const[l,c]=$.singularValueDecompose2dScale(Ut(this.ctx)),{viewportScale:d}=this,f=Math.ceil(a*this.outputScaleX*d),u=Math.ceil(o*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(f,u);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),Gl(this.ctx)}else Gl(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new sf(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),v(this,yn,Xc).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=Ev(t)),s.compiled)){s.compiled(i);return}const n=this._createMaskCanvas(t),a=n.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,n.offsetX,n.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,s=0,n,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const o=this.ctx;o.save();const l=Ut(o);o.transform(e,i,s,n,0,0);const c=this._createMaskCanvas(t);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let d=0,f=a.length;d<f;d+=2){const u=$.transform(l,[e,i,s,n,a[d],a[d+1]]),[p,g]=$.applyTransform([0,0],u);o.drawImage(c.canvas,p,g)}o.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const n of t){const{data:a,width:o,height:l,transform:c}=n,d=this.cachedCanvases.getCanvas("maskCanvas",o,l),f=d.context;f.save();const u=this.getObject(a,n);rf(f,u),f.globalCompositeOperation="source-in",f.fillStyle=s?i.getPattern(f,this,ns(e),Ie.FILL):i,f.fillRect(0,0,o,l),f.restore(),e.save(),e.transform(...c),e.scale(1,-1),$l(e,d.canvas,0,0,o,l,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){ht("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,i,s){if(!this.contentVisible)return;const n=this.getObject(t);if(!n){ht("Dependent image isn't ready yet");return}const a=n.width,o=n.height,l=[];for(let c=0,d=s.length;c<d;c+=2)l.push({transform:[e,0,0,i,s[c],s[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(n,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:s}=t,n=this.cachedCanvases.getCanvas("inlineImage",i,s),a=n.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",n.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,s=this.ctx;if(this.save(),!Ce){const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none")}s.scale(1/e,-1/i);let n;if(t.bitmap)n=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)n=t;else{const l=this.cachedCanvases.getCanvas("inlineImage",e,i).context;nf(l,t),n=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(n,ns(s));s.imageSmoothingEnabled=af(Ut(s),t.interpolate),$l(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const n=t.width,a=t.height,l=this.cachedCanvases.getCanvas("inlineImage",n,a).context;nf(l,t),s=this.applyTransferMapsToCanvas(l)}for(const n of e)i.save(),i.transform(...n.transform),i.scale(1,-1),$l(i,s,n.x,n.y,n.w,n.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===of?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Ut(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:n}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const l=Math.abs(e),c=Math.abs(n);if(l===c)if(t===0)a=o=1/l;else{const d=l*t;a=o=d<1?1/d:1}else if(t===0)a=1/l,o=1/c;else{const d=l*t,f=c*t;a=d<1?1/d:1,o=f<1?1/f:1}}else{const l=Math.abs(e*n-i*s),c=Math.hypot(e,i),d=Math.hypot(s,n);if(t===0)a=d/l,o=c/l;else{const f=t*l;a=d>f?d/f:1,o=c>f?c/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:i}=this.current,[s,n]=this.getScaleForStroking();if(e.lineWidth=i||1,s===1&&n===1){e.stroke();return}const a=e.getLineDash();if(t&&e.save(),e.scale(s,n),a.length>0){const o=Math.max(s,n);e.setLineDash(a.map(l=>l/o)),e.lineDashOffset/=o}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};yn=new WeakSet,qc=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Xc=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}};let $r=su;for(const h in yi)$r.prototype[h]!==void 0&&($r.prototype[yi[h]]=$r.prototype[h]);var Uo,Vo;class Ls{static get workerPort(){return r(this,Uo)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");m(this,Uo,t)}static get workerSrc(){return r(this,Vo)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");m(this,Vo,t)}}Uo=new WeakMap,Vo=new WeakMap,y(Ls,Uo,null),y(Ls,Vo,"");const ql={UNKNOWN:0,DATA:1,ERROR:2},Yt={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Ge(h){switch(h instanceof Error||typeof h=="object"&&h!==null||Nt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),h.name){case"AbortException":return new Lr(h.message);case"MissingPDFException":return new Mr(h.message);case"PasswordException":return new yc(h.message,h.code);case"UnexpectedResponseException":return new tc(h.message,h.status);case"UnknownErrorException":return new wc(h.message,h.details);default:return new wc(h.message,h.toString())}}var ha,gi,up,fp,pp,rh;class oo{constructor(t,e,i){y(this,gi);y(this,ha,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",v(this,gi,up).bind(this),{signal:r(this,ha).signal})}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,n=Promise.withResolvers();this.callbackCapabilities[s]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(a){n.reject(a)}return n.promise}sendWithStream(t,e,i,s){const n=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const d=Promise.withResolvers();return this.streamControllers[n]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:t,streamId:n,data:e,desiredSize:c.desiredSize},s),d.promise},pull:c=>{const d=Promise.withResolvers();return this.streamControllers[n].pullCall=d,l.postMessage({sourceName:a,targetName:o,stream:Yt.PULL,streamId:n,desiredSize:c.desiredSize}),d.promise},cancel:c=>{se(c instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[n].cancelCall=d,this.streamControllers[n].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Yt.CANCEL,streamId:n,reason:Ge(c)}),d.promise}},i)}destroy(){var t;(t=r(this,ha))==null||t.abort(),m(this,ha,null)}}ha=new WeakMap,gi=new WeakSet,up=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){v(this,gi,pp).call(this,t);return}if(t.callback){const i=t.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===ql.DATA)s.resolve(t.data);else if(t.callback===ql.ERROR)s.reject(Ge(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,s=t.sourceName,n=this.comObj;new Promise(function(a){a(e(t.data))}).then(function(a){n.postMessage({sourceName:i,targetName:s,callback:ql.DATA,callbackId:t.callbackId,data:a})},function(a){n.postMessage({sourceName:i,targetName:s,callback:ql.ERROR,callbackId:t.callbackId,reason:Ge(a)})});return}if(t.streamId){v(this,gi,fp).call(this,t);return}e(t.data)},fp=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,n=this.comObj,a=this,o=this.actionHandler[t.action],l={enqueue(c,d=1,f){if(this.isCancelled)return;const u=this.desiredSize;this.desiredSize-=d,u>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),n.postMessage({sourceName:i,targetName:s,stream:Yt.ENQUEUE,streamId:e,chunk:c},f)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:Yt.CLOSE,streamId:e}),delete a.streamSinks[e])},error(c){se(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:Yt.ERROR,streamId:e,reason:Ge(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[e]=l,new Promise(function(c){c(o(t.data,l))}).then(function(){n.postMessage({sourceName:i,targetName:s,stream:Yt.START_COMPLETE,streamId:e,success:!0})},function(c){n.postMessage({sourceName:i,targetName:s,stream:Yt.START_COMPLETE,streamId:e,reason:Ge(c)})})},pp=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,n=this.comObj,a=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case Yt.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(Ge(t.reason));break;case Yt.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(Ge(t.reason));break;case Yt.PULL:if(!o){n.postMessage({sourceName:i,targetName:s,stream:Yt.PULL_COMPLETE,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,new Promise(function(l){var c;l((c=o.onPull)==null?void 0:c.call(o))}).then(function(){n.postMessage({sourceName:i,targetName:s,stream:Yt.PULL_COMPLETE,streamId:e,success:!0})},function(l){n.postMessage({sourceName:i,targetName:s,stream:Yt.PULL_COMPLETE,streamId:e,reason:Ge(l)})});break;case Yt.ENQUEUE:if(se(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case Yt.CLOSE:if(se(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),v(this,gi,rh).call(this,a,e);break;case Yt.ERROR:se(a,"error should have stream controller"),a.controller.error(Ge(t.reason)),v(this,gi,rh).call(this,a,e);break;case Yt.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(Ge(t.reason)),v(this,gi,rh).call(this,a,e);break;case Yt.CANCEL:if(!o)break;new Promise(function(l){var c;l((c=o.onCancel)==null?void 0:c.call(o,Ge(t.reason)))}).then(function(){n.postMessage({sourceName:i,targetName:s,stream:Yt.CANCEL_COMPLETE,streamId:e,success:!0})},function(l){n.postMessage({sourceName:i,targetName:s,stream:Yt.CANCEL_COMPLETE,streamId:e,reason:Ge(l)})}),o.sinkCapability.reject(Ge(t.reason)),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},rh=async function(t,e){var i,s,n;await Promise.allSettled([(i=t.startCall)==null?void 0:i.promise,(s=t.pullCall)==null?void 0:s.promise,(n=t.cancelCall)==null?void 0:n.promise]),delete this.streamControllers[e]};var Xn,zo;class Cv{constructor({parsedData:t,rawData:e}){y(this,Xn);y(this,zo);m(this,Xn,t),m(this,zo,e)}getRaw(){return r(this,zo)}get(t){return r(this,Xn).get(t)??null}getAll(){return Ud(r(this,Xn))}has(t){return r(this,Xn).has(t)}}Xn=new WeakMap,zo=new WeakMap;const jr=Symbol("INTERNAL");var $o,Go,qo,ca;class Pv{constructor(t,{name:e,intent:i,usage:s,rbGroups:n}){y(this,$o,!1);y(this,Go,!1);y(this,qo,!1);y(this,ca,!0);m(this,$o,!!(t&ei.DISPLAY)),m(this,Go,!!(t&ei.PRINT)),this.name=e,this.intent=i,this.usage=s,this.rbGroups=n}get visible(){if(r(this,qo))return r(this,ca);if(!r(this,ca))return!1;const{print:t,view:e}=this.usage;return r(this,$o)?(e==null?void 0:e.viewState)!=="OFF":r(this,Go)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,i=!1){t!==jr&&Nt("Internal method `_setVisible` called."),m(this,qo,i),m(this,ca,e)}}$o=new WeakMap,Go=new WeakMap,qo=new WeakMap,ca=new WeakMap;var Zs,Pt,da,ua,Xo,Yc;class Rv{constructor(t,e=ei.DISPLAY){y(this,Xo);y(this,Zs,null);y(this,Pt,new Map);y(this,da,null);y(this,ua,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,m(this,ua,t.order);for(const i of t.groups)r(this,Pt).set(i.id,new Pv(e,i));if(t.baseState==="OFF")for(const i of r(this,Pt).values())i._setVisible(jr,!1);for(const i of t.on)r(this,Pt).get(i)._setVisible(jr,!0);for(const i of t.off)r(this,Pt).get(i)._setVisible(jr,!1);m(this,da,this.getHash())}}isVisible(t){if(r(this,Pt).size===0)return!0;if(!t)return Zh("Optional content group not defined."),!0;if(t.type==="OCG")return r(this,Pt).has(t.id)?r(this,Pt).get(t.id).visible:(ht(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return v(this,Xo,Yc).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!r(this,Pt).has(e))return ht(`Optional content group not found: ${e}`),!0;if(r(this,Pt).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!r(this,Pt).has(e))return ht(`Optional content group not found: ${e}`),!0;if(!r(this,Pt).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!r(this,Pt).has(e))return ht(`Optional content group not found: ${e}`),!0;if(!r(this,Pt).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!r(this,Pt).has(e))return ht(`Optional content group not found: ${e}`),!0;if(r(this,Pt).get(e).visible)return!1}return!0}return ht(`Unknown optional content policy ${t.policy}.`),!0}return ht(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){var n;const s=r(this,Pt).get(t);if(!s){ht(`Optional content group not found: ${t}`);return}if(i&&e&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==t&&((n=r(this,Pt).get(o))==null||n._setVisible(jr,!1,!0));s._setVisible(jr,!!e,!0),m(this,Zs,null)}setOCGState({state:t,preserveRB:e}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const n=r(this,Pt).get(s);if(n)switch(i){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!n.visible,e);break}}m(this,Zs,null)}get hasInitialVisibility(){return r(this,da)===null||this.getHash()===r(this,da)}getOrder(){return r(this,Pt).size?r(this,ua)?r(this,ua).slice():[...r(this,Pt).keys()]:null}getGroups(){return r(this,Pt).size>0?Ud(r(this,Pt)):null}getGroup(t){return r(this,Pt).get(t)||null}getHash(){if(r(this,Zs)!==null)return r(this,Zs);const t=new ep;for(const[e,i]of r(this,Pt))t.update(`${e}:${i.visible}`);return m(this,Zs,t.hexdigest())}}Zs=new WeakMap,Pt=new WeakMap,da=new WeakMap,ua=new WeakMap,Xo=new WeakSet,Yc=function(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let s=1;s<e;s++){const n=t[s];let a;if(Array.isArray(n))a=v(this,Xo,Yc).call(this,n);else if(r(this,Pt).has(n))a=r(this,Pt).get(n).visible;else return ht(`Optional content group not found: ${n}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class kv{constructor(t,{disableRange:e=!1,disableStream:i=!1}){se(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:n,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(n==null?void 0:n.length)>0){const l=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),t.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),t.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(n){return n._begin!==t?!1:(n._enqueue(i),!0)});se(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,i,s,n;t.total===void 0?(i=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||i.call(e,{loaded:t.loaded}):(n=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||n.call(s,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){se(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Mv(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Lv(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class Mv{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=$d(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Lv{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Iv(h){let t=!0,e=i("filename\\*","i").exec(h);if(e){e=e[1];let d=o(e);return d=unescape(d),d=l(d),d=c(d),n(d)}if(e=a(h),e){const d=c(e);return n(d)}if(e=i("filename","i").exec(h),e){e=e[1];let d=o(e);return d=c(d),n(d)}function i(d,f){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(d,f){if(d){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const u=new TextDecoder(d,{fatal:!0}),p=ec(f);f=u.decode(p),t=!1}catch{}}return f}function n(d){return t&&/[\x80-\xff]/.test(d)&&(d=s("utf-8",d),t&&(d=s("iso-8859-1",d))),d}function a(d){const f=[];let u;const p=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=p.exec(d))!==null;){let[,b,w,A]=u;if(b=parseInt(b,10),b in f){if(b===0)break;continue}f[b]=[w,A]}const g=[];for(let b=0;b<f.length&&b in f;++b){let[w,A]=f[b];A=o(A),w&&(A=unescape(A),b===0&&(A=l(A))),g.push(A)}return g.join("")}function o(d){if(d.startsWith('"')){const f=d.slice(1).split('\\"');for(let u=0;u<f.length;++u){const p=f[u].indexOf('"');p!==-1&&(f[u]=f[u].slice(0,p),f.length=u+1),f[u]=f[u].replaceAll(/\\(.)/g,"$1")}d=f.join('"')}return d}function l(d){const f=d.indexOf("'");if(f===-1)return d;const u=d.slice(0,f),g=d.slice(f+1).replace(/^[^']*'/,"");return s(u,g)}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,u,p,g){if(p==="q"||p==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,w){return String.fromCharCode(parseInt(w,16))}),s(u,g);try{g=atob(g)}catch{}return s(u,g)})}return""}function Kd(h,t){const e=new Headers;if(!h||!t||typeof t!="object")return e;for(const i in t){const s=t[i];s!==void 0&&e.append(i,s)}return e}function Qd({responseHeaders:h,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},n=parseInt(h.get("Content-Length"),10);return!Number.isInteger(n)||(s.suggestedLength=n,n<=2*e)||i||!t||h.get("Accept-Ranges")!=="bytes"||(h.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function Jd(h){const t=h.get("Content-Disposition");if(t){let e=Iv(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if($d(e))return e}return null}function nc(h,t){return h===404||h===0&&t.startsWith("file:")?new Mr('Missing PDF "'+t+'".'):new tc(`Unexpected server response (${h}) while retrieving PDF "${t}".`,h)}function gp(h){return h===200||h===206}function mp(h,t,e){return{method:"GET",headers:h,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function bp(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:(ht(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class lf{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Kd(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return se(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Fv(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Dv(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Fv{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),s=e.url;fetch(s,mp(i,this._withCredentials,this._abortController)).then(n=>{if(!gp(n.status))throw nc(n.status,s);this._reader=n.body.getReader(),this._headersCapability.resolve();const a=n.headers,{allowRangeRequests:o,suggestedLength:l}=Qd({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=Jd(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Lr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:bp(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class Dv{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const n=new Headers(t.headers);n.append("Range",`bytes=${e}-${i-1}`);const a=s.url;fetch(a,mp(n,this._withCredentials,this._abortController)).then(o=>{if(!gp(o.status))throw nc(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:bp(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const fc=200,pc=206;function Ov(h){const t=h.response;return typeof t!="string"?t:ec(t).buffer}class Nv{constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Kd(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,i){const s={begin:t,end:e};for(const n in i)s[n]=i[n];return this.request(s)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[n,a]of this.headers)e.setRequestHeader(n,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=pc):s.expectedStatus=fc,e.responseType="arraybuffer",t.onError&&(e.onerror=function(n){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){var s;const i=this.pendingRequests[t];i&&((s=i.onProgress)==null||s.call(i,e))}onStateChange(t,e){var l,c,d;const i=this.pendingRequests[t];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){(l=i.onError)==null||l.call(i,s.status);return}const n=s.status||fc;if(!(n===fc&&i.expectedStatus===pc)&&n!==i.expectedStatus){(c=i.onError)==null||c.call(i,s.status);return}const o=Ov(s);if(n===pc){const f=s.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);i.onDone({begin:parseInt(u[1],10),chunk:o})}else o?i.onDone({begin:0,chunk:o}):(d=i.onError)==null||d.call(i,s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class Bv{constructor(t){this._source=t,this._manager=new Nv(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return se(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Hv(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new jv(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Hv{constructor(t,e){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=new Headers(e.getAllResponseHeaders().trim().split(/[\r\n]+/).map(a=>{const[o,...l]=a.split(": ");return[o,l.join(": ")]})),{allowRangeRequests:s,suggestedLength:n}=Qd({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=n||this._contentLength,this._filename=Jd(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=nc(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class jv{constructor(t,e,i){this._manager=t;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,i,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=nc(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Wv=/^[a-z][a-z0-9\-+.]+:/i;function Uv(h){if(Wv.test(h))return new URL(h);const t=bn.get("url");return new URL(t.pathToFileURL(h))}function vp(h,t,e){return h.protocol==="http:"?bn.get("http").request(h,{headers:t},e):bn.get("https").request(h,{headers:t},e)}class Vv{constructor(t){this.source=t,this.url=Uv(t.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=Kd(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return se(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Gv(this):new zv(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=this.isFsUrl?new qv(this,t,e):new $v(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class yp{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Lr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class wp{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class zv extends yp{constructor(t){super(t);const e=Object.fromEntries(t.headers),i=s=>{if(s.statusCode===404){const l=new Mr(`Missing PDF "${this._url}".`);this._storedError=l,this._headersCapability.reject(l);return}this._headersCapability.resolve(),this._setReadableStream(s);const n=new Headers(this._readableStream.headers),{allowRangeRequests:a,suggestedLength:o}=Qd({responseHeaders:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=o||this._contentLength,this._filename=Jd(n)};this._request=vp(this._url,e,i),this._request.on("error",s=>{this._storedError=s,this._headersCapability.reject(s)}),this._request.end()}}class $v extends wp{constructor(t,e,i){super(t);const s=Object.fromEntries(t.headers);s.Range=`bytes=${e}-${i-1}`;const n=a=>{if(a.statusCode===404){const o=new Mr(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(a)};this._request=vp(this._url,s,n),this._request.on("error",a=>{this._storedError=a}),this._request.end()}}class Gv extends yp{constructor(t){super(t);const e=bn.get("fs");e.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(e.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Mr(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}}class qv extends wp{constructor(t,e,i){super(t);const s=bn.get("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:i-1}))}}const Xv=1e5,Be=30,Yv=.8;var Ef,tn,We,Yo,Ko,Yn,ps,Qo,Jo,Kn,fa,pa,en,ga,Zo,ma,Qn,tl,el,zt,Jn,Zn,il,sn,ba,Os,Ap,_p,Qc,ni,ah,Jc,Ep,Sp;let Kc=(zt=class{constructor({textContentSource:t,container:e,viewport:i}){y(this,Os);y(this,tn,Promise.withResolvers());y(this,We,null);y(this,Yo,!1);y(this,Ko,!!((Ef=globalThis.FontInspector)!=null&&Ef.enabled));y(this,Yn,null);y(this,ps,null);y(this,Qo,0);y(this,Jo,0);y(this,Kn,null);y(this,fa,null);y(this,pa,0);y(this,en,0);y(this,ga,Object.create(null));y(this,Zo,[]);y(this,ma,null);y(this,Qn,[]);y(this,tl,new WeakMap);y(this,el,null);var l;if(t instanceof ReadableStream)m(this,ma,t);else if(typeof t=="object")m(this,ma,new ReadableStream({start(c){c.enqueue(t),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');m(this,We,m(this,fa,e)),m(this,en,i.scale*(globalThis.devicePixelRatio||1)),m(this,pa,i.rotation),m(this,ps,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:n,pageX:a,pageY:o}=i.rawDims;m(this,el,[1,0,0,-1,-a,o+n]),m(this,Jo,s),m(this,Qo,n),v(l=zt,ni,Ep).call(l),xr(e,i),r(this,tn).promise.finally(()=>{r(zt,ba).delete(this),m(this,ps,null),m(this,ga,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Fe.platform;return gt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{r(this,Kn).read().then(({value:e,done:i})=>{if(i){r(this,tn).resolve();return}r(this,Yn)??m(this,Yn,e.lang),Object.assign(r(this,ga),e.styles),v(this,Os,Ap).call(this,e.items),t()},r(this,tn).reject)};return m(this,Kn,r(this,ma).getReader()),r(zt,ba).add(this),t(),r(this,tn).promise}update({viewport:t,onBefore:e=null}){var n;const i=t.scale*(globalThis.devicePixelRatio||1),s=t.rotation;if(s!==r(this,pa)&&(e==null||e(),m(this,pa,s),xr(r(this,fa),{rotation:s})),i!==r(this,en)){e==null||e(),m(this,en,i);const a={div:null,properties:null,ctx:v(n=zt,ni,ah).call(n,r(this,Yn))};for(const o of r(this,Qn))a.properties=r(this,tl).get(o),a.div=o,v(this,Os,Qc).call(this,a)}}cancel(){var e;const t=new Lr("TextLayer task cancelled.");(e=r(this,Kn))==null||e.cancel(t).catch(()=>{}),m(this,Kn,null),r(this,tn).reject(t)}get textDivs(){return r(this,Qn)}get textContentItemsStr(){return r(this,Zo)}static cleanup(){if(!(r(this,ba).size>0)){r(this,Jn).clear();for(const{canvas:t}of r(this,Zn).values())t.remove();r(this,Zn).clear()}}},tn=new WeakMap,We=new WeakMap,Yo=new WeakMap,Ko=new WeakMap,Yn=new WeakMap,ps=new WeakMap,Qo=new WeakMap,Jo=new WeakMap,Kn=new WeakMap,fa=new WeakMap,pa=new WeakMap,en=new WeakMap,ga=new WeakMap,Zo=new WeakMap,ma=new WeakMap,Qn=new WeakMap,tl=new WeakMap,el=new WeakMap,Jn=new WeakMap,Zn=new WeakMap,il=new WeakMap,sn=new WeakMap,ba=new WeakMap,Os=new WeakSet,Ap=function(t){var s,n;if(r(this,Yo))return;(n=r(this,ps)).ctx??(n.ctx=v(s=zt,ni,ah).call(s,r(this,Yn)));const e=r(this,Qn),i=r(this,Zo);for(const a of t){if(e.length>Xv){ht("Ignoring additional textDivs for performance reasons."),m(this,Yo,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=r(this,We);m(this,We,document.createElement("span")),r(this,We).classList.add("markedContent"),a.id!==null&&r(this,We).setAttribute("id",`${a.id}`),o.append(r(this,We))}else a.type==="endMarkedContent"&&m(this,We,r(this,We).parentNode);continue}i.push(a.str),v(this,Os,_p).call(this,a)}},_p=function(t){var b;const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};r(this,Qn).push(e);const s=$.transform(r(this,el),t.transform);let n=Math.atan2(s[1],s[0]);const a=r(this,ga)[t.fontName];a.vertical&&(n+=Math.PI/2);let o=r(this,Ko)&&a.fontSubstitution||a.fontFamily;o=zt.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),c=l*v(b=zt,ni,Sp).call(b,o,r(this,Yn));let d,f;n===0?(d=s[4],f=s[5]-c):(d=s[4]+c*Math.sin(n),f=s[5]-c*Math.cos(n));const u="calc(var(--scale-factor)*",p=e.style;r(this,We)===r(this,fa)?(p.left=`${(100*d/r(this,Jo)).toFixed(2)}%`,p.top=`${(100*f/r(this,Qo)).toFixed(2)}%`):(p.left=`${u}${d.toFixed(2)}px)`,p.top=`${u}${f.toFixed(2)}px)`),p.fontSize=`${u}${(r(zt,sn)*l).toFixed(2)}px)`,p.fontFamily=o,i.fontSize=l,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,r(this,Ko)&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),n!==0&&(i.angle=n*(180/Math.PI));let g=!1;if(t.str.length>1)g=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),A=Math.abs(t.transform[3]);w!==A&&Math.max(w,A)/Math.min(w,A)>1.5&&(g=!0)}if(g&&(i.canvasWidth=a.vertical?t.height:t.width),r(this,tl).set(e,i),r(this,ps).div=e,r(this,ps).properties=i,v(this,Os,Qc).call(this,r(this,ps)),i.hasText&&r(this,We).append(e),i.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),r(this,We).append(w)}},Qc=function(t){var o;const{div:e,properties:i,ctx:s}=t,{style:n}=e;let a="";if(r(zt,sn)>1&&(a=`scale(${1/r(zt,sn)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=n,{canvasWidth:c,fontSize:d}=i;v(o=zt,ni,Jc).call(o,s,d*r(this,en),l);const{width:f}=s.measureText(e.textContent);f>0&&(a=`scaleX(${c*r(this,en)/f}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(n.transform=a)},ni=new WeakSet,ah=function(t=null){let e=r(this,Zn).get(t||(t=""));if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),r(this,Zn).set(t,e),r(this,il).set(e,{size:0,family:""})}return e},Jc=function(t,e,i){const s=r(this,il).get(t);e===s.size&&i===s.family||(t.font=`${e}px ${i}`,s.size=e,s.family=i)},Ep=function(){if(r(this,sn)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),m(this,sn,t.getBoundingClientRect().height),t.remove()},Sp=function(t,e){const i=r(this,Jn).get(t);if(i)return i;const s=v(this,ni,ah).call(this,e);s.canvas.width=s.canvas.height=Be,v(this,ni,Jc).call(this,s,Be,t);const n=s.measureText("");let a=n.fontBoundingBoxAscent,o=Math.abs(n.fontBoundingBoxDescent);if(a){const d=a/(a+o);return r(this,Jn).set(t,d),s.canvas.width=s.canvas.height=0,d}s.strokeStyle="red",s.clearRect(0,0,Be,Be),s.strokeText("g",0,0);let l=s.getImageData(0,0,Be,Be).data;o=0;for(let d=l.length-1-3;d>=0;d-=4)if(l[d]>0){o=Math.ceil(d/4/Be);break}s.clearRect(0,0,Be,Be),s.strokeText("A",0,Be),l=s.getImageData(0,0,Be,Be).data,a=0;for(let d=0,f=l.length;d<f;d+=4)if(l[d]>0){a=Be-Math.floor(d/4/Be);break}s.canvas.width=s.canvas.height=0;const c=a?a/(a+o):Yv;return r(this,Jn).set(t,c),c},y(zt,ni),y(zt,Jn,new Map),y(zt,Zn,new Map),y(zt,il,new WeakMap),y(zt,sn,null),y(zt,ba,new Set),zt);class wo{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function s(n){var l;if(!n)return;let a=null;const o=n.name;if(o==="#text")a=n.value;else if(wo.shouldBuildText(o))(l=n==null?void 0:n.attributes)!=null&&l.textContent?a=n.attributes.textContent:n.value&&(a=n.value);else return;if(a!==null&&e.push({str:a}),!!n.children)for(const c of n.children)s(c)}return s(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const Kv=65536,Qv=100,Jv=5e3,Zv=Ce?dv:lv,ty=Ce?uv:ap,ey=Ce?cv:hv,iy=Ce?fv:cp;function sy(h={}){typeof h=="string"||h instanceof URL?h={url:h}:(h instanceof ArrayBuffer||ArrayBuffer.isView(h))&&(h={data:h});const t=new Zc,{docId:e}=t,i=h.url?ny(h.url):null,s=h.data?ry(h.data):null,n=h.httpHeaders||null,a=h.withCredentials===!0,o=h.password??null,l=h.range instanceof xp?h.range:null,c=Number.isInteger(h.rangeChunkSize)&&h.rangeChunkSize>0?h.rangeChunkSize:Kv;let d=h.worker instanceof Gr?h.worker:null;const f=h.verbosity,u=typeof h.docBaseUrl=="string"&&!sc(h.docBaseUrl)?h.docBaseUrl:null,p=typeof h.cMapUrl=="string"?h.cMapUrl:null,g=h.cMapPacked!==!1,b=h.CMapReaderFactory||ty,w=typeof h.standardFontDataUrl=="string"?h.standardFontDataUrl:null,A=h.StandardFontDataFactory||iy,T=h.stopAtErrors!==!0,S=Number.isInteger(h.maxImageSize)&&h.maxImageSize>-1?h.maxImageSize:-1,x=h.isEvalSupported!==!1,P=typeof h.isOffscreenCanvasSupported=="boolean"?h.isOffscreenCanvasSupported:!Ce,R=typeof h.isChrome=="boolean"?h.isChrome:!Fe.platform.isFirefox&&typeof window<"u"&&!!(window!=null&&window.chrome),M=Number.isInteger(h.canvasMaxAreaInBytes)?h.canvasMaxAreaInBytes:-1,L=typeof h.disableFontFace=="boolean"?h.disableFontFace:Ce,D=h.fontExtraProperties===!0,O=h.enableXfa===!0,j=h.ownerDocument||globalThis.document,st=h.disableRange===!0,X=h.disableStream===!0,G=h.disableAutoFetch===!0,Z=h.pdfBug===!0,Q=h.CanvasFactory||Zv,W=h.FilterFactory||ey,q=h.enableHWA===!0,ut=l?l.length:h.length??NaN,mt=typeof h.useSystemFonts=="boolean"?h.useSystemFonts:!Ce&&!L,Ft=typeof h.useWorkerFetch=="boolean"?h.useWorkerFetch:b===ap&&A===cp&&p&&w&&to(p,document.baseURI)&&to(w,document.baseURI);h.canvasFactory&&Yu("`canvasFactory`-instance option, please use `CanvasFactory` instead."),h.filterFactory&&Yu("`filterFactory`-instance option, please use `FilterFactory` instead.");const St=null;Hb(f);const wt={canvasFactory:new Q({ownerDocument:j,enableHWA:q}),filterFactory:new W({docId:e,ownerDocument:j}),cMapReaderFactory:Ft?null:new b({baseUrl:p,isCompressed:g}),standardFontDataFactory:Ft?null:new A({baseUrl:w})};if(!d){const xt={verbosity:f,port:Ls.workerPort};d=xt.port?Gr.fromPort(xt):new Gr(xt),t._worker=d}const Jt={docId:e,apiVersion:"4.8.69",data:s,password:o,disableAutoFetch:G,rangeChunkSize:c,length:ut,docBaseUrl:u,enableXfa:O,evaluatorOptions:{maxImageSize:S,disableFontFace:L,ignoreErrors:T,isEvalSupported:x,isOffscreenCanvasSupported:P,isChrome:R,canvasMaxAreaInBytes:M,fontExtraProperties:D,useSystemFonts:mt,cMapUrl:Ft?p:null,standardFontDataUrl:Ft?w:null}},z={disableFontFace:L,fontExtraProperties:D,ownerDocument:j,pdfBug:Z,styleElement:St,loadingParams:{disableAutoFetch:G,enableXfa:O}};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const xt=d.messageHandler.sendWithPromise("GetDocRequest",Jt,s?[s.buffer]:null);let ct;if(l)ct=new kv(l,{disableRange:st,disableStream:X});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let Pe;Ce?Pe=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&to(i)?lf:Vv:Pe=to(i)?lf:Bv,ct=new Pe({url:i,length:ut,httpHeaders:n,withCredentials:a,rangeChunkSize:c,disableRange:st,disableStream:X})}return xt.then(Pe=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const de=new oo(e,Pe,d.port),Tt=new hy(de,t,ct,z,wt);t._transport=Tt,de.send("Ready",null)})}).catch(t._capability.reject),t}function ny(h){if(h instanceof URL)return h.href;try{return new URL(h,window.location).href}catch{if(Ce&&typeof h=="string")return h}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function ry(h){if(Ce&&typeof Buffer<"u"&&h instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength)return h;if(typeof h=="string")return ec(h);if(h instanceof ArrayBuffer||ArrayBuffer.isView(h)||typeof h=="object"&&!isNaN(h==null?void 0:h.length))return new Uint8Array(h);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function hf(h){return typeof h=="object"&&Number.isInteger(h==null?void 0:h.num)&&h.num>=0&&Number.isInteger(h==null?void 0:h.gen)&&h.gen>=0}var Vh;const zh=class zh{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${ke(zh,Vh)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(s){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,s}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};Vh=new WeakMap,y(zh,Vh,0);let Zc=zh,xp=class{constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const i of this._rangeListeners)i(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){Nt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class ay{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return gt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var nn,gs,fi,Wr,oh;class oy{constructor(t,e,i,s=!1){y(this,fi);y(this,nn,null);y(this,gs,!1);this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new Xu:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new Tp,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:n=!1}={}){return new Nl({viewBox:this.view,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:n})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return gt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:s=Ws.ENABLE,transform:n=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:d=null,isEditing:f=!1}){var x,P;(x=this._stats)==null||x.time("Overall");const u=this._transport.getRenderingIntent(i,s,d,f),{renderingIntent:p,cacheKey:g}=u;m(this,gs,!1),v(this,fi,oh).call(this),o||(o=this._transport.getOptionalContentConfig(p));let b=this._intentStates.get(g);b||(b=Object.create(null),this._intentStates.set(g,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const w=!!(p&ei.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(P=this._stats)==null||P.time("Page Request"),this._pumpOperatorList(u));const A=R=>{var M;b.renderTasks.delete(T),(this._maybeCleanupAfterRender||w)&&m(this,gs,!0),v(this,fi,Wr).call(this,!w),R?(T.capability.reject(R),this._abortOperatorList({intentState:b,reason:R instanceof Error?R:new Error(R)})):T.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(M=globalThis.Stats)!=null&&M.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},T=new ed({callback:A,params:{canvasContext:t,viewport:e,transform:n,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:c});(b.renderTasks||(b.renderTasks=new Set)).add(T);const S=T.task;return Promise.all([b.displayReadyCapability.promise,o]).then(([R,M])=>{var L;if(this.destroyed){A();return}if((L=this._stats)==null||L.time("Rendering"),!(M.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");T.initializeGraphics({transparency:R,optionalContentConfig:M}),T.operatorListChanged()}).catch(A),S}getOperatorList({intent:t="display",annotationMode:e=Ws.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var c;function n(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(t,e,i,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=n,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>wo.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){function n(){a.read().then(function({value:l,done:c}){if(c){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),n()},s)}const a=e.getReader(),o={items:[],styles:Object.create(null),lang:null};n()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),m(this,gs,!1),v(this,fi,oh).call(this),Promise.all(t)}cleanup(t=!1){m(this,gs,!0);const e=v(this,fi,Wr).call(this,!1);return t&&e&&this._stats&&(this._stats=new Xu),e}_startRenderPage(t,e){var s,n;const i=this._intentStates.get(e);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(n=i.displayReadyCapability)==null||n.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&v(this,fi,Wr).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:s}){const{map:n,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:n,modifiedIds:s},a).getReader(),c=this._intentStates.get(e);c.streamReader=l;const d=()=>{l.read().then(({value:f,done:u})=>{if(u){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,c),d())},f=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const u of c.renderTasks)u.operatorListChanged();v(this,fi,Wr).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(f);else if(c.opListReadCapability)c.opListReadCapability.reject(f);else throw f}})};d()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof zd){let s=Qv;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new Lr(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,n]of this._intentStates)if(n===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}nn=new WeakMap,gs=new WeakMap,fi=new WeakSet,Wr=function(t=!1){if(v(this,fi,oh).call(this),!r(this,gs)||this.destroyed)return!1;if(t)return m(this,nn,setTimeout(()=>{m(this,nn,null),v(this,fi,Wr).call(this,!1)},Jv)),!1;for(const{renderTasks:e,operatorList:i}of this._intentStates.values())if(e.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,gs,!1),!0},oh=function(){r(this,nn)&&(clearTimeout(r(this,nn)),m(this,nn,null))};var ms,$h;class ly{constructor(){y(this,ms,new Map);y(this,$h,Promise.resolve())}postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};r(this,$h).then(()=>{for(const[s]of r(this,ms))s.call(this,i)})}addEventListener(t,e,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:n}=i;if(n.aborted){ht("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);s=()=>n.removeEventListener("abort",a),n.addEventListener("abort",a)}r(this,ms).set(e,s)}removeEventListener(t,e){const i=r(this,ms).get(e);i==null||i(),r(this,ms).delete(e)}terminate(){for(const[,t]of r(this,ms))t==null||t();r(this,ms).clear()}}ms=new WeakMap,$h=new WeakMap;var Gh,tr,er,va,lh,ya,hh;const Bt=class Bt{constructor({name:t=null,port:e=null,verbosity:i=jb()}={}){y(this,va);var s;if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((s=r(Bt,er))!=null&&s.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(r(Bt,er)||m(Bt,er,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return Ce?Promise.all([bn.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new oo("main","worker",t),this._messageHandler.on("ready",function(){}),v(this,va,lh).call(this)}_initialize(){if(r(Bt,tr)||r(Bt,ya,hh)){this._setupFakeWorker();return}let{workerSrc:t}=Bt;try{Bt._isSameOrigin(window.location.href,t)||(t=Bt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new oo("main","worker",e),s=()=>{n.abort(),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=new AbortController;e.addEventListener("error",()=>{this._webWorker||s()},{signal:n.signal}),i.on("test",o=>{if(n.abort(),this.destroyed||!o){s();return}this._messageHandler=i,this._port=e,this._webWorker=e,v(this,va,lh).call(this)}),i.on("ready",o=>{if(n.abort(),this.destroyed){s();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{Zh("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){r(Bt,tr)||(ht("Setting up fake worker."),m(Bt,tr,!0)),Bt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new ly;this._port=e;const i=`fake${ke(Bt,Gh)._++}`,s=new oo(i+"_worker",i,e);t.setup(s,e),this._messageHandler=new oo(i,i+"_worker",e),v(this,va,lh).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(t=r(Bt,er))==null||t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){var i;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(i=r(this,er))==null?void 0:i.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Bt(t)}static get workerSrc(){if(Ls.workerSrc)return Ls.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return gt(this,"_setupFakeWorkerGlobal",(async()=>r(this,ya,hh)?r(this,ya,hh):(await import(this.workerSrc)).WorkerMessageHandler)())}};Gh=new WeakMap,tr=new WeakMap,er=new WeakMap,va=new WeakSet,lh=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},ya=new WeakSet,hh=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},y(Bt,ya),y(Bt,Gh,0),y(Bt,tr,!1),y(Bt,er),Ce&&(m(Bt,tr,!0),Ls.workerSrc||(Ls.workerSrc="./pdf.worker.mjs")),Bt._isSameOrigin=(t,e)=>{let i;try{if(i=new URL(t),!i.origin||i.origin==="null")return!1}catch{return!1}const s=new URL(e,i);return i.origin===s.origin},Bt._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let Gr=Bt;var bs,qi,wa,Aa,Xi,ir,lo;class hy{constructor(t,e,i,s,n){y(this,ir);y(this,bs,new Map);y(this,qi,new Map);y(this,wa,new Map);y(this,Aa,new Map);y(this,Xi,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Tp,this.fontLoader=new av({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return gt(this,"annotationStorage",new Xd)}getRenderingIntent(t,e=Ws.ENABLE,i=null,s=!1,n=!1){let a=ei.DISPLAY,o=Wc;switch(t){case"any":a=ei.ANY;break;case"display":break;case"print":a=ei.PRINT;break;default:ht(`getRenderingIntent - invalid intent: ${t}`)}const l=a&ei.PRINT&&i instanceof sp?i:this.annotationStorage;switch(e){case Ws.DISABLE:a+=ei.ANNOTATIONS_DISABLE;break;case Ws.ENABLE:break;case Ws.ENABLE_FORMS:a+=ei.ANNOTATIONS_FORMS;break;case Ws.ENABLE_STORAGE:a+=ei.ANNOTATIONS_STORAGE,o=l.serializable;break;default:ht(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(a+=ei.IS_EDITING),n&&(a+=ei.OPLIST);const{ids:c,hash:d}=l.modifiedIds,f=[a,o.hash,d];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=r(this,Xi))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of r(this,qi).values())t.push(s._destroy());r(this,qi).clear(),r(this,wa).clear(),r(this,Aa).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var s;this.commonObjs.clear(),this.fontLoader.clear(),r(this,bs).clear(),this.filterFactory.destroy(),Kc.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Lr("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{se(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},s.onPull=()=>{this._fullReader.read().then(function({value:n,done:a}){if(a){s.close();return}se(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{s.error(n)})},s.onCancel=n=>{this._fullReader.cancel(n),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async i=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:n,contentLength:a}=this._fullReader;return(!s||!n)&&(this._lastProgress&&((o=e.onProgress)==null||o.call(e,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=e.onProgress)==null||c.call(e,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:n,contentLength:a}}),t.on("GetRangeReader",(i,s)=>{se(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(i.begin,i.end);if(!n){s.close();return}s.onPull=()=>{n.read().then(function({value:a,done:o}){if(o){s.close();return}se(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{n.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new ay(i,this))}),t.on("DocException",function(i){let s;switch(i.name){case"PasswordException":s=new yc(i.message,i.code);break;case"InvalidPDFException":s=new Rf(i.message);break;case"MissingPDFException":s=new Mr(i.message);break;case"UnexpectedResponseException":s=new tc(i.message,i.status);break;case"UnknownErrorException":s=new wc(i.message,i.details);break;default:Nt("DocException - expected a valid Error.")}e._capability.reject(s)}),t.on("PasswordRequest",i=>{if(m(this,Xi,Promise.withResolvers()),e.onPassword){const s=n=>{n instanceof Error?r(this,Xi).reject(n):r(this,Xi).resolve({password:n})};try{e.onPassword(s,i.code)}catch(n){r(this,Xi).reject(n)}}else r(this,Xi).reject(new yc(i.message,i.code));return r(this,Xi).promise}),t.on("DataLoaded",i=>{var s;(s=e.onProgress)==null||s.call(e,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;r(this,qi).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,n])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:o,fontExtraProperties:l,pdfBug:c}=this._params;if("error"in n){const p=n.error;ht(`Error during font loading: ${p}`),this.commonObjs.resolve(i,p);break}const d=c&&((a=globalThis.FontInspector)!=null&&a.enabled)?(p,g)=>globalThis.FontInspector.fontAdded(p,g):null,f=new ov(n,{disableFontFace:o,inspectFont:d});this.fontLoader.bind(f).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l&&f.data&&(f.data=null),this.commonObjs.resolve(i,f)});break;case"CopyLocalImage":const{imageRef:u}=n;se(u,"The imageRef must be defined.");for(const p of r(this,qi).values())for(const[,g]of p.objs)if((g==null?void 0:g.ref)===u)return g.dataLen?(this.commonObjs.resolve(i,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,n);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,n,a])=>{var l;if(this.destroyed)return;const o=r(this,qi).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(n){case"Image":o.objs.resolve(i,a),(a==null?void 0:a.dataLen)>Db&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${n}`)}}}),t.on("DocProgress",i=>{var s;this.destroyed||(s=e.onProgress)==null||s.call(e,{loaded:i.loaded,total:i.total})}),t.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),t.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&ht("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((i=this._fullReader)==null?void 0:i.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=r(this,wa).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&r(this,Aa).set(n.refStr,t);const a=new oy(e,n,this,this._params.pdfBug);return r(this,qi).set(e,a),a});return r(this,wa).set(e,s),s}getPageIndex(t){return hf(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return v(this,ir,lo).call(this,"GetFieldObjects")}hasJSActions(){return v(this,ir,lo).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return v(this,ir,lo).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return v(this,ir,lo).call(this,"GetOptionalContentConfig").then(e=>new Rv(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=r(this,bs).get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>{var n,a;return{info:s[0],metadata:s[1]?new Cv(s[1]):null,contentDispositionFilename:((n=this._fullReader)==null?void 0:n.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return r(this,bs).set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of r(this,qi).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),r(this,bs).clear(),this.filterFactory.destroy(!0),Kc.cleanup()}}cachedPageNumber(t){if(!hf(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return r(this,Aa).get(e)??null}}bs=new WeakMap,qi=new WeakMap,wa=new WeakMap,Aa=new WeakMap,Xi=new WeakMap,ir=new WeakSet,lo=function(t,e=null){const i=r(this,bs).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return r(this,bs).set(t,s),s};const Xl=Symbol("INITIAL_DATA");var xi,sl,td;class Tp{constructor(){y(this,sl);y(this,xi,Object.create(null))}get(t,e=null){if(e){const s=v(this,sl,td).call(this,t);return s.promise.then(()=>e(s.data)),null}const i=r(this,xi)[t];if(!i||i.data===Xl)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=r(this,xi)[t];return!!e&&e.data!==Xl}resolve(t,e=null){const i=v(this,sl,td).call(this,t);i.data=e,i.resolve()}clear(){var t;for(const e in r(this,xi)){const{data:i}=r(this,xi)[e];(t=i==null?void 0:i.bitmap)==null||t.close()}m(this,xi,Object.create(null))}*[Symbol.iterator](){for(const t in r(this,xi)){const{data:e}=r(this,xi)[t];e!==Xl&&(yield[t,e])}}}xi=new WeakMap,sl=new WeakSet,td=function(t){var e;return(e=r(this,xi))[t]||(e[t]={...Promise.withResolvers(),data:Xl})};var rn;class cy{constructor(t){y(this,rn,null);m(this,rn,t),this.onContinue=null}get promise(){return r(this,rn).capability.promise}cancel(t=0){r(this,rn).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=r(this,rn).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=r(this,rn);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}rn=new WeakMap;var an,sr;const Pn=class Pn{constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:n,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:f=!1,pageColors:u=null}){y(this,an,null);this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=f,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new cy(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var o,l;if(this.cancelled)return;if(this._canvas){if(r(Pn,sr).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r(Pn,sr).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:n,background:a}=this.params;this.gfx=new $r(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:n,viewport:s,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(t=null,e=0){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),r(this,an)&&(window.cancelAnimationFrame(r(this,an)),m(this,an,null)),r(Pn,sr).delete(this._canvas),this.callback(t||new zd(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,an,window.requestAnimationFrame(()=>{m(this,an,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),r(Pn,sr).delete(this._canvas),this.callback())))}};an=new WeakMap,sr=new WeakMap,y(Pn,sr,new WeakSet);let ed=Pn;const dy="4.8.69",uy="3634dab10";function cf(h){return Math.floor(Math.max(0,Math.min(1,h))*255).toString(16).padStart(2,"0")}function Qa(h){return Math.max(0,Math.min(255,255*h))}class df{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Qa(t),[t,t,t]}static G_HTML([t]){const e=cf(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Qa)}static RGB_HTML(t){return`#${t.map(cf).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[Qa(1-Math.min(1,t+s)),Qa(1-Math.min(1,i+s)),Qa(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,n=1-e,a=1-i,o=Math.min(s,n,a);return["CMYK",s,n,a,o]}}class fy{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Nt("Abstract method `_createSVG` called.")}}class Zd extends fy{_createSVG(t){return document.createElementNS(rs,t)}}class Cp{static setupStorage(t,e,i,s,n){const a=s.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),n==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),n==="print")break;t.addEventListener("change",o=>{s.setValue(e,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),n==="print")break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(e,{value:c})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:n}){const{attributes:a}=e,o=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&t.setAttribute(l,c)}o&&n.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){var f,u;const e=t.annotationStorage,i=t.linkService,s=t.xfaHtml,n=t.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:n,linkService:i});const o=n!=="richText",l=t.div;if(l.append(a),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=p}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const p=document.createTextNode(s.value);a.append(p),o&&wo.shouldBuildText(s.name)&&c.push(p)}return{textDivs:c}}const d=[[s,-1,a]];for(;d.length>0;){const[p,g,b]=d.at(-1);if(g+1===p.children.length){d.pop();continue}const w=p.children[++d.at(-1)[1]];if(w===null)continue;const{name:A}=w;if(A==="#text"){const S=document.createTextNode(w.value);c.push(S),b.append(S);continue}const T=(f=w==null?void 0:w.attributes)!=null&&f.xmlns?document.createElementNS(w.attributes.xmlns,A):document.createElement(A);if(b.append(T),w.attributes&&this.setAttributes({html:T,element:w,storage:e,intent:n,linkService:i}),((u=w.children)==null?void 0:u.length)>0)d.push([w,-1,T]);else if(w.value){const S=document.createTextNode(w.value);o&&wo.shouldBuildText(A)&&c.push(S),T.append(S)}}for(const p of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Hl=1e3,py=9,Cr=new WeakSet;function Is(h){return{width:h[2]-h[0],height:h[3]-h[1]}}class gy{static create(t){switch(t.data.annotationType){case Zt.LINK:return new Pp(t);case Zt.TEXT:return new my(t);case Zt.WIDGET:switch(t.data.fieldType){case"Tx":return new by(t);case"Btn":return t.data.radioButton?new Mp(t):t.data.checkBox?new yy(t):new wy(t);case"Ch":return new Ay(t);case"Sig":return new vy(t)}return new Ir(t);case Zt.POPUP:return new sd(t);case Zt.FREETEXT:return new Op(t);case Zt.LINE:return new Ey(t);case Zt.SQUARE:return new Sy(t);case Zt.CIRCLE:return new xy(t);case Zt.POLYLINE:return new Np(t);case Zt.CARET:return new Cy(t);case Zt.INK:return new tu(t);case Zt.POLYGON:return new Ty(t);case Zt.HIGHLIGHT:return new Bp(t);case Zt.UNDERLINE:return new Py(t);case Zt.SQUIGGLY:return new Ry(t);case Zt.STRIKEOUT:return new ky(t);case Zt.STAMP:return new Hp(t);case Zt.FILEATTACHMENT:return new My(t);default:return new qt(t)}}}var nr,_a,Ea,nl,id;const nu=class nu{constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){y(this,nl);y(this,nr,null);y(this,_a,!1);y(this,Ea,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t!=null&&t.str||e!=null&&e.str||i!=null&&i.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return nu._hasPopupData(this.data)}updateEdited(t){var i;if(!this.container)return;r(this,nr)||m(this,nr,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&v(this,nl,id).call(this,e),(i=r(this,Ea))==null||i.popup.updateEdited(t)}resetEdited(){var t;r(this,nr)&&(v(this,nl,id).call(this,r(this,nr).rect),(t=r(this,Ea))==null||t.popup.resetEdited(),m(this,nr,null))}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",e.id),this instanceof Ir||(n.tabIndex=Hl);const{style:a}=n;if(a.zIndex=this.parent.zIndex++,e.alternativeText&&(n.title=e.alternativeText),e.noRotate&&n.classList.add("norotate"),!e.rect||this instanceof sd){const{rotation:b}=e;return!e.hasOwnCanvas&&b!==0&&this.setRotation(b,n),n}const{width:o,height:l}=Is(e.rect);if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const b=e.borderStyle.horizontalCornerRadius,w=e.borderStyle.verticalCornerRadius;if(b>0||w>0){const T=`calc(${b}px * var(--scale-factor)) / calc(${w}px * var(--scale-factor))`;a.borderRadius=T}else if(this instanceof Mp){const T=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=T}switch(e.borderStyle.style){case Ya.SOLID:a.borderStyle="solid";break;case Ya.DASHED:a.borderStyle="dashed";break;case Ya.BEVELED:ht("Unimplemented border style: beveled");break;case Ya.INSET:ht("Unimplemented border style: inset");break;case Ya.UNDERLINE:a.borderBottomStyle="solid";break}const A=e.borderColor||null;A?(m(this,_a,!0),a.borderColor=$.makeHexColor(A[0]|0,A[1]|0,A[2]|0)):a.borderWidth=0}const c=$.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:d,pageHeight:f,pageX:u,pageY:p}=s.rawDims;a.left=`${100*(c[0]-u)/d}%`,a.top=`${100*(c[1]-p)/f}%`;const{rotation:g}=e;return e.hasOwnCanvas||g===0?(a.width=`${100*o/d}%`,a.height=`${100*l/f}%`):this.setRotation(g,n),n}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:n,height:a}=Is(this.data.rect);let o,l;t%180===0?(o=100*n/i,l=100*a/s):(o=100*a/i,l=100*n/s),e.style.width=`${o}%`,e.style.height=`${l}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const n=s.detail[e],a=n[0],o=n.slice(1);s.target.style[i]=df[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:df[`${a}_rgb`](o)})};return gt(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail)){const n=t[s]||i[s];n==null||n(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,n]of Object.entries(e)){const a=i[s];if(a){const o={detail:{[s]:n},target:t};a(o),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,n]=this.data.rect.map(b=>Math.fround(b));if(t.length===8){const[b,w,A,T]=t.subarray(2,6);if(s===b&&n===w&&e===A&&i===T)return}const{style:a}=this.container;let o;if(r(this,_a)){const{borderColor:b,borderWidth:w}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const l=s-e,c=n-i,{svgFactory:d}=this,f=d.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const u=d.createElement("defs");f.append(u);const p=d.createElement("clipPath"),g=`clippath_${this.data.id}`;p.setAttribute("id",g),p.setAttribute("clipPathUnits","objectBoundingBox"),u.append(p);for(let b=2,w=t.length;b<w;b+=8){const A=t[b],T=t[b+1],S=t[b+2],x=t[b+3],P=d.createElement("rect"),R=(S-e)/l,M=(n-T)/c,L=(A-S)/l,D=(T-x)/c;P.setAttribute("x",R),P.setAttribute("y",M),P.setAttribute("width",L),P.setAttribute("height",D),p.append(P),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${R}" y="${M}" width="${L}" height="${D}"/>`)}r(this,_a)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:t}=this,e=m(this,Ea,new sd({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){Nt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:n,id:a,exportValues:o}of s){if(n===-1||a===e)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Cr.has(c)){ht(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:c})}return i}for(const s of document.getElementsByName(t)){const{exportValue:n}=s,a=s.getAttribute("data-element-id");a!==e&&Cr.has(s)&&i.push({id:a,exportValue:n,domElement:s})}return i}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};nr=new WeakMap,_a=new WeakMap,Ea=new WeakMap,nl=new WeakSet,id=function(t){const{container:{style:e},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:n,pageHeight:a,pageX:o,pageY:l}}}}=this;i==null||i.splice(0,4,...t);const{width:c,height:d}=Is(t);e.left=`${100*(t[0]-o)/n}%`,e.top=`${100*(a-t[3]+l)/a}%`,s===0?(e.width=`${100*c/n}%`,e.height=`${100*d/a}%`):this.setRotation(s)};let qt=nu;var si,En,Rp,kp;class Pp extends qt{constructor(e,i=null){super(e,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});y(this,si);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let n=!1;return e.url?(i.addLinkAttributes(s,e.url,e.newWindow),n=!0):e.action?(this._bindNamedAction(s,e.action),n=!0):e.attachment?(v(this,si,Rp).call(this,s,e.attachment,e.attachmentDest),n=!0):e.setOCGState?(v(this,si,kp).call(this,s,e.setOCGState),n=!0):e.dest?(this._bindLink(s,e.dest),n=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),n=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(s,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(s),this.container}_bindLink(e,i){e.href=this.linkService.getDestinationHash(i),e.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&v(this,si,En).call(this)}_bindNamedAction(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(i),!1),v(this,si,En).call(this)}_bindJSAction(e,i){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(i.actions)){const a=s.get(n);a&&(e[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:n}}),!1})}e.onclick||(e.onclick=()=>!1),v(this,si,En).call(this)}_bindResetFormAction(e,i){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),v(this,si,En).call(this),!this._fieldObjects){ht('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{var f;s==null||s();const{fields:n,refs:a,include:o}=i,l=[];if(n.length!==0||a.length!==0){const u=new Set(a);for(const p of n){const g=this._fieldObjects[p]||[];for(const{id:b}of g)u.add(b)}for(const p of Object.values(this._fieldObjects))for(const g of p)u.has(g.id)===o&&l.push(g)}else for(const u of Object.values(this._fieldObjects))l.push(...u);const c=this.annotationStorage,d=[];for(const u of l){const{id:p}=u;switch(d.push(p),u.type){case"text":{const b=u.defaultValue||"";c.setValue(p,{value:b});break}case"checkbox":case"radiobutton":{const b=u.defaultValue===u.exportValues;c.setValue(p,{value:b});break}case"combobox":case"listbox":{const b=u.defaultValue||"";c.setValue(p,{value:b});break}default:continue}const g=document.querySelector(`[data-element-id="${p}"]`);if(g){if(!Cr.has(g)){ht(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}si=new WeakSet,En=function(){this.container.setAttribute("data-internal-link","")},Rp=function(e,i,s=null){e.href=this.linkService.getAnchorUrl(""),i.description&&(e.title=i.description),e.onclick=()=>{var n;return(n=this.downloadManager)==null||n.openOrDownloadData(i.content,i.filename,s),!1},v(this,si,En).call(this)},kp=function(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(i),!1),v(this,si,En).call(this)};class my extends qt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Ir extends qt{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Fe.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,n){i.includes("mouse")?t.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{var o;if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}n&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a)}}))})}_setEventListeners(t,e,i,s){var n,a,o;for(const[l,c]of i)(c==="Action"||(n=this.data.actions)!=null&&n[c])&&((c==="Focus"||c==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,l,c,s),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":$.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||py,n=t.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),d=Math.round(c/(hc*s))||1,f=c/d;a=Math.min(s,l(f/hc))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(c/hc))}n.fontSize=`calc(${a}px * var(--scale-factor))`,n.color=$.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(n.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class by extends Ir{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,s){const n=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),n.setValue(a.id,{[s]:i})}render(){var s,n;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let o=a.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",c??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Cr.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=Hl,this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",u=>{t.setValue(e,{value:u.target.value}),this.setPropertyOnSiblings(i,"value",u.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",u=>{const p=this.data.defaultFieldValue??"";i.value=d.userValue=p,d.formattedValue=null});let f=u=>{const{formattedValue:p}=d;p!=null&&(u.target.value=p),u.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",p=>{var b;if(d.focused)return;const{target:g}=p;d.userValue&&(g.value=d.userValue),d.lastCommittedValue=g.value,d.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const g={value(b){d.userValue=b.detail.value??"",t.setValue(e,{value:d.userValue.toString()}),b.target.value=d.userValue},formattedValue(b){const{formattedValue:w}=b.detail;d.formattedValue=w,w!=null&&b.target!==document.activeElement&&(b.target.value=w),t.setValue(e,{formattedValue:w})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var S;const{charLimit:w}=b.detail,{target:A}=b;if(w===0){A.removeAttribute("maxLength");return}A.setAttribute("maxLength",w);let T=d.userValue;!T||T.length<=w||(T=T.slice(0,w),A.value=d.userValue=T,t.setValue(e,{value:T}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:T,willCommit:!0,commitKey:1,selStart:A.selectionStart,selEnd:A.selectionEnd}}))}};this._dispatchEventFromSandbox(g,p)}),i.addEventListener("keydown",p=>{var w;d.commitKey=1;let g=-1;if(p.key==="Escape"?g=0:p.key==="Enter"&&!this.data.multiLine?g=2:p.key==="Tab"&&(d.commitKey=3),g===-1)return;const{value:b}=p.target;d.lastCommittedValue!==b&&(d.lastCommittedValue=b,d.userValue=b,(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,willCommit:!0,commitKey:g,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const u=f;f=null,i.addEventListener("blur",p=>{var b,w;if(!d.focused||!p.relatedTarget)return;(b=this.data.actions)!=null&&b.Blur||(d.focused=!1);const{value:g}=p.target;d.userValue=g,d.lastCommittedValue!==g&&((w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:g,willCommit:!0,commitKey:d.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),u(p)}),(n=this.data.actions)!=null&&n.Keystroke&&i.addEventListener("beforeinput",p=>{var P;d.lastCommittedValue=null;const{data:g,target:b}=p,{value:w,selectionStart:A,selectionEnd:T}=b;let S=A,x=T;switch(p.inputType){case"deleteWordBackward":{const R=w.substring(0,A).match(/\w*[^\w]*$/);R&&(S-=R[0].length);break}case"deleteWordForward":{const R=w.substring(A).match(/^[^\w]*\w*/);R&&(x+=R[0].length);break}case"deleteContentBackward":A===T&&(S-=1);break;case"deleteContentForward":A===T&&(x+=1);break}p.preventDefault(),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:w,change:g||"",willCommit:!1,selStart:S,selEnd:x}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(f&&i.addEventListener("blur",f),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class vy extends Ir{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class yy extends Ir{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const n=document.createElement("input");return Cr.add(n),n.setAttribute("data-element-id",i),n.disabled=e.readOnly,this._setRequired(n,this.data.required),n.type="checkbox",n.name=e.fieldName,s&&n.setAttribute("checked",!0),n.setAttribute("exportValue",e.exportValue),n.tabIndex=Hl,n.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i)){const d=l&&c.exportValue===e.exportValue;c.domElement&&(c.domElement.checked=d),t.setValue(c.id,{value:d})}t.setValue(i,{value:l})}),n.addEventListener("resetform",a=>{const o=e.defaultFieldValue||"Off";a.target.checked=o===e.exportValue}),this.enableScripting&&this.hasJSActions&&(n.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",t.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Mp extends Ir{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const n=document.createElement("input");if(Cr.add(n),n.setAttribute("data-element-id",i),n.disabled=e.readOnly,this._setRequired(n,this.data.required),n.type="radio",n.name=e.fieldName,s&&n.setAttribute("checked",!0),n.tabIndex=Hl,n.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,i))t.setValue(c.id,{value:!1});t.setValue(i,{value:l})}),n.addEventListener("resetform",a=>{const o=e.defaultFieldValue;a.target.checked=o!=null&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;n.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const d=a===c.detail.value;for(const f of this._getElementsByName(c.target.name)){const u=d&&f.id===i;f.domElement&&(f.domElement.checked=u),t.setValue(f.id,{value:u})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class wy extends Pp{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class Ay extends Ir{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");Cr.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=Hl;let n=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",d=>{const f=this.data.defaultFieldValue;for(const u of s.options)u.selected=u.value===f});for(const d of this.data.options){const f=document.createElement("option");f.textContent=d.displayValue,f.value=d.exportValue,i.value.includes(d.exportValue)&&(f.setAttribute("selected",!0),n=!1),s.append(f)}let a=null;if(n){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),s.prepend(d),a=()=>{d.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=d=>{const f=d?"value":"textContent",{options:u,multiple:p}=s;return p?Array.prototype.filter.call(u,g=>g.selected).map(g=>g[f]):u.selectedIndex===-1?null:u[u.selectedIndex][f]};let l=o(!1);const c=d=>{const f=d.target.options;return Array.prototype.map.call(f,u=>({displayValue:u.textContent,exportValue:u.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",d=>{const f={value(u){a==null||a();const p=u.detail.value,g=new Set(Array.isArray(p)?p:[p]);for(const b of s.options)b.selected=g.has(b.value);t.setValue(e,{value:o(!0)}),l=o(!1)},multipleSelection(u){s.multiple=!0},remove(u){const p=s.options,g=u.detail.remove;p[g].selected=!1,s.remove(g),p.length>0&&Array.prototype.findIndex.call(p,w=>w.selected)===-1&&(p[0].selected=!0),t.setValue(e,{value:o(!0),items:c(u)}),l=o(!1)},clear(u){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),l=o(!1)},insert(u){const{index:p,displayValue:g,exportValue:b}=u.detail.insert,w=s.children[p],A=document.createElement("option");A.textContent=g,A.value=b,w?w.before(A):s.append(A),t.setValue(e,{value:o(!0),items:c(u)}),l=o(!1)},items(u){const{items:p}=u.detail;for(;s.length!==0;)s.remove(0);for(const g of p){const{displayValue:b,exportValue:w}=g,A=document.createElement("option");A.textContent=b,A.value=w,s.append(A)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:o(!0),items:c(u)}),l=o(!1)},indices(u){const p=new Set(u.detail.indices);for(const g of u.target.options)g.selected=p.has(g.index);t.setValue(e,{value:o(!0)}),l=o(!1)},editable(u){u.target.disabled=!u.detail.editable}};this._dispatchEventFromSandbox(f,d)}),s.addEventListener("input",d=>{var p;const f=o(!0),u=o(!1);t.setValue(e,{value:f}),d.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:l,change:u,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):s.addEventListener("input",function(d){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class sd extends qt{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:qt._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new _y({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${Vd}${i}`).join(",")),this.container}}var Sa,qh,Xh,xa,rr,Vt,vs,Ta,rl,al,Ca,ys,Ti,ws,ol,As,ll,ar,or,Lt,ch,nd,Lp,Ip,Fp,Dp,dh,uh,rd;class _y{constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:n,contentsObj:a,richText:o,parent:l,rect:c,parentRect:d,open:f}){y(this,Lt);y(this,Sa,v(this,Lt,Fp).bind(this));y(this,qh,v(this,Lt,rd).bind(this));y(this,Xh,v(this,Lt,uh).bind(this));y(this,xa,v(this,Lt,dh).bind(this));y(this,rr,null);y(this,Vt,null);y(this,vs,null);y(this,Ta,null);y(this,rl,null);y(this,al,null);y(this,Ca,null);y(this,ys,!1);y(this,Ti,null);y(this,ws,null);y(this,ol,null);y(this,As,null);y(this,ll,null);y(this,ar,null);y(this,or,!1);var u;m(this,Vt,t),m(this,ll,s),m(this,vs,a),m(this,As,o),m(this,al,l),m(this,rr,e),m(this,ol,c),m(this,Ca,d),m(this,rl,i),m(this,Ta,Gd.toDateObject(n)),this.trigger=i.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",r(this,xa)),p.addEventListener("mouseenter",r(this,Xh)),p.addEventListener("mouseleave",r(this,qh)),p.classList.add("popupTriggerArea");for(const p of i)(u=p.container)==null||u.addEventListener("keydown",r(this,Sa));r(this,Vt).hidden=!0,f&&v(this,Lt,dh).call(this)}render(){if(r(this,Ti))return;const t=m(this,Ti,document.createElement("div"));if(t.className="popup",r(this,rr)){const n=t.style.outlineColor=$.makeHexColor(...r(this,rr));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`:t.style.backgroundColor=$.makeHexColor(...r(this,rr).map(o=>Math.floor(.7*(255-o)+o)))}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),{dir:i.dir,str:i.textContent}=r(this,ll),t.append(e),r(this,Ta)){const n=document.createElement("span");n.classList.add("popupDate"),n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:r(this,Ta).valueOf()})),e.append(n)}const s=r(this,Lt,ch);if(s)Cp.render({xfaHtml:s,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const n=this._formatContents(r(this,vs));t.append(n)}r(this,Vt).append(t)}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let n=0,a=s.length;n<a;++n){const o=s[n];i.append(document.createTextNode(o)),n<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:t,popupContent:e}){var i;r(this,ar)||m(this,ar,{contentsObj:r(this,vs),richText:r(this,As)}),t&&m(this,ws,null),e&&(m(this,As,v(this,Lt,Ip).call(this,e)),m(this,vs,null)),(i=r(this,Ti))==null||i.remove(),m(this,Ti,null)}resetEdited(){var t;r(this,ar)&&({contentsObj:ke(this,vs)._,richText:ke(this,As)._}=r(this,ar),m(this,ar,null),(t=r(this,Ti))==null||t.remove(),m(this,Ti,null),m(this,ws,null))}forceHide(){m(this,or,this.isVisible),r(this,or)&&(r(this,Vt).hidden=!0)}maybeShow(){r(this,or)&&(r(this,Ti)||v(this,Lt,uh).call(this),m(this,or,!1),r(this,Vt).hidden=!1)}get isVisible(){return r(this,Vt).hidden===!1}}Sa=new WeakMap,qh=new WeakMap,Xh=new WeakMap,xa=new WeakMap,rr=new WeakMap,Vt=new WeakMap,vs=new WeakMap,Ta=new WeakMap,rl=new WeakMap,al=new WeakMap,Ca=new WeakMap,ys=new WeakMap,Ti=new WeakMap,ws=new WeakMap,ol=new WeakMap,As=new WeakMap,ll=new WeakMap,ar=new WeakMap,or=new WeakMap,Lt=new WeakSet,ch=function(){const t=r(this,As),e=r(this,vs);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&r(this,As).html||null},nd=function(){var t,e,i;return((i=(e=(t=r(this,Lt,ch))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.fontSize)||0},Lp=function(){var t,e,i;return((i=(e=(t=r(this,Lt,ch))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:i.color)||null},Ip=function(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:r(this,Lt,Lp),fontSize:r(this,Lt,nd)?`calc(${r(this,Lt,nd)}px * var(--scale-factor))`:""}};for(const n of t.split(`
`))e.push({name:"span",value:n,attributes:s});return i},Fp=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&r(this,ys))&&v(this,Lt,dh).call(this)},Dp=function(){if(r(this,ws)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:s,pageY:n}}}=r(this,al);let a=!!r(this,Ca),o=a?r(this,Ca):r(this,ol);for(const g of r(this,rl))if(!o||$.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const l=$.normalizeRect([o[0],t[3]-o[1]+t[1],o[2],t[3]-o[3]+t[1]]),d=a?o[2]-o[0]+5:0,f=l[0]+d,u=l[1];m(this,ws,[100*(f-s)/e,100*(u-n)/i]);const{style:p}=r(this,Vt);p.left=`${r(this,ws)[0]}%`,p.top=`${r(this,ws)[1]}%`},dh=function(){m(this,ys,!r(this,ys)),r(this,ys)?(v(this,Lt,uh).call(this),r(this,Vt).addEventListener("click",r(this,xa)),r(this,Vt).addEventListener("keydown",r(this,Sa))):(v(this,Lt,rd).call(this),r(this,Vt).removeEventListener("click",r(this,xa)),r(this,Vt).removeEventListener("keydown",r(this,Sa)))},uh=function(){r(this,Ti)||this.render(),this.isVisible?r(this,ys)&&r(this,Vt).classList.add("focused"):(v(this,Lt,Dp).call(this),r(this,Vt).hidden=!1,r(this,Vt).style.zIndex=parseInt(r(this,Vt).style.zIndex)+1e3)},rd=function(){r(this,Vt).classList.remove("focused"),!(r(this,ys)||!this.isVisible)&&(r(this,Vt).hidden=!0,r(this,Vt).style.zIndex=parseInt(r(this,Vt).style.zIndex)-1e3)};class Op extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=at.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var hl;class Ey extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,hl,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:i,height:s}=Is(e.rect),n=this.svgFactory.create(i,s,!0),a=m(this,hl,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,hl)}addHighlightArea(){this.container.classList.add("highlightArea")}}hl=new WeakMap;var cl;class Sy extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,cl,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:i,height:s}=Is(e.rect),n=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=m(this,cl,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,cl)}addHighlightArea(){this.container.classList.add("highlightArea")}}cl=new WeakMap;var dl;class xy extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,dl,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:i,height:s}=Is(e.rect),n=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=m(this,dl,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,dl)}addHighlightArea(){this.container.classList.add("highlightArea")}}dl=new WeakMap;var ul;class Np extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,ul,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:i,borderStyle:s,popupRef:n}}=this;if(!i)return this.container;const{width:a,height:o}=Is(e),l=this.svgFactory.create(a,o,!0);let c=[];for(let f=0,u=i.length;f<u;f+=2){const p=i[f]-e[0],g=e[3]-i[f+1];c.push(`${p},${g}`)}c=c.join(" ");const d=m(this,ul,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",c),d.setAttribute("stroke-width",s.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,ul)}addHighlightArea(){this.container.classList.add("highlightArea")}}ul=new WeakMap;class Ty extends Np{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Cy extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var fl;class tu extends qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});y(this,fl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?at.HIGHLIGHT:at.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,inkLists:i,borderStyle:s,popupRef:n}}=this,{width:a,height:o}=Is(e),l=this.svgFactory.create(a,o,!0);for(const c of i){let d=[];for(let u=0,p=c.length;u<p;u+=2){const g=c[u]-e[0],b=e[3]-c[u+1];d.push(`${g},${b}`)}d=d.join(" ");const f=this.svgFactory.createElement(this.svgElementName);r(this,fl).push(f),f.setAttribute("points",d),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),l.append(f)}return!n&&this.hasPopupData&&this._createPopup(),this.container.append(l),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return r(this,fl)}addHighlightArea(){this.container.classList.add("highlightArea")}}fl=new WeakMap;class Bp extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=at.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Py extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Ry extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ky extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Hp extends qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=at.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var pl,gl,ad;class My extends qt{constructor(e){var s;super(e,{isRenderable:!0});y(this,gl);y(this,pl,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",v(this,gl,ad).bind(this)),m(this,pl,s);const{isMac:n}=Fe.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(n?a.metaKey:a.ctrlKey)&&v(this,gl,ad).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return r(this,pl)}addHighlightArea(){this.container.classList.add("highlightArea")}}pl=new WeakMap,gl=new WeakSet,ad=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var ml,lr,hr,bl,Rr,jp,od,Sf;let Ly=(Sf=class{constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:s,page:n,viewport:a,structTreeLayer:o}){y(this,Rr);y(this,ml,null);y(this,lr,null);y(this,hr,new Map);y(this,bl,null);this.div=t,m(this,ml,e),m(this,lr,i),m(this,bl,o||null),this.page=n,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return r(this,hr).size>0}async render(t){var a;const{annotations:e}=t,i=this.div;xr(i,this.viewport);const s=new Map,n={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Zd,annotationStorage:t.annotationStorage||new Xd,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const l=o.annotationType===Zt.POPUP;if(l){const f=s.get(o.id);if(!f)continue;n.elements=f}else{const{width:f,height:u}=Is(o.rect);if(f<=0||u<=0)continue}n.data=o;const c=gy.create(n);if(!c.isRenderable)continue;if(!l&&o.popupRef){const f=s.get(o.popupRef);f?f.push(c):s.set(o.popupRef,[c])}const d=c.render();o.hidden&&(d.style.visibility="hidden"),await v(this,Rr,jp).call(this,d,o.id),c._isEditable&&(r(this,hr).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}v(this,Rr,od).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,xr(e,{rotation:t.rotation}),v(this,Rr,od).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(r(this,hr).values())}getEditableAnnotation(t){return r(this,hr).get(t)}},ml=new WeakMap,lr=new WeakMap,hr=new WeakMap,bl=new WeakMap,Rr=new WeakSet,jp=async function(t,e){var a,o;const i=t.firstChild||t,s=i.id=`${Vd}${e}`,n=await((a=r(this,bl))==null?void 0:a.getAriaAttributes(s));if(n)for(const[l,c]of n)i.setAttribute(l,c);this.div.append(t),(o=r(this,ml))==null||o.moveElementInDOM(this.div,t,i,!1)},od=function(){if(!r(this,lr))return;const t=this.div;for(const[e,i]of r(this,lr)){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:n}=s;n?n.nodeName==="CANVAS"?n.replaceWith(i):n.classList.contains("annotationContent")?n.after(i):n.before(i):s.append(i)}r(this,lr).clear()},Sf);const Yl=/\r\n?|\n/g;var Ci,Ye,vl,cr,Ke,Qt,Wp,Up,Vp,fh,Ds,ph,gh,zp,hd,$p;const Dt=class Dt extends Rt{constructor(e){super({...e,name:"freeTextEditor"});y(this,Qt);y(this,Ci);y(this,Ye,"");y(this,vl,`${this.id}-editor`);y(this,cr,null);y(this,Ke);m(this,Ci,e.color||Dt._defaultColor||Rt._defaultLineColor),m(this,Ke,e.fontSize||Dt._defaultFontSize)}static get _keyboardManager(){const e=Dt.prototype,i=a=>a.isEmpty(),s=Tr.TRANSLATE_SMALL,n=Tr.TRANSLATE_BIG;return gt(this,"_keyboardManager",new Bl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:i}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[n,0],checker:i}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:i}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,n],checker:i}]]))}static initialize(e,i){Rt.initialize(e,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,i){switch(e){case et.FREETEXT_SIZE:Dt._defaultFontSize=i;break;case et.FREETEXT_COLOR:Dt._defaultColor=i;break}}updateParams(e,i){switch(e){case et.FREETEXT_SIZE:v(this,Qt,Wp).call(this,i);break;case et.FREETEXT_COLOR:v(this,Qt,Up).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[et.FREETEXT_SIZE,Dt._defaultFontSize],[et.FREETEXT_COLOR,Dt._defaultColor||Rt._defaultLineColor]]}get propertiesToUpdate(){return[[et.FREETEXT_SIZE,r(this,Ke)],[et.FREETEXT_COLOR,r(this,Ci)]]}_translateEmpty(e,i){this._uiManager.translateSelectedEditors(e,i,!0)}getInitialTranslation(){const e=this.parentScale;return[-Dt._internalPadding*e,-(Dt._internalPadding+r(this,Ke))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(at.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,cr,new AbortController);const e=this._uiManager.combinedSignal(r(this,cr));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",r(this,vl)),this._isDraggable=!0,(e=r(this,cr))==null||e.abort(),m(this,cr,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width||(this.enableEditMode(),this.editorDiv.focus(),(e=this._initialOptions)!=null&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=r(this,Ye),i=m(this,Ye,v(this,Qt,Vp).call(this).trimEnd());if(e===i)return;const s=n=>{if(m(this,Ye,n),!n){this.remove();return}v(this,Qt,gh).call(this),this._uiManager.rebuild(this),v(this,Qt,fh).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(e)},mustExec:!1}),v(this,Qt,fh).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Dt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",r(this,vl)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${r(this,Ke)}px * var(--scale-factor))`,s.color=r(this,Ci),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Rh(this,this.div,["dblclick","keydown"]),this.width){const[n,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[d,f]=this.pageDimensions,[u,p]=this.pageTranslation;let g,b;switch(this.rotation){case 0:g=e+(o[0]-u)/d,b=i+this.height-(o[1]-p)/f;break;case 90:g=e+(o[0]-u)/d,b=i-(o[1]-p)/f,[l,c]=[c,-l];break;case 180:g=e-this.width+(o[0]-u)/d,b=i-(o[1]-p)/f,[l,c]=[-l,-c];break;case 270:g=e+(o[0]-u-this.height*f)/d,b=i+(o[1]-p-this.width*d)/f,[l,c]=[-c,l];break}this.setAt(g*n,b*a,l,c)}else this.setAt(e*n,i*a,this.width*n,this.height*a);v(this,Qt,gh).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var g,b,w;const i=e.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const n=v(g=Dt,Ds,hd).call(g,i.getData("text")||"").replaceAll(Yl,`
`);if(!n)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!n.includes(`
`)){o.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,d=[],f=[];if(l.nodeType===Node.TEXT_NODE){const A=l.parentElement;if(f.push(l.nodeValue.slice(c).replaceAll(Yl,"")),A!==this.editorDiv){let T=d;for(const S of this.editorDiv.childNodes){if(S===A){T=f;continue}T.push(v(b=Dt,Ds,ph).call(b,S))}}d.push(l.nodeValue.slice(0,c).replaceAll(Yl,""))}else if(l===this.editorDiv){let A=d,T=0;for(const S of this.editorDiv.childNodes)T++===c&&(A=f),A.push(v(w=Dt,Ds,ph).call(w,S))}m(this,Ye,`${d.join(`
`)}${n}${f.join(`
`)}`),v(this,Qt,gh).call(this);const u=new Range;let p=d.reduce((A,T)=>A+T.length,0);for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const T=A.nodeValue.length;if(p<=T){u.setStart(A,p),u.setEnd(A,p);break}p-=T}a.removeAllRanges(),a.addRange(u)}get contentDiv(){return this.editorDiv}static async deserialize(e,i,s){var o;let n=null;if(e instanceof Op){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:d,rotation:f,id:u,popupRef:p},textContent:g,textPosition:b,parent:{page:{pageNumber:w}}}=e;if(!g||g.length===0)return null;n=e={annotationType:at.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:b,pageIndex:w-1,rect:d.slice(0),rotation:f,id:u,deleted:!1,popupRef:p}}const a=await super.deserialize(e,i,s);return m(a,Ke,e.fontSize),m(a,Ci,$.makeHexColor(...e.color)),m(a,Ye,v(o=Dt,Ds,hd).call(o,e.value)),a.annotationElementId=e.id||null,a._initialData=n,a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Dt._internalPadding*this.parentScale,s=this.getRect(i,i),n=Rt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:r(this,Ci)),a={annotationType:at.FREETEXT,color:n,fontSize:r(this,Ke),value:v(this,Qt,zp).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?a:this.annotationElementId&&!v(this,Qt,$p).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(e){const i=super.renderAnnotationElement(e);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${r(this,Ke)}px * var(--scale-factor))`,s.color=r(this,Ci),i.replaceChildren();for(const a of r(this,Ye).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const n=Dt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(n,n),popupContent:r(this,Ye)}),i}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Ci=new WeakMap,Ye=new WeakMap,vl=new WeakMap,cr=new WeakMap,Ke=new WeakMap,Qt=new WeakSet,Wp=function(e){const i=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--scale-factor))`,this.translate(0,-(n-r(this,Ke))*this.parentScale),m(this,Ke,n),v(this,Qt,fh).call(this)},s=r(this,Ke);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Up=function(e){const i=n=>{m(this,Ci,this.editorDiv.style.color=n)},s=r(this,Ci);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Vp=function(){var s;const e=[];this.editorDiv.normalize();let i=null;for(const n of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(v(s=Dt,Ds,ph).call(s,n)),i=n);return e.join(`
`)},fh=function(){const[e,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:n,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",n.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/i):(this.width=s.height/e,this.height=s.width/i),this.fixAndSetPosition()},Ds=new WeakSet,ph=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Yl,"")},gh=function(){if(this.editorDiv.replaceChildren(),!!r(this,Ye))for(const e of r(this,Ye).split(`
`)){const i=document.createElement("div");i.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(i)}},zp=function(){return r(this,Ye).replaceAll(" "," ")},hd=function(e){return e.replaceAll(" "," ")},$p=function(e){const{value:i,fontSize:s,color:n,pageIndex:a}=this._initialData;return this._hasBeenMoved||e.value!==i||e.fontSize!==s||e.color.some((o,l)=>o!==n[l])||e.pageIndex!==a},y(Dt,Ds),tt(Dt,"_freeTextDefaultContent",""),tt(Dt,"_internalPadding",0),tt(Dt,"_defaultColor",null),tt(Dt,"_defaultFontSize",10),tt(Dt,"_type","freetext"),tt(Dt,"_editorType",at.FREETEXT);let ld=Dt;class Gp{toSVGPath(){Nt("Abstract method `toSVGPath` must be implemented.")}get box(){Nt("Abstract getter `box` must be implemented.")}serialize(t,e){Nt("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){Nt("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){Nt("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}}var Qe,Pi,Pa,Ra,Yi,dt,dr,ur,yl,wl,ka,Ma,on,Al,Yh,Kh,ne,ho,qp,Xp,Yp,Kp,Qp,Jp;const os=class os{constructor({x:t,y:e},i,s,n,a,o=0){y(this,ne);y(this,Qe);y(this,Pi,[]);y(this,Pa);y(this,Ra);y(this,Yi,[]);y(this,dt,new Float64Array(18));y(this,dr);y(this,ur);y(this,yl);y(this,wl);y(this,ka);y(this,Ma);y(this,on,[]);m(this,Qe,i),m(this,Ma,n*s),m(this,Ra,a),r(this,dt).set([NaN,NaN,NaN,NaN,t,e],6),m(this,Pa,o),m(this,wl,r(os,Al)*s),m(this,yl,r(os,Kh)*s),m(this,ka,s),r(this,on).push(t,e)}isEmpty(){return isNaN(r(this,dt)[8])}add({x:t,y:e}){var D;m(this,dr,t),m(this,ur,e);const[i,s,n,a]=r(this,Qe);let[o,l,c,d]=r(this,dt).subarray(8,12);const f=t-c,u=e-d,p=Math.hypot(f,u);if(p<r(this,yl))return!1;const g=p-r(this,wl),b=g/p,w=b*f,A=b*u;let T=o,S=l;o=c,l=d,c+=w,d+=A,(D=r(this,on))==null||D.push(t,e);const x=-A/g,P=w/g,R=x*r(this,Ma),M=P*r(this,Ma);return r(this,dt).set(r(this,dt).subarray(2,8),0),r(this,dt).set([c+R,d+M],4),r(this,dt).set(r(this,dt).subarray(14,18),12),r(this,dt).set([c-R,d-M],16),isNaN(r(this,dt)[6])?(r(this,Yi).length===0&&(r(this,dt).set([o+R,l+M],2),r(this,Yi).push(NaN,NaN,NaN,NaN,(o+R-i)/n,(l+M-s)/a),r(this,dt).set([o-R,l-M],14),r(this,Pi).push(NaN,NaN,NaN,NaN,(o-R-i)/n,(l-M-s)/a)),r(this,dt).set([T,S,o,l,c,d],6),!this.isEmpty()):(r(this,dt).set([T,S,o,l,c,d],6),Math.abs(Math.atan2(S-l,T-o)-Math.atan2(A,w))<Math.PI/2?([o,l,c,d]=r(this,dt).subarray(2,6),r(this,Yi).push(NaN,NaN,NaN,NaN,((o+c)/2-i)/n,((l+d)/2-s)/a),[o,l,T,S]=r(this,dt).subarray(14,18),r(this,Pi).push(NaN,NaN,NaN,NaN,((T+o)/2-i)/n,((S+l)/2-s)/a),!0):([T,S,o,l,c,d]=r(this,dt).subarray(0,6),r(this,Yi).push(((T+5*o)/6-i)/n,((S+5*l)/6-s)/a,((5*o+c)/6-i)/n,((5*l+d)/6-s)/a,((o+c)/2-i)/n,((l+d)/2-s)/a),[c,d,o,l,T,S]=r(this,dt).subarray(12,18),r(this,Pi).push(((T+5*o)/6-i)/n,((S+5*l)/6-s)/a,((5*o+c)/6-i)/n,((5*l+d)/6-s)/a,((o+c)/2-i)/n,((l+d)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=r(this,Yi),e=r(this,Pi);if(isNaN(r(this,dt)[6])&&!this.isEmpty())return v(this,ne,qp).call(this);const i=[];i.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);v(this,ne,Yp).call(this,i);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return v(this,ne,Xp).call(this,i),i.join(" ")}newFreeDrawOutline(t,e,i,s,n,a){return new Zp(t,e,i,s,n,a)}getOutlines(){var f;const t=r(this,Yi),e=r(this,Pi),i=r(this,dt),[s,n,a,o]=r(this,Qe),l=new Float64Array((((f=r(this,on))==null?void 0:f.length)??0)+2);for(let u=0,p=l.length-2;u<p;u+=2)l[u]=(r(this,on)[u]-s)/a,l[u+1]=(r(this,on)[u+1]-n)/o;if(l[l.length-2]=(r(this,dr)-s)/a,l[l.length-1]=(r(this,ur)-n)/o,isNaN(i[6])&&!this.isEmpty())return v(this,ne,Kp).call(this,l);const c=new Float64Array(r(this,Yi).length+24+r(this,Pi).length);let d=t.length;for(let u=0;u<d;u+=2){if(isNaN(t[u])){c[u]=c[u+1]=NaN;continue}c[u]=t[u],c[u+1]=t[u+1]}d=v(this,ne,Jp).call(this,c,d);for(let u=e.length-6;u>=6;u-=6)for(let p=0;p<6;p+=2){if(isNaN(e[u+p])){c[d]=c[d+1]=NaN,d+=2;continue}c[d]=e[u+p],c[d+1]=e[u+p+1],d+=2}return v(this,ne,Qp).call(this,c,d),this.newFreeDrawOutline(c,l,r(this,Qe),r(this,ka),r(this,Pa),r(this,Ra))}};Qe=new WeakMap,Pi=new WeakMap,Pa=new WeakMap,Ra=new WeakMap,Yi=new WeakMap,dt=new WeakMap,dr=new WeakMap,ur=new WeakMap,yl=new WeakMap,wl=new WeakMap,ka=new WeakMap,Ma=new WeakMap,on=new WeakMap,Al=new WeakMap,Yh=new WeakMap,Kh=new WeakMap,ne=new WeakSet,ho=function(){const t=r(this,dt).subarray(4,6),e=r(this,dt).subarray(16,18),[i,s,n,a]=r(this,Qe);return[(r(this,dr)+(t[0]-e[0])/2-i)/n,(r(this,ur)+(t[1]-e[1])/2-s)/a,(r(this,dr)+(e[0]-t[0])/2-i)/n,(r(this,ur)+(e[1]-t[1])/2-s)/a]},qp=function(){const[t,e,i,s]=r(this,Qe),[n,a,o,l]=v(this,ne,ho).call(this);return`M${(r(this,dt)[2]-t)/i} ${(r(this,dt)[3]-e)/s} L${(r(this,dt)[4]-t)/i} ${(r(this,dt)[5]-e)/s} L${n} ${a} L${o} ${l} L${(r(this,dt)[16]-t)/i} ${(r(this,dt)[17]-e)/s} L${(r(this,dt)[14]-t)/i} ${(r(this,dt)[15]-e)/s} Z`},Xp=function(t){const e=r(this,Pi);t.push(`L${e[4]} ${e[5]} Z`)},Yp=function(t){const[e,i,s,n]=r(this,Qe),a=r(this,dt).subarray(4,6),o=r(this,dt).subarray(16,18),[l,c,d,f]=v(this,ne,ho).call(this);t.push(`L${(a[0]-e)/s} ${(a[1]-i)/n} L${l} ${c} L${d} ${f} L${(o[0]-e)/s} ${(o[1]-i)/n}`)},Kp=function(t){const e=r(this,dt),[i,s,n,a]=r(this,Qe),[o,l,c,d]=v(this,ne,ho).call(this),f=new Float64Array(36);return f.set([NaN,NaN,NaN,NaN,(e[2]-i)/n,(e[3]-s)/a,NaN,NaN,NaN,NaN,(e[4]-i)/n,(e[5]-s)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,(e[16]-i)/n,(e[17]-s)/a,NaN,NaN,NaN,NaN,(e[14]-i)/n,(e[15]-s)/a],0),this.newFreeDrawOutline(f,t,r(this,Qe),r(this,ka),r(this,Pa),r(this,Ra))},Qp=function(t,e){const i=r(this,Pi);return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6},Jp=function(t,e){const i=r(this,dt).subarray(4,6),s=r(this,dt).subarray(16,18),[n,a,o,l]=r(this,Qe),[c,d,f,u]=v(this,ne,ho).call(this);return t.set([NaN,NaN,NaN,NaN,(i[0]-n)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,f,u,NaN,NaN,NaN,NaN,(s[0]-n)/o,(s[1]-a)/l],e),e+=24},y(os,Al,8),y(os,Yh,2),y(os,Kh,r(os,Al)+r(os,Yh));let Mh=os;var La,fr,_s,_l,Je,El,Gt,ze,co,uo,tg;class Zp extends Gp{constructor(e,i,s,n,a,o){super();y(this,ze);y(this,La);y(this,fr,null);y(this,_s);y(this,_l);y(this,Je);y(this,El);y(this,Gt);m(this,Gt,e),m(this,Je,i),m(this,La,s),m(this,El,n),m(this,_s,a),m(this,_l,o),v(this,ze,tg).call(this,o);const{x:l,y:c,width:d,height:f}=r(this,fr);for(let u=0,p=e.length;u<p;u+=2)e[u]=(e[u]-l)/d,e[u+1]=(e[u+1]-c)/f;for(let u=0,p=i.length;u<p;u+=2)i[u]=(i[u]-l)/d,i[u+1]=(i[u+1]-c)/f}toSVGPath(){const e=[`M${r(this,Gt)[4]} ${r(this,Gt)[5]}`];for(let i=6,s=r(this,Gt).length;i<s;i+=6){if(isNaN(r(this,Gt)[i])){e.push(`L${r(this,Gt)[i+4]} ${r(this,Gt)[i+5]}`);continue}e.push(`C${r(this,Gt)[i]} ${r(this,Gt)[i+1]} ${r(this,Gt)[i+2]} ${r(this,Gt)[i+3]} ${r(this,Gt)[i+4]} ${r(this,Gt)[i+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,i,s,n],a){const o=s-e,l=n-i;let c,d;switch(a){case 0:c=v(this,ze,co).call(this,r(this,Gt),e,n,o,-l),d=v(this,ze,co).call(this,r(this,Je),e,n,o,-l);break;case 90:c=v(this,ze,uo).call(this,r(this,Gt),e,i,o,l),d=v(this,ze,uo).call(this,r(this,Je),e,i,o,l);break;case 180:c=v(this,ze,co).call(this,r(this,Gt),s,i,-o,l),d=v(this,ze,co).call(this,r(this,Je),s,i,-o,l);break;case 270:c=v(this,ze,uo).call(this,r(this,Gt),s,n,-o,-l),d=v(this,ze,uo).call(this,r(this,Je),s,n,-o,-l);break}return{outline:Array.from(c),points:[Array.from(d)]}}get box(){return r(this,fr)}newOutliner(e,i,s,n,a,o=0){return new Mh(e,i,s,n,a,o)}getNewOutline(e,i){const{x:s,y:n,width:a,height:o}=r(this,fr),[l,c,d,f]=r(this,La),u=a*d,p=o*f,g=s*d+l,b=n*f+c,w=this.newOutliner({x:r(this,Je)[0]*u+g,y:r(this,Je)[1]*p+b},r(this,La),r(this,El),e,r(this,_l),i??r(this,_s));for(let A=2;A<r(this,Je).length;A+=2)w.add({x:r(this,Je)[A]*u+g,y:r(this,Je)[A+1]*p+b});return w.getOutlines()}get mustRemoveSelfIntersections(){return!0}}La=new WeakMap,fr=new WeakMap,_s=new WeakMap,_l=new WeakMap,Je=new WeakMap,El=new WeakMap,Gt=new WeakMap,ze=new WeakSet,co=function(e,i,s,n,a){const o=new Float64Array(e.length);for(let l=0,c=e.length;l<c;l+=2)o[l]=i+e[l]*n,o[l+1]=s+e[l+1]*a;return o},uo=function(e,i,s,n,a){const o=new Float64Array(e.length);for(let l=0,c=e.length;l<c;l+=2)o[l]=i+e[l+1]*n,o[l+1]=s+e[l]*a;return o},tg=function(e){const i=r(this,Gt);let s=i[4],n=i[5],a=s,o=n,l=s,c=n,d=s,f=n;const u=e?Math.max:Math.min;for(let A=6,T=i.length;A<T;A+=6){if(isNaN(i[A]))a=Math.min(a,i[A+4]),o=Math.min(o,i[A+5]),l=Math.max(l,i[A+4]),c=Math.max(c,i[A+5]),f<i[A+5]?(d=i[A+4],f=i[A+5]):f===i[A+5]&&(d=u(d,i[A+4]));else{const S=$.bezierBoundingBox(s,n,...i.slice(A,A+6));a=Math.min(a,S[0]),o=Math.min(o,S[1]),l=Math.max(l,S[2]),c=Math.max(c,S[3]),f<S[3]?(d=S[2],f=S[3]):f===S[3]&&(d=u(d,S[2]))}s=i[A+4],n=i[A+5]}const p=a-r(this,_s),g=o-r(this,_s),b=l-a+2*r(this,_s),w=c-o+2*r(this,_s);m(this,fr,{x:p,y:g,width:b,height:w,lastPoint:[d,f]})};var Sl,ln,Ri,Oe,eg,mh,ig,sg,cd;class uf{constructor(t,e=0,i=0,s=!0){y(this,Oe);y(this,Sl);y(this,ln,[]);y(this,Ri,[]);let n=1/0,a=-1/0,o=1/0,l=-1/0;const d=10**-4;for(const{x:A,y:T,width:S,height:x}of t){const P=Math.floor((A-e)/d)*d,R=Math.ceil((A+S+e)/d)*d,M=Math.floor((T-e)/d)*d,L=Math.ceil((T+x+e)/d)*d,D=[P,M,L,!0],O=[R,M,L,!1];r(this,ln).push(D,O),n=Math.min(n,P),a=Math.max(a,R),o=Math.min(o,M),l=Math.max(l,L)}const f=a-n+2*i,u=l-o+2*i,p=n-i,g=o-i,b=r(this,ln).at(s?-1:-2),w=[b[0],b[2]];for(const A of r(this,ln)){const[T,S,x]=A;A[0]=(T-p)/f,A[1]=(S-g)/u,A[2]=(x-g)/u}m(this,Sl,{x:p,y:g,width:f,height:u,lastPoint:w})}getOutlines(){r(this,ln).sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of r(this,ln))e[3]?(t.push(...v(this,Oe,cd).call(this,e)),v(this,Oe,ig).call(this,e)):(v(this,Oe,sg).call(this,e),t.push(...v(this,Oe,cd).call(this,e)));return v(this,Oe,eg).call(this,t)}}Sl=new WeakMap,ln=new WeakMap,Ri=new WeakMap,Oe=new WeakSet,eg=function(t){const e=[],i=new Set;for(const a of t){const[o,l,c]=a;e.push([o,l,a],[o,c,a])}e.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=e.length;a<o;a+=2){const l=e[a][2],c=e[a+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const s=[];let n;for(;i.size>0;){const a=i.values().next().value;let[o,l,c,d,f]=a;i.delete(a);let u=o,p=l;for(n=[o,c],s.push(n);;){let g;if(i.has(d))g=d;else if(i.has(f))g=f;else break;i.delete(g),[o,l,c,d,f]=g,u!==o&&(n.push(u,p,o,p===l?l:c),u=o),p=p===l?c:l}n.push(u,p)}return new Iy(s,r(this,Sl))},mh=function(t){const e=r(this,Ri);let i=0,s=e.length-1;for(;i<=s;){const n=i+s>>1,a=e[n][0];if(a===t)return n;a<t?i=n+1:s=n-1}return s+1},ig=function([,t,e]){const i=v(this,Oe,mh).call(this,t);r(this,Ri).splice(i,0,[t,e])},sg=function([,t,e]){const i=v(this,Oe,mh).call(this,t);for(let s=i;s<r(this,Ri).length;s++){const[n,a]=r(this,Ri)[s];if(n!==t)break;if(n===t&&a===e){r(this,Ri).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[n,a]=r(this,Ri)[s];if(n!==t)break;if(n===t&&a===e){r(this,Ri).splice(s,1);return}}},cd=function(t){const[e,i,s]=t,n=[[e,i,s]],a=v(this,Oe,mh).call(this,s);for(let o=0;o<a;o++){const[l,c]=r(this,Ri)[o];for(let d=0,f=n.length;d<f;d++){const[,u,p]=n[d];if(!(c<=u||p<=l)){if(u>=l){if(p>c)n[d][1]=c;else{if(f===1)return[];n.splice(d,1),d--,f--}continue}n[d][2]=l,p>c&&n.push([e,c,p])}}}return n};var xl,Ia;class Iy extends Gp{constructor(e,i){super();y(this,xl);y(this,Ia);m(this,Ia,e),m(this,xl,i)}toSVGPath(){const e=[];for(const i of r(this,Ia)){let[s,n]=i;e.push(`M${s} ${n}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===s?(e.push(`V${l}`),n=l):l===n&&(e.push(`H${o}`),s=o)}e.push("Z")}return e.join(" ")}serialize([e,i,s,n],a){const o=[],l=s-e,c=n-i;for(const d of r(this,Ia)){const f=new Array(d.length);for(let u=0;u<d.length;u+=2)f[u]=e+d[u]*l,f[u+1]=n-d[u+1]*c;o.push(f)}return o}get box(){return r(this,xl)}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}}xl=new WeakMap,Ia=new WeakMap;class dd extends Mh{newFreeDrawOutline(t,e,i,s,n,a){return new Fy(t,e,i,s,n,a)}get classNamesForDrawing(){return["highlight","free"]}}class Fy extends Zp{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(t,e,i,s,n,a=0){return new dd(t,e,i,s,n,a)}}var ki,pr,Fa,ee,Tl,Da,Cl,Pl,hn,Mi,Oa,Rl,Mt,ud,fd,pd,Sn,ng,js;const He=class He{constructor({editor:t=null,uiManager:e=null}){y(this,Mt);y(this,ki,null);y(this,pr,null);y(this,Fa);y(this,ee,null);y(this,Tl,!1);y(this,Da,!1);y(this,Cl,null);y(this,Pl);y(this,hn,null);y(this,Mi,null);y(this,Oa);var i;t?(m(this,Da,!1),m(this,Oa,et.HIGHLIGHT_COLOR),m(this,Cl,t)):(m(this,Da,!0),m(this,Oa,et.HIGHLIGHT_DEFAULT_COLOR)),m(this,Mi,(t==null?void 0:t._uiManager)||e),m(this,Pl,r(this,Mi)._eventBus),m(this,Fa,(t==null?void 0:t.color)||((i=r(this,Mi))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),r(He,Rl)||m(He,Rl,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return gt(this,"_keyboardManager",new Bl([[["Escape","mac+Escape"],He.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],He.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],He.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],He.prototype._moveToPrevious],[["Home","mac+Home"],He.prototype._moveToBeginning],[["End","mac+End"],He.prototype._moveToEnd]]))}renderButton(){const t=m(this,ki,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=r(this,Mi)._signal;t.addEventListener("click",v(this,Mt,Sn).bind(this),{signal:e}),t.addEventListener("keydown",v(this,Mt,pd).bind(this),{signal:e});const i=m(this,pr,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=r(this,Fa),t.append(i),t}renderMainDropdown(){const t=m(this,ee,v(this,Mt,ud).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===r(this,ki)){v(this,Mt,Sn).call(this,t);return}const e=t.target.getAttribute("data-color");e&&v(this,Mt,fd).call(this,e,t)}_moveToNext(t){var e,i;if(!r(this,Mt,js)){v(this,Mt,Sn).call(this,t);return}if(t.target===r(this,ki)){(e=r(this,ee).firstChild)==null||e.focus();return}(i=t.target.nextSibling)==null||i.focus()}_moveToPrevious(t){var e,i;if(t.target===((e=r(this,ee))==null?void 0:e.firstChild)||t.target===r(this,ki)){r(this,Mt,js)&&this._hideDropdownFromKeyboard();return}r(this,Mt,js)||v(this,Mt,Sn).call(this,t),(i=t.target.previousSibling)==null||i.focus()}_moveToBeginning(t){var e;if(!r(this,Mt,js)){v(this,Mt,Sn).call(this,t);return}(e=r(this,ee).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!r(this,Mt,js)){v(this,Mt,Sn).call(this,t);return}(e=r(this,ee).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=r(this,ee))==null||t.classList.add("hidden"),(e=r(this,hn))==null||e.abort(),m(this,hn,null)}_hideDropdownFromKeyboard(){var t;if(!r(this,Da)){if(!r(this,Mt,js)){(t=r(this,Cl))==null||t.unselect();return}this.hideDropdown(),r(this,ki).focus({preventScroll:!0,focusVisible:r(this,Tl)})}}updateColor(t){if(r(this,pr)&&(r(this,pr).style.backgroundColor=t),!r(this,ee))return;const e=r(this,Mi).highlightColors.values();for(const i of r(this,ee).children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=r(this,ki))==null||t.remove(),m(this,ki,null),m(this,pr,null),(e=r(this,ee))==null||e.remove(),m(this,ee,null)}};ki=new WeakMap,pr=new WeakMap,Fa=new WeakMap,ee=new WeakMap,Tl=new WeakMap,Da=new WeakMap,Cl=new WeakMap,Pl=new WeakMap,hn=new WeakMap,Mi=new WeakMap,Oa=new WeakMap,Rl=new WeakMap,Mt=new WeakSet,ud=function(){const t=document.createElement("div"),e=r(this,Mi)._signal;t.addEventListener("contextmenu",mi,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of r(this,Mi).highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",s),n.title=i,n.setAttribute("data-l10n-id",r(He,Rl)[i]);const a=document.createElement("span");n.append(a),a.className="swatch",a.style.backgroundColor=s,n.setAttribute("aria-selected",s===r(this,Fa)),n.addEventListener("click",v(this,Mt,fd).bind(this,s),{signal:e}),t.append(n)}return t.addEventListener("keydown",v(this,Mt,pd).bind(this),{signal:e}),t},fd=function(t,e){e.stopPropagation(),r(this,Pl).dispatch("switchannotationeditorparams",{source:this,type:r(this,Oa),value:t})},pd=function(t){He._keyboardManager.exec(this,t)},Sn=function(t){if(r(this,Mt,js)){this.hideDropdown();return}if(m(this,Tl,t.detail===0),r(this,hn)||(m(this,hn,new AbortController),window.addEventListener("pointerdown",v(this,Mt,ng).bind(this),{signal:r(this,Mi).combinedSignal(r(this,hn))})),r(this,ee)){r(this,ee).classList.remove("hidden");return}const e=m(this,ee,v(this,Mt,ud).call(this));r(this,ki).append(e)},ng=function(t){var e;(e=r(this,ee))!=null&&e.contains(t.target)||this.hideDropdown()},js=function(){return r(this,ee)&&!r(this,ee).classList.contains("hidden")},y(He,Rl,null);let Lh=He;var Na,kl,Es,gr,Ba,ci,Ml,Ll,mr,Li,Se,Ue,Ha,Ss,ie,ja,di,Il,nt,gd,bh,rg,ag,og,md,xn,pi,Ur,lg,vh,fo,hg,cg,dg,ug,fg;const _t=class _t extends Rt{constructor(e){super({...e,name:"highlightEditor"});y(this,nt);y(this,Na,null);y(this,kl,0);y(this,Es);y(this,gr,null);y(this,Ba,null);y(this,ci,null);y(this,Ml,null);y(this,Ll,0);y(this,mr,null);y(this,Li,null);y(this,Se,null);y(this,Ue,!1);y(this,Ha,null);y(this,Ss);y(this,ie,null);y(this,ja,"");y(this,di);y(this,Il,"");this.color=e.color||_t._defaultColor,m(this,di,e.thickness||_t._defaultThickness),m(this,Ss,e.opacity||_t._defaultOpacity),m(this,Es,e.boxes||null),m(this,Il,e.methodOfCreation||""),m(this,ja,e.text||""),this._isDraggable=!1,e.highlightId>-1?(m(this,Ue,!0),v(this,nt,bh).call(this,e),v(this,nt,xn).call(this)):r(this,Es)&&(m(this,Na,e.anchorNode),m(this,kl,e.anchorOffset),m(this,Ml,e.focusNode),m(this,Ll,e.focusOffset),v(this,nt,gd).call(this),v(this,nt,xn).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=_t.prototype;return gt(this,"_keyboardManager",new Bl([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:r(this,Ue)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:r(this,di),methodOfCreation:r(this,Il)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,i){var s;Rt.initialize(e,i),_t._defaultColor||(_t._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(e,i){switch(e){case et.HIGHLIGHT_DEFAULT_COLOR:_t._defaultColor=i;break;case et.HIGHLIGHT_THICKNESS:_t._defaultThickness=i;break}}translateInPage(e,i){}get toolbarPosition(){return r(this,Ha)}updateParams(e,i){switch(e){case et.HIGHLIGHT_COLOR:v(this,nt,rg).call(this,i);break;case et.HIGHLIGHT_THICKNESS:v(this,nt,ag).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[et.HIGHLIGHT_DEFAULT_COLOR,_t._defaultColor],[et.HIGHLIGHT_THICKNESS,_t._defaultThickness]]}get propertiesToUpdate(){return[[et.HIGHLIGHT_COLOR,this.color||_t._defaultColor],[et.HIGHLIGHT_THICKNESS,r(this,di)||_t._defaultThickness],[et.HIGHLIGHT_FREE,r(this,Ue)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(m(this,Ba,new Lh({editor:this})),e.addColorPicker(r(this,Ba))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(v(this,nt,fo).call(this))}getBaseTranslation(){return[0,0]}getRect(e,i){return super.getRect(e,i,v(this,nt,fo).call(this))}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){v(this,nt,md).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(v(this,nt,xn).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var s;let i=!1;this.parent&&!e?v(this,nt,md).call(this):e&&(v(this,nt,xn).call(this,e),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),i&&this.select()}rotate(e){var n,a,o;const{drawLayer:i}=this.parent;let s;r(this,Ue)?(e=(e-this.rotation+360)%360,s=v(n=_t,pi,Ur).call(n,r(this,Li).box,e)):s=v(a=_t,pi,Ur).call(a,this,e),i.rotate(r(this,Se),e),i.rotate(r(this,ie),e),i.updateBox(r(this,Se),s),i.updateBox(r(this,ie),v(o=_t,pi,Ur).call(o,r(this,ci).box,e))}render(){if(this.div)return this.div;const e=super.render();r(this,ja)&&(e.setAttribute("aria-label",r(this,ja)),e.setAttribute("role","mark")),r(this,Ue)?e.classList.add("free"):this.div.addEventListener("keydown",v(this,nt,lg).bind(this),{signal:this._uiManager._signal});const i=m(this,mr,document.createElement("div"));e.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=r(this,gr);const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),Rh(this,r(this,mr),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent.drawLayer.addClass(r(this,ie),"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(r(this,ie),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:v(this,nt,vh).call(this,!0);break;case 1:case 3:v(this,nt,vh).call(this,!1);break}}select(){var e,i;super.select(),r(this,ie)&&((e=this.parent)==null||e.drawLayer.removeClass(r(this,ie),"hovered"),(i=this.parent)==null||i.drawLayer.addClass(r(this,ie),"selected"))}unselect(){var e;super.unselect(),r(this,ie)&&((e=this.parent)==null||e.drawLayer.removeClass(r(this,ie),"selected"),r(this,Ue)||v(this,nt,vh).call(this,!1))}get _mustFixPosition(){return!r(this,Ue)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(r(this,Se),e),this.parent.drawLayer.show(r(this,ie),e))}static startHighlighting(e,i,{target:s,x:n,y:a}){const{x:o,y:l,width:c,height:d}=s.getBoundingClientRect(),f=new AbortController,u=e.combinedSignal(f),p=b=>{b.preventDefault(),b.stopPropagation()},g=b=>{f.abort(),v(this,pi,ug).call(this,e,b)};window.addEventListener("blur",g,{signal:u}),window.addEventListener("pointerup",g,{signal:u}),window.addEventListener("pointerdown",p,{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",mi,{signal:u}),s.addEventListener("pointermove",v(this,pi,dg).bind(this,e),{signal:u}),this._freeHighlight=new dd({x:n,y:a},[o,l,c,d],e.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static async deserialize(e,i,s){var b,w,A,T;let n=null;if(e instanceof Bp){const{data:{quadPoints:S,rect:x,rotation:P,id:R,color:M,opacity:L,popupRef:D},parent:{page:{pageNumber:O}}}=e;n=e={annotationType:at.HIGHLIGHT,color:Array.from(M),opacity:L,quadPoints:S,boxes:null,pageIndex:O-1,rect:x.slice(0),rotation:P,id:R,deleted:!1,popupRef:D}}else if(e instanceof tu){const{data:{inkLists:S,rect:x,rotation:P,id:R,color:M,borderStyle:{rawWidth:L},popupRef:D},parent:{page:{pageNumber:O}}}=e;n=e={annotationType:at.HIGHLIGHT,color:Array.from(M),thickness:L,inkLists:S,boxes:null,pageIndex:O-1,rect:x.slice(0),rotation:P,id:R,deleted:!1,popupRef:D}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=e,d=await super.deserialize(e,i,s);d.color=$.makeHexColor(...a),m(d,Ss,c||1),l&&m(d,di,e.thickness),d.annotationElementId=e.id||null,d._initialData=n;const[f,u]=d.pageDimensions,[p,g]=d.pageTranslation;if(o){const S=m(d,Es,[]);for(let x=0;x<o.length;x+=8)S.push({x:(o[x]-p)/f,y:1-(o[x+1]-g)/u,width:(o[x+2]-o[x])/f,height:(o[x+1]-o[x+5])/u});v(b=d,nt,gd).call(b),v(w=d,nt,xn).call(w),d.rotate(d.rotation)}else if(l){m(d,Ue,!0);const S=l[0],x={x:S[0]-p,y:u-(S[1]-g)},P=new dd(x,[0,0,f,u],1,r(d,di)/2,!0,.001);for(let L=0,D=S.length;L<D;L+=2)x.x=S[L]-p,x.y=u-(S[L+1]-g),P.add(x);const{id:R,clipPathId:M}=i.drawLayer.draw(P,d.color,d._defaultOpacity,!0);v(A=d,nt,bh).call(A,{highlightOutlines:P.getOutlines(),highlightId:R,clipPathId:M}),v(T=d,nt,xn).call(T)}return d}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=Rt._colorManager.convert(this.color),n={annotationType:at.HIGHLIGHT,color:s,opacity:r(this,Ss),thickness:r(this,di),quadPoints:v(this,nt,hg).call(this),outlines:v(this,nt,cg).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:v(this,nt,fo).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!v(this,nt,fg).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Na=new WeakMap,kl=new WeakMap,Es=new WeakMap,gr=new WeakMap,Ba=new WeakMap,ci=new WeakMap,Ml=new WeakMap,Ll=new WeakMap,mr=new WeakMap,Li=new WeakMap,Se=new WeakMap,Ue=new WeakMap,Ha=new WeakMap,Ss=new WeakMap,ie=new WeakMap,ja=new WeakMap,di=new WeakMap,Il=new WeakMap,nt=new WeakSet,gd=function(){const e=new uf(r(this,Es),.001);m(this,Li,e.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=r(this,Li).box;const i=new uf(r(this,Es),.0025,.001,this._uiManager.direction==="ltr");m(this,ci,i.getOutlines());const{lastPoint:s}=r(this,ci).box;m(this,Ha,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},bh=function({highlightOutlines:e,highlightId:i,clipPathId:s}){var f,u;if(m(this,Li,e),m(this,ci,e.getNewOutline(r(this,di)/2+1.5,.0025)),i>=0)m(this,Se,i),m(this,gr,s),this.parent.drawLayer.finalizeLine(i,e),m(this,ie,this.parent.drawLayer.drawOutline(r(this,ci)));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(r(this,Se),e),this.parent.drawLayer.updateBox(r(this,Se),v(f=_t,pi,Ur).call(f,r(this,Li).box,(p-this.rotation+360)%360)),this.parent.drawLayer.updateLine(r(this,ie),r(this,ci)),this.parent.drawLayer.updateBox(r(this,ie),v(u=_t,pi,Ur).call(u,r(this,ci).box,p))}const{x:a,y:o,width:l,height:c}=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[p,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*g/p,this.height=c*p/g;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[p,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*g/p,this.height=c*p/g;break}}const{lastPoint:d}=r(this,ci).box;m(this,Ha,[(d[0]-a)/l,(d[1]-o)/c])},rg=function(e){const i=(a,o)=>{var l,c,d;this.color=a,(l=this.parent)==null||l.drawLayer.changeColor(r(this,Se),a),(c=r(this,Ba))==null||c.updateColor(a),m(this,Ss,o),(d=this.parent)==null||d.drawLayer.changeOpacity(r(this,Se),o)},s=this.color,n=r(this,Ss);this.addCommands({cmd:i.bind(this,e,_t._defaultOpacity),undo:i.bind(this,s,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},ag=function(e){const i=r(this,di),s=n=>{m(this,di,n),v(this,nt,og).call(this,n)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},og=function(e){if(!r(this,Ue))return;v(this,nt,bh).call(this,{highlightOutlines:r(this,Li).getNewOutline(e/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},md=function(){r(this,Se)===null||!this.parent||(this.parent.drawLayer.remove(r(this,Se)),m(this,Se,null),this.parent.drawLayer.remove(r(this,ie)),m(this,ie,null))},xn=function(e=this.parent){r(this,Se)===null&&({id:ke(this,Se)._,clipPathId:ke(this,gr)._}=e.drawLayer.draw(r(this,Li),this.color,r(this,Ss)),m(this,ie,e.drawLayer.drawOutline(r(this,ci))),r(this,mr)&&(r(this,mr).style.clipPath=r(this,gr)))},pi=new WeakSet,Ur=function({x:e,y:i,width:s,height:n},a){switch(a){case 90:return{x:1-i-n,y:e,width:n,height:s};case 180:return{x:1-e-s,y:1-i-n,width:s,height:n};case 270:return{x:i,y:1-e-s,width:n,height:s}}return{x:e,y:i,width:s,height:n}},lg=function(e){_t._keyboardManager.exec(this,e)},vh=function(e){if(!r(this,Na))return;const i=window.getSelection();e?i.setPosition(r(this,Na),r(this,kl)):i.setPosition(r(this,Ml),r(this,Ll))},fo=function(){return r(this,Ue)?this.rotation:0},hg=function(){if(r(this,Ue))return null;const[e,i]=this.pageDimensions,[s,n]=this.pageTranslation,a=r(this,Es),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:d,width:f,height:u}of a){const p=c*e+s,g=(1-d-u)*i+n;o[l]=o[l+4]=p,o[l+1]=o[l+3]=g,o[l+2]=o[l+6]=p+f*e,o[l+5]=o[l+7]=g+u*i,l+=8}return o},cg=function(e){return r(this,Li).serialize(e,v(this,nt,fo).call(this))},dg=function(e,i){this._freeHighlight.add(i)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},ug=function(e,i){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},fg=function(e){const{color:i}=this._initialData;return e.color.some((s,n)=>s!==i[n])},y(_t,pi),tt(_t,"_defaultColor",null),tt(_t,"_defaultOpacity",1),tt(_t,"_defaultThickness",12),tt(_t,"_type","highlight"),tt(_t,"_editorType",at.HIGHLIGHT),tt(_t,"_freeHighlightId",-1),tt(_t,"_freeHighlight",null),tt(_t,"_freeHighlightClipId","");let Ih=_t;var br,vr,Ki,xs,ui,yr,wr,Ar,Ts,Wa,_r,Er,cn,B,pg,gg,mg,bg,vd,vg,yd,yg,wg,Ag,_g,Eg,Tn,wd,Ad,_d,yh,wh,Vr,Ed,Ah,Ns,Sg,Sd,xg,Tg,xd,_h,po;const Ht=class Ht extends Rt{constructor(e){super({...e,name:"inkEditor"});y(this,B);y(this,br,0);y(this,vr,0);y(this,Ki,null);y(this,xs,new Path2D);y(this,ui,!1);y(this,yr,null);y(this,wr,!1);y(this,Ar,!1);y(this,Ts,null);y(this,Wa,null);y(this,_r,0);y(this,Er,0);y(this,cn,null);this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,i){Rt.initialize(e,i)}static updateDefaultParams(e,i){switch(e){case et.INK_THICKNESS:Ht._defaultThickness=i;break;case et.INK_COLOR:Ht._defaultColor=i;break;case et.INK_OPACITY:Ht._defaultOpacity=i/100;break}}updateParams(e,i){switch(e){case et.INK_THICKNESS:v(this,B,pg).call(this,i);break;case et.INK_COLOR:v(this,B,gg).call(this,i);break;case et.INK_OPACITY:v(this,B,mg).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[et.INK_THICKNESS,Ht._defaultThickness],[et.INK_COLOR,Ht._defaultColor||Rt._defaultLineColor],[et.INK_OPACITY,Math.round(Ht._defaultOpacity*100)]]}get propertiesToUpdate(){return[[et.INK_THICKNESS,this.thickness||Ht._defaultThickness],[et.INK_COLOR,this.color||Ht._defaultColor||Rt._defaultLineColor],[et.INK_OPACITY,Math.round(100*(this.opacity??Ht._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(v(this,B,yh).call(this),v(this,B,wh).call(this)),this.isAttachedToDOM||(this.parent.add(this),v(this,B,Vr).call(this)),v(this,B,po).call(this)))}remove(){var e;this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,r(this,Ki)&&(clearTimeout(r(this,Ki)),m(this,Ki,null)),(e=r(this,Ts))==null||e.disconnect(),m(this,Ts,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,i]=this.parentDimensions,s=this.width*e,n=this.height*i;this.setDimensions(s,n)}enableEditMode(){r(this,ui)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,v(this,B,wd).call(this))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),v(this,B,Ad).call(this))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){r(this,ui)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),m(this,ui,!0),this.div.classList.add("disabled"),v(this,B,po).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||r(this,ui)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),v(this,B,vg).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),v(this,B,yd).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),v(this,B,_d).call(this,e)}canvasPointerleave(e){v(this,B,_d).call(this,e)}get isResizable(){return!this.isEmpty()&&r(this,ui)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[s,n,a,o]=v(this,B,bg).call(this);if(this.setAt(s,n,0,0),this.setDims(a,o),v(this,B,yh).call(this),this.width){const[l,c]=this.parentDimensions;this.setAspectRatio(this.width*l,this.height*c),this.setAt(e*l,i*c,this.width*l,this.height*c),m(this,Ar,!0),v(this,B,Vr).call(this),this.setDims(this.width*l,this.height*c),v(this,B,Tn).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return v(this,B,wh).call(this),this.div}setDimensions(e,i){const s=Math.round(e),n=Math.round(i);if(r(this,_r)===s&&r(this,Er)===n)return;m(this,_r,s),m(this,Er,n),this.canvas.style.visibility="hidden";const[a,o]=this.parentDimensions;this.width=e/a,this.height=i/o,this.fixAndSetPosition(),r(this,ui)&&v(this,B,Ed).call(this,e,i),v(this,B,Vr).call(this),v(this,B,Tn).call(this),this.canvas.style.visibility="visible",this.fixDims()}static async deserialize(e,i,s){var w,A,T;if(e instanceof tu)return null;const n=await super.deserialize(e,i,s);n.thickness=e.thickness,n.color=$.makeHexColor(...e.color),n.opacity=e.opacity;const[a,o]=n.pageDimensions,l=n.width*a,c=n.height*o,d=n.parentScale,f=e.thickness/2;m(n,ui,!0),m(n,_r,Math.round(l)),m(n,Er,Math.round(c));const{paths:u,rect:p,rotation:g}=e;for(let{bezier:S}of u){S=v(w=Ht,Ns,xg).call(w,S,p,g);const x=[];n.paths.push(x);let P=d*(S[0]-f),R=d*(S[1]-f);for(let L=2,D=S.length;L<D;L+=6){const O=d*(S[L]-f),j=d*(S[L+1]-f),st=d*(S[L+2]-f),X=d*(S[L+3]-f),G=d*(S[L+4]-f),Z=d*(S[L+5]-f);x.push([[P,R],[O,j],[st,X],[G,Z]]),P=G,R=Z}const M=v(this,Ns,Sg).call(this,x);n.bezierPath2D.push(M)}const b=v(A=n,B,xd).call(A);return m(n,vr,Math.max(Rt.MIN_SIZE,b[2]-b[0])),m(n,br,Math.max(Rt.MIN_SIZE,b[3]-b[1])),v(T=n,B,Ed).call(T,l,c),n}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),i=Rt._colorManager.convert(this.ctx.strokeStyle);return{annotationType:at.INK,color:i,thickness:this.thickness,opacity:this.opacity,paths:v(this,B,Tg).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};br=new WeakMap,vr=new WeakMap,Ki=new WeakMap,xs=new WeakMap,ui=new WeakMap,yr=new WeakMap,wr=new WeakMap,Ar=new WeakMap,Ts=new WeakMap,Wa=new WeakMap,_r=new WeakMap,Er=new WeakMap,cn=new WeakMap,B=new WeakSet,pg=function(e){const i=n=>{this.thickness=n,v(this,B,po).call(this)},s=this.thickness;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},gg=function(e){const i=n=>{this.color=n,v(this,B,Tn).call(this)},s=this.color;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},mg=function(e){const i=n=>{this.opacity=n,v(this,B,Tn).call(this)};e/=100;const s=this.opacity;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:et.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},bg=function(){const{parentRotation:e,parentDimensions:[i,s]}=this;switch(e){case 90:return[0,s,s,i];case 180:return[i,s,i,s];case 270:return[i,0,s,i];default:return[0,0,i,s]}},vd=function(){const{ctx:e,color:i,opacity:s,thickness:n,parentScale:a,scaleFactor:o}=this;e.lineWidth=n*a/o,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${i}${iv(s)}`},vg=function(e,i){this.canvas.addEventListener("contextmenu",mi,{signal:this._uiManager._signal}),v(this,B,Ad).call(this),m(this,yr,new AbortController);const s=this._uiManager.combinedSignal(r(this,yr));this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:s}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:s}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:s}),this.isEditing=!0,r(this,Ar)||(m(this,Ar,!0),v(this,B,Vr).call(this),this.thickness||(this.thickness=Ht._defaultThickness),this.color||(this.color=Ht._defaultColor||Rt._defaultLineColor),this.opacity??(this.opacity=Ht._defaultOpacity)),this.currentPath.push([e,i]),m(this,wr,!1),v(this,B,vd).call(this),m(this,cn,()=>{v(this,B,Ag).call(this),r(this,cn)&&window.requestAnimationFrame(r(this,cn))}),window.requestAnimationFrame(r(this,cn))},yd=function(e,i){const[s,n]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===s&&i===n)return;const a=this.currentPath;let o=r(this,xs);if(a.push([e,i]),m(this,wr,!0),a.length<=2){o.moveTo(...a[0]),o.lineTo(e,i);return}a.length===3&&(m(this,xs,o=new Path2D),o.moveTo(...a[0])),v(this,B,_g).call(this,o,...a.at(-3),...a.at(-2),e,i)},yg=function(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);r(this,xs).lineTo(...e)},wg=function(e,i){m(this,cn,null),e=Math.min(Math.max(e,0),this.canvas.width),i=Math.min(Math.max(i,0),this.canvas.height),v(this,B,yd).call(this,e,i),v(this,B,yg).call(this);let s;if(this.currentPath.length!==1)s=v(this,B,Eg).call(this);else{const c=[e,i];s=[[c,c.slice(),c.slice(),c]]}const n=r(this,xs),a=this.currentPath;this.currentPath=[],m(this,xs,new Path2D);const o=()=>{this.allRawPaths.push(a),this.paths.push(s),this.bezierPath2D.push(n),this._uiManager.rebuild(this)},l=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(v(this,B,yh).call(this),v(this,B,wh).call(this)),v(this,B,po).call(this))};this.addCommands({cmd:o,undo:l,mustExec:!0})},Ag=function(){if(!r(this,wr))return;m(this,wr,!1);const e=Math.ceil(this.thickness*this.parentScale),i=this.currentPath.slice(-3),s=i.map(o=>o[0]),n=i.map(o=>o[1]);Math.min(...s)-e,Math.max(...s)+e,Math.min(...n)-e,Math.max(...n)+e;const{ctx:a}=this;a.save(),a.clearRect(0,0,this.canvas.width,this.canvas.height);for(const o of this.bezierPath2D)a.stroke(o);a.stroke(r(this,xs)),a.restore()},_g=function(e,i,s,n,a,o,l){const c=(i+n)/2,d=(s+a)/2,f=(n+o)/2,u=(a+l)/2;e.bezierCurveTo(c+2*(n-c)/3,d+2*(a-d)/3,f+2*(n-f)/3,u+2*(a-u)/3,f,u)},Eg=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const i=[];let s,[n,a]=e[0];for(s=1;s<e.length-2;s++){const[p,g]=e[s],[b,w]=e[s+1],A=(p+b)/2,T=(g+w)/2,S=[n+2*(p-n)/3,a+2*(g-a)/3],x=[A+2*(p-A)/3,T+2*(g-T)/3];i.push([[n,a],S,x,[A,T]]),[n,a]=[A,T]}const[o,l]=e[s],[c,d]=e[s+1],f=[n+2*(o-n)/3,a+2*(l-a)/3],u=[c+2*(o-c)/3,d+2*(l-d)/3];return i.push([[n,a],f,u,[c,d]]),i},Tn=function(){if(this.isEmpty()){v(this,B,Ah).call(this);return}v(this,B,vd).call(this);const{canvas:e,ctx:i}=this;i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),v(this,B,Ah).call(this);for(const s of this.bezierPath2D)i.stroke(s)},wd=function(){if(r(this,Wa))return;m(this,Wa,new AbortController);const e=this._uiManager.combinedSignal(r(this,Wa));this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})},Ad=function(){var e;(e=this.pointerdownAC)==null||e.abort(),this.pointerdownAC=null},_d=function(e){var i;(i=r(this,yr))==null||i.abort(),m(this,yr,null),v(this,B,wd).call(this),r(this,Ki)&&clearTimeout(r(this,Ki)),m(this,Ki,setTimeout(()=>{m(this,Ki,null),this.canvas.removeEventListener("contextmenu",mi)},10)),v(this,B,wg).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},yh=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},wh=function(){m(this,Ts,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&this.setDimensions(i.width,i.height)})),r(this,Ts).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=r(this,Ts))==null||e.disconnect(),m(this,Ts,null)},{once:!0})},Vr=function(){if(!r(this,Ar))return;const[e,i]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*i),v(this,B,Ah).call(this)},Ed=function(e,i){const s=v(this,B,_h).call(this),n=(e-s)/r(this,vr),a=(i-s)/r(this,br);this.scaleFactor=Math.min(n,a)},Ah=function(){const e=v(this,B,_h).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},Ns=new WeakSet,Sg=function(e){const i=new Path2D;for(let s=0,n=e.length;s<n;s++){const[a,o,l,c]=e[s];s===0&&i.moveTo(...a),i.bezierCurveTo(o[0],o[1],l[0],l[1],c[0],c[1])}return i},Sd=function(e,i,s){const[n,a,o,l]=i;switch(s){case 0:for(let c=0,d=e.length;c<d;c+=2)e[c]+=n,e[c+1]=l-e[c+1];break;case 90:for(let c=0,d=e.length;c<d;c+=2){const f=e[c];e[c]=e[c+1]+n,e[c+1]=f+a}break;case 180:for(let c=0,d=e.length;c<d;c+=2)e[c]=o-e[c],e[c+1]+=a;break;case 270:for(let c=0,d=e.length;c<d;c+=2){const f=e[c];e[c]=o-e[c+1],e[c+1]=l-f}break;default:throw new Error("Invalid rotation")}return e},xg=function(e,i,s){const[n,a,o,l]=i;switch(s){case 0:for(let c=0,d=e.length;c<d;c+=2)e[c]-=n,e[c+1]=l-e[c+1];break;case 90:for(let c=0,d=e.length;c<d;c+=2){const f=e[c];e[c]=e[c+1]-a,e[c+1]=f-n}break;case 180:for(let c=0,d=e.length;c<d;c+=2)e[c]=o-e[c],e[c+1]-=a;break;case 270:for(let c=0,d=e.length;c<d;c+=2){const f=e[c];e[c]=l-e[c+1],e[c+1]=o-f}break;default:throw new Error("Invalid rotation")}return e},Tg=function(e,i,s,n){var d,f;const a=[],o=this.thickness/2,l=e*i+o,c=e*s+o;for(const u of this.paths){const p=[],g=[];for(let b=0,w=u.length;b<w;b++){const[A,T,S,x]=u[b];if(A[0]===x[0]&&A[1]===x[1]&&w===1){const X=e*A[0]+l,G=e*A[1]+c;p.push(X,G),g.push(X,G);break}const P=e*A[0]+l,R=e*A[1]+c,M=e*T[0]+l,L=e*T[1]+c,D=e*S[0]+l,O=e*S[1]+c,j=e*x[0]+l,st=e*x[1]+c;b===0&&(p.push(P,R),g.push(P,R)),p.push(M,L,D,O,j,st),g.push(M,L),b===w-1&&g.push(j,st)}a.push({bezier:v(d=Ht,Ns,Sd).call(d,p,n,this.rotation),points:v(f=Ht,Ns,Sd).call(f,g,n,this.rotation)})}return a},xd=function(){let e=1/0,i=-1/0,s=1/0,n=-1/0;for(const a of this.paths)for(const[o,l,c,d]of a){const f=$.bezierBoundingBox(...o,...l,...c,...d);e=Math.min(e,f[0]),s=Math.min(s,f[1]),i=Math.max(i,f[2]),n=Math.max(n,f[3])}return[e,s,i,n]},_h=function(){return r(this,ui)?Math.ceil(this.thickness*this.parentScale):0},po=function(e=!1){if(this.isEmpty())return;if(!r(this,ui)){v(this,B,Tn).call(this);return}const i=v(this,B,xd).call(this),s=v(this,B,_h).call(this);m(this,vr,Math.max(Rt.MIN_SIZE,i[2]-i[0])),m(this,br,Math.max(Rt.MIN_SIZE,i[3]-i[1]));const n=Math.ceil(s+r(this,vr)*this.scaleFactor),a=Math.ceil(s+r(this,br)*this.scaleFactor),[o,l]=this.parentDimensions;this.width=n/o,this.height=a/l,this.setAspectRatio(n,a);const c=this.translationX,d=this.translationY;this.translationX=-i[0],this.translationY=-i[1],v(this,B,Vr).call(this),v(this,B,Tn).call(this),m(this,_r,n),m(this,Er,a),this.setDims(n,a);const f=e?s/this.scaleFactor/2:0;this.translate(c-this.translationX-f,d-this.translationY-f)},y(Ht,Ns),tt(Ht,"_defaultColor",null),tt(Ht,"_defaultOpacity",1),tt(Ht,"_defaultThickness",1),tt(Ht,"_type","ink"),tt(Ht,"_editorType",at.INK);let bd=Ht;var Wt,me,dn,Cs,un,Ua,Qi,Ps,Ji,Ze,Va,pt,go,mo,Eh,Cd,Cg,Sh,Pd,xh,Pg,Rg;const yo=class yo extends Rt{constructor(e){super({...e,name:"stampEditor"});y(this,pt);y(this,Wt,null);y(this,me,null);y(this,dn,null);y(this,Cs,null);y(this,un,null);y(this,Ua,"");y(this,Qi,null);y(this,Ps,null);y(this,Ji,null);y(this,Ze,!1);y(this,Va,!1);m(this,Cs,e.bitmapUrl),m(this,un,e.bitmapFile)}static initialize(e,i){Rt.initialize(e,i)}static get supportedTypes(){return gt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return gt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,i){i.pasteEditor(at.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const i=e.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(e=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:a,height:o}=e||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:n,width:a,height:o,channels:n.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),i&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var e,i;r(this,me)&&(m(this,Wt,null),this._uiManager.imageManager.deleteId(r(this,me)),(e=r(this,Qi))==null||e.remove(),m(this,Qi,null),(i=r(this,Ps))==null||i.disconnect(),m(this,Ps,null),r(this,Ji)&&(clearTimeout(r(this,Ji)),m(this,Ji,null))),super.remove()}rebuild(){if(!this.parent){r(this,me)&&v(this,pt,Eh).call(this);return}super.rebuild(),this.div!==null&&(r(this,me)&&r(this,Qi)===null&&v(this,pt,Eh).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(r(this,dn)||r(this,Wt)||r(this,Cs)||r(this,un)||r(this,me))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,i;if(this.width&&(e=this.x,i=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),r(this,Wt)?v(this,pt,Cd).call(this):v(this,pt,Eh).call(this),this.width&&!this.annotationElementId){const[s,n]=this.parentDimensions;this.setAt(e*s,i*n,this.width*s,this.height*n)}return this.div}copyCanvas(e,i,s=!1){var p;e||(e=224);const{width:n,height:a}=r(this,Wt),o=new _c;let l=r(this,Wt),c=n,d=a,f=null;if(i){if(n>i||a>i){const L=Math.min(i/n,i/a);c=Math.floor(n*L),d=Math.floor(a*L)}f=document.createElement("canvas");const g=f.width=Math.ceil(c*o.sx),b=f.height=Math.ceil(d*o.sy);r(this,Ze)||(l=v(this,pt,Sh).call(this,g,b));const w=f.getContext("2d");w.filter=this._uiManager.hcmFilter;let A="white",T="#cfcfd8";this._uiManager.hcmFilter!=="none"?T="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(A="#8f8f9d",T="#42414d");const S=15,x=S*o.sx,P=S*o.sy,R=new OffscreenCanvas(x*2,P*2),M=R.getContext("2d");M.fillStyle=A,M.fillRect(0,0,x*2,P*2),M.fillStyle=T,M.fillRect(0,0,x,P),M.fillRect(x,P,x,P),w.fillStyle=w.createPattern(R,"repeat"),w.fillRect(0,0,g,b),w.drawImage(l,0,0,l.width,l.height,0,0,g,b)}let u=null;if(s){let g,b;if(o.symmetric&&l.width<e&&l.height<e)g=l.width,b=l.height;else if(l=r(this,Wt),n>e||a>e){const T=Math.min(e/n,e/a);g=Math.floor(n*T),b=Math.floor(a*T),r(this,Ze)||(l=v(this,pt,Sh).call(this,g,b))}const A=new OffscreenCanvas(g,b).getContext("2d",{willReadFrequently:!0});A.drawImage(l,0,0,l.width,l.height,0,0,g,b),u={width:g,height:b,data:A.getImageData(0,0,g,b).data}}return{canvas:f,width:c,height:d,imageData:u}}getImageForAltText(){return r(this,Qi)}static async deserialize(e,i,s){var b;let n=null;if(e instanceof Hp){const{data:{rect:w,rotation:A,id:T,structParent:S,popupRef:x},container:P,parent:{page:{pageNumber:R}}}=e,M=P.querySelector("canvas"),L=s.imageManager.getFromCanvas(P.id,M);M.remove();const D=((b=await i._structTree.getAriaAttributes(`${Vd}${T}`))==null?void 0:b.get("aria-label"))||"";n=e={annotationType:at.STAMP,bitmapId:L.id,bitmap:L.bitmap,pageIndex:R-1,rect:w.slice(0),rotation:A,id:T,deleted:!1,accessibilityData:{decorative:!1,altText:D},isSvg:!1,structParent:S,popupRef:x}}const a=await super.deserialize(e,i,s),{rect:o,bitmap:l,bitmapUrl:c,bitmapId:d,isSvg:f,accessibilityData:u}=e;d&&s.imageManager.isValidId(d)?(m(a,me,d),l&&m(a,Wt,l)):m(a,Cs,c),m(a,Ze,f);const[p,g]=a.pageDimensions;return a.width=(o[2]-o[0])/p,a.height=(o[3]-o[1])/g,a.annotationElementId=e.id||null,u&&(a.altTextData=u),a._initialData=n,m(a,Va,!!n),a}serialize(e=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:at.STAMP,bitmapId:r(this,me),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:r(this,Ze),structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=v(this,pt,xh).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:n,altText:a}=this.serializeAltText(!1);if(!n&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=v(this,pt,Rg).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const o=r(this,Ze)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(r(this,me)))i.stamps.set(r(this,me),{area:o,serialized:s}),s.bitmap=v(this,pt,xh).call(this,!1);else if(r(this,Ze)){const l=i.stamps.get(r(this,me));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=v(this,pt,xh).call(this,!1))}return s}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}};Wt=new WeakMap,me=new WeakMap,dn=new WeakMap,Cs=new WeakMap,un=new WeakMap,Ua=new WeakMap,Qi=new WeakMap,Ps=new WeakMap,Ji=new WeakMap,Ze=new WeakMap,Va=new WeakMap,pt=new WeakSet,go=function(e,i=!1){if(!e){this.remove();return}m(this,Wt,e.bitmap),i||(m(this,me,e.id),m(this,Ze,e.isSvg)),e.file&&m(this,Ua,e.file.name),v(this,pt,Cd).call(this)},mo=function(){if(m(this,dn,null),this._uiManager.enableWaiting(!1),!!r(this,Qi)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Wt)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,Wt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Eh=function(){if(r(this,me)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(r(this,me)).then(s=>v(this,pt,go).call(this,s,!0)).finally(()=>v(this,pt,mo).call(this));return}if(r(this,Cs)){const s=r(this,Cs);m(this,Cs,null),this._uiManager.enableWaiting(!0),m(this,dn,this._uiManager.imageManager.getFromUrl(s).then(n=>v(this,pt,go).call(this,n)).finally(()=>v(this,pt,mo).call(this)));return}if(r(this,un)){const s=r(this,un);m(this,un,null),this._uiManager.enableWaiting(!0),m(this,dn,this._uiManager.imageManager.getFromFile(s).then(n=>v(this,pt,go).call(this,n)).finally(()=>v(this,pt,mo).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=yo.supportedTypesStr;const i=this._uiManager._signal;m(this,dn,new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),v(this,pt,go).call(this,n)}s()},{signal:i}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>v(this,pt,mo).call(this))),e.click()},Cd=function(){const{div:e}=this;let{width:i,height:s}=r(this,Wt);const[n,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*n,s=this.height*a;else if(i>o*n||s>o*a){const f=Math.min(o*n/i,o*a/s);i*=f,s*=f}const[l,c]=this.parentDimensions;this.setDims(i*l/n,s*c/a),this._uiManager.enableWaiting(!1);const d=m(this,Qi,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),v(this,pt,Pd).call(this,i,s),v(this,pt,Pg).call(this),r(this,Va)||(this.parent.addUndoableEditor(this),m(this,Va,!0)),this._reportTelemetry({action:"inserted_image"}),r(this,Ua)&&d.setAttribute("aria-label",r(this,Ua))},Cg=function(e,i){var o;const[s,n]=this.parentDimensions;this.width=e/s,this.height=i/n,(o=this._initialOptions)!=null&&o.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,r(this,Ji)!==null&&clearTimeout(r(this,Ji)),m(this,Ji,setTimeout(()=>{m(this,Ji,null),v(this,pt,Pd).call(this,e,i)},200))},Sh=function(e,i){const{width:s,height:n}=r(this,Wt);let a=s,o=n,l=r(this,Wt);for(;a>2*e||o>2*i;){const c=a,d=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,c,d,0,0,a,o),l=f.transferToImageBitmap()}return l},Pd=function(e,i){const s=new _c,n=Math.ceil(e*s.sx),a=Math.ceil(i*s.sy),o=r(this,Qi);if(!o||o.width===n&&o.height===a)return;o.width=n,o.height=a;const l=r(this,Ze)?r(this,Wt):v(this,pt,Sh).call(this,n,a),c=o.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,n,a)},xh=function(e){if(e){if(r(this,Ze)){const n=this._uiManager.imageManager.getSvgUrl(r(this,me));if(n)return n}const i=document.createElement("canvas");return{width:i.width,height:i.height}=r(this,Wt),i.getContext("2d").drawImage(r(this,Wt),0,0),i.toDataURL()}if(r(this,Ze)){const[i,s]=this.pageDimensions,n=Math.round(this.width*i*mn.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*mn.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(n,a);return o.getContext("2d").drawImage(r(this,Wt),0,0,r(this,Wt).width,r(this,Wt).height,0,0,n,a),o.transferToImageBitmap()}return structuredClone(r(this,Wt))},Pg=function(){this._uiManager._signal&&(m(this,Ps,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&v(this,pt,Cg).call(this,i.width,i.height)})),r(this,Ps).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var e;(e=r(this,Ps))==null||e.disconnect(),m(this,Ps,null)},{once:!0}))},Rg=function(e){var c;const{rect:i,pageIndex:s,accessibilityData:{altText:n}}=this._initialData,a=e.rect.every((d,f)=>Math.abs(d-i[f])<1),o=e.pageIndex===s,l=(((c=e.accessibilityData)==null?void 0:c.alt)||"")===n;return{isSame:a&&o&&l,isSameAltText:l}},tt(yo,"_type","stamp"),tt(yo,"_editorType",at.STAMP);let Td=yo;var Sr,za,Zi,fn,Rs,ti,pn,$a,Ga,xe,ks,Y,gn,be,kg,kd,Md,Ld,Th;const vi=class vi{constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:s,accessibilityManager:n,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:d}){y(this,be);y(this,Sr);y(this,za,!1);y(this,Zi,null);y(this,fn,null);y(this,Rs,null);y(this,ti,new Map);y(this,pn,!1);y(this,$a,!1);y(this,Ga,!1);y(this,xe,null);y(this,ks,null);y(this,Y);const f=[...r(vi,gn).values()];if(!vi._initialized){vi._initialized=!0;for(const u of f)u.initialize(d,t)}t.registerEditorTypes(f),m(this,Y,t),this.pageIndex=e,this.div=i,m(this,Sr,n),m(this,Zi,a),this.viewport=c,m(this,xe,l),this.drawLayer=o,this._structTree=s,r(this,Y).addLayer(this)}get isEmpty(){return r(this,ti).size===0}get isInvisible(){return this.isEmpty&&r(this,Y).getMode()===at.NONE}updateToolbar(t){r(this,Y).updateToolbar(t)}updateMode(t=r(this,Y).getMode()){switch(v(this,be,Th).call(this),t){case at.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case at.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case at.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of r(vi,gn).values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=r(this,xe))==null?void 0:e.div)}addInkEditorIfNeeded(t){if(r(this,Y).getMode()!==at.INK)return;if(!t){for(const i of r(this,ti).values())if(i.isEmpty()){i.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){r(this,Y).setEditingState(t)}addCommands(t){r(this,Y).addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=r(this,Zi))==null||e.div.classList.toggle("disabled",!t)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of r(this,ti).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(r(this,Y).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!r(this,Zi))return;const e=r(this,Zi).getEditableAnnotations();for(const i of e){if(i.hide(),r(this,Y).isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}}disable(){var s;m(this,Ga,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const n of r(this,ti).values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){t.set(n.annotationElementId,n);continue}else e.set(n.annotationElementId,n);(s=this.getEditableAnnotation(n.annotationElementId))==null||s.show(),n.remove()}if(r(this,Zi)){const n=r(this,Zi).getEditableAnnotations();for(const a of n){const{id:o}=a.data;if(r(this,Y).isDeletedAnnotationElement(o))continue;let l=e.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=t.get(o),l&&(r(this,Y).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}v(this,be,Th).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const n of r(vi,gn).values())i.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),m(this,Ga,!1)}getEditableAnnotation(t){var e;return((e=r(this,Zi))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){r(this,Y).getActive()!==t&&r(this,Y).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=r(this,xe))!=null&&t.div&&!r(this,ks)){m(this,ks,new AbortController);const e=r(this,Y).combinedSignal(r(this,ks));r(this,xe).div.addEventListener("pointerdown",v(this,be,kg).bind(this),{signal:e}),r(this,xe).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=r(this,xe))!=null&&t.div&&r(this,ks)&&(r(this,ks).abort(),m(this,ks,null),r(this,xe).div.classList.remove("highlighting"))}enableClick(){if(r(this,fn))return;m(this,fn,new AbortController);const t=r(this,Y).combinedSignal(r(this,fn));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){var t;(t=r(this,fn))==null||t.abort(),m(this,fn,null)}attach(t){r(this,ti).set(t.id,t);const{annotationElementId:e}=t;e&&r(this,Y).isDeletedAnnotationElement(e)&&r(this,Y).removeDeletedAnnotationElement(t)}detach(t){var e;r(this,ti).delete(t.id),(e=r(this,Sr))==null||e.removePointerInTextLayer(t.contentDiv),!r(this,Ga)&&t.annotationElementId&&r(this,Y).addDeletedAnnotationElement(t)}remove(t){this.detach(t),r(this,Y).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,r(this,$a)||this.addInkEditorIfNeeded(!1)}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(r(this,Y).addDeletedAnnotationElement(t.annotationElementId),Rt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),r(this,Y).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),r(this,Y).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var i;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!r(this,Rs)&&(t._focusEventsAllowed=!1,m(this,Rs,setTimeout(()=>{m(this,Rs,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:r(this,Y)._signal}),e.focus())},0))),t._structTreeParentId=(i=r(this,Sr))==null?void 0:i.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return r(this,Y).getId()}combinedSignal(t){return r(this,Y).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=r(this,be,kd))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){r(this,Y).updateToolbar(t),r(this,Y).updateMode(t);const{offsetX:i,offsetY:s}=v(this,be,Ld).call(this),n=this.getNextId(),a=v(this,be,Md).call(this,{parent:this,id:n,x:i,y:s,uiManager:r(this,Y),isCentered:!0,...e});a&&this.add(a)}async deserialize(t){var e;return await((e=r(vi,gn).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,r(this,Y)))||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),n=v(this,be,Md).call(this,{parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:r(this,Y),isCentered:e,...i});return n&&this.add(n),n}addNewEditor(){this.createAndAddNewEditor(v(this,be,Ld).call(this),!0)}setSelected(t){r(this,Y).setSelected(t)}toggleSelected(t){r(this,Y).toggleSelected(t)}unselect(t){r(this,Y).unselect(t)}pointerup(t){const{isMac:e}=Fe.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&r(this,pn)){if(m(this,pn,!1),!r(this,za)){m(this,za,!0);return}if(r(this,Y).getMode()===at.STAMP){r(this,Y).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(r(this,Y).getMode()===at.HIGHLIGHT&&this.enableTextSelection(),r(this,pn)){m(this,pn,!1);return}const{isMac:e}=Fe.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;m(this,pn,!0);const i=r(this,Y).getActive();m(this,za,!i||i.isEmpty())}findNewParent(t,e,i){const s=r(this,Y).findParent(e,i);return s===null||s===this?!1:(s.changeParent(t),!0)}destroy(){var t,e;((t=r(this,Y).getActive())==null?void 0:t.parent)===this&&(r(this,Y).commitOrRemove(),r(this,Y).setActiveEditor(null)),r(this,Rs)&&(clearTimeout(r(this,Rs)),m(this,Rs,null));for(const i of r(this,ti).values())(e=r(this,Sr))==null||e.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,r(this,ti).clear(),r(this,Y).removeLayer(this)}render({viewport:t}){this.viewport=t,xr(this.div,t);for(const e of r(this,Y).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){r(this,Y).commitOrRemove(),v(this,be,Th).call(this);const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,xr(this.div,{rotation:i}),e!==i)for(const s of r(this,ti).values())s.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return r(this,Y).viewParameters.realScale}};Sr=new WeakMap,za=new WeakMap,Zi=new WeakMap,fn=new WeakMap,Rs=new WeakMap,ti=new WeakMap,pn=new WeakMap,$a=new WeakMap,Ga=new WeakMap,xe=new WeakMap,ks=new WeakMap,Y=new WeakMap,gn=new WeakMap,be=new WeakSet,kg=function(t){r(this,Y).unselectAll();const{target:e}=t;if(e===r(this,xe).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&r(this,xe).div.contains(e)){const{isMac:i}=Fe.platform;if(t.button!==0||t.ctrlKey&&i)return;r(this,Y).showAllEditors("highlight",!0,!0),r(this,xe).div.classList.add("free"),this.toggleDrawing(),Ih.startHighlighting(this,r(this,Y).direction==="ltr",{target:r(this,xe).div,x:t.x,y:t.y}),r(this,xe).div.addEventListener("pointerup",()=>{r(this,xe).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:r(this,Y)._signal}),t.preventDefault()}},kd=function(){return r(vi,gn).get(r(this,Y).getMode())},Md=function(t){const e=r(this,be,kd);return e?new e.prototype.constructor(t):null},Ld=function(){const{x:t,y:e,width:i,height:s}=this.div.getBoundingClientRect(),n=Math.max(0,t),a=Math.max(0,e),o=Math.min(window.innerWidth,t+i),l=Math.min(window.innerHeight,e+s),c=(n+o)/2-t,d=(a+l)/2-e,[f,u]=this.viewport.rotation%180===0?[c,d]:[d,c];return{offsetX:f,offsetY:u}},Th=function(){m(this,$a,!0);for(const t of r(this,ti).values())t.isEmpty()&&t.remove();m(this,$a,!1)},tt(vi,"_initialized",!1),y(vi,gn,new Map([ld,bd,Td,Ih].map(t=>[t._editorType,t])));let Rd=vi;var ts,Fl,Kt,Ms,Dl,Fd,kr,Dd,Mg;const fe=class fe{constructor({pageIndex:t}){y(this,kr);y(this,ts,null);y(this,Fl,0);y(this,Kt,new Map);y(this,Ms,new Map);this.pageIndex=t}setParent(t){if(!r(this,ts)){m(this,ts,t);return}if(r(this,ts)!==t){if(r(this,Kt).size>0)for(const e of r(this,Kt).values())e.remove(),t.append(e);m(this,ts,t)}}static get _svgFactory(){return gt(this,"_svgFactory",new Zd)}draw(t,e,i,s=!1){const n=ke(this,Fl)._++,a=v(this,kr,Dd).call(this,t.box);a.classList.add(...t.classNamesForDrawing);const o=fe._svgFactory.createElement("defs");a.append(o);const l=fe._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("d",t.toSVGPath()),s&&r(this,Ms).set(n,l);const d=v(this,kr,Mg).call(this,o,c),f=fe._svgFactory.createElement("use");return a.append(f),a.setAttribute("fill",e),a.setAttribute("fill-opacity",i),f.setAttribute("href",`#${c}`),r(this,Kt).set(n,a),{id:n,clipPathId:`url(#${d})`}}drawOutline(t){const e=ke(this,Fl)._++,i=v(this,kr,Dd).call(this,t.box);i.classList.add(...t.classNamesForOutlining);const s=fe._svgFactory.createElement("defs");i.append(s);const n=fe._svgFactory.createElement("path");s.append(n);const a=`path_p${this.pageIndex}_${e}`;n.setAttribute("id",a),n.setAttribute("d",t.toSVGPath()),n.setAttribute("vector-effect","non-scaling-stroke");let o;if(t.mustRemoveSelfIntersections){const d=fe._svgFactory.createElement("mask");s.append(d),o=`mask_p${this.pageIndex}_${e}`,d.setAttribute("id",o),d.setAttribute("maskUnits","objectBoundingBox");const f=fe._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const u=fe._svgFactory.createElement("use");d.append(u),u.setAttribute("href",`#${a}`),u.setAttribute("stroke","none"),u.setAttribute("fill","black"),u.setAttribute("fill-rule","nonzero"),u.classList.add("mask")}const l=fe._svgFactory.createElement("use");i.append(l),l.setAttribute("href",`#${a}`),o&&l.setAttribute("mask",`url(#${o})`);const c=l.cloneNode();return i.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),r(this,Kt).set(e,i),e}finalizeLine(t,e){const i=r(this,Ms).get(t);r(this,Ms).delete(t),this.updateBox(t,e.box),i.setAttribute("d",e.toSVGPath())}updateLine(t,e){r(this,Kt).get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}updatePath(t,e){r(this,Ms).get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){var i;v(i=fe,Dl,Fd).call(i,r(this,Kt).get(t),e)}show(t,e){r(this,Kt).get(t).classList.toggle("hidden",!e)}rotate(t,e){r(this,Kt).get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){r(this,Kt).get(t).setAttribute("fill",e)}changeOpacity(t,e){r(this,Kt).get(t).setAttribute("fill-opacity",e)}addClass(t,e){r(this,Kt).get(t).classList.add(e)}removeClass(t,e){r(this,Kt).get(t).classList.remove(e)}getSVGRoot(t){return r(this,Kt).get(t)}remove(t){r(this,Ms).delete(t),r(this,ts)!==null&&(r(this,Kt).get(t).remove(),r(this,Kt).delete(t))}destroy(){m(this,ts,null);for(const t of r(this,Kt).values())t.remove();r(this,Kt).clear(),r(this,Ms).clear()}};ts=new WeakMap,Fl=new WeakMap,Kt=new WeakMap,Ms=new WeakMap,Dl=new WeakSet,Fd=function(t,{x:e=0,y:i=0,width:s=1,height:n=1}={}){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*s}%`,a.height=`${100*n}%`},kr=new WeakSet,Dd=function(t){var i;const e=fe._svgFactory.create(1,1,!0);return r(this,ts).append(e),e.setAttribute("aria-hidden",!0),v(i=fe,Dl,Fd).call(i,e,t),e},Mg=function(t,e){const i=fe._svgFactory.createElement("clipPath");t.append(i);const s=`clip_${e}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const n=fe._svgFactory.createElement("use");return i.append(n),n.setAttribute("href",`#${e}`),n.classList.add("clip"),s},y(fe,Dl);let Id=fe;var Dy=it.AbortException,Oy=it.AnnotationEditorLayer,Ny=it.AnnotationEditorParamsType,By=it.AnnotationEditorType,Hy=it.AnnotationEditorUIManager,Lg=it.AnnotationLayer,Ig=it.AnnotationMode,jy=it.ColorPicker,Wy=it.DOMSVGFactory,Uy=it.DrawLayer,Vy=it.FeatureTest,eu=it.GlobalWorkerOptions,zy=it.ImageKind,$y=it.InvalidPDFException,Gy=it.MissingPDFException,qy=it.OPS,Xy=it.OutputScale,Yy=it.PDFDataRangeTransport,Ky=it.PDFDateString,Qy=it.PDFWorker,Jy=it.PasswordResponses,Zy=it.PermissionFlag,tw=it.PixelsPerInch,ew=it.RenderingCancelledException,Fg=it.TextLayer,iw=it.UnexpectedResponseException,sw=it.Util,nw=it.VerbosityLevel,rw=it.XfaLayer,aw=it.build,ow=it.createValidAbsoluteUrl,lw=it.fetchData,Dg=it.getDocument,hw=it.getFilenameFromUrl,cw=it.getPdfFilenameFromUrl,dw=it.getXfaPageViewport,uw=it.isDataScheme,fw=it.isPdfFile,pw=it.noContextMenu,gw=it.normalizeUnicode,mw=it.setLayerDimensions,bw=it.shadow,Og=it.version;const vw=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Dy,AnnotationEditorLayer:Oy,AnnotationEditorParamsType:Ny,AnnotationEditorType:By,AnnotationEditorUIManager:Hy,AnnotationLayer:Lg,AnnotationMode:Ig,ColorPicker:jy,DOMSVGFactory:Wy,DrawLayer:Uy,FeatureTest:Vy,GlobalWorkerOptions:eu,ImageKind:zy,InvalidPDFException:$y,MissingPDFException:Gy,OPS:qy,OutputScale:Xy,PDFDataRangeTransport:Yy,PDFDateString:Ky,PDFWorker:Qy,PasswordResponses:Jy,PermissionFlag:Zy,PixelsPerInch:tw,RenderingCancelledException:ew,TextLayer:Fg,UnexpectedResponseException:iw,Util:sw,VerbosityLevel:nw,XfaLayer:rw,build:aw,createValidAbsoluteUrl:ow,fetchData:lw,getDocument:Dg,getFilenameFromUrl:hw,getPdfFilenameFromUrl:cw,getXfaPageViewport:dw,isDataScheme:uw,isPdfFile:fw,noContextMenu:pw,normalizeUnicode:gw,setLayerDimensions:mw,shadow:bw,version:Og},Symbol.toStringTag,{value:"Module"}));var re=function(h,t,e){if(e||arguments.length===2)for(var i=0,s=t.length,n;i<s;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return h.concat(n||Array.prototype.slice.call(t))},yw=["onCopy","onCut","onPaste"],ww=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],Aw=["onFocus","onBlur"],_w=["onInput","onInvalid","onReset","onSubmit"],Ew=["onLoad","onError"],Sw=["onKeyDown","onKeyPress","onKeyUp"],xw=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],Tw=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],Cw=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],Pw=["onSelect"],Rw=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],kw=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],Mw=["onScroll"],Lw=["onWheel"],Iw=["onAnimationStart","onAnimationEnd","onAnimationIteration"],Fw=["onTransitionEnd"],Dw=["onToggle"],Ow=["onChange"],Nw=re(re(re(re(re(re(re(re(re(re(re(re(re(re(re(re(re(re([],yw,!0),ww,!0),Aw,!0),_w,!0),Ew,!0),Sw,!0),xw,!0),Tw,!0),Cw,!0),Pw,!0),Rw,!0),kw,!0),Mw,!0),Lw,!0),Iw,!0),Fw,!0),Ow,!0),Dw,!0);function Ng(h,t){var e={};return Nw.forEach(function(i){var s=h[i];s&&(t?e[i]=function(n){return s(n,t(i))}:e[i]=s)}),e}function jl(h){var t=!1,e=new Promise(function(i,s){h.then(function(n){return!t&&i(n)}).catch(function(n){return!t&&s(n)})});return{promise:e,cancel:function(){t=!0}}}var Bw="Invariant failed";function It(h,t){if(!h)throw new Error(Bw)}var gc,ff;function Hw(){if(ff)return gc;ff=1;var h=function(){};return gc=h,gc}var jw=Hw();const Te=sb(jw);var pf=Object.prototype.hasOwnProperty;function gf(h,t,e){for(e of h.keys())if(qr(e,t))return e}function qr(h,t){var e,i,s;if(h===t)return!0;if(h&&t&&(e=h.constructor)===t.constructor){if(e===Date)return h.getTime()===t.getTime();if(e===RegExp)return h.toString()===t.toString();if(e===Array){if((i=h.length)===t.length)for(;i--&&qr(h[i],t[i]););return i===-1}if(e===Set){if(h.size!==t.size)return!1;for(i of h)if(s=i,s&&typeof s=="object"&&(s=gf(t,s),!s)||!t.has(s))return!1;return!0}if(e===Map){if(h.size!==t.size)return!1;for(i of h)if(s=i[0],s&&typeof s=="object"&&(s=gf(t,s),!s)||!qr(i[1],t.get(s)))return!1;return!0}if(e===ArrayBuffer)h=new Uint8Array(h),t=new Uint8Array(t);else if(e===DataView){if((i=h.byteLength)===t.byteLength)for(;i--&&h.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(h)){if((i=h.byteLength)===t.byteLength)for(;i--&&h[i]===t[i];);return i===-1}if(!e||typeof h=="object"){i=0;for(e in h)if(pf.call(h,e)&&++i&&!pf.call(t,e)||!(e in t)||!qr(h[e],t[e]))return!1;return Object.keys(t).length===i}}return h!==h&&t!==t}const Bg=N.createContext(null);function Xr({children:h,type:t}){return F.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:h})}const Ww="noopener noreferrer nofollow";class Uw{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return It(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){It(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{It(this.pdfDocument),It(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{It(Array.isArray(e));const i=e[0];new Promise(s=>{It(this.pdfDocument),i instanceof Object?this.pdfDocument.getPageIndex(i).then(n=>{s(n)}).catch(()=>{It(!1)}):typeof i=="number"?s(i):It(!1)}).then(s=>{const n=s+1;It(this.pdfViewer),It(n>=1&&n<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:s,pageNumber:n})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;It(this.pdfViewer),It(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||Ww,t.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const mf={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},rc=typeof window<"u",Hg=rc&&window.location.protocol==="file:";function Vw(h){return typeof h<"u"}function _n(h){return Vw(h)&&h!==null}function zw(h){return typeof h=="string"}function $w(h){return h instanceof ArrayBuffer}function Gw(h){return It(rc),h instanceof Blob}function Od(h){return zw(h)&&/^data:/.test(h)}function bf(h){It(Od(h));const[t="",e=""]=h.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function qw(){return rc&&window.devicePixelRatio||1}const jg="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function vf(){Te(!Hg,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${jg}`)}function Xw(){Te(!Hg,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${jg}`)}function Pr(h){h!=null&&h.cancel&&h.cancel()}function Nd(h,t){return Object.defineProperty(h,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(h,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(h,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(h,"originalHeight",{get(){return this.view[3]},configurable:!0}),h}function Yw(h){return h.name==="RenderingCancelledException"}function Kw(h){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=s=>{if(!s.target)return e(new Error("Error while reading a file."));const{error:n}=s.target;if(!n)return e(new Error("Error while reading a file."));switch(n.code){case n.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case n.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case n.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(h)})}function Qw(h,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return h}}function qa(){return N.useReducer(Qw,{value:void 0,error:void 0})}var Jw=function(h,t,e,i){function s(n){return n instanceof e?n:new e(function(a){a(n)})}return new(e||(e=Promise))(function(n,a){function o(d){try{c(i.next(d))}catch(f){a(f)}}function l(d){try{c(i.throw(d))}catch(f){a(f)}}function c(d){d.done?n(d.value):s(d.value).then(o,l)}c((i=i.apply(h,t||[])).next())})},yf=function(h,t){var e={};for(var i in h)Object.prototype.hasOwnProperty.call(h,i)&&t.indexOf(i)<0&&(e[i]=h[i]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(h);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(h,i[s])&&(e[i[s]]=h[i[s]]);return e};const{PDFDataRangeTransport:Zw}=vw,tA=(h,t)=>{switch(t){case mf.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");h(e);break}case mf.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");h(e);break}}};function wf(h){return typeof h=="object"&&h!==null&&("data"in h||"range"in h||"url"in h)}const Bd=N.forwardRef(function(t,e){var{children:i,className:s,error:n="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:d,loading:f="Loading PDF…",noData:u="No PDF file specified.",onItemClick:p,onLoadError:g,onLoadProgress:b,onLoadSuccess:w,onPassword:A=tA,onSourceError:T,onSourceSuccess:S,options:x,renderMode:P,rotate:R}=t,M=yf(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[L,D]=qa(),{value:O,error:j}=L,[st,X]=qa(),{value:G,error:Z}=st,Q=N.useRef(new Uw),W=N.useRef([]),q=N.useRef(void 0),ut=N.useRef(void 0);l&&l!==q.current&&wf(l)&&(Te(!qr(l,q.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),q.current=l),x&&x!==ut.current&&(Te(!qr(x,ut.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),ut.current=x);const mt=N.useRef({scrollPageIntoView:At=>{const{dest:kt,pageNumber:$t,pageIndex:Ot=$t-1}=At;if(p){p({dest:kt,pageIndex:Ot,pageNumber:$t});return}const Re=W.current[Ot];if(Re){Re.scrollIntoView();return}Te(!1,`An internal link leading to page ${$t} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});N.useImperativeHandle(e,()=>({linkService:Q,pages:W,viewer:mt}),[]);function Ft(){S&&S()}function St(){j&&(Te(!1,j.toString()),T&&T(j))}function wt(){D({type:"RESET"})}N.useEffect(wt,[l,D]);const Jt=N.useCallback(()=>Jw(this,void 0,void 0,function*(){if(!l)return null;if(typeof l=="string")return Od(l)?{data:bf(l)}:(vf(),{url:l});if(l instanceof Zw)return{range:l};if($w(l))return{data:l};if(rc&&Gw(l))return{data:yield Kw(l)};if(It(typeof l=="object"),It(wf(l)),"url"in l&&typeof l.url=="string"){if(Od(l.url)){const{url:At}=l,kt=yf(l,["url"]),$t=bf(At);return Object.assign({data:$t},kt)}vf()}return l}),[l]);N.useEffect(()=>{const At=jl(Jt());return At.promise.then(kt=>{D({type:"RESOLVE",value:kt})}).catch(kt=>{D({type:"REJECT",error:kt})}),()=>{Pr(At)}},[Jt,D]),N.useEffect(()=>{if(!(typeof O>"u")){if(O===!1){St();return}Ft()}},[O]);function z(){G&&(w&&w(G),W.current=new Array(G.numPages),Q.current.setDocument(G))}function xt(){Z&&(Te(!1,Z.toString()),g&&g(Z))}N.useEffect(function(){X({type:"RESET"})},[X,O]),N.useEffect(function(){if(!O)return;const kt=x?Object.assign(Object.assign({},O),x):O,$t=Dg(kt);b&&($t.onProgress=b),A&&($t.onPassword=A);const Ot=$t,Re=Ot.promise.then(ai=>{X({type:"RESOLVE",value:ai})}).catch(ai=>{Ot.destroyed||X({type:"REJECT",error:ai})});return()=>{Re.finally(()=>Ot.destroy())}},[x,X,O]),N.useEffect(()=>{if(!(typeof G>"u")){if(G===!1){xt();return}z()}},[G]),N.useEffect(function(){Q.current.setViewer(mt.current),Q.current.setExternalLinkRel(a),Q.current.setExternalLinkTarget(o)},[a,o]);const ct=N.useCallback((At,kt)=>{W.current[At]=kt},[]),Pe=N.useCallback(At=>{delete W.current[At]},[]),de=N.useMemo(()=>({imageResourcesPath:d,linkService:Q.current,onItemClick:p,pdf:G,registerPage:ct,renderMode:P,rotate:R,unregisterPage:Pe}),[d,p,G,ct,P,R,Pe]),Tt=N.useMemo(()=>Ng(M,()=>G),[M,G]);function es(){return F.jsx(Bg.Provider,{value:de,children:i})}function ri(){return l?G==null?F.jsx(Xr,{type:"loading",children:typeof f=="function"?f():f}):G===!1?F.jsx(Xr,{type:"error",children:typeof n=="function"?n():n}):es():F.jsx(Xr,{type:"no-data",children:typeof u=="function"?u():u})}return F.jsx("div",Object.assign({className:Ol("react-pdf__Document",s),ref:c,style:{"--scale-factor":"1"}},Tt,{children:ri()}))});function Wg(){return N.useContext(Bg)}function Ug(){for(var h=[],t=0;t<arguments.length;t++)h[t]=arguments[t];var e=h.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(n){e.forEach(function(a){typeof a=="function"?a(n):a&&(a.current=n)})}}const Vg=N.createContext(null),zg={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},eA=/^H(\d+)$/;function iA(h){return h in zg}function ac(h){return"children"in h}function $g(h){return ac(h)?h.children.length===1&&0 in h.children&&"id"in h.children[0]:!1}function sA(h){const t={};if(ac(h)){const{role:e}=h,i=e.match(eA);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(iA(e)){const s=zg[e];s&&(t.role=s)}}return t}function Gg(h){const t={};if(ac(h)){if(h.alt!==void 0&&(t["aria-label"]=h.alt),h.lang!==void 0&&(t.lang=h.lang),$g(h)){const[e]=h.children;if(e){const i=Gg(e);return Object.assign(Object.assign({},t),i)}}}else"id"in h&&(t["aria-owns"]=h.id);return t}function nA(h){return h?Object.assign(Object.assign({},sA(h)),Gg(h)):null}function qg({className:h,node:t}){const e=N.useMemo(()=>nA(t),[t]),i=N.useMemo(()=>!ac(t)||$g(t)?null:t.children.map((s,n)=>F.jsx(qg,{node:s},n)),[t]);return F.jsx("span",Object.assign({className:h},e,{children:i}))}function oc(){return N.useContext(Vg)}function rA(){const h=oc();It(h);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=h,[i,s]=qa(),{value:n,error:a}=i,{customTextRenderer:o,page:l}=h;function c(){n&&e&&e(n)}function d(){a&&(Te(!1,a.toString()),t&&t(a))}return N.useEffect(function(){s({type:"RESET"})},[s,l]),N.useEffect(function(){if(o||!l)return;const u=jl(l.getStructTree()),p=u;return u.promise.then(g=>{s({type:"RESOLVE",value:g})}).catch(g=>{s({type:"REJECT",error:g})}),()=>Pr(p)},[o,l,s]),N.useEffect(()=>{if(n!==void 0){if(n===!1){d();return}c()}},[n]),n?F.jsx(qg,{className:"react-pdf__Page__structTree structTree",node:n}):null}const Af=Ig;function aA(h){const t=oc();It(t);const e=Object.assign(Object.assign({},t),h),{_className:i,canvasBackground:s,devicePixelRatio:n=qw(),onRenderError:a,onRenderSuccess:o,page:l,renderForms:c,renderTextLayer:d,rotate:f,scale:u}=e,{canvasRef:p}=h;It(l);const g=N.useRef(null);function b(){l&&o&&o(Nd(l,u))}function w(x){Yw(x)||(Te(!1,x.toString()),a&&a(x))}const A=N.useMemo(()=>l.getViewport({scale:u*n,rotation:f}),[n,l,f,u]),T=N.useMemo(()=>l.getViewport({scale:u,rotation:f}),[l,f,u]);N.useEffect(function(){if(!l)return;l.cleanup();const{current:P}=g;if(!P)return;P.width=A.width,P.height=A.height,P.style.width=`${Math.floor(T.width)}px`,P.style.height=`${Math.floor(T.height)}px`,P.style.visibility="hidden";const R={annotationMode:c?Af.ENABLE_FORMS:Af.ENABLE,canvasContext:P.getContext("2d",{alpha:!1}),viewport:A};s&&(R.background=s);const M=l.render(R),L=M;return M.promise.then(()=>{P.style.visibility="",b()}).catch(w),()=>Pr(L)},[s,l,c,A,T]);const S=N.useCallback(()=>{const{current:x}=g;x&&(x.width=0,x.height=0)},[]);return N.useEffect(()=>S,[S]),F.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:Ug(p,g),style:{display:"block",userSelect:"none"},children:d?F.jsx(rA,{}):null})}function oA(h){return"str"in h}function lA(){const h=oc();It(h);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:s,onRenderTextLayerSuccess:n,page:a,pageIndex:o,pageNumber:l,rotate:c,scale:d}=h;It(a);const[f,u]=qa(),{value:p,error:g}=f,b=N.useRef(null);Te(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function w(){p&&i&&i(p)}function A(){g&&(Te(!1,g.toString()),e&&e(g))}N.useEffect(function(){u({type:"RESET"})},[a,u]),N.useEffect(function(){if(!a)return;const L=jl(a.getTextContent()),D=L;return L.promise.then(O=>{u({type:"RESOLVE",value:O})}).catch(O=>{u({type:"REJECT",error:O})}),()=>Pr(D)},[a,u]),N.useEffect(()=>{if(p!==void 0){if(p===!1){A();return}w()}},[p]);const T=N.useCallback(()=>{n&&n()},[n]),S=N.useCallback(M=>{Te(!1,M.toString()),s&&s(M)},[s]);function x(){const M=b.current;M&&M.classList.add("selecting")}function P(){const M=b.current;M&&M.classList.remove("selecting")}const R=N.useMemo(()=>a.getViewport({scale:d,rotation:c}),[a,c,d]);return N.useLayoutEffect(function(){if(!a||!p)return;const{current:L}=b;if(!L)return;L.innerHTML="";const D=a.streamTextContent({includeMarkedContent:!0}),O={container:L,textContentSource:D,viewport:R},j=new Fg(O),st=j;return j.render().then(()=>{const X=document.createElement("div");X.className="endOfContent",L.append(X);const G=L.querySelectorAll('[role="presentation"]');if(t){let Z=0;p.items.forEach((Q,W)=>{if(!oA(Q))return;const q=G[Z];if(!q)return;const ut=t(Object.assign({pageIndex:o,pageNumber:l,itemIndex:W},Q));q.innerHTML=ut,Z+=Q.str&&Q.hasEOL?2:1})}T()}).catch(S),()=>Pr(st)},[t,S,T,a,o,l,p,R]),F.jsx("div",{className:Ol("react-pdf__Page__textContent","textLayer"),onMouseUp:P,onMouseDown:x,ref:b})}function hA(){const h=Wg(),t=oc();It(t);const e=Object.assign(Object.assign({},h),t),{imageResourcesPath:i,linkService:s,onGetAnnotationsError:n,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:o,onRenderAnnotationLayerSuccess:l,page:c,pdf:d,renderForms:f,rotate:u,scale:p=1}=e;It(d),It(c),It(s);const[g,b]=qa(),{value:w,error:A}=g,T=N.useRef(null);Te(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function S(){w&&a&&a(w)}function x(){A&&(Te(!1,A.toString()),n&&n(A))}N.useEffect(function(){b({type:"RESET"})},[b,c]),N.useEffect(function(){if(!c)return;const D=jl(c.getAnnotations()),O=D;return D.promise.then(j=>{b({type:"RESOLVE",value:j})}).catch(j=>{b({type:"REJECT",error:j})}),()=>{Pr(O)}},[b,c]),N.useEffect(()=>{if(w!==void 0){if(w===!1){x();return}S()}},[w]);function P(){l&&l()}function R(L){Te(!1,`${L}`),o&&o(L)}const M=N.useMemo(()=>c.getViewport({scale:p,rotation:u}),[c,u,p]);return N.useEffect(function(){if(!d||!c||!s||!w)return;const{current:D}=T;if(!D)return;const O=M.clone({dontFlip:!0}),j={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:D,l10n:null,page:c,structTreeLayer:null,viewport:O},st={annotations:w,annotationStorage:d.annotationStorage,div:D,imageResourcesPath:i,linkService:s,page:c,renderForms:f,viewport:O};D.innerHTML="";try{new Lg(j).render(st),P()}catch(X){R(X)}return()=>{}},[w,i,s,c,d,f,M]),F.jsx("div",{className:Ol("react-pdf__Page__annotations","annotationLayer"),ref:T})}var cA=function(h,t){var e={};for(var i in h)Object.prototype.hasOwnProperty.call(h,i)&&t.indexOf(i)<0&&(e[i]=h[i]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(h);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(h,i[s])&&(e[i[s]]=h[i[s]]);return e};const _f=1;function Hd(h){const t=Wg(),e=Object.assign(Object.assign({},t),h),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:n,canvasRef:a,children:o,className:l,customRenderer:c,customTextRenderer:d,devicePixelRatio:f,error:u="Failed to load the page.",height:p,inputRef:g,loading:b="Loading page…",noData:w="No page specified.",onGetAnnotationsError:A,onGetAnnotationsSuccess:T,onGetStructTreeError:S,onGetStructTreeSuccess:x,onGetTextError:P,onGetTextSuccess:R,onLoadError:M,onLoadSuccess:L,onRenderAnnotationLayerError:D,onRenderAnnotationLayerSuccess:O,onRenderError:j,onRenderSuccess:st,onRenderTextLayerError:X,onRenderTextLayerSuccess:G,pageIndex:Z,pageNumber:Q,pdf:W,registerPage:q,renderAnnotationLayer:ut=!0,renderForms:mt=!1,renderMode:Ft="canvas",renderTextLayer:St=!0,rotate:wt,scale:Jt=_f,unregisterPage:z,width:xt}=e,ct=cA(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Pe,de]=qa(),{value:Tt,error:es}=Pe,ri=N.useRef(null);It(W);const At=_n(Q)?Q-1:Z??null,kt=Q??(_n(Z)?Z+1:null),$t=wt??(Tt?Tt.rotate:null),Ot=N.useMemo(()=>{if(!Tt)return null;let K=1;const vt=Jt??_f;if(xt||p){const ye=Tt.getViewport({scale:1,rotation:$t});xt?K=xt/ye.width:p&&(K=p/ye.height)}return vt*K},[p,Tt,$t,Jt,xt]);N.useEffect(function(){return()=>{_n(At)&&s&&z&&z(At)}},[s,W,At,z]);function Re(){if(L){if(!Tt||!Ot)return;L(Nd(Tt,Ot))}if(s&&q){if(!_n(At)||!ri.current)return;q(At,ri.current)}}function ai(){es&&(Te(!1,es.toString()),M&&M(es))}N.useEffect(function(){de({type:"RESET"})},[de,W,At]),N.useEffect(function(){if(!W||!kt)return;const vt=jl(W.getPage(kt)),ye=vt;return vt.promise.then(ue=>{de({type:"RESOLVE",value:ue})}).catch(ue=>{de({type:"REJECT",error:ue})}),()=>Pr(ye)},[de,W,kt]),N.useEffect(()=>{if(Tt!==void 0){if(Tt===!1){ai();return}Re()}},[Tt,Ot]);const Bs=N.useMemo(()=>Tt&&_n(At)&&kt&&_n($t)&&_n(Ot)?{_className:i,canvasBackground:n,customTextRenderer:d,devicePixelRatio:f,onGetAnnotationsError:A,onGetAnnotationsSuccess:T,onGetStructTreeError:S,onGetStructTreeSuccess:x,onGetTextError:P,onGetTextSuccess:R,onRenderAnnotationLayerError:D,onRenderAnnotationLayerSuccess:O,onRenderError:j,onRenderSuccess:st,onRenderTextLayerError:X,onRenderTextLayerSuccess:G,page:Tt,pageIndex:At,pageNumber:kt,renderForms:mt,renderTextLayer:St,rotate:$t,scale:Ot}:null,[i,n,d,f,A,T,S,x,P,R,D,O,j,st,X,G,Tt,At,kt,mt,St,$t,Ot]),An=N.useMemo(()=>Ng(ct,()=>Tt&&(Ot?Nd(Tt,Ot):void 0)),[ct,Tt,Ot]),Fi=`${At}@${Ot}/${$t}`;function ve(){switch(Ft){case"custom":return It(c),F.jsx(c,{},`${Fi}_custom`);case"none":return null;case"canvas":default:return F.jsx(aA,{canvasRef:a},`${Fi}_canvas`)}}function bi(){return St?F.jsx(lA,{},`${Fi}_text`):null}function is(){return ut?F.jsx(hA,{},`${Fi}_annotations`):null}function ot(){return F.jsxs(Vg.Provider,{value:Bs,children:[ve(),bi(),is(),o]})}function bt(){return kt?W===null||Tt===void 0||Tt===null?F.jsx(Xr,{type:"loading",children:typeof b=="function"?b():b}):W===!1||Tt===!1?F.jsx(Xr,{type:"error",children:typeof u=="function"?u():u}):ot():F.jsx(Xr,{type:"no-data",children:typeof w=="function"?w():w})}return F.jsx("div",Object.assign({className:Ol(i,l),"data-page-number":kt,ref:Ug(g,ri),style:{"--scale-factor":`${Ot}`,backgroundColor:n||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},An,{children:bt()}))}Xw();eu.workerSrc="pdf.worker.mjs";eu.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${Og}/pdf.worker.min.mjs`;function dA({file:h,documentDimension:t}){const[e,i]=N.useState(null),[s,n]=N.useState(1),[a,o]=N.useState(1),l=()=>{o(g=>g+.2)},c=()=>{a!==1&&o(g=>g-.2)};function d({numPages:g}){i(g)}function f(g){n(b=>b+g)}function u(){f(-1)}function p(){f(1)}return N.useEffect(()=>{n(1)},[h]),h?F.jsxs("div",{children:[F.jsxs(zu,{id:"scaleButton",sx:{my:"1em"},children:[F.jsx(Ja,{onClick:l,variant:"outlined",children:"+"}),F.jsx(Ja,{onClick:c,variant:"outlined",disabled:a<=1,children:"-"})]}),F.jsx(Bd,{file:h,onLoadSuccess:d,loading:F.jsx("div",{style:{height:t.height,width:t.width},children:F.jsx(Ph,{})}),children:F.jsx(Hd,{renderTextLayer:!1,className:"page",scale:a,height:t.height,width:t.width,pageNumber:s,loading:F.jsx("div",{style:{height:t.height,width:t.width},children:F.jsx(Ph,{})})})}),F.jsxs("p",{style:{color:"black"},children:["Page ",s||(e?1:"--")," of ",e||"--"]}),F.jsxs(zu,{id:"pageButton",children:[F.jsx(Ja,{variant:"outlined",disabled:s<=1,onClick:u,children:"Previous"}),F.jsx(Ja,{variant:"outlined",disabled:s>=e,onClick:p,children:"Next"})]})]}):F.jsx("p",{children:"해당 날짜의 주보가 존재하지 않습니다."})}const Ch=new Date("2022/04/03"),uA=({isOpen:h,onClose:t,setParentDate:e})=>{const{openSnackbar:i}=nb(),[s,n]=N.useState(Cb(Tf(new Date),{days:1})),[a,o]=N.useState(null),[l,c]=N.useState(null),d=()=>{o(null),c(null),t()},f=T=>{o(T[0])},u=T=>{c(T[0])},[p,g]=N.useState(null);N.useEffect(()=>{const T=()=>{const S=bc.isMobile?document.documentElement.clientWidth:window.innerWidth;g(Math.min(S*.8,1300)/2-24)};return T(),window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]);const b=async()=>{try{A(!0);const T=new FormData;T.append("pdfs",a),T.append("pdfs",l),await ab(mc(s,"yyyyMMdd"),T),i("success","Uploaded Succesfully!"),e(s),d()}catch(T){console.log(T),i("error","Error Occured. Please contact to the administrator.")}finally{A(!1)}},[w,A]=N.useState(!1);return F.jsx(rb,{isOpen:h,onClose:d,maxHeight:"85vh",maxWidth:"1300px",children:w?F.jsx(Ph,{}):F.jsxs(F.Fragment,{children:[F.jsx("h1",{style:{marginTop:0},children:"주보 업로드"}),F.jsx(Cf,{value:s,minDate:Ch,onChange:n,disableDate:T=>!Kl(T)}),F.jsxs("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"},children:[F.jsxs("div",{style:{width:"49%"},children:[F.jsx("h3",{children:"헌금 내역 미포함"}),F.jsxs("div",{style:{height:"40svh"},children:[F.jsx("p",{children:a==null?void 0:a.name}),F.jsx(Bd,{file:a,noData:"파일을 선택해주세요.",children:F.jsx(Hd,{renderTextLayer:!1,className:"page",width:p,pageNumber:1})})]}),F.jsx("div",{style:{height:"12.75svh"},children:F.jsx(Vu,{accept:{"application/pdf":[]},handleChangeFile:f})})]}),F.jsxs("div",{style:{width:"49%"},children:[F.jsx("h3",{children:"헌금 내역 포함"}),F.jsxs("div",{style:{height:"40svh"},children:[F.jsx("p",{children:l==null?void 0:l.name}),F.jsx(Bd,{file:l,noData:"파일을 선택해주세요.",children:F.jsx(Hd,{renderTextLayer:!1,className:"page",width:p,pageNumber:1})})]}),F.jsx("div",{style:{height:"12.75svh"},children:F.jsx(Vu,{accept:{"application/pdf":[]},handleChangeFile:u})})]})]}),F.jsx(Ja,{fullWidth:!0,variant:"outlined",onClick:b,disabled:!a||!l,sx:{mt:"1.5em"},children:"Upload"})]})})},fA={backgroundImage:'url("/img/News/WeeklyUpdate/WeeklyUpdate.webp")'},PA=()=>{const{openModal:h}=ob(),t=lb(),e=hb(S=>S.authToken.authenticated),{maxDate:i,queryDate:s}=cb(),[n,a]=N.useState(null),[o,l]=N.useState(s),[c,d]=N.useState(!0),[f,u]=N.useState(!1),p=N.useCallback(async()=>{d(!0);try{const S=await db(o);a(S.data)}catch(S){console.log(S),a(null)}finally{d(!1)}},[o]),g=async()=>{const S=await fb(o);l(pb(JSON.stringify(S.data),"yyyyMMdd",new Date))},b=()=>{l(S=>Kl(S)?Pb(S,7):gb(S,{weekStartsOn:0}))},w=()=>{l(S=>Kl(S)?jd(S,7):Tf(S,{weekStartsOn:1}))};N.useEffect(()=>{p(),t("/weeklyupdate/"+mc(o,"yyyyMMdd"))},[o,e,p,t]);const[A,T]=N.useState({width:null,height:null});return N.useEffect(()=>{const S=()=>{const x=bc.isMobile?document.documentElement.clientWidth:window.innerWidth,P=bc.isMobile?document.documentElement.clientHeight:window.innerHeight,M=P/x>=16/10;T({width:M?x-30:null,height:M?null:P})};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]),F.jsxs(F.Fragment,{children:[F.jsx("div",{className:"title-wrapper",style:fA,children:F.jsx("div",{className:"title",children:F.jsx(ub,{variant:"h4",fontWeight:830,sx:{letterSpacing:"0.4em",pl:"0.4em",color:"white"},children:"주보"})})}),F.jsx("div",{className:"container-wrapper",children:F.jsxs("div",{className:"container",style:{textAlign:"center",paddingLeft:0,paddingRight:0},children:[F.jsxs(F.Fragment,{children:[F.jsx(ju,{id:"previousBulletin",onClick:b,disabled:Wu(o,Ch)||vb(o,Ch)||c,children:F.jsx(Rb,{})}),F.jsx(Cf,{value:o,minDate:Ch,maxDate:i,onChange:l,disableDate:S=>!Kl(S)}),F.jsx(ju,{id:"nextBulletin",onClick:w,disabled:Wu(o,i)||yb(o,i)||c,children:F.jsx(kb,{})})]}),c?F.jsx("div",{style:{height:"100vh"},children:F.jsx(Ph,{sx:{mt:2}})}):F.jsx(dA,{file:n,documentDimension:A})]})}),F.jsxs(wb,{children:[F.jsx(Uu,{id:"uploadBulletinButton",onClick:()=>h(uA,{setParentDate:l}),children:F.jsx(Mb,{})}),F.jsx(Uu,{id:"deleteBulletinButton",sx:{backgroundColor:"#d10000",color:"white",":hover":{backgroundColor:"#ff0000"}},onClick:()=>u(!0),children:F.jsx(mb,{})}),F.jsx(Ab,{title:"삭제하시겠습니까?",body:`${mc(o,"yyyyMMdd")} 주보가 삭제됩니다`,isOpen:f,onClose:()=>u(!1),onConfirm:g})]})]})};export{PA as default};
