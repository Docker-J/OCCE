import{r as s,j as e,a0 as I,z as S,G as w,C as u,B as f,a$ as b,b0 as C,x as O,T as N,a1 as E,av as M,b1 as P}from"./index-DKCTCQLW.js";import{A as k}from"./Add-BWx2kbRm.js";import{I as F,a as L}from"./ImageListItem-ScX54qgz.js";import{I as T,u as R,a as U}from"./ImagePreviews-DgnHy-lV.js";import{F as A}from"./FileUploadComponent-BTfPnJ1U.js";import{A as W,F as B}from"./AdminComponent-B4RYgW97.js";import{u as H}from"./index-BCcwPcEs.js";import{S as j}from"./Stack-C5z8-Dnu.js";const z=({posts:m})=>m.map(a=>e.jsx(F,{component:I,to:a.ID,children:e.jsx("img",{src:`https://imagedelivery.net/ICo2WI8PXO_BVRlWfwzOww/${a.Cover}/thumbnail`,alt:"thumbnail",loading:"lazy"})},a.ID)),D=s.memo(z),J=({isOpen:m,onClose:a})=>{const{openSnackbar:p}=S(),t=()=>{i(),a()},[d,n]=s.useState([]),[h,r]=s.useState([]),g=l=>{n(c=>[...c,...l]),l.forEach(c=>{r(y=>R(y,{$push:[URL.createObjectURL(c)]}))})},o=async()=>{const l=new FormData;d.forEach(c=>{l.append("images",c)});try{x(!0),await b(l),p("success","Uploaded Succesfully!"),t()}catch(c){console.log(c),p("error","Error Occured. Please contact to the administrator.")}finally{x(!1)}},i=()=>{h.forEach(l=>URL.revokeObjectURL(l)),n([]),r([])},[v,x]=s.useState(!1);return e.jsx(w,{isOpen:m,onClose:t,maxHeight:"85vh",maxWidth:"1300px",children:v?e.jsx(u,{}):e.jsxs(e.Fragment,{children:[e.jsx(T,{imagesPreview:h,setImagesPreview:r,setFilesToUpload:n}),e.jsx("div",{style:{width:"100%",height:"12.75svh"},children:e.jsx(A,{accept:{"image/*":[]},handleChangeFile:g,multiple:!0})}),e.jsxs("div",{style:{display:"flex",marginTop:"1.5em",width:"100%"},children:[e.jsx(f,{variant:"outlined",disabled:d.length<=0,onClick:o,fullWidth:!0,children:"Submit"}),e.jsx(f,{variant:"outlined",onClick:i,disabled:d.length<=0,fullWidth:!0,children:"Clear All"})]})]})})},$=12,G={backgroundImage:'url("/img/Online/MeditationON.webp")'},ee=()=>{const m=H("(min-width:1200px)"),a=C(),{openModal:p}=O(),[t,d]=s.useState([]),[n,h]=s.useState(!1),r=async()=>{console.log("test getPosts");const o=await P(t);o.data.length>0?d(i=>[...i,...o.data]):h(!0)};s.useEffect(()=>{t.length%$!==0&&h(!0)},[t]),s.useEffect(()=>{console.log(a),a==="POP"&&JSON.parse(sessionStorage.getItem("posts")).length>0?d(JSON.parse(sessionStorage.getItem("posts"))):(console.log("get"),r())},[]),s.useEffect(()=>()=>{sessionStorage.setItem("posts",JSON.stringify(t))});const g=s.useRef();return s.useEffect(()=>{g.current&&!n&&t.length>=12&&setTimeout(()=>{try{const o=g.current.clientHeight,i=window.innerHeight-500;console.log("test content",o),console.log("test screen",i),o>100&&o<i&&r()}catch{}},500)},[t]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title-wrapper",style:G,children:e.jsx("div",{className:"title",children:e.jsx(N,{variant:"h4",fontWeight:830,sx:{letterSpacing:"0.4em",pl:"0.4em",color:"white"},children:"묵상 ON"})})}),e.jsx("div",{className:"container-wrapper",children:e.jsx(E,{className:"container",sx:{px:{xs:"0 !important",md:"1.5em !important"},py:"0 !important"},children:t.length<=0?e.jsx(j,{alignItems:"center",children:e.jsx(u,{})}):e.jsx(U,{dataLength:t.length,next:r,hasMore:!n,loader:e.jsx(j,{alignItems:"center",children:e.jsx(u,{})}),scrollThreshold:1,style:{overflowY:"hidden"},children:e.jsx(L,{ref:g,cols:m?4:3,gap:3,children:e.jsx(D,{posts:t})})})})}),e.jsx(W,{children:e.jsx(B,{variant:"primary",style:{position:"fixed",right:"2vw",bottom:"3vh"},onClick:()=>p(J,{}),children:e.jsx(k,{})})}),n&&e.jsx(M,{})]})};export{ee as default};
