import{r as s,n as e,a2 as x,D as C,k as u,B as y,F as S,K as O,a$ as N,b0 as E,z as M,T as P,a3 as k,ar as F,b1 as L}from"./index-Dwj7peSb.js";import{A as T}from"./Add-Bx0OgEs9.js";import{I as U,a as A}from"./ImageListItem-C7z5NW7v.js";import{I as R,u as W,a as B}from"./ImagePreviews-BFaNRnNz.js";import{F as H}from"./FileUploadComponent-COEch6tD.js";import{C as f}from"./CircularProgress-CcMbAy8M.js";import{F as j,A as z}from"./AdminComponent-DID4qE_L.js";import{u as D}from"./index-DzAaGmuo.js";import{S as I}from"./Stack-CaZpkoUK.js";const J=({posts:m})=>m.map(a=>e(U,{component:x,to:a.ID,children:e("img",{src:`https://imagedelivery.net/ICo2WI8PXO_BVRlWfwzOww/${a.Cover}/thumbnail`,alt:"thumbnail",loading:"lazy"})},a.ID)),$=s.memo(J),_=({isOpen:m,onClose:a})=>{const{openSnackbar:p}=C(),t=()=>{i(),a()},[d,n]=s.useState([]),[h,r]=s.useState([]),g=l=>{n(c=>[...c,...l]),l.forEach(c=>{r(b=>W(b,{$push:[URL.createObjectURL(c)]}))})},o=async()=>{const l=new FormData;d.forEach(c=>{l.append("images",c)});try{v(!0),await N(l),p("success","Uploaded Succesfully!"),t()}catch(c){console.log(c),p("error","Error Occured. Please contact to the administrator.")}finally{v(!1)}},i=()=>{h.forEach(l=>URL.revokeObjectURL(l)),n([]),r([])},[w,v]=s.useState(!1);return e(O,{isOpen:m,onClose:t,maxHeight:"85vh",maxWidth:"1300px",children:w?e(f,{}):u(S,{children:[e(R,{imagesPreview:h,setImagesPreview:r,setFilesToUpload:n}),e("div",{style:{width:"100%",height:"12.75svh"},children:e(H,{accept:{"image/*":[]},handleChangeFile:g,multiple:!0})}),u("div",{style:{display:"flex",marginTop:"1.5em",width:"100%"},children:[e(y,{variant:"outlined",disabled:d.length<=0,onClick:o,fullWidth:!0,children:"Submit"}),e(y,{variant:"outlined",onClick:i,disabled:d.length<=0,fullWidth:!0,children:"Clear All"})]})]})})},G=12,K={backgroundImage:'url("/img/Online/MeditationON.webp")'},oe=()=>{const m=D("(min-width:1200px)"),a=E(),{openModal:p}=M(),[t,d]=s.useState([]),[n,h]=s.useState(!1),r=async()=>{console.log("test getPosts");const o=await L(t);o.data.length>0?d(i=>[...i,...o.data]):h(!0)};s.useEffect(()=>{t.length%G!==0&&h(!0)},[t]),s.useEffect(()=>{console.log(a),a==="POP"&&JSON.parse(sessionStorage.getItem("posts")).length>0?d(JSON.parse(sessionStorage.getItem("posts"))):(console.log("get"),r())},[]),s.useEffect(()=>()=>{sessionStorage.setItem("posts",JSON.stringify(t))});const g=s.useRef();return s.useEffect(()=>{g.current&&!n&&t.length>=12&&setTimeout(()=>{try{const o=g.current.clientHeight,i=window.innerHeight-500;console.log("test content",o),console.log("test screen",i),o>100&&o<i&&r()}catch{}},500)},[t]),u(S,{children:[e("div",{className:"title-wrapper",style:K,children:e("div",{className:"title",children:e(P,{variant:"h4",fontWeight:830,sx:{letterSpacing:"0.4em",pl:"0.4em",color:"white"},children:"묵상 ON"})})}),e("div",{className:"container-wrapper",children:e(k,{className:"container",sx:{px:{xs:"0 !important",md:"1.5em !important"},py:"0 !important"},children:t.length<=0?e(I,{alignItems:"center",children:e(f,{})}):e(B,{dataLength:t.length,next:r,hasMore:!n,loader:e(I,{alignItems:"center",children:e(f,{})}),scrollThreshold:1,style:{overflowY:"hidden"},children:e(A,{ref:g,cols:m?4:3,gap:3,children:e($,{posts:t})})})})}),e(z,{children:e(j,{variant:"primary",style:{position:"fixed",right:"2vw",bottom:"3vh"},onClick:()=>p(_,{}),children:e(T,{})})}),n&&e(F,{})]})};export{oe as default};
